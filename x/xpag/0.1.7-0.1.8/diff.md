# Comparing `tmp/xpag-0.1.7-py3-none-any.whl.zip` & `tmp/xpag-0.1.8-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,42 +1,42 @@
-Zip file size: 54775 bytes, number of entries: 40
--rw-r--r--  2.0 unx      211 b- defN 23-Apr-14 18:03 xpag/__init__.py
--rw-r--r--  2.0 unx      204 b- defN 23-Apr-14 18:03 xpag/agents/__init__.py
--rw-r--r--  2.0 unx     1098 b- defN 23-Apr-14 18:03 xpag/agents/agent.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-14 18:03 xpag/agents/sac/__init__.py
--rw-r--r--  2.0 unx     5554 b- defN 23-Apr-14 18:03 xpag/agents/sac/sac.py
--rw-r--r--  2.0 unx    18817 b- defN 23-Apr-14 18:03 xpag/agents/sac/sac_from_jaxrl.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-14 18:03 xpag/agents/sdqn/__init__.py
--rw-r--r--  2.0 unx    22063 b- defN 23-Apr-14 18:03 xpag/agents/sdqn/sdqn.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-14 18:03 xpag/agents/td3/__init__.py
--rw-r--r--  2.0 unx    15221 b- defN 23-Apr-14 18:03 xpag/agents/td3/td3.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-14 18:03 xpag/agents/tqc/__init__.py
--rw-r--r--  2.0 unx    12988 b- defN 23-Apr-14 18:03 xpag/agents/tqc/tqc.py
--rw-r--r--  2.0 unx      160 b- defN 23-Apr-14 18:03 xpag/buffers/__init__.py
--rw-r--r--  2.0 unx    11221 b- defN 23-Apr-14 18:03 xpag/buffers/buffer.py
--rw-r--r--  2.0 unx     5236 b- defN 23-Apr-14 18:03 xpag/buffers/jax_buffer.py
--rw-r--r--  2.0 unx       55 b- defN 23-Apr-14 18:03 xpag/plotting/__init__.py
--rw-r--r--  2.0 unx     4086 b- defN 23-Apr-14 18:03 xpag/plotting/plotting.py
--rw-r--r--  2.0 unx     2841 b- defN 23-Apr-14 18:03 xpag/samplers/HER.py
--rw-r--r--  2.0 unx      182 b- defN 23-Apr-14 18:03 xpag/samplers/__init__.py
--rw-r--r--  2.0 unx     2941 b- defN 23-Apr-14 18:03 xpag/samplers/jax_sampler.py
--rw-r--r--  2.0 unx     1829 b- defN 23-Apr-14 18:03 xpag/samplers/sampler.py
--rw-r--r--  2.0 unx       71 b- defN 23-Apr-14 18:03 xpag/setters/__init__.py
--rw-r--r--  2.0 unx     3734 b- defN 23-Apr-14 18:03 xpag/setters/setter.py
--rw-r--r--  2.0 unx      438 b- defN 23-Apr-14 18:03 xpag/tools/__init__.py
--rw-r--r--  2.0 unx     5065 b- defN 23-Apr-14 18:03 xpag/tools/eval.py
--rw-r--r--  2.0 unx     7611 b- defN 23-Apr-14 18:03 xpag/tools/learn.py
--rw-r--r--  2.0 unx     3225 b- defN 23-Apr-14 18:03 xpag/tools/logging.py
--rw-r--r--  2.0 unx     4708 b- defN 23-Apr-14 18:03 xpag/tools/replay.py
--rw-r--r--  2.0 unx      899 b- defN 23-Apr-14 18:03 xpag/tools/timing.py
--rw-r--r--  2.0 unx     5273 b- defN 23-Apr-14 18:03 xpag/tools/utils.py
--rw-r--r--  2.0 unx      179 b- defN 23-Apr-14 18:03 xpag/wrappers/__init__.py
--rw-r--r--  2.0 unx     8257 b- defN 23-Apr-14 18:03 xpag/wrappers/brax_vec_env.py
--rw-r--r--  2.0 unx     6071 b- defN 23-Apr-14 18:03 xpag/wrappers/goalenv_wrapper.py
--rw-r--r--  2.0 unx    10125 b- defN 23-Apr-14 18:03 xpag/wrappers/gym_vec_env.py
--rw-r--r--  2.0 unx      936 b- defN 23-Apr-14 18:03 xpag/wrappers/reset_done.py
--rw-r--r--  2.0 unx     1517 b- defN 23-Apr-14 18:03 xpag-0.1.7.dist-info/LICENSE
--rw-r--r--  2.0 unx    15098 b- defN 23-Apr-14 18:03 xpag-0.1.7.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-14 18:03 xpag-0.1.7.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Apr-14 18:03 xpag-0.1.7.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3184 b- defN 23-Apr-14 18:03 xpag-0.1.7.dist-info/RECORD
-40 files, 181195 bytes uncompressed, 49753 bytes compressed:  72.5%
+Zip file size: 54803 bytes, number of entries: 40
+-rw-r--r--  2.0 unx      211 b- defN 23-May-09 14:49 xpag/__init__.py
+-rw-r--r--  2.0 unx      204 b- defN 23-May-09 14:49 xpag/agents/__init__.py
+-rw-r--r--  2.0 unx     1098 b- defN 23-May-09 14:49 xpag/agents/agent.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/sac/__init__.py
+-rw-r--r--  2.0 unx     5554 b- defN 23-May-09 14:49 xpag/agents/sac/sac.py
+-rw-r--r--  2.0 unx    18817 b- defN 23-May-09 14:49 xpag/agents/sac/sac_from_jaxrl.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/sdqn/__init__.py
+-rw-r--r--  2.0 unx    22063 b- defN 23-May-09 14:49 xpag/agents/sdqn/sdqn.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/td3/__init__.py
+-rw-r--r--  2.0 unx    15221 b- defN 23-May-09 14:49 xpag/agents/td3/td3.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/tqc/__init__.py
+-rw-r--r--  2.0 unx    12988 b- defN 23-May-09 14:49 xpag/agents/tqc/tqc.py
+-rw-r--r--  2.0 unx      160 b- defN 23-May-09 14:49 xpag/buffers/__init__.py
+-rw-r--r--  2.0 unx    11221 b- defN 23-May-09 14:49 xpag/buffers/buffer.py
+-rw-r--r--  2.0 unx     5236 b- defN 23-May-09 14:49 xpag/buffers/jax_buffer.py
+-rw-r--r--  2.0 unx       55 b- defN 23-May-09 14:49 xpag/plotting/__init__.py
+-rw-r--r--  2.0 unx     4086 b- defN 23-May-09 14:49 xpag/plotting/plotting.py
+-rw-r--r--  2.0 unx     2841 b- defN 23-May-09 14:49 xpag/samplers/HER.py
+-rw-r--r--  2.0 unx      182 b- defN 23-May-09 14:49 xpag/samplers/__init__.py
+-rw-r--r--  2.0 unx     2941 b- defN 23-May-09 14:49 xpag/samplers/jax_sampler.py
+-rw-r--r--  2.0 unx     1917 b- defN 23-May-09 14:49 xpag/samplers/sampler.py
+-rw-r--r--  2.0 unx       71 b- defN 23-May-09 14:49 xpag/setters/__init__.py
+-rw-r--r--  2.0 unx     3734 b- defN 23-May-09 14:49 xpag/setters/setter.py
+-rw-r--r--  2.0 unx      438 b- defN 23-May-09 14:49 xpag/tools/__init__.py
+-rw-r--r--  2.0 unx     5065 b- defN 23-May-09 14:49 xpag/tools/eval.py
+-rw-r--r--  2.0 unx     7611 b- defN 23-May-09 14:49 xpag/tools/learn.py
+-rw-r--r--  2.0 unx     3225 b- defN 23-May-09 14:49 xpag/tools/logging.py
+-rw-r--r--  2.0 unx     4708 b- defN 23-May-09 14:49 xpag/tools/replay.py
+-rw-r--r--  2.0 unx      899 b- defN 23-May-09 14:49 xpag/tools/timing.py
+-rw-r--r--  2.0 unx     5273 b- defN 23-May-09 14:49 xpag/tools/utils.py
+-rw-r--r--  2.0 unx      179 b- defN 23-May-09 14:49 xpag/wrappers/__init__.py
+-rw-r--r--  2.0 unx     8257 b- defN 23-May-09 14:49 xpag/wrappers/brax_vec_env.py
+-rw-r--r--  2.0 unx     6071 b- defN 23-May-09 14:49 xpag/wrappers/goalenv_wrapper.py
+-rw-r--r--  2.0 unx    10125 b- defN 23-May-09 14:49 xpag/wrappers/gym_vec_env.py
+-rw-r--r--  2.0 unx      936 b- defN 23-May-09 14:49 xpag/wrappers/reset_done.py
+-rw-r--r--  2.0 unx     1517 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/LICENSE
+-rw-r--r--  2.0 unx    15098 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3184 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/RECORD
+40 files, 181283 bytes uncompressed, 49781 bytes compressed:  72.5%
```

## zipnote {}

```diff
@@ -99,23 +99,23 @@
 
 Filename: xpag/wrappers/gym_vec_env.py
 Comment: 
 
 Filename: xpag/wrappers/reset_done.py
 Comment: 
 
-Filename: xpag-0.1.7.dist-info/LICENSE
+Filename: xpag-0.1.8.dist-info/LICENSE
 Comment: 
 
-Filename: xpag-0.1.7.dist-info/METADATA
+Filename: xpag-0.1.8.dist-info/METADATA
 Comment: 
 
-Filename: xpag-0.1.7.dist-info/WHEEL
+Filename: xpag-0.1.8.dist-info/WHEEL
 Comment: 
 
-Filename: xpag-0.1.7.dist-info/top_level.txt
+Filename: xpag-0.1.8.dist-info/top_level.txt
 Comment: 
 
-Filename: xpag-0.1.7.dist-info/RECORD
+Filename: xpag-0.1.8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## xpag/__init__.py

```diff
@@ -2,8 +2,8 @@
 from xpag import plotting
 from xpag import wrappers
 from xpag import buffers
 from xpag import samplers
 from xpag import agents
 from xpag import setters
 
-__version__ = "0.1.7"  # -version-
+__version__ = "0.1.8"  # -version-
```

## xpag/samplers/sampler.py

```diff
@@ -7,37 +7,38 @@
 import jax.numpy as jnp
 from typing import Union, Dict
 
 
 class Sampler(ABC):
     def __init__(self, *, seed: Union[int, None] = None):
         self.seed = seed
+        self.rng = np.random.default_rng(seed)
         pass
 
     @abstractmethod
     def sample(
         self,
         buffer,
         batch_size: int,
     ) -> Dict[str, Union[np.ndarray, jnp.ndarray]]:
         """Return a batch of transitions"""
         pass
 
 
 class DefaultSampler(Sampler):
-    def __init__(self):
-        super().__init__()
+    def __init__(self, *, seed: Union[int, None] = None):
+        super().__init__(seed=seed)
 
     def sample(
         self,
         buffer: Dict[str, Union[np.ndarray]],
         batch_size: int,
     ) -> Dict[str, Union[np.ndarray]]:
         buffer_size = next(iter(buffer.values())).shape[0]
-        idxs = np.random.choice(
+        idxs = self.rng.choice(
             buffer_size,
             size=batch_size,
             replace=True,
         )
         transitions = {key: buffer[key][idxs] for key in buffer.keys()}
         return transitions
 
@@ -48,20 +49,20 @@
 
     def sample(
         self,
         buffer: Dict[str, Union[np.ndarray]],
         batch_size: int,
     ) -> Dict[str, Union[np.ndarray]]:
         rollout_batch_size = buffer["episode_length"].shape[0]
-        episode_idxs = np.random.choice(
+        episode_idxs = self.rng.choice(
             np.arange(rollout_batch_size),
             size=batch_size,
             replace=True,
             p=buffer["episode_length"][:, 0, 0]
             / buffer["episode_length"][:, 0, 0].sum(),
         )
         t_max_episodes = buffer["episode_length"][episode_idxs, 0].flatten()
-        t_samples = np.random.randint(t_max_episodes)
+        t_samples = self.rng.integers(t_max_episodes)
         transitions = {
             key: buffer[key][episode_idxs, t_samples] for key in buffer.keys()
         }
         return transitions
```

## Comparing `xpag-0.1.7.dist-info/LICENSE` & `xpag-0.1.8.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `xpag-0.1.7.dist-info/METADATA` & `xpag-0.1.8.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: xpag
-Version: 0.1.7
+Version: 0.1.8
 Summary: xpag: Exploring Agents
 Home-page: https://github.com/perrin-isir/xpag
 Author: Nicolas Perrin-Gilbert
 License: LICENSE
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: psutil (>=5.8.0)
@@ -19,15 +19,15 @@
 Requires-Dist: flax (>=0.6.3)
 Requires-Dist: brax (>=0.9.0)
 Requires-Dist: tensorflow-probability (>=0.15.0)
 Requires-Dist: mediapy (>=1.1.4)
 
 # ![alt text](https://raw.githubusercontent.com/perrin-isir/xpag/main/logo.png "xpag logo")
 
-![version](https://img.shields.io/badge/version-0.1.7-blue)
+![version](https://img.shields.io/badge/version-0.1.8-blue)
 [![codestyle](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
 [![Documentation](https://img.shields.io/github/actions/workflow/status/perrin-isir/xpag/docs.yml?branch=main&label=docs)](https://perrin-isir.github.io/xpag/)
 [![PyPI version](https://img.shields.io/pypi/v/xpag)](https://pypi.org/project/xpag/)
 
 
 *xpag* ("e**xp**loring **ag**ents") is a modular reinforcement learning library with JAX agents, currently in beta version.
```

## Comparing `xpag-0.1.7.dist-info/RECORD` & `xpag-0.1.8.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-xpag/__init__.py,sha256=WMRMMnxdagJ11XfEMKlbJ_n6od9qxENbQszpdDfty7U,211
+xpag/__init__.py,sha256=4me-5TXuzghFP4LNEl-OnOl9TftoCM-NMTg749JVmdw,211
 xpag/agents/__init__.py,sha256=qwWcvnIIALsfDemnUNkyQqZNAbRoNbBkS9ppu0BjjRc,204
 xpag/agents/agent.py,sha256=sMvWydFTU1f4kar6nnSbvXSi56tlEla6NJiwgVnM47s,1098
 xpag/agents/sac/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 xpag/agents/sac/sac.py,sha256=xLKisxVIAmQ5FA4E4ppV3O7W8HyWgUu0VkVZzGJvsik,5554
 xpag/agents/sac/sac_from_jaxrl.py,sha256=2Nbr3jg96Ohbwcjom10WH0Pcu5ipH058KI66_LFZYUk,18817
 xpag/agents/sdqn/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 xpag/agents/sdqn/sdqn.py,sha256=0CP9Se8S9QIpMUjHJmFAQBulGzAd6FQHKbkQWhCtLSY,22063
@@ -14,27 +14,27 @@
 xpag/buffers/buffer.py,sha256=UjNieWaV0mTEaol7HjGDhWr3ll8Vcwy72Kl3M3OwLqE,11221
 xpag/buffers/jax_buffer.py,sha256=mKlFwkGt4b5NcJbY9RB_W04aqk3kDs3U8M63oooWGnM,5236
 xpag/plotting/__init__.py,sha256=Yt8egGFZIAgrAlcKFzfHExb7ky28BSD3E-igrBYFxTU,55
 xpag/plotting/plotting.py,sha256=h3JH9QpmOgDhIXXvqGF31FqrIF-nud731IlAkPgIPJ0,4086
 xpag/samplers/HER.py,sha256=xmjKZv4eCOPudddqDnNW-Vqo5TEol_SToRSqzQ74P0k,2841
 xpag/samplers/__init__.py,sha256=fazYtUuLPWpbDxZxB40VRUZcYuE7P-LnRpFuoTHMSkE,182
 xpag/samplers/jax_sampler.py,sha256=iPLVriHQu_X-YbSxbYMTA1gV7TKYhS186rTpEbR2c40,2941
-xpag/samplers/sampler.py,sha256=77P_YLUfduAbn-zvUq5fp5M1MohgwTZ0RNgMjsC-Wiw,1829
+xpag/samplers/sampler.py,sha256=9At5VBYL5ziH7UzCkA8du_zSjPjLTx0sI81AVhSOoBw,1917
 xpag/setters/__init__.py,sha256=gEEbf529oUwVHTpStUelg0Y7NQ8qQxbCK_Mnhv0pb6I,71
 xpag/setters/setter.py,sha256=Rey6VOm8T8gEhVql_2LhQIN6ZKC0lC5J6aAOizPq5Rs,3734
 xpag/tools/__init__.py,sha256=6PpnqZEtELXPQ_vWnyp-l6ZnIVFXFiaMWhaTZ7XEJoI,438
 xpag/tools/eval.py,sha256=8ceSq-WiZTljQE1IE220iR1b1WodqgHsFfaxu88CK0k,5065
 xpag/tools/learn.py,sha256=Ow63UUpeW5g6vx1Hzz_wVggrCwQOfa24eyc18-_ct60,7611
 xpag/tools/logging.py,sha256=Ip3ETtLHYyqlmC8Z2BncuaI_y2RNBN99-UF1VoEWeuE,3225
 xpag/tools/replay.py,sha256=ixLRRzDgcg9NtQtbxPKTj69tpGsU4Xtop8QiL__TpfA,4708
 xpag/tools/timing.py,sha256=aihoZOw4xCML2hrgpqWs_TgFIOThPqJuyFG7weod9-Y,899
 xpag/tools/utils.py,sha256=S0AQObm47diWYNgg3aP4SSz2UEZ5F_G2leGkBGV952I,5273
 xpag/wrappers/__init__.py,sha256=4tECDefZtReXVN3tUyIbfNeO-Q-hXA9Pm0e5vOMKwgA,179
 xpag/wrappers/brax_vec_env.py,sha256=NvB7BvuPhWz9OSNtyz7W6infeViVRM5OOauA43OAJiE,8257
 xpag/wrappers/goalenv_wrapper.py,sha256=wryWDyfQGneC6y1emTLUmtU0c0bB8VkXhFZCPdiZkls,6071
 xpag/wrappers/gym_vec_env.py,sha256=Ot43NfJTBOLGjvvXaaSjIFpZRwNGdbW8jySODxW_X4U,10125
 xpag/wrappers/reset_done.py,sha256=GJHmSIpJuQNkiO-rKg0oDG0np7_CbZkBPJ-4akSpypY,936
-xpag-0.1.7.dist-info/LICENSE,sha256=g85jiSLf3DU-cU426LLpqKUqjFwcnfYF8qpyms8R9p8,1517
-xpag-0.1.7.dist-info/METADATA,sha256=g8lqtUB08qJ9sJgnEtb4XiqTQfh0m88GMR8jwPKZfcQ,15098
-xpag-0.1.7.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-xpag-0.1.7.dist-info/top_level.txt,sha256=CUClY4Z7dB5zr_iqoqBK479ZNT9uDDCD7hWIHgQTDpc,5
-xpag-0.1.7.dist-info/RECORD,,
+xpag-0.1.8.dist-info/LICENSE,sha256=g85jiSLf3DU-cU426LLpqKUqjFwcnfYF8qpyms8R9p8,1517
+xpag-0.1.8.dist-info/METADATA,sha256=mBpg3Kwuazbl_0w6Aj8JnECz-GO0fk6N_CwJrcNRSM0,15098
+xpag-0.1.8.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+xpag-0.1.8.dist-info/top_level.txt,sha256=CUClY4Z7dB5zr_iqoqBK479ZNT9uDDCD7hWIHgQTDpc,5
+xpag-0.1.8.dist-info/RECORD,,
```

