# Comparing `tmp/odoo14_addon_connector_importer-14.0.1.2.0-py3-none-any.whl.zip` & `tmp/odoo14_addon_connector_importer-14.0.2.0.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,70 +1,74 @@
-Zip file size: 90682 bytes, number of entries: 68
--rw-r--r--  2.0 unx     3900 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/README.rst
--rw-r--r--  2.0 unx       72 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/__init__.py
--rw-r--r--  2.0 unx      994 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/__manifest__.py
--rw-r--r--  2.0 unx      985 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/events.py
--rw-r--r--  2.0 unx      757 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/log.py
--rw-r--r--  2.0 unx      531 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/menuitems.xml
--rw-r--r--  2.0 unx      199 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/__init__.py
--rw-r--r--  2.0 unx      566 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/automapper.py
--rw-r--r--  2.0 unx      332 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/base.py
--rw-r--r--  2.0 unx    14674 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/importer.py
--rw-r--r--  2.0 unx     6589 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/importer_csv_std.py
--rw-r--r--  2.0 unx     3450 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/mapper.py
--rw-r--r--  2.0 unx     7019 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/odoorecord.py
--rw-r--r--  2.0 unx     1436 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/odoorecord_csv_std.py
--rw-r--r--  2.0 unx     4204 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/components/tracker.py
--rw-r--r--  2.0 unx       19 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/controllers/__init__.py
--rw-r--r--  2.0 unx      788 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/controllers/main.py
--rw-r--r--  2.0 unx      678 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/data/ir_cron.xml
--rw-r--r--  2.0 unx      827 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/data/queue_job_function_data.xml
--rw-r--r--  2.0 unx    30256 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/i18n/connector_importer.pot
--rw-r--r--  2.0 unx      187 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/__init__.py
--rw-r--r--  2.0 unx     5023 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/backend.py
--rw-r--r--  2.0 unx     2499 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/cron_mixin.py
--rw-r--r--  2.0 unx     5479 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/import_type.py
--rw-r--r--  2.0 unx      903 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/job_mixin.py
--rw-r--r--  2.0 unx     4551 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/record.py
--rw-r--r--  2.0 unx    11630 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/recordset.py
--rw-r--r--  2.0 unx     8955 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/reporter.py
--rw-r--r--  2.0 unx       88 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/sources/__init__.py
--rw-r--r--  2.0 unx     2409 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/sources/source_consumer_mixin.py
--rw-r--r--  2.0 unx     3670 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/sources/source_csv.py
--rw-r--r--  2.0 unx     4110 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/models/sources/source_mixin.py
--rw-r--r--  2.0 unx      184 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      118 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      871 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/readme/ROADMAP.rst
--rw-r--r--  2.0 unx     1402 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/security/ir.model.access.csv
--rw-r--r--  2.0 unx      647 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/security/security.xml
--rw-r--r--  2.0 unx     9455 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/static/description/icon.png
--rw-r--r--  2.0 unx    13311 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/static/description/index.html
--rw-r--r--  2.0 unx      284 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/__init__.py
--rw-r--r--  2.0 unx     3171 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/common.py
--rw-r--r--  2.0 unx     1850 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/fake_components.py
--rw-r--r--  2.0 unx     1022 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/fake_models.py
--rw-r--r--  2.0 unx     1543 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_backend.py
--rw-r--r--  2.0 unx     1505 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_cron.py
--rw-r--r--  2.0 unx     4564 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_import_type.py
--rw-r--r--  2.0 unx     4451 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_record_importer.py
--rw-r--r--  2.0 unx     3417 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_record_importer_basic.py
--rw-r--r--  2.0 unx     1847 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_record_importer_xmlid.py
--rw-r--r--  2.0 unx     3042 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_recordset.py
--rw-r--r--  2.0 unx     3352 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_recordset_importer.py
--rw-r--r--  2.0 unx     2627 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_source.py
--rw-r--r--  2.0 unx     2990 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/test_source_csv.py
--rw-r--r--  2.0 unx       85 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/tests/fixtures/csv_source_test1.csv
--rw-r--r--  2.0 unx        0 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/utils/__init__.py
--rw-r--r--  2.0 unx     3753 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/utils/import_utils.py
--rw-r--r--  2.0 unx     9909 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/utils/mapper_utils.py
--rw-r--r--  2.0 unx     4254 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/utils/report_html.py
--rw-r--r--  2.0 unx     5639 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/views/backend_views.xml
--rw-r--r--  2.0 unx     9503 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/views/docs_template.xml
--rw-r--r--  2.0 unx     5912 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/views/recordset_views.xml
--rw-r--r--  2.0 unx     2099 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/views/report_template.xml
--rw-r--r--  2.0 unx      576 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/views/source_config_template.xml
--rw-r--r--  2.0 unx     1419 b- defN 22-Apr-05 09:54 odoo/addons/connector_importer/views/source_views.xml
--rw-r--r--  2.0 unx     4608 b- defN 22-Apr-05 09:54 odoo14_addon_connector_importer-14.0.1.2.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Apr-05 09:54 odoo14_addon_connector_importer-14.0.1.2.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Apr-05 09:54 odoo14_addon_connector_importer-14.0.1.2.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     7455 b- defN 22-Apr-05 09:54 odoo14_addon_connector_importer-14.0.1.2.0.dist-info/RECORD
-68 files, 244742 bytes uncompressed, 78166 bytes compressed:  68.1%
+Zip file size: 98031 bytes, number of entries: 72
+-rw-r--r--  2.0 unx     4056 b- defN 23-May-09 09:23 odoo/addons/connector_importer/README.rst
+-rw-r--r--  2.0 unx       72 b- defN 23-May-09 09:23 odoo/addons/connector_importer/__init__.py
+-rw-r--r--  2.0 unx     1033 b- defN 23-May-09 09:23 odoo/addons/connector_importer/__manifest__.py
+-rw-r--r--  2.0 unx      985 b- defN 23-May-09 09:23 odoo/addons/connector_importer/events.py
+-rw-r--r--  2.0 unx      757 b- defN 23-May-09 09:23 odoo/addons/connector_importer/log.py
+-rw-r--r--  2.0 unx      993 b- defN 23-May-09 09:23 odoo/addons/connector_importer/menuitems.xml
+-rw-r--r--  2.0 unx      227 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/__init__.py
+-rw-r--r--  2.0 unx      566 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/automapper.py
+-rw-r--r--  2.0 unx      332 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/base.py
+-rw-r--r--  2.0 unx     6256 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/dynamicmapper.py
+-rw-r--r--  2.0 unx    15079 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/importer.py
+-rw-r--r--  2.0 unx     6589 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/importer_csv_std.py
+-rw-r--r--  2.0 unx     4380 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/mapper.py
+-rw-r--r--  2.0 unx     7834 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/odoorecord.py
+-rw-r--r--  2.0 unx     1436 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/odoorecord_csv_std.py
+-rw-r--r--  2.0 unx     4204 b- defN 23-May-09 09:23 odoo/addons/connector_importer/components/tracker.py
+-rw-r--r--  2.0 unx       19 b- defN 23-May-09 09:23 odoo/addons/connector_importer/controllers/__init__.py
+-rw-r--r--  2.0 unx      788 b- defN 23-May-09 09:23 odoo/addons/connector_importer/controllers/main.py
+-rw-r--r--  2.0 unx      678 b- defN 23-May-09 09:23 odoo/addons/connector_importer/data/ir_cron.xml
+-rw-r--r--  2.0 unx      827 b- defN 23-May-09 09:23 odoo/addons/connector_importer/data/queue_job_function_data.xml
+-rw-r--r--  2.0 unx    32311 b- defN 23-May-09 09:23 odoo/addons/connector_importer/i18n/connector_importer.pot
+-rw-r--r--  2.0 unx      187 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/__init__.py
+-rw-r--r--  2.0 unx     5152 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/backend.py
+-rw-r--r--  2.0 unx     2499 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/cron_mixin.py
+-rw-r--r--  2.0 unx     5696 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/import_type.py
+-rw-r--r--  2.0 unx      903 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/job_mixin.py
+-rw-r--r--  2.0 unx     4078 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/record.py
+-rw-r--r--  2.0 unx    11612 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/recordset.py
+-rw-r--r--  2.0 unx     8955 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/reporter.py
+-rw-r--r--  2.0 unx       88 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/sources/__init__.py
+-rw-r--r--  2.0 unx     2409 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/sources/source_consumer_mixin.py
+-rw-r--r--  2.0 unx     4005 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/sources/source_csv.py
+-rw-r--r--  2.0 unx     4110 b- defN 23-May-09 09:23 odoo/addons/connector_importer/models/sources/source_mixin.py
+-rw-r--r--  2.0 unx      184 b- defN 23-May-09 09:23 odoo/addons/connector_importer/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      118 b- defN 23-May-09 09:23 odoo/addons/connector_importer/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx     1027 b- defN 23-May-09 09:23 odoo/addons/connector_importer/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx     1402 b- defN 23-May-09 09:23 odoo/addons/connector_importer/security/ir.model.access.csv
+-rw-r--r--  2.0 unx      647 b- defN 23-May-09 09:23 odoo/addons/connector_importer/security/security.xml
+-rw-r--r--  2.0 unx     9455 b- defN 23-May-09 09:23 odoo/addons/connector_importer/static/description/icon.png
+-rw-r--r--  2.0 unx    13479 b- defN 23-May-09 09:23 odoo/addons/connector_importer/static/description/index.html
+-rw-r--r--  2.0 unx      310 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/__init__.py
+-rw-r--r--  2.0 unx     3171 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/common.py
+-rw-r--r--  2.0 unx     1814 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/fake_components.py
+-rw-r--r--  2.0 unx     1022 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/fake_models.py
+-rw-r--r--  2.0 unx     1543 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_backend.py
+-rw-r--r--  2.0 unx     1505 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_cron.py
+-rw-r--r--  2.0 unx     5840 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_import_type.py
+-rw-r--r--  2.0 unx     4087 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_mapper.py
+-rw-r--r--  2.0 unx     4451 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_record_importer.py
+-rw-r--r--  2.0 unx     4258 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_record_importer_basic.py
+-rw-r--r--  2.0 unx     1847 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_record_importer_xmlid.py
+-rw-r--r--  2.0 unx     3008 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_recordset.py
+-rw-r--r--  2.0 unx     3352 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_recordset_importer.py
+-rw-r--r--  2.0 unx     2760 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_source.py
+-rw-r--r--  2.0 unx     2990 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/test_source_csv.py
+-rw-r--r--  2.0 unx       85 b- defN 23-May-09 09:23 odoo/addons/connector_importer/tests/fixtures/csv_source_test1.csv
+-rw-r--r--  2.0 unx        0 b- defN 23-May-09 09:23 odoo/addons/connector_importer/utils/__init__.py
+-rw-r--r--  2.0 unx     4114 b- defN 23-May-09 09:23 odoo/addons/connector_importer/utils/import_utils.py
+-rw-r--r--  2.0 unx    11103 b- defN 23-May-09 09:23 odoo/addons/connector_importer/utils/mapper_utils.py
+-rw-r--r--  2.0 unx     2418 b- defN 23-May-09 09:23 odoo/addons/connector_importer/utils/misc.py
+-rw-r--r--  2.0 unx     4254 b- defN 23-May-09 09:23 odoo/addons/connector_importer/utils/report_html.py
+-rw-r--r--  2.0 unx     6218 b- defN 23-May-09 09:23 odoo/addons/connector_importer/views/backend_views.xml
+-rw-r--r--  2.0 unx     9503 b- defN 23-May-09 09:23 odoo/addons/connector_importer/views/docs_template.xml
+-rw-r--r--  2.0 unx     1637 b- defN 23-May-09 09:23 odoo/addons/connector_importer/views/import_type_views.xml
+-rw-r--r--  2.0 unx     5912 b- defN 23-May-09 09:23 odoo/addons/connector_importer/views/recordset_views.xml
+-rw-r--r--  2.0 unx     2099 b- defN 23-May-09 09:23 odoo/addons/connector_importer/views/report_template.xml
+-rw-r--r--  2.0 unx      576 b- defN 23-May-09 09:23 odoo/addons/connector_importer/views/source_config_template.xml
+-rw-r--r--  2.0 unx     2616 b- defN 23-May-09 09:23 odoo/addons/connector_importer/views/source_views.xml
+-rw-r--r--  2.0 unx     4764 b- defN 23-May-09 09:23 odoo14_addon_connector_importer-14.0.2.0.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-09 09:23 odoo14_addon_connector_importer-14.0.2.0.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-09 09:23 odoo14_addon_connector_importer-14.0.2.0.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     7897 b- defN 23-May-09 09:23 odoo14_addon_connector_importer-14.0.2.0.0.dist-info/RECORD
+72 files, 270679 bytes uncompressed, 84789 bytes compressed:  68.7%
```

## zipnote {}

```diff
@@ -21,14 +21,17 @@
 
 Filename: odoo/addons/connector_importer/components/automapper.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/components/base.py
 Comment: 
 
+Filename: odoo/addons/connector_importer/components/dynamicmapper.py
+Comment: 
+
 Filename: odoo/addons/connector_importer/components/importer.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/components/importer_csv_std.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/components/mapper.py
@@ -132,14 +135,17 @@
 
 Filename: odoo/addons/connector_importer/tests/test_cron.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/tests/test_import_type.py
 Comment: 
 
+Filename: odoo/addons/connector_importer/tests/test_mapper.py
+Comment: 
+
 Filename: odoo/addons/connector_importer/tests/test_record_importer.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/tests/test_record_importer_basic.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/tests/test_record_importer_xmlid.py
@@ -165,41 +171,47 @@
 
 Filename: odoo/addons/connector_importer/utils/import_utils.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/utils/mapper_utils.py
 Comment: 
 
+Filename: odoo/addons/connector_importer/utils/misc.py
+Comment: 
+
 Filename: odoo/addons/connector_importer/utils/report_html.py
 Comment: 
 
 Filename: odoo/addons/connector_importer/views/backend_views.xml
 Comment: 
 
 Filename: odoo/addons/connector_importer/views/docs_template.xml
 Comment: 
 
+Filename: odoo/addons/connector_importer/views/import_type_views.xml
+Comment: 
+
 Filename: odoo/addons/connector_importer/views/recordset_views.xml
 Comment: 
 
 Filename: odoo/addons/connector_importer/views/report_template.xml
 Comment: 
 
 Filename: odoo/addons/connector_importer/views/source_config_template.xml
 Comment: 
 
 Filename: odoo/addons/connector_importer/views/source_views.xml
 Comment: 
 
-Filename: odoo14_addon_connector_importer-14.0.1.2.0.dist-info/METADATA
+Filename: odoo14_addon_connector_importer-14.0.2.0.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_connector_importer-14.0.1.2.0.dist-info/WHEEL
+Filename: odoo14_addon_connector_importer-14.0.2.0.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_connector_importer-14.0.1.2.0.dist-info/top_level.txt
+Filename: odoo14_addon_connector_importer-14.0.2.0.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_connector_importer-14.0.1.2.0.dist-info/RECORD
+Filename: odoo14_addon_connector_importer-14.0.2.0.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/connector_importer/README.rst

```diff
@@ -38,18 +38,20 @@
   importer: `self._do_report()` -> `self.recordset.set_report(...)`).
   The job is automatically retried a second time (without concurrency errors).
   For small files it's not a big issue, but for files with a huge amount of
   lines it takes time to process them two times.
 * refactor the `recordset.full_report_url` field to return a QWeb report
   instead of a home-made HTML document + display it on the recordset form.
 * move generic functions from `utils.mapper_utils` to the `connector` module
-* unit tests from `tests.test_source_csv` are not imported (Odoo ignores them)
-  and they need to be fixed
 * unit tests for record handler and tracker
-* rely on `self.work.options` in all components to replace all custom flags
+* add more test coverage for mapper utils and dynamic mapper
+* consider making dynamic mapper the default one
+* control how to generate xid (eg: from a specicic field with key `must_generate_xmlid_from_key`)
+* add manual control for backend_to_rel mappers
+* refactor source to be  a specific m2o to ease mgmt instead of a generic relation
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/connector-interfaces/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
```

## odoo/addons/connector_importer/__manifest__.py

```diff
@@ -1,28 +1,29 @@
 # Author: Simone Orsi
 # Copyright 2018 Camptocamp SA
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
 {
     "name": "Connector Importer",
     "summary": """This module takes care of import sessions.""",
-    "version": "14.0.1.2.0",
+    "version": "14.0.2.0.0",
     "depends": ["connector", "queue_job"],
     "author": "Camptocamp, Odoo Community Association (OCA)",
     "license": "AGPL-3",
     "category": "Connector",
     "website": "https://github.com/OCA/connector-interfaces",
     "maintainers": ["simahawk"],
     "data": [
         "data/ir_cron.xml",
         "data/queue_job_function_data.xml",
         "security/security.xml",
         "security/ir.model.access.csv",
         "views/backend_views.xml",
         "views/recordset_views.xml",
+        "views/import_type_views.xml",
         "views/source_views.xml",
         "views/report_template.xml",
         "views/docs_template.xml",
         "views/source_config_template.xml",
         "menuitems.xml",
     ],
     "external_dependencies": {"python": ["chardet", "pytz", "pyyaml"]},
```

## odoo/addons/connector_importer/menuitems.xml

### odoo/addons/connector_importer/menuitems.xml

```diff
@@ -1,6 +1,9 @@
 <?xml version="1.0" encoding="utf-8"?>
 <odoo>
   <menuitem id="menu_importer_root" name="Importer" sequence="10" groups="connector.group_connector_manager"/>
   <menuitem id="menu_import_backend" name="Import Backends" parent="menu_importer_root" action="action_import_backend"/>
   <menuitem id="menu_import_recordset" name="Import Recordsets" parent="menu_importer_root" action="action_import_recordset"/>
+  <menuitem id="menu_import_settings_root" name="Settings" parent="menu_importer_root"/>
+  <menuitem id="menu_import_settings_types" name="Import types" parent="menu_import_settings_root" action="action_import_type"/>
+  <menuitem id="menu_import_settings_sources" name="Import sources" parent="menu_import_settings_root" action="action_import_source"/>
 </odoo>
```

## odoo/addons/connector_importer/components/__init__.py

```diff
@@ -2,7 +2,8 @@
 from . import tracker
 from . import odoorecord
 from . import odoorecord_csv_std
 from . import importer
 from . import importer_csv_std
 from . import mapper
 from . import automapper
+from . import dynamicmapper
```

## odoo/addons/connector_importer/components/importer.py

```diff
@@ -53,78 +53,91 @@
     and keep tracks of errored, skipped, etc.
     See `run` method for detailed information on what it does.
     """
 
     _name = "importer.record"
     _inherit = ["importer.base.component"]
     _usage = "record.importer"
-    _apply_on = "import.record"
     # log and report errors
     # do not make the whole import fail
     _break_on_error = False
     _record_handler_usage = "odoorecord.handler"
     _tracking_handler_usage = "tracking.handler"
     # a unique key (field name) to retrieve the odoo record
-    # if this key is an external/XML ID, set 'odoo_unique_key_is_xmlid' to True
+    # if this key is an external/XML ID, prefix the name with `xid::` (eg: xid::id)
     odoo_unique_key = ""
-    odoo_unique_key_is_xmlid = False
 
     def _init_importer(self, recordset):
         self.recordset = recordset
         # record handler is responsible for create/write on odoo records
         self.record_handler = self.component(usage=self._record_handler_usage)
         self.record_handler._init_handler(
             importer=self,
-            unique_key=self.odoo_unique_key,
-            unique_key_is_xmlid=self.odoo_unique_key_is_xmlid,
+            unique_key=self.unique_key,
         )
         # tracking handler is responsible for logging and chunk reports
         self.tracker = self.component(usage=self._tracking_handler_usage)
         self.tracker._init_handler(
             model_name=self.model._name,
             logger_name=LOGGER_NAME,
             log_prefix=self.recordset.import_type_id.key + " ",
         )
 
+    @property
+    def unique_key(self):
+        return self.work.options.importer.get("odoo_unique_key", self.odoo_unique_key)
+
+    @property
+    def unique_key_is_xmlid(self):
+        return self.unique_key.startswith("xid::") or self.unique_key == "id"
+
     # Override to not rely on automatic mapper lookup.
     # This is especially needed if you register more than one importer
     # for a given odoo model. Eg: 2 importers for res.partner
     # (1 for customers and 1 for suppliers)
     _mapper_name = None
     _mapper_usage = "importer.mapper"
     # just an instance cache for the mapper
     _mapper = None
 
-    # TODO: add tests
+    # TODO: do the same for record handler and tracking handler
     def _get_mapper(self):
-        if self._mapper_name:
-            return self.component_by_name(self._mapper_name)
-        return self.component(usage=self._mapper_usage)
+        mapper_name = self.work.options.mapper.get("name", self._mapper_name)
+        if mapper_name:
+            return self.component_by_name(mapper_name)
+        mapper_usage = self.work.options.mapper.get("usage", self._mapper_usage)
+        return self.component(usage=mapper_usage)
 
     @property
     def mapper(self):
         if not self._mapper:
             self._mapper = self._get_mapper()
         return self._mapper
 
     @property
     def must_break_on_error(self):
         return self.work.options.importer.get("break_on_error", self._break_on_error)
 
+    @property
+    def must_override_existing(self):
+        return self.work.options.importer.get(
+            "override_existing", self.recordset.override_existing
+        )
+
     def required_keys(self, create=False):
         """Keys that are mandatory to import a line."""
         req = self.mapper.required_keys()
         all_values = []
         for k, v in req.items():
             # make sure values are always tuples
             # as we support multiple dest keys
             if not isinstance(v, (tuple, list)):
                 req[k] = (v,)
             all_values.extend(req[k])
-        unique_key = self.odoo_unique_key
+        unique_key = self.unique_key
         if (
             unique_key
             and unique_key not in list(req.keys())
             and unique_key not in all_values
         ):
             # this one is REALLY required :)
             req[unique_key] = (unique_key,)
@@ -141,15 +154,15 @@
 
     def translatable_langs(self):
         return self.env["res.lang"].search([("active", "=", True)]).mapped("code")
 
     def make_translation_key(self, key, lang):
         sep = self.work.options.importer.get("translation_key_sep", ":")
         regional_lang = self.work.options.importer.get(
-            "translation_use_regional_lang", True
+            "translation_use_regional_lang", False
         )
         if not regional_lang:
             lang = lang[:2]  # eg: "de_DE" -> "de"
         return f"{key}{sep}{lang}"
 
     def collect_translatable(self, values, orig_values):
         """Get translations values for `mapper.translatable_keys`.
@@ -179,22 +192,22 @@
         return translatable
 
     def _check_missing(self, source_key, dest_key, values, orig_values):
         """Check for required keys missing."""
         missing = (
             not source_key.startswith("__") and orig_values.get(source_key) is None
         )
-        unique_key = self.odoo_unique_key
+        unique_key = self.unique_key
         if missing:
             msg = "MISSING REQUIRED SOURCE KEY={}".format(source_key)
             if unique_key and values.get(unique_key):
                 msg += ": {}={}".format(unique_key, values[unique_key])
             return {"message": msg}
         missing = not dest_key.startswith("__") and values.get(dest_key) is None
-        is_xmlid = dest_key == unique_key and self.odoo_unique_key_is_xmlid
+        is_xmlid = dest_key == unique_key and self.unique_key_is_xmlid
         if missing and not is_xmlid:
             msg = "MISSING REQUIRED DESTINATION KEY={}".format(dest_key)
             if unique_key and values.get(unique_key):
                 msg += ": {}={}".format(unique_key, values[unique_key])
             return {"message": msg}
         return False
 
@@ -213,21 +226,19 @@
                     source_key, _dest_key, values, orig_values
                 )
                 if missing:
                     return missing
 
         if (
             self.record_handler.odoo_exists(values, orig_values)
-            and not self.recordset.override_existing
+            and not self.must_override_existing
         ):
             msg = "ALREADY EXISTS"
-            if self.odoo_unique_key:
-                msg += ": {}={}".format(
-                    self.odoo_unique_key, values[self.odoo_unique_key]
-                )
+            if self.unique_key:
+                msg += ": {}={}".format(self.unique_key, values[self.unique_key])
             return {
                 "message": msg,
                 "odoo_record": self.record_handler.odoo_find(values, orig_values).id,
             }
         return False
 
     def _cleanup_line(self, line):
@@ -274,15 +285,15 @@
 
     def _record_lines(self):
         """Get lines from import record."""
         return self.record.get_data()
 
     def _load_mapper_options(self):
         """Retrieve mapper options."""
-        return {"override_existing": self.recordset.override_existing}
+        return {"override_existing": self.must_override_existing}
 
     # TODO: make these contexts customizable via recordset settings
     def _odoo_default_context(self):
         """Default context to be used in both create and write methods"""
         return {
             "importer_type_id": self.recordset.import_type_id.id,
             "tracking_disable": True,
```

## odoo/addons/connector_importer/components/mapper.py

```diff
@@ -1,16 +1,19 @@
 # Author: Simone Orsi
 # Copyright 2018 Camptocamp SA
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
+
 from odoo import _, exceptions
 
 from odoo.addons.component.core import Component
 from odoo.addons.connector.components.mapper import mapping
 
+from ..log import logger
+
 
 class ImportMapper(Component):
     _name = "importer.base.mapper"
     _inherit = ["importer.base.component", "base.import.mapper"]
     _usage = "importer.mapper"
 
     required = {
@@ -45,27 +48,45 @@
         """Return required keys for this mapper.
 
         The importer can use this to determine if a line
         has to be skipped.
 
         The recordset will use this to show required fields to users.
         """
-        return self.required
+        req = dict(self.required)
+        req.update(self.work.options.mapper.get("required_keys", {}))
+        return req
 
     translatable = []
 
     def translatable_keys(self, create=False):
         """Return translatable keys for this mapper.
 
         The importer can use this to translate specific fields
         if the are found in the csv in the form `field_name:lang_code`.
 
         The recordset will use this to show translatable fields to users.
         """
-        return self.translatable
+        translatable = list(self.translatable)
+        translatable += self.work.options.mapper.get("translatable_keys", [])
+        translatable = self._validate_translate_keys(set(translatable))
+        return tuple(translatable)
+
+    def _validate_translate_keys(self, translatable):
+        valid = []
+        fields_spec = self.model.fields_get(translatable)
+        for fname in translatable:
+            if not fields_spec.get(fname):
+                logger.error("%s - translate key not found: `%s`.", self._name, fname)
+                continue
+            if not fields_spec[fname]["translate"]:
+                logger.error("%s - `%s` key is not translatable.", self._name, fname)
+                continue
+            valid.append(fname)
+        return valid
 
     defaults = [
         # odoo field, value
         # ('sale_ok', True),
         # defaults can be also retrieved via xmlid to other records.
         # The format is: `_xmlid::$record_xmlid::$record_field_value`
         # whereas `$record_xmlid` is the xmlid to retrieve
@@ -87,8 +108,9 @@
                 if not real_val or ":" not in real_val:
                     raise exceptions.UserError(
                         _("Malformated xml id ref: `%s`") % real_val
                     )
                 xmlid, field_value = real_val.split(":")
                 v = self.env.ref(xmlid)[field_value]
             values[k] = v
+        values.update(self.work.options.mapper.get("default_keys", {}))
         return values
```

## odoo/addons/connector_importer/components/odoorecord.py

```diff
@@ -1,58 +1,79 @@
 # Author: Simone Orsi
 # Copyright 2018 Camptocamp SA
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
 from odoo.addons.component.core import Component
 
+from ..utils.misc import sanitize_external_id
+
+NO_VALUE = object()
+
 
 class OdooRecordHandler(Component):
     """Interact w/ odoo importable records."""
 
     _name = "importer.odoorecord.handler"
     _inherit = "importer.base.component"
     _usage = "odoorecord.handler"
 
     # TODO: collect these from `work.options.record_handler`
     unique_key = ""
-    unique_key_is_xmlid = False
     importer = None
     # By default odoo ignores create_uid/write_uid in vals.
     # If you enable this flags and `create_uid` and/or `write_uid`
     # are found in values they gonna be used for sudo.
     # Same for `create_date`.
     override_create_uid = False
     override_create_date = False
     override_write_uid = False
     override_write_date = False
 
-    def _init_handler(self, importer=None, unique_key=None, unique_key_is_xmlid=False):
+    def _init_handler(self, importer=None, unique_key=None):
         self.importer = importer
         self.unique_key = unique_key
-        self.unique_key_is_xmlid = unique_key_is_xmlid
+
+    @property
+    def unique_key_is_xmlid(self):
+        return self.importer.unique_key_is_xmlid
 
     def odoo_find_domain(self, values, orig_values):
         """Domain to find the record in odoo."""
-        return [(self.unique_key, "=", values[self.unique_key])]
+        value = NO_VALUE
+        if self.unique_key in values:
+            value = values[self.unique_key]
+        elif self.unique_key in orig_values:
+            value = orig_values[self.unique_key]
+        if value is NO_VALUE:
+            raise ValueError(
+                f"Cannot find {self.unique_key} in `values` nor `orig_values`"
+            )
+        return [(self.unique_key, "=", value)]
 
     def odoo_find(self, values, orig_values):
         """Find any existing item in odoo."""
         if self.unique_key == "":
             # if unique_key is None we might use as special find domain
             return self.model
         if self.unique_key_is_xmlid:
-            item = self.env.ref(values[self.unique_key], raise_if_not_found=False)
+            xid = self._get_xmlid(values, orig_values)
+            item = self.env.ref(xid, raise_if_not_found=False)
             return item
         item = self.model.search(
             self.odoo_find_domain(values, orig_values),
             order="create_date desc",
             limit=1,
         )
         return item
 
+    def _get_xmlid(self, values, orig_values):
+        # Mappers will remove `xid::` prefix from the final values
+        # hence, look for the original key.
+        return sanitize_external_id(orig_values.get(self.unique_key))
+
     def odoo_exists(self, values, orig_values):
         """Return true if the items exists."""
         return bool(self.odoo_find(values, orig_values))
 
     def update_translations(self, odoo_record, translatable, ctx=None):
         """Write translations on given record."""
         ctx = ctx or {}
@@ -71,14 +92,20 @@
         """Inject context variables on create."""
         return dict(
             self.importer._odoo_create_context(),
             # mark each action w/ this flag
             connector_importer_session=True,
         )
 
+    @property
+    def must_generate_xmlid(self):
+        return self.work.options.record_handler.get(
+            "must_generate_xmlid", self.unique_key_is_xmlid
+        )
+
     def odoo_create(self, values, orig_values):
         """Create a new odoo record."""
         self.odoo_pre_create(values, orig_values)
         # TODO: remove keys that are not model's fields
         odoo_record = self.model.with_context(**self.create_context()).create(
             values.copy()
         )
@@ -88,18 +115,18 @@
         # force create date
         if self.override_create_date and values.get("create_date"):
             self._force_value(odoo_record, values, "create_date")
         self.odoo_post_create(odoo_record, values, orig_values)
         translatable = self.importer.collect_translatable(values, orig_values)
         self.update_translations(odoo_record, translatable)
         # Set the external ID if necessary
-        if self.unique_key_is_xmlid:
-            external_id = values[self.unique_key]
-            if not self.env.ref(external_id, raise_if_not_found=False):
-                module, id_ = external_id.split(".", 1)
+        if self.must_generate_xmlid:
+            xid = self._get_xmlid(values, orig_values)
+            if not self.env.ref(xid, raise_if_not_found=False):
+                module, id_ = xid.split(".", 1)
                 self.env["ir.model.data"].create(
                     {
                         "name": id_,
                         "module": module,
                         "model": odoo_record._name,
                         "res_id": odoo_record.id,
                         "noupdate": False,
```

## odoo/addons/connector_importer/i18n/connector_importer.pot

```diff
@@ -37,14 +37,24 @@
 
 #. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_recordset_form
 msgid "Additional notes"
 msgstr ""
 
 #. module: connector_importer
+#: model_terms:ir.ui.view,arch_db:connector_importer.view_import_type_form
+msgid "Adv. options"
+msgstr ""
+
+#. module: connector_importer
+#: model_terms:ir.ui.view,arch_db:connector_importer.view_import_type_form
+msgid "Advanced"
+msgstr ""
+
+#. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_import_record__backend_id
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_recordset_search
 msgid "Backend"
 msgstr ""
 
 #. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_recordset_form
@@ -93,14 +103,21 @@
 
 #. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_import_source_csv__csv_quotechar
 msgid "CSV quotechar"
 msgstr ""
 
 #. module: connector_importer
+#: model:ir.model.fields,field_description:connector_importer.field_import_source_csv__csv_rows_from_to
+msgid ""
+"CSV use only a slice of the available lines. Format: $from:$to. NOTE: "
+"recommended only for debug/test purpose."
+msgstr ""
+
+#. module: connector_importer
 #: model:ir.model.fields.selection,name:connector_importer.selection__import_recordset__jobs_global_state__cancelled
 msgid "Cancelled"
 msgstr ""
 
 #. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_import_source__chunk_size
 #: model:ir.model.fields,field_description:connector_importer.field_import_source_csv__chunk_size
@@ -184,14 +201,19 @@
 
 #. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.recordset_docs
 msgid "Defaults"
 msgstr ""
 
 #. module: connector_importer
+#: model:ir.model.fields,field_description:connector_importer.field_import_type__description
+msgid "Description"
+msgstr ""
+
+#. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.recordset_docs
 msgid "Destination key"
 msgstr ""
 
 #. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_cron_mixin__display_name
 #: model:ir.model.fields,field_description:connector_importer.field_import_backend__display_name
@@ -367,25 +389,37 @@
 
 #. module: connector_importer
 #: model:ir.model,name:connector_importer.model_import_source_consumer_mixin
 msgid "Import source consumer"
 msgstr ""
 
 #. module: connector_importer
+#: model:ir.actions.act_window,name:connector_importer.action_import_source
+#: model:ir.ui.menu,name:connector_importer.menu_import_settings_sources
+msgid "Import sources"
+msgstr ""
+
+#. module: connector_importer
 #: model:ir.model,name:connector_importer.model_import_type
 #: model:ir.model.fields,field_description:connector_importer.field_import_recordset__import_type_id
 msgid "Import type"
 msgstr ""
 
 #. module: connector_importer
 #: model:ir.model.constraint,message:connector_importer.constraint_import_type_key_uniq
 msgid "Import type `key` must be unique!"
 msgstr ""
 
 #. module: connector_importer
+#: model:ir.actions.act_window,name:connector_importer.action_import_type
+#: model:ir.ui.menu,name:connector_importer.menu_import_settings_types
+msgid "Import types"
+msgstr ""
+
+#. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.recordset_docs
 msgid "Importable models:"
 msgstr ""
 
 #. module: connector_importer
 #: model:ir.module.category,name:connector_importer.module_category_connector_importer
 #: model:ir.ui.menu,name:connector_importer.menu_importer_root
@@ -460,14 +494,19 @@
 #: model:ir.model.fields,field_description:connector_importer.field_job_related_mixin____last_update
 #: model:ir.model.fields,field_description:connector_importer.field_reporter_csv____last_update
 #: model:ir.model.fields,field_description:connector_importer.field_reporter_mixin____last_update
 msgid "Last Modified on"
 msgstr ""
 
 #. module: connector_importer
+#: model:ir.model.fields,field_description:connector_importer.field_import_recordset__last_run_on
+msgid "Last Run On"
+msgstr ""
+
+#. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_import_backend__write_uid
 #: model:ir.model.fields,field_description:connector_importer.field_import_record__write_uid
 #: model:ir.model.fields,field_description:connector_importer.field_import_recordset__write_uid
 #: model:ir.model.fields,field_description:connector_importer.field_import_source_csv__write_uid
 #: model:ir.model.fields,field_description:connector_importer.field_import_type__write_uid
 msgid "Last Updated by"
 msgstr ""
@@ -493,14 +532,19 @@
 
 #. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.recordset_docs
 msgid "Legend: TODO"
 msgstr ""
 
 #. module: connector_importer
+#: model_terms:ir.ui.view,arch_db:connector_importer.view_import_type_form
+msgid "Main"
+msgstr ""
+
+#. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_backend_form
 msgid "Make all related jobs completed"
 msgstr ""
 
 #. module: connector_importer
 #: code:addons/connector_importer/components/mapper.py:0
 #, python-format
@@ -666,21 +710,27 @@
 
 #. module: connector_importer
 #: model:ir.model.fields,help:connector_importer.field_import_recordset__sequence
 msgid "Sequence for the handle."
 msgstr ""
 
 #. module: connector_importer
+#: model:ir.ui.menu,name:connector_importer.menu_import_settings_root
+msgid "Settings"
+msgstr ""
+
+#. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_import_recordset__shared_data
 msgid "Shared Data"
 msgstr ""
 
 #. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_import_recordset__source_ref_id
 #: model:ir.model.fields,field_description:connector_importer.field_import_source_consumer_mixin__source_ref_id
+#: model_terms:ir.ui.view,arch_db:connector_importer.view_import_backend_form
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_recordset_form
 msgid "Source"
 msgstr ""
 
 #. module: connector_importer
 #: model:ir.model.fields,field_description:connector_importer.field_import_recordset__source_config_summary
 #: model:ir.model.fields,field_description:connector_importer.field_import_source_consumer_mixin__source_config_summary
@@ -731,14 +781,22 @@
 #: model:ir.model.fields,help:connector_importer.field_import_recordset__jobs_global_state
 msgid ""
 "Tells you if a job is running for this recordset. If any of the sub jobs is "
 "not DONE or FAILED we assume the global state is PENDING."
 msgstr ""
 
 #. module: connector_importer
+#: code:addons/connector_importer/utils/misc.py:0
+#, python-format
+msgid ""
+"The ID reference '%s' must contain maximum one dot (or 0). They are used to "
+"refer to other modules ID, in the form: module.record_id"
+msgstr ""
+
+#. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.recordset_docs
 msgid "Translatable"
 msgstr ""
 
 #. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_recordset_search
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_recordset_tree
@@ -775,14 +833,19 @@
 msgid ""
 "WARNING: one or more jobs are scheduled for a recorset or a record. <br/>\n"
 "                    You will not be able to run the import again or to delete this backend<br/>\n"
 "                    until you complete the jobs."
 msgstr ""
 
 #. module: connector_importer
+#: model:ir.model.fields.selection,name:connector_importer.selection__import_recordset__jobs_global_state__wait_dependencies
+msgid "Wait Dependencies"
+msgstr ""
+
+#. module: connector_importer
 #: model:ir.model.fields,help:connector_importer.field_import_type__options
 msgid "YAML configuration"
 msgstr ""
 
 #. module: connector_importer
 #: model_terms:ir.ui.view,arch_db:connector_importer.view_import_backend_form
 msgid "You are about to run ALL configured recordsets. Are you sure?"
```

## odoo/addons/connector_importer/models/backend.py

```diff
@@ -99,14 +99,17 @@
         """Run all recordset imports."""
         self.ensure_one()
         recordsets = self.recordset_ids
         if self.cron_master_recordset_id:
             # clone and use it to run
             recordsets = self.cron_master_recordset_id.copy()
         for recordset in recordsets:
+            if not recordset.source_ref_id:
+                # source not configured yet, useless to run
+                continue
             recordset.run_import()
 
     @api.model
     def cron_cleanup_recordsets(self):
         """Delete obsolete recordsets.
 
         If you are running imports via cron and you create one recorset
```

## odoo/addons/connector_importer/models/import_type.py

```diff
@@ -42,28 +42,31 @@
       context:
         key1: foo
       # will be ignored
       description: a nice import
       options:
         importer:
           break_on_error: True
+        mapper:
+            name: my.nice.mapper
         record_handler:
           one: False
 
     The model is what you want to import, the importer states
     the name of the connector component to handle the import for that model.
 
     The importer machinery will run the imports for all the models declared
     and will retrieve their specific importerts to execute them.
     """
 
     _name = "import.type"
     _description = "Import type"
 
     name = fields.Char(required=True, help="A meaningful human-friendly name")
+    description = fields.Text()
     key = fields.Char(required=True, help="Unique mnemonic identifier")
     options = fields.Text(help="YAML configuration")
     settings = fields.Text(
         string="Legacy Settings",
         required=False,
         help="""
             # comment me
@@ -123,23 +126,28 @@
         """Prepare importer information.
 
         :param line: dictionary representing a config line from `settings`
         :param is_last_importer: boolean to state if the line represents the last one
         :return: odoo.tools.DotDict instance containing all importer options.
         """
         res = DotDict(line, is_last_importer=is_last_importer)
-        if "options" not in res:
-            res["options"] = {}
-        if "context" not in res:
-            res["context"] = {}
+        for key in ("importer", "options", "context"):
+            if key not in res:
+                res[key] = self._importer_info_defaults.get(key, {})
         for k in ("importer", "mapper", "record_handler", "tracking_handler"):
             if k not in res.options:
                 res["options"][k] = {}
         return res
 
+    _importer_info_defaults = {
+        "importer": {
+            "name": "importer.record",
+        },
+    }
+
     # TODO: trash it for v14
     def _legacy_available_importers(self):
         for item in self.available_models():
             yield self._make_importer_info(
                 {"model": item[0], "importer": item[1]}, is_last_importer=item[2]
             )
```

## odoo/addons/connector_importer/models/record.py

```diff
@@ -3,17 +3,17 @@
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
 import base64
 import json
 import os
 
 from odoo import api, fields, models
-from odoo.tools import DotDict
 
 from ..log import logger
+from ..utils.misc import get_importer_for_config
 
 
 class ImportRecord(models.Model):
     """Data to be imported.
 
     An import record contains what you are actually importing.
 
@@ -76,28 +76,18 @@
         """This job will import a record.
 
         # TODO rewrite
         :param component_name: name of the importer component to use
         :param model_name: name of the model to import
         :param is_last_importer: flag for last importer of the recordset
         """
-        # When using jobs, importer_config is loaded from the DB as a pure dict.
-        # Make sure we always have a dotted dict.
-        # FIXME: we should pass the import_type_id to the job and load it here.
-        importer_config = DotDict(importer_config)
-        kwargs = {
-            "options": importer_config.options,
-        }
-        with self.backend_id.with_context(**importer_config.context).work_on(
-            self._name, **kwargs
-        ) as work:
-            importer = work.component_by_name(
-                importer_config.importer, model_name=importer_config.model
-            )
-            return importer.run(self, is_last_importer=importer_config.is_last_importer)
+        importer = get_importer_for_config(self.backend_id, self._name, importer_config)
+        return importer.run(
+            self, is_last_importer=importer_config.get("is_last_importer")
+        )
 
     def run_import(self):
         """Queue a job for importing data stored in to self"""
         self.ensure_one()
         use_job = self.recordset_id.import_type_id.use_job
         # TODO: use ctx key to disable job instead
         job_method = self.with_delay().import_record
```

## odoo/addons/connector_importer/models/recordset.py

```diff
@@ -1,21 +1,21 @@
 # Author: Simone Orsi
 # Copyright 2018 Camptocamp SA
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
-import base64
 import os
 from collections import OrderedDict
 
 from odoo import api, fields, models
 
 from odoo.addons.base_sparse_field.models.fields import Serialized
 from odoo.addons.queue_job.job import DONE, STATES
 
 from ..log import logger
+from ..utils.misc import get_importer_for_config, to_b64
 
 
 class ImportRecordset(models.Model):
     """Set of records, together with their configuration.
 
     A recordset can be considered as an "import session".
     Here you declare:
@@ -78,20 +78,19 @@
             "we assume the global state is PENDING."
         ),
     )
     report_file = fields.Binary("Report file")
     report_filename = fields.Char("Report filename")
     docs_html = fields.Html(string="Docs", compute="_compute_docs_html")
     notes = fields.Html("Notes", help="Useful info for your users")
+    last_run_on = fields.Datetime()
 
-    @api.depends("backend_id.name")
     def _compute_name(self):
         for item in self:
-            names = [item.backend_id.name.strip(), "#" + str(item.id)]
-            item.name = " ".join(names)
+            item.name = f"#{item.id}"
 
     def get_records(self):
         """Retrieve importable records and keep ordering."""
         return self.env["import.record"].search([("recordset_id", "=", self.id)])
 
     def _set_serialized(self, fname, values, reset=False):
         """Update serialized data."""
@@ -223,25 +222,26 @@
             importer = work.component(usage="recordset.importer")
             return importer.run(self)
 
     def run_import(self):
         """queue a job for creating records (import.record items)"""
         job_method = self.with_delay().import_recordset
         if self.debug_mode():
-            logger.warn("### DEBUG MODE ACTIVE: WILL NOT USE QUEUE ###")
+            logger.warning("### DEBUG MODE ACTIVE: WILL NOT USE QUEUE ###")
             job_method = self.import_recordset
 
         for item in self:
             result = job_method()
             if self.debug_mode():
                 # debug mode, no job here: reset it!
                 item.write({"job_id": False})
             else:
                 # link the job
                 item.write({"job_id": result.db_record().id})
+        self.last_run_on = fields.Datetime.now()
         if self.debug_mode():
             # TODO: port this
             # the "after_all" job needs to be fired manually when in debug mode
             # since the event handler in .events.chunk_finished_subscriber
             # cannot estimate when all the chunks have been processed.
             # for model, importer in self.import_type_id.available_models():
             #     import_record_after_all(
@@ -256,45 +256,42 @@
         reporter = self.get_source().get_reporter()
         if reporter is None:
             logger.debug("No reporter found...")
             return
         metadata, content = reporter.report_get(self)
         self.write(
             {
-                "report_file": base64.encodestring(content.encode()),
+                "report_file": to_b64(content.encode()),
                 "report_filename": metadata["complete_filename"],
             }
         )
         logger.info(
             ("Report file updated on recordset={}. " "Filename: {}").format(
                 self.id, metadata["complete_filename"]
             )
         )
 
     def _get_importers(self):
         importers = OrderedDict()
         for importer_config in self.available_importers():
-            kwargs = {
-                "options": importer_config.options,
-            }
-            model = self.env["ir.model"]._get(importer_config.model)
-            with self.backend_id.with_context(**importer_config.context).work_on(
-                self._name, **kwargs
-            ) as work:
-                importers[model] = work.component_by_name(
-                    importer_config.importer, model_name=importer_config.model
-                )
+            model_record = self.env["ir.model"]._get(importer_config.model)
+            importers[model_record] = get_importer_for_config(
+                self.backend_id, self._name, importer_config
+            )
         return importers
 
     @api.depends("import_type_id")
     def _compute_docs_html(self):
         template = self.env.ref("connector_importer.recordset_docs")
         for item in self:
             item.docs_html = False
-            if isinstance(item.id, models.NewId):
+            if isinstance(item.id, models.NewId) or not item.backend_id:
+                # Surprise surprise: when editing a new recordset
+                # if you hit `configure source` btn
+                # the record will be saved but the backend can be null :S
                 continue
             importers = item._get_importers()
             data = {"recordset": item, "importers": importers}
             item.docs_html = template._render(data)
 
 
 # TODO
```

## odoo/addons/connector_importer/models/sources/source_csv.py

```diff
@@ -23,14 +23,19 @@
         string="CSV filesize", compute="_compute_csv_filesize", readonly=True
     )
     # This is for scheduled import via FS path (FTP, sFTP, etc)
     csv_path = fields.Char("CSV path")
     csv_delimiter = fields.Char(string="CSV delimiter", default=";")
     csv_quotechar = fields.Char(string="CSV quotechar", default='"')
     csv_encoding = fields.Char(string="CSV Encoding")
+    csv_rows_from_to = fields.Char(
+        string="CSV use only a slice of the available lines. "
+        "Format: $from:$to. "
+        "NOTE: recommended only for debug/test purpose.",
+    )
     # Handy fields to get a downloadable example file
     example_file_ext_id = fields.Char(
         help=(
             "You can define example file by creating attachments "
             "with an external ID matching the 'import.source.csv' record "
             "external ID:\n"
             "\t${import.source.csv.ExtID}_example_file\n\n"
@@ -72,20 +77,26 @@
             item.csv_filesize = False
             if item.csv_file:
                 # in v11 binary fields now can return the size of the file
                 item.csv_filesize = self.with_context(bin_size=True).csv_file
 
     def _get_lines(self):
         # read CSV
-        reader_args = {"delimiter": self.csv_delimiter, "encoding": self.csv_encoding}
+        reader_args = {
+            "delimiter": self.csv_delimiter,
+            "encoding": self.csv_encoding,
+            "rows_from_to": self.csv_rows_from_to,
+        }
         if self.csv_path:
             # TODO: join w/ filename
             reader_args["filepath"] = self.csv_path
-        else:
+        elif self.csv_file:
             reader_args["filedata"] = base64.decodebytes(self.csv_file)
+        else:
+            return iter([])
 
         reader = self._csv_reader_klass(**reader_args)
         return reader.read_lines()
 
     def _get_example_attachment(self):
         self.ensure_one()
         xmlid = self.example_file_ext_id
```

## odoo/addons/connector_importer/readme/ROADMAP.rst

```diff
@@ -3,11 +3,13 @@
   importer: `self._do_report()` -> `self.recordset.set_report(...)`).
   The job is automatically retried a second time (without concurrency errors).
   For small files it's not a big issue, but for files with a huge amount of
   lines it takes time to process them two times.
 * refactor the `recordset.full_report_url` field to return a QWeb report
   instead of a home-made HTML document + display it on the recordset form.
 * move generic functions from `utils.mapper_utils` to the `connector` module
-* unit tests from `tests.test_source_csv` are not imported (Odoo ignores them)
-  and they need to be fixed
 * unit tests for record handler and tracker
-* rely on `self.work.options` in all components to replace all custom flags
+* add more test coverage for mapper utils and dynamic mapper
+* consider making dynamic mapper the default one
+* control how to generate xid (eg: from a specicic field with key `must_generate_xmlid_from_key`)
+* add manual control for backend_to_rel mappers
+* refactor source to be  a specific m2o to ease mgmt instead of a generic relation
```

## odoo/addons/connector_importer/static/description/index.html

### odoo/addons/connector_importer/static/description/index.html

```diff
@@ -437,26 +437,24 @@
           <li>
             move generic functions from
             <cite>utils.mapper_utils</cite>
             to the
             <cite>connector</cite>
             module
           </li>
-          <li>
-            unit tests from
-            <cite>tests.test_source_csv</cite>
-            are not imported (Odoo ignores them)
-and they need to be fixed
-          </li>
           <li>unit tests for record handler and tracker</li>
+          <li>add more test coverage for mapper utils and dynamic mapper</li>
+          <li>consider making dynamic mapper the default one</li>
           <li>
-            rely on
-            <cite>self.work.options</cite>
-            in all components to replace all custom flags
+            control how to generate xid (eg: from a specicic field with key
+            <cite>must_generate_xmlid_from_key</cite>
+            )
           </li>
+          <li>add manual control for backend_to_rel mappers</li>
+          <li>refactor source to be  a specific m2o to ease mgmt instead of a generic relation</li>
         </ul>
       </div>
       <div class="section" id="bug-tracker">
         <h1>
           <a class="toc-backref" href="#id2">Bug Tracker</a>
         </h1>
         <p>
```

## odoo/addons/connector_importer/tests/__init__.py

```diff
@@ -3,7 +3,8 @@
 from . import test_import_type
 from . import test_recordset
 from . import test_record_importer
 from . import test_record_importer_basic
 from . import test_record_importer_xmlid
 from . import test_source
 from . import test_source_csv
+from . import test_mapper
```

## odoo/addons/connector_importer/tests/fake_components.py

```diff
@@ -54,15 +54,14 @@
 
 class PartnerRecordImporterXMLID(Component):
     _name = "fake.partner.importer.xmlid"
     _inherit = "importer.record"
     _apply_on = "res.partner"
 
     odoo_unique_key = "id"
-    odoo_unique_key_is_xmlid = True
 
     def create_context(self):
         return {"tracking_disable": True}
 
     def prepare_line(self, line):
         res = super().prepare_line(line)
         res["id"] = "__import__." + line["id"]
```

## odoo/addons/connector_importer/tests/test_import_type.py

```diff
@@ -76,14 +76,55 @@
                         "record_handler": {},
                         "tracking_handler": {},
                     },
                 },
             ),
         )
 
+    def test_available_importers_defaults(self):
+        options = """
+        - model: res.partner
+        - model: res.users
+          options:
+            importer:
+              baz: True
+        """
+        itype = self.type_model.create({"name": "Ok", "key": "ok", "options": options})
+        importers = tuple(itype.available_importers())
+        expected = (
+            {
+                "context": {},
+                "importer": {"name": "importer.record"},
+                "is_last_importer": False,
+                "model": "res.partner",
+                "options": {
+                    "importer": {},
+                    "mapper": {},
+                    "record_handler": {},
+                    "tracking_handler": {},
+                },
+            },
+            {
+                "context": {},
+                "importer": {"name": "importer.record"},
+                "is_last_importer": True,
+                "model": "res.users",
+                "options": {
+                    "importer": {"baz": True},
+                    "mapper": {},
+                    "record_handler": {},
+                    "tracking_handler": {},
+                },
+            },
+        )
+        self.assertEqual(
+            importers,
+            expected,
+        )
+
     def test_available_importers(self):
         options = """
         - model: res.partner
           importer: partner.importer
         - model: res.users
           importer: user.importer
           options:
```

## odoo/addons/connector_importer/tests/test_record_importer_basic.py

```diff
@@ -1,12 +1,12 @@
 # Author: Simone Orsi
 # Copyright 2018 Camptocamp SA
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 
-from odoo.tools import mute_logger
+from odoo.tools import DotDict, mute_logger
 
 from .common import TestImporterBase
 
 
 class TestRecordImporter(TestImporterBase):
     @classmethod
     def _setup_records(cls):
@@ -16,15 +16,17 @@
     def _get_components(self):
         from .fake_components import PartnerMapper, PartnerRecordImporter
 
         return [PartnerRecordImporter, PartnerMapper]
 
     def _get_importer(self):
         with self.backend.work_on(
-            self.record._name, components_registry=self.comp_registry
+            self.record._name,
+            components_registry=self.comp_registry,
+            options=DotDict({"importer": {}, "mapper": {}}),
         ) as work:
             return work.component(usage="record.importer", model_name="res.partner")
 
     @mute_logger("[importer]")
     def test_importer_lookup(self):
         importer = self._get_importer()
         self.assertEqual(importer._name, "fake.partner.importer")
@@ -82,7 +84,22 @@
         missing = importer._check_missing("id", "ref", values, orig_values)
         # name is missing now
         # `id` missing, so the destination key `ref` is missing
         # so we don't see it in the message
         self.assertDictEqual(
             missing, {"message": "MISSING REQUIRED DESTINATION KEY=ref"}
         )
+
+    def test_importer_get_mapper(self):
+        importer = self._get_importer()
+        mapper = importer._get_mapper()
+        self.assertEqual(mapper._name, "fake.partner.mapper")
+        importer.work.options["mapper"] = {"name": "importer.mapper.dynamic"}
+        mapper = importer._get_mapper()
+        self.assertEqual(mapper._name, "importer.mapper.dynamic")
+        importer.work.options["mapper"] = {"usage": "importer.dynamicmapper"}
+        mapper = importer._get_mapper()
+        self.assertEqual(mapper._name, "importer.mapper.dynamic")
+        # name via class attribute have precedence
+        importer._mapper_name = "fake.partner.mapper"
+        mapper = importer._get_mapper()
+        self.assertEqual(mapper._name, "fake.partner.mapper")
```

## odoo/addons/connector_importer/tests/test_recordset.py

```diff
@@ -39,15 +39,15 @@
         return cls.recordset_model.create(
             {"backend_id": cls.bknd.id, "import_type_id": cls.itype.id}
         )
 
     def test_recordset_name(self):
         self.assertEqual(
             self.recordset.name,
-            self.recordset.backend_id.name + " #" + str(self.recordset.id),
+            "#" + str(self.recordset.id),
         )
 
     def test_available_importers(self):
         """Available models are propagated from import type."""
         self.assertEqual(
             tuple(self.recordset.available_importers()),
             tuple(self.recordset.import_type_id.available_importers()),
```

## odoo/addons/connector_importer/tests/test_source.py

```diff
@@ -66,14 +66,16 @@
             sorted(data["summary_fields"]), sorted(["chunk_size", "fake_param"])
         )
         self.assertIn("chunk_size", data["fields_info"])
         self.assertIn("fake_param", data["fields_info"])
 
     @mock.patch(SOURCE_MODEL + "._selection_source_ref_id")
     def test_consumer_basic(self, _selection_source_ref_id):
+        # Needed to let `odoo.fields.determine` work properly
+        _selection_source_ref_id.__name__ = "_selection_source_ref_id"
         # enable our fake source
         _selection_source_ref_id.return_value = [(self.source._name, "Fake")]
         consumer = self.consumer
         self.assertFalse(consumer.get_source())
         consumer.update(
             {"source_id": self.source.id, "source_model": self.source._name}
         )
```

## odoo/addons/connector_importer/utils/import_utils.py

```diff
@@ -88,29 +88,39 @@
         self,
         filepath=None,
         filedata=None,
         delimiter="|",
         quotechar='"',
         encoding=None,
         fieldnames=None,
+        rows_from_to=None,
     ):
         assert filedata or filepath, "Provide a file path or some file data!"
         if filepath:
             filedata = read_path(filepath)
         self.bdata = csv_content_to_file(filedata, encoding)
         self.data = str(self.bdata, "utf-8")
         self.delimiter = delimiter
         self.quotechar = quotechar
         self.encoding = encoding
         self.fieldnames = fieldnames
+        self.rows_from_to = rows_from_to or ""
 
     def read_lines(self):
         """Yields lines and add info to them (like line nr)."""
+        lines = self.data.splitlines()
+        if ":" in self.rows_from_to:
+            header = lines[0]
+            lines = lines[1:]
+            _from, _to = self.rows_from_to.split(":")
+            lines = [
+                header,
+            ] + lines[int(_from or 0) : int(_to or len(lines) + 1)]
         reader = csv.DictReader(
-            self.data.splitlines(),
+            lines,
             delimiter=str(self.delimiter),
             quotechar=str(self.quotechar),
             fieldnames=self.fieldnames,
         )
         for line in reader:
             line["_line_nr"] = reader.line_num
             yield line
```

## odoo/addons/connector_importer/utils/mapper_utils.py

```diff
@@ -6,14 +6,15 @@
 
 import pytz
 
 from odoo import fields
 from odoo.tools.misc import str2bool
 
 from ..log import logger
+from ..utils.misc import sanitize_external_id
 
 FMTS = ("%d/%m/%Y",)
 
 FMTS_DT = ("%Y-%m-%d %H:%M:%S", "%Y-%m-%d %H:%M:%S.000")
 
 
 def to_date(value, formats=FMTS):
@@ -91,14 +92,15 @@
 def convert(field, conv_type, fallback_field=None, pre_value_handler=None, **kw):
     """Convert the source field to a defined ``conv_type``
     (ex. str) before returning it.
     You can also use predefined converters like 'date'.
     Use ``fallback_field`` to provide a field of the same type
     to be used in case the base field has no value.
     """
+
     if conv_type in CONV_MAPPING:
         conv_type = CONV_MAPPING[conv_type]
 
     def modifier(self, record, to_attr):
         if field not in record:
             # be gentle
             logger.warn("Field `%s` missing in line `%s`", field, record["_line_nr"])
@@ -109,24 +111,26 @@
         if pre_value_handler:
             value = pre_value_handler(value)
         # do not use `if not value` otherwise you override all zero values
         if value is None:
             return None
         return conv_type(value, **kw)
 
+    modifier._from_key = field
     return modifier
 
 
 def from_mapping(field, mapping, default_value=None):
     """Convert the source value using a ``mapping`` of values."""
 
     def modifier(self, record, to_attr):
         value = record.get(field)
         return mapping.get(value, default_value)
 
+    modifier._from_key = field
     return modifier
 
 
 def concat(field, separator=" ", handler=None):
     """Concatenate values from different fields."""
 
     # TODO: `field` is actually a list of fields.
@@ -136,37 +140,54 @@
 
     def modifier(self, record, to_attr):
         value = [
             record.get(_field, "") for _field in field if record.get(_field, "").strip()
         ]
         return separator.join(value)
 
+    modifier._from_key = field
     return modifier
 
 
-def xmlid_to_rel(field):
+def xmlid_to_rel(field, sanitize=True, sanitize_default_mod_name=None):
     """Convert xmlids source values to ids."""
+    xmlid_to_rel._sanitize = sanitize
+    xmlid_to_rel._sanitize_default_mod_name = sanitize_default_mod_name
+
+    def _xid_to_record(env, xid):
+        xid = (
+            sanitize_external_id(
+                xid, default_mod_name=xmlid_to_rel._sanitize_default_mod_name
+            )
+            if xmlid_to_rel._sanitize
+            else xid
+        )
+        return env.ref(xid, raise_if_not_found=False)
 
     def modifier(self, record, to_attr):
         value = record.get(field)
         if value is None:
             return None
+        if isinstance(value, str) and "," in value:
+            value = [x.strip() for x in value.split(",") if x.strip()]
         if isinstance(value, str):
             # m2o
-            rec = self.env.ref(value, raise_if_not_found=False)
+            rec = _xid_to_record(self.env, value)
             if rec:
                 return rec.id
             return None
         # x2m
-        return [
-            (6, 0, self.env.ref(x).ids)
-            for x in value
-            if self.env.ref(x, raise_if_not_found=False)
-        ]
+        values = []
+        for xid in value:
+            rec = _xid_to_record(self.env, xid)
+            if rec:
+                values.append((6, 0, rec.ids))
+        return values
 
+    modifier._from_key = field
     return modifier
 
 
 # TODO: consider to move this to mapper base klass
 # to ease maintanability and override
 
 
@@ -211,23 +232,33 @@
 
     def modifier(self, record, to_attr):
         search_value = record.get(field)
 
         if search_value and value_handler:
             search_value = value_handler(self, record, search_value)
 
+        # get the real column and the model
+        column = self.model._fields[to_attr]
+        rel_model = self.env[column.comodel_name].with_context(active_test=False)
+
         # handle defaults if no search value here
         if not search_value and default_search_value:
             search_value = default_search_value
             if default_search_field:
                 modifier.search_field = default_search_field
 
-        # get the real column and the model
-        column = self.model._fields[to_attr]
-        rel_model = self.env[column.comodel_name].with_context(active_test=False)
+        # Support Odoo studio fields dynamically.
+        # When a model is created automatically from Odoo studio
+        # it gets an `x_name` field which cannot be modified :/
+        if (
+            not default_search_field
+            and modifier.search_field not in rel_model._fields
+            and "x_name" in rel_model._fields
+        ):
+            modifier.search_field = "x_name"
 
         if allowed_length and len(search_value) != allowed_length:
             return None
 
         # alter search value if handler is given
         if search_value and search_value_handler:
             search_value = search_value_handler(search_value)
@@ -297,9 +328,9 @@
 
     # use method attributes to not mess up the variables' scope.
     # If we change the var inside modifier, without this trick
     # you get UnboundLocalError, as the variable was never defined.
     # Trick tnx to http://stackoverflow.com/a/27910553/647924
     modifier.search_field = search_field or "name"
     modifier.search_operator = search_operator or None
-
+    modifier._from_key = field
     return modifier
```

## odoo/addons/connector_importer/views/backend_views.xml

### odoo/addons/connector_importer/views/backend_views.xml

```diff
@@ -44,19 +44,22 @@
           <notebook>
             <page string="Recordsets">
               <field name="recordset_ids" nolabel="1">
                 <tree>
                   <field name="sequence" widget="handle"/>
                   <field name="name" readonly="1"/>
                   <field name="create_date" readonly="1"/>
+                  <field name="last_run_on" readonly="1"/>
                   <field name="import_type_id"/>
                   <field name="override_existing" string="Override existing"/>
                   <field name="job_state"/>
                   <field name="jobs_global_state"/>
                   <button name="run_import" type="object" class="oe_highlight" string="Import"/>
+                  <field name="source_model" invisible="1"/>
+                  <button name="open_source_config" type="object" class="oe_highlight btn-sm" string="Source" attrs="{'invisible': [('source_model', '=', False)]}"/>
                 </tree>
               </field>
             </page>
             <page string="Notes">
               <field name="notes" nolabel="1"/>
             </page>
           </notebook>
```

## odoo/addons/connector_importer/views/source_views.xml

### odoo/addons/connector_importer/views/source_views.xml

```diff
@@ -21,14 +21,36 @@
         <group col="2" name="info">
           <field name="csv_filename"/>
           <field name="csv_file" filename="csv_filename"/>
           <field name="csv_path"/>
           <field name="csv_delimiter"/>
           <field name="csv_quotechar"/>
           <field name="csv_encoding"/>
+          <field name="csv_rows_from_to"/>
           <field name="example_file_ext_id"/>
           <field name="example_file_url" widget="url"/>
         </group>
       </group>
     </field>
   </record>
+  <record id="view_import_source_csv_tree" model="ir.ui.view">
+    <field name="name">import.source.csv tree</field>
+    <field name="model">import.source.csv</field>
+    <field name="priority" eval="99"/>
+    <field name="arch" type="xml">
+      <tree>
+        <field name="name"/>
+        <field name="csv_filename"/>
+        <field name="csv_path"/>
+        <field name="csv_delimiter"/>
+        <field name="csv_quotechar"/>
+        <field name="csv_encoding"/>
+      </tree>
+    </field>
+  </record>
+  <record id="action_import_source" model="ir.actions.act_window">
+    <field name="name">Import sources</field>
+    <field name="res_model">import.source.csv</field>
+    <field name="view_mode">tree,form</field>
+    <field name="view_ids" eval="[(5, 0, 0),                      (0, 0, {'view_mode': 'tree', 'view_id': ref('view_import_source_csv_tree')}),                      (0, 0, {'view_mode': 'form', 'view_id': ref('view_import_source_csv_form')}),                      ]"/>
+  </record>
 </odoo>
```

## Comparing `odoo14_addon_connector_importer-14.0.1.2.0.dist-info/METADATA` & `odoo14_addon_connector_importer-14.0.2.0.0.dist-info/METADATA`

 * *Files 15% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-connector-importer
-Version: 14.0.1.2.0
+Version: 14.0.2.0.0
 Summary: This module takes care of import sessions.
 Home-page: https://github.com/OCA/connector-interfaces
 Author: Camptocamp, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -59,18 +59,20 @@
   importer: `self._do_report()` -> `self.recordset.set_report(...)`).
   The job is automatically retried a second time (without concurrency errors).
   For small files it's not a big issue, but for files with a huge amount of
   lines it takes time to process them two times.
 * refactor the `recordset.full_report_url` field to return a QWeb report
   instead of a home-made HTML document + display it on the recordset form.
 * move generic functions from `utils.mapper_utils` to the `connector` module
-* unit tests from `tests.test_source_csv` are not imported (Odoo ignores them)
-  and they need to be fixed
 * unit tests for record handler and tracker
-* rely on `self.work.options` in all components to replace all custom flags
+* add more test coverage for mapper utils and dynamic mapper
+* consider making dynamic mapper the default one
+* control how to generate xid (eg: from a specicic field with key `must_generate_xmlid_from_key`)
+* add manual control for backend_to_rel mappers
+* refactor source to be  a specific m2o to ease mgmt instead of a generic relation
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/connector-interfaces/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
```

## Comparing `odoo14_addon_connector_importer-14.0.1.2.0.dist-info/RECORD` & `odoo14_addon_connector_importer-14.0.2.0.0.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,68 +1,72 @@
-odoo/addons/connector_importer/README.rst,sha256=AodsRC2RixpW3IlaKmYhiH8oxWOtMS6OP02U2EPJL6g,3900
+odoo/addons/connector_importer/README.rst,sha256=uvfiXXWG9O758SjPvOL_cS5OxJIDmq8X7Yvxc9zM9Wo,4056
 odoo/addons/connector_importer/__init__.py,sha256=5SeaXt24NrD4Cl8GdTw9cCoQGGsXBtNqjgaG5NwJZB8,72
-odoo/addons/connector_importer/__manifest__.py,sha256=czeQBufFguC3wNk9MBmPHy869miAYYs3GESnThBo5q4,994
+odoo/addons/connector_importer/__manifest__.py,sha256=5u35GJwP0LOhiwtj_wj3lvk1tIG7QHnWCg0Lu2qVSls,1033
 odoo/addons/connector_importer/events.py,sha256=zCYEllpQE1FFKv_5HFzVDYJ3VrTe184JqD46tL661-Q,985
 odoo/addons/connector_importer/log.py,sha256=MFjVgOU0c3dRyBViLa8kiV7b3gYpE0cXc8_lD2qmgcc,757
-odoo/addons/connector_importer/menuitems.xml,sha256=rKfv4bq_iOw6DUqQKsefwWZjsSEcMoJ455lOSzRwVek,531
-odoo/addons/connector_importer/components/__init__.py,sha256=10_5Jdc3qDCmLq1rcmveGRZkKeH2k_fmmX2epOpAUuM,199
+odoo/addons/connector_importer/menuitems.xml,sha256=5t8dbiKI-B2kcRhHW-gkB1umcxRbWzt69LEhMSgfHkM,993
+odoo/addons/connector_importer/components/__init__.py,sha256=R7E960FPDtW9OXhWEyIwd8Bfez2xXtrlMCzqxX8xsCs,227
 odoo/addons/connector_importer/components/automapper.py,sha256=N7gpp-NzFXvQN4uxfvRGaA-2uIzGMmEf1f8RctWezfc,566
 odoo/addons/connector_importer/components/base.py,sha256=SXRDM0H_I13Eu_qfUvZ9xaCZplXf9PSnAt1ydhJ176s,332
-odoo/addons/connector_importer/components/importer.py,sha256=Ly6h7GTnFcdOitI8jqr3IywidRNusy_ADYzNim1sUQ4,14674
+odoo/addons/connector_importer/components/dynamicmapper.py,sha256=7J0XCePl1GcFQEWSNHUST6Bvl7XPXOh-tmkL24yF_Yg,6256
+odoo/addons/connector_importer/components/importer.py,sha256=G200k6m9w-6OTPBxPFXyWIBBDjQwICHEkgni4qw8mZ4,15079
 odoo/addons/connector_importer/components/importer_csv_std.py,sha256=A50NzEH5ZJY_6jmpZbaPoakVX6oDxNWDdUSkSZ92A9Q,6589
-odoo/addons/connector_importer/components/mapper.py,sha256=o1yTSDSYScV8-LojlfaAvcMPHlz7AotjAywn67vMykA,3450
-odoo/addons/connector_importer/components/odoorecord.py,sha256=YfzYUjhuSLSrPDXTVqo0a_tv9HV5TvLZqp7TbBSkdHk,7019
+odoo/addons/connector_importer/components/mapper.py,sha256=xCHab-xVM0sbqkunZEUZwmuMHoTEGlnDes7cI6zYegA,4380
+odoo/addons/connector_importer/components/odoorecord.py,sha256=syT_KtXLLjnO7cI9YrAUQCAGIZq8n8yb3uzYp1EnZLY,7834
 odoo/addons/connector_importer/components/odoorecord_csv_std.py,sha256=2a6suU7GEcbfJNYqpmwB0ABJVj0pTiuATAKQP0M02Cs,1436
 odoo/addons/connector_importer/components/tracker.py,sha256=LVATxle9Cme4mcs37Y0pdJqExRFnK-QrzeFjws1I2zU,4204
 odoo/addons/connector_importer/controllers/__init__.py,sha256=4KFqEP2QHFbPN66eQJMdGsmNz2v7ywWv_FR1pW_kkLk,19
 odoo/addons/connector_importer/controllers/main.py,sha256=nhoRxonfXSGRgiU4b3ZG_-VnOXx40fZbpgZucdvVilU,788
 odoo/addons/connector_importer/data/ir_cron.xml,sha256=rOMNu38Eyf6oP_wZ_RrGaLYAw2ppps1LeVAn3MRCvdY,678
 odoo/addons/connector_importer/data/queue_job_function_data.xml,sha256=2NLyI0tIRNqHCK6LzLR2HxqlJbP_IkXhdSWBRckEcrA,827
-odoo/addons/connector_importer/i18n/connector_importer.pot,sha256=aHf-c_y-FrCONuAjpFAK75KxHLzSdYO1U0471Kidk-w,30256
+odoo/addons/connector_importer/i18n/connector_importer.pot,sha256=C68K6cY8dM9q1QCqrssitDzrMqm9seXpou5Z1maCPWU,32311
 odoo/addons/connector_importer/models/__init__.py,sha256=orxP9e6AoeA-14goPFDfkc7-HVbytsRaqtOHoCa0Na0,187
-odoo/addons/connector_importer/models/backend.py,sha256=z-PiUTLMSH1TKPDppEpeOxwxrt2yvGfQpjqfWIs-iZE,5023
+odoo/addons/connector_importer/models/backend.py,sha256=EIC4f2wtaeHJxZJvkGOXSTVEKJUxC_BPWft0q_evCRI,5152
 odoo/addons/connector_importer/models/cron_mixin.py,sha256=q6WFTHSxazjyaiNmP3ykgz_MN-BiWSZ34FdsMTxb7pc,2499
-odoo/addons/connector_importer/models/import_type.py,sha256=BAVO2RJlqpwJvuYUHviUiOsurv5yLwE-w_MRvHBOiVE,5479
+odoo/addons/connector_importer/models/import_type.py,sha256=go6VTH7QvlnbhCRjGG1jFt-7g1eDacIFxh7JQz-q66M,5696
 odoo/addons/connector_importer/models/job_mixin.py,sha256=hthk1PLNsUoazxqivzYGrSZ5fT8EqK3Ekj8zUNFftE0,903
-odoo/addons/connector_importer/models/record.py,sha256=_ie56qGFdf5NxqPA-KXXNzs_XaZnGE6sAy0ZeT4Qwzw,4551
-odoo/addons/connector_importer/models/recordset.py,sha256=Ir_FkOIj3E_MxA7mP8-OSZ7dde22wOnesPwCzkKlWKY,11630
+odoo/addons/connector_importer/models/record.py,sha256=HGB06kJz4j9T2Fi5CZLSNqxyFE1T8tyMf82q3XPPyp4,4078
+odoo/addons/connector_importer/models/recordset.py,sha256=Wwgf6C2UZebZIqCYVhnnlGqJOUMEv2w7AE3QYwOKPf4,11612
 odoo/addons/connector_importer/models/reporter.py,sha256=dys_2TTjg301IjuxGTX7BTfmjgrEKe-kkUeymmV2saQ,8955
 odoo/addons/connector_importer/models/sources/__init__.py,sha256=2CvxncwEjp49RFm7hxCm7VYZpaL8MzQ6FsFIMNOMGUg,88
 odoo/addons/connector_importer/models/sources/source_consumer_mixin.py,sha256=wRsyxbg8va44fJh4J3gIJ2Hse4AhV2SjsqchYmo8XVo,2409
-odoo/addons/connector_importer/models/sources/source_csv.py,sha256=L3Gv46BUUdm7n0VjG_HG5nzrz1d08kiTqKZ_O4g6t5U,3670
+odoo/addons/connector_importer/models/sources/source_csv.py,sha256=T2GLPfU8tYeFv1DNlHMXNFGzxBeePsEWzal5abvF4O4,4005
 odoo/addons/connector_importer/models/sources/source_mixin.py,sha256=EdQGgYKuAORTfk_g4lYwDd1wg_zcwfnnH8tvhQ46Wj0,4110
 odoo/addons/connector_importer/readme/CONTRIBUTORS.rst,sha256=I5OupHaW-F6JYLvCwIYqxXsoViOe0OH731bcuUhIHfI,184
 odoo/addons/connector_importer/readme/DESCRIPTION.rst,sha256=AapsY8CNlKP2rYweGMixRmhBSj4Ls168IoY8SQ3dD3c,118
-odoo/addons/connector_importer/readme/ROADMAP.rst,sha256=LmDvrF0r8u1p8UG3zT_ftlQnl518Jp4faRVVhJtK0dQ,871
+odoo/addons/connector_importer/readme/ROADMAP.rst,sha256=AwNw4pfEVxtLzGblgfDZXFLwiG-YWohIDlBM0jMYmM4,1027
 odoo/addons/connector_importer/security/ir.model.access.csv,sha256=TPIauEs3e9XOyxNrwxX02jgovdNue7QHgtiTwB3FlCo,1402
 odoo/addons/connector_importer/security/security.xml,sha256=bUZo9v07QxNOWY-JNIN2I3d24oL-TE5JpZl5tOzf_5Q,647
 odoo/addons/connector_importer/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
-odoo/addons/connector_importer/static/description/index.html,sha256=6rA6mfJOrB8zgnV7PWap75paVi2dRpHGVB1NefR93fo,13311
-odoo/addons/connector_importer/tests/__init__.py,sha256=sIWRr8qOsgxponCgEMsnPcll6YSpkiDgbFiKnvopmFM,284
+odoo/addons/connector_importer/static/description/index.html,sha256=gRwsd4iBHpYfBWJU6ZcrRKv672_aLE-4Y2DEySo2yOw,13479
+odoo/addons/connector_importer/tests/__init__.py,sha256=DxBp8Lkw0a0ccstVMCc0fYZBmlXToF6VcjQDl50cCok,310
 odoo/addons/connector_importer/tests/common.py,sha256=KXQEdAMczgXrWPaw78Lh9nrM8wM2rLo_--jNXd6qdik,3171
-odoo/addons/connector_importer/tests/fake_components.py,sha256=k6PoWV9BWxMYzGqI2A3ldBRbchfrcKVaPBMCNUrvYdo,1850
+odoo/addons/connector_importer/tests/fake_components.py,sha256=g8BGXc3KkKtubuKgUlT3fulR9KuzpeaDOreEZ4joAC4,1814
 odoo/addons/connector_importer/tests/fake_models.py,sha256=n14ncv6ivEJAwBZIKbyLpouFs8bji_W8UcBg-urcYuI,1022
 odoo/addons/connector_importer/tests/test_backend.py,sha256=CIgsUfTvZQ579jI6TOdYbiyY94MYoKZHmLgQ8vbCjUQ,1543
 odoo/addons/connector_importer/tests/test_cron.py,sha256=37fIpfhOc64J47NKI5E-kgW3aEGApAWuvRzYvgjerYM,1505
-odoo/addons/connector_importer/tests/test_import_type.py,sha256=HUlXgbeZT8BI1dK36pfYdTmuYSvz-j_1SyaIn38LQQo,4564
+odoo/addons/connector_importer/tests/test_import_type.py,sha256=BN5rncBa0zT8fMnLeMOBnxO1QKfwWcojlcKuCEFYHfk,5840
+odoo/addons/connector_importer/tests/test_mapper.py,sha256=Kd7RxT0mgMWyBy1RDtAklyCDP2CC2AHmok1dptkwk_0,4087
 odoo/addons/connector_importer/tests/test_record_importer.py,sha256=LIv0E2_nrfGPRk0aV1sUj-dglFDnsDGqc4HsNO1M0y0,4451
-odoo/addons/connector_importer/tests/test_record_importer_basic.py,sha256=QCUjsXisbrZsXVHKfA0RMoFkpRaOn6ybABXb_siYZGM,3417
+odoo/addons/connector_importer/tests/test_record_importer_basic.py,sha256=Ujynpv0ElQq7qEr9nHjQ3yWoDOoXog6jb0A6cH5sKAo,4258
 odoo/addons/connector_importer/tests/test_record_importer_xmlid.py,sha256=4Qcp7o7tNbfpm7YJ8rS-IUnZyvA3Z0R9vvHI1WVPGdU,1847
-odoo/addons/connector_importer/tests/test_recordset.py,sha256=edyq4w8bYFTsv1nCZxCd3qMntAqJPkSaZq_O2aC-HOM,3042
+odoo/addons/connector_importer/tests/test_recordset.py,sha256=KcwunzLbNWV-yCSka-qYaKvIAV26djAP-NJ1186MYVA,3008
 odoo/addons/connector_importer/tests/test_recordset_importer.py,sha256=qXK23Bg6_-2y3UyvsRjvA2GAuivKmt_uLMqqVTdKhvg,3352
-odoo/addons/connector_importer/tests/test_source.py,sha256=lR0QO4kimTc6zHtaseI8NrrncQVTygDkoDX-GjGMIOE,2627
+odoo/addons/connector_importer/tests/test_source.py,sha256=U-dbcxAjoWCmDrwuQ_Y-spLCU7yq-8Ah9hif_1vRFeQ,2760
 odoo/addons/connector_importer/tests/test_source_csv.py,sha256=XhUbTxKsBiZ9jIkcMb6mfGTEDMseHdSV3vCXxsoaB3k,2990
 odoo/addons/connector_importer/tests/fixtures/csv_source_test1.csv,sha256=Eny0O_lQM8KuBAuF7fwHLM_Zsbk03i79olGfEWa6SS8,85
 odoo/addons/connector_importer/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-odoo/addons/connector_importer/utils/import_utils.py,sha256=RyRSzTSgQQ22DMtgLV2t85knfRSyGx-psL_3xVgZJOQ,3753
-odoo/addons/connector_importer/utils/mapper_utils.py,sha256=zAVf43svzrtQGxme1bSVsJ6s_3J8NklzM_3diHNgQsM,9909
+odoo/addons/connector_importer/utils/import_utils.py,sha256=kb0pb6Se-jUiIUhX-tyHc5DW7XSIjgLxNAPVq6zBO0M,4114
+odoo/addons/connector_importer/utils/mapper_utils.py,sha256=smtPiSkwMsMDsFHa5FmrDYJqGhI6OmFUYPJWhNmb_vg,11103
+odoo/addons/connector_importer/utils/misc.py,sha256=poQXBBU3BTbbJKZ9Z-Z8sdsy_uOVGgKX3ZHZFqz7F4I,2418
 odoo/addons/connector_importer/utils/report_html.py,sha256=7Ljotu3AOaNUG6412mNmWiGwNpoVtkbz5QwqVVKFSPI,4254
-odoo/addons/connector_importer/views/backend_views.xml,sha256=RF3THgsvkWmTpnzKw1kKnDnjE4fosEPjNiByydFeTqU,5639
+odoo/addons/connector_importer/views/backend_views.xml,sha256=ed8t86WnZLFw9rgdUcTdstvTkOaCZU7Qd1x7iW6GCEk,6218
 odoo/addons/connector_importer/views/docs_template.xml,sha256=QHQgJtlEBqulmLzpulpHiAGSnHmkEYds-hGsf55AOmw,9503
+odoo/addons/connector_importer/views/import_type_views.xml,sha256=hklf5eaJ0NVGJDr3-tDr-ZXJy3I4IbTHoUKOsahdeHU,1637
 odoo/addons/connector_importer/views/recordset_views.xml,sha256=34TTS_vyNAskBZxSUqzhLVOV7XYFok0_jbP_qJnyXwg,5912
 odoo/addons/connector_importer/views/report_template.xml,sha256=DLYJgdxWw2FoH-1IFaKqQ5Vpl_J7wEzryPonpTGUzxc,2099
 odoo/addons/connector_importer/views/source_config_template.xml,sha256=LzIiidOvDNBRQV_5byrSQK6gyVDxcbVr4rlnxLTkKgw,576
-odoo/addons/connector_importer/views/source_views.xml,sha256=Z66CNzxSM5ABHoL8_1SqTQh5GqEU4uSi-czHh1QM1Q8,1419
-odoo14_addon_connector_importer-14.0.1.2.0.dist-info/METADATA,sha256=yT9s72-gIygw1-Xnvlw7CHANj5T6mfKQ0kpcF4t2BFw,4608
-odoo14_addon_connector_importer-14.0.1.2.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo14_addon_connector_importer-14.0.1.2.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_connector_importer-14.0.1.2.0.dist-info/RECORD,,
+odoo/addons/connector_importer/views/source_views.xml,sha256=-8V2OP0V2Ier1ulc8L9mhY7mp104HkbVHGJj64e7Kkc,2616
+odoo14_addon_connector_importer-14.0.2.0.0.dist-info/METADATA,sha256=A0xMmkZJAlEwHNnvEMZmt5bMEWoYwnxslJeVT5sCZVw,4764
+odoo14_addon_connector_importer-14.0.2.0.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo14_addon_connector_importer-14.0.2.0.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_connector_importer-14.0.2.0.0.dist-info/RECORD,,
```

