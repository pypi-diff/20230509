# Comparing `tmp/tensordict-0.1.1-py3-none-any.whl.zip` & `tmp/tensordict-0.1.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,29 +1,29 @@
-Zip file size: 129598 bytes, number of entries: 27
--rw-r--r--  2.0 unx     1088 b- defN 23-May-06 20:59 tensordict/__init__.py
--rw-r--r--  2.0 unx     6000 b- defN 23-May-06 20:59 tensordict/_contextlib.py
--rw-r--r--  2.0 unx    29601 b- defN 23-May-06 20:59 tensordict/memmap.py
--rw-r--r--  2.0 unx    33049 b- defN 23-May-06 20:59 tensordict/persistent.py
--rw-r--r--  2.0 unx    30420 b- defN 23-May-06 20:59 tensordict/tensorclass.py
--rw-r--r--  2.0 unx   267125 b- defN 23-May-06 20:59 tensordict/tensordict.py
--rw-r--r--  2.0 unx    26209 b- defN 23-May-06 20:59 tensordict/utils.py
--rw-r--r--  2.0 unx       79 b- defN 23-May-06 21:07 tensordict/version.py
--rw-r--r--  2.0 unx     1314 b- defN 23-May-06 20:59 tensordict/nn/__init__.py
--rw-r--r--  2.0 unx    35649 b- defN 23-May-06 20:59 tensordict/nn/common.py
--rw-r--r--  2.0 unx    19188 b- defN 23-May-06 20:59 tensordict/nn/functional_modules.py
--rw-r--r--  2.0 unx    22301 b- defN 23-May-06 20:59 tensordict/nn/probabilistic.py
--rw-r--r--  2.0 unx    19564 b- defN 23-May-06 20:59 tensordict/nn/sequence.py
--rw-r--r--  2.0 unx    10621 b- defN 23-May-06 20:59 tensordict/nn/utils.py
--rw-r--r--  2.0 unx      499 b- defN 23-May-06 20:59 tensordict/nn/distributions/__init__.py
--rw-r--r--  2.0 unx     7073 b- defN 23-May-06 20:59 tensordict/nn/distributions/continuous.py
--rw-r--r--  2.0 unx     2580 b- defN 23-May-06 20:59 tensordict/nn/distributions/discrete.py
--rw-r--r--  2.0 unx     6504 b- defN 23-May-06 20:59 tensordict/nn/distributions/truncated_normal.py
--rw-r--r--  2.0 unx     1226 b- defN 23-May-06 20:59 tensordict/nn/distributions/utils.py
--rw-r--r--  2.0 unx      381 b- defN 23-May-06 20:59 tensordict/prototype/__init__.py
--rw-r--r--  2.0 unx     7507 b- defN 23-May-06 20:59 tensordict/prototype/fx.py
--rw-r--r--  2.0 unx      739 b- defN 23-May-06 20:59 tensordict/prototype/tensorclass.py
--rw-r--r--  2.0 unx     1098 b- defN 23-May-06 21:07 tensordict-0.1.1.dist-info/LICENSE
--rw-r--r--  2.0 unx    15197 b- defN 23-May-06 21:07 tensordict-0.1.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-06 21:07 tensordict-0.1.1.dist-info/WHEEL
--rw-r--r--  2.0 unx       11 b- defN 23-May-06 21:07 tensordict-0.1.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2297 b- defN 23-May-06 21:07 tensordict-0.1.1.dist-info/RECORD
-27 files, 547412 bytes uncompressed, 125906 bytes compressed:  77.0%
+Zip file size: 130056 bytes, number of entries: 27
+-rw-r--r--  2.0 unx     1088 b- defN 23-May-09 15:36 tensordict/__init__.py
+-rw-r--r--  2.0 unx     6000 b- defN 23-May-09 15:36 tensordict/_contextlib.py
+-rw-r--r--  2.0 unx    29601 b- defN 23-May-09 15:36 tensordict/memmap.py
+-rw-r--r--  2.0 unx    33049 b- defN 23-May-09 15:36 tensordict/persistent.py
+-rw-r--r--  2.0 unx    30420 b- defN 23-May-09 15:36 tensordict/tensorclass.py
+-rw-r--r--  2.0 unx   267149 b- defN 23-May-09 15:36 tensordict/tensordict.py
+-rw-r--r--  2.0 unx    28030 b- defN 23-May-09 15:36 tensordict/utils.py
+-rw-r--r--  2.0 unx       79 b- defN 23-May-09 15:47 tensordict/version.py
+-rw-r--r--  2.0 unx     1314 b- defN 23-May-09 15:36 tensordict/nn/__init__.py
+-rw-r--r--  2.0 unx    35649 b- defN 23-May-09 15:36 tensordict/nn/common.py
+-rw-r--r--  2.0 unx    19059 b- defN 23-May-09 15:36 tensordict/nn/functional_modules.py
+-rw-r--r--  2.0 unx    22301 b- defN 23-May-09 15:36 tensordict/nn/probabilistic.py
+-rw-r--r--  2.0 unx    19564 b- defN 23-May-09 15:36 tensordict/nn/sequence.py
+-rw-r--r--  2.0 unx    10621 b- defN 23-May-09 15:36 tensordict/nn/utils.py
+-rw-r--r--  2.0 unx      499 b- defN 23-May-09 15:36 tensordict/nn/distributions/__init__.py
+-rw-r--r--  2.0 unx     7073 b- defN 23-May-09 15:36 tensordict/nn/distributions/continuous.py
+-rw-r--r--  2.0 unx     2580 b- defN 23-May-09 15:36 tensordict/nn/distributions/discrete.py
+-rw-r--r--  2.0 unx     6504 b- defN 23-May-09 15:36 tensordict/nn/distributions/truncated_normal.py
+-rw-r--r--  2.0 unx     1226 b- defN 23-May-09 15:36 tensordict/nn/distributions/utils.py
+-rw-r--r--  2.0 unx      381 b- defN 23-May-09 15:36 tensordict/prototype/__init__.py
+-rw-r--r--  2.0 unx     7507 b- defN 23-May-09 15:36 tensordict/prototype/fx.py
+-rw-r--r--  2.0 unx      739 b- defN 23-May-09 15:36 tensordict/prototype/tensorclass.py
+-rw-r--r--  2.0 unx     1098 b- defN 23-May-09 15:47 tensordict-0.1.2.dist-info/LICENSE
+-rw-r--r--  2.0 unx    15197 b- defN 23-May-09 15:47 tensordict-0.1.2.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-09 15:47 tensordict-0.1.2.dist-info/WHEEL
+-rw-r--r--  2.0 unx       11 b- defN 23-May-09 15:47 tensordict-0.1.2.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2297 b- defN 23-May-09 15:47 tensordict-0.1.2.dist-info/RECORD
+27 files, 549128 bytes uncompressed, 126364 bytes compressed:  77.0%
```

## zipnote {}

```diff
@@ -60,23 +60,23 @@
 
 Filename: tensordict/prototype/fx.py
 Comment: 
 
 Filename: tensordict/prototype/tensorclass.py
 Comment: 
 
-Filename: tensordict-0.1.1.dist-info/LICENSE
+Filename: tensordict-0.1.2.dist-info/LICENSE
 Comment: 
 
-Filename: tensordict-0.1.1.dist-info/METADATA
+Filename: tensordict-0.1.2.dist-info/METADATA
 Comment: 
 
-Filename: tensordict-0.1.1.dist-info/WHEEL
+Filename: tensordict-0.1.2.dist-info/WHEEL
 Comment: 
 
-Filename: tensordict-0.1.1.dist-info/top_level.txt
+Filename: tensordict-0.1.2.dist-info/top_level.txt
 Comment: 
 
-Filename: tensordict-0.1.1.dist-info/RECORD
+Filename: tensordict-0.1.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## tensordict/tensordict.py

```diff
@@ -3022,15 +3022,15 @@
                 "indexing a tensordict with td.batch_dims==0 is not permitted"
             )
 
         if _is_number(idx):
             return self._index_tensordict((idx,))
 
         if isinstance(idx, list):
-            idx = torch.tensor(idx, device=self.device)
+            # idx = torch.tensor(idx, device=self.device)
             return self._index_tensordict(idx)
 
         if isinstance(idx, np.ndarray):
             idx = torch.tensor(idx, device=self.device)
             return self._index_tensordict(idx)
 
         if isinstance(idx, range):
@@ -3574,25 +3574,25 @@
         if self.device is not None and len(devices) >= 1 and devices != {self.device}:
             raise RuntimeError(
                 f"TensorDict.device is {self._device}, but elements have "
                 f"device values {devices}. If TensorDict.device is set then "
                 "all elements must share that device."
             )
 
-    def _index_tensordict(self, idx: IndexType) -> TensorDictBase:
-        names = self._get_names_idx(idx)
-        self_copy = copy(self)
-        # self_copy = self.clone(False)
-        self_copy._tensordict = {
-            key: _get_item(item, idx) for key, item in self.items()
-        }
-        self_copy._batch_size = _getitem_batch_size(self_copy.batch_size, idx)
-        self_copy._device = self.device
-        self_copy.names = names
-        return self_copy
+    # def _index_tensordict(self, idx: IndexType) -> TensorDictBase:
+    #     names = self._get_names_idx(idx)
+    #     self_copy = copy(self)
+    #     # self_copy = self.clone(False)
+    #     self_copy._tensordict = {
+    #         key: _get_item(item, idx) for key, item in self.items()
+    #     }
+    #     self_copy._batch_size = _getitem_batch_size(self_copy.batch_size, idx)
+    #     self_copy._device = self.device
+    #     self_copy.names = names
+    #     return self_copy
 
     def pin_memory(self) -> TensorDictBase:
         def pin_mem(tensor):
             return tensor.pin_memory()
 
         return self.apply(pin_mem)
```

## tensordict/utils.py

```diff
@@ -3,14 +3,16 @@
 # This source code is licensed under the MIT license found in the
 # LICENSE file in the root directory of this source tree.
 
 from __future__ import annotations
 
 import math
 import time
+
+import warnings
 from functools import wraps
 from numbers import Number
 from typing import Any, List, Sequence, Tuple, TYPE_CHECKING, Union
 
 import numpy as np
 import torch
 from torch import Tensor
@@ -91,14 +93,21 @@
     if isinstance(items, torch.Tensor) and items.dtype is torch.bool:
         return torch.Size([items.sum(), *shape[items.ndimension() :]])
     if (
         isinstance(items, (torch.Tensor, np.ndarray)) and len(items.shape) <= 1
     ) or isinstance(items, list):
         if isinstance(items, torch.Tensor) and not items.shape:
             return shape[1:]
+        if _is_lis_of_list_of_bools(items):
+            warnings.warn(
+                "Got a list of list of bools: this indexing behaviour will be deprecated soon.",
+                category=DeprecationWarning,
+            )
+            items = torch.tensor(items)
+            return torch.Size([items.sum(), *shape[items.ndimension() :]])
         if len(items):
             return torch.Size([len(items), *shape[1:]])
         else:
             return shape[1:]
 
     if not isinstance(items, tuple):
         items = (items,)
@@ -688,15 +697,30 @@
         return tensor._values.dtype
     else:
         return tensor.dtype
 
 
 def _get_item(tensor: torch.Tensor, index: IndexType) -> torch.Tensor:
     if isinstance(tensor, torch.Tensor):
-        return tensor[index]
+        try:
+            return tensor[index]
+        except IndexError as err:
+            # try to map list index to tensor, and assess type. If bool, we
+            # likely have a nested list of booleans which is not supported by pytorch
+            if _is_lis_of_list_of_bools(index):
+                index = torch.tensor(index, device=tensor.device)
+                if index.dtype is torch.bool:
+                    warnings.warn(
+                        "Indexing a tensor with a nested list of boolean values is "
+                        "going to be deprecated as this functionality is not supported "
+                        f"by PyTorch. (follows error: {err})",
+                        category=DeprecationWarning,
+                    )
+                return tensor[index]
+            raise err
     elif isinstance(tensor, KeyedJaggedTensor):
         return index_keyedjaggedtensor(tensor, index)
     else:
         return tensor[index]
 
 
 def _set_item(
@@ -786,7 +810,27 @@
         6756, 1717, 4410, 9740, 9611, 9716, 5397, 7745, 4521, 7523,
         6756, 1717, 4410, 9740, 9611, 9716, 5397, 7745, 4521, 7523,
     """
     max_seed_val = 10_000
     rng = np.random.default_rng(seed)
     seed = int.from_bytes(rng.bytes(8), "big")
     return seed % max_seed_val
+
+
+def _is_lis_of_list_of_bools(index, first_level=True):
+    # determines if an index is a list of list of bools.
+    # this is aimed at catching a deprecation feature where list of list
+    # of bools are valid indices
+    if first_level:
+        if not isinstance(index, list):
+            return False
+        if not len(index):
+            return False
+        if isinstance(index[0], list):
+            return _is_lis_of_list_of_bools(index[0], False)
+        return False
+    # then we know it is a list of lists
+    if isinstance(index[0], bool):
+        return True
+    if isinstance(index[0], list):
+        return _is_lis_of_list_of_bools(index[0], False)
+    return False
```

## tensordict/version.py

```diff
@@ -1,2 +1,2 @@
-__version__ = '0.1.1'
-git_version = '7cebb2ab5745641d3e5bded35c9512905508649f'
+__version__ = '0.1.2'
+git_version = '841a0546d4549dbb6eaaeaf12b58b24bdc521b3d'
```

## tensordict/nn/functional_modules.py

```diff
@@ -196,23 +196,21 @@
             if not isinstance(batched_output, TensorDictBase):
                 out = _remove_batch_dim(batched_output, vmap_level, batch_size, out_dim)
             else:
                 new_batch_size = list(batched_output.batch_size)
                 new_batch_size.insert(out_dim, batch_size)
                 new_names = list(batched_output.names)
                 new_names.insert(out_dim, None)
-                print(batched_output.names)
                 out = batched_output.apply(
                     lambda x, out_dim=out_dim: _remove_batch_dim(
                         x, vmap_level, batch_size, out_dim
                     ),
                     batch_size=new_batch_size,
                     names=new_names,
                 )
-                print(new_batch_size, out_dim, batch_size, flat_out_dims, out.names)
             flat_outputs.append(out)
         return tree_unflatten(flat_outputs, output_spec)
 
     vmap_src._unwrap_batched = _unwrap_batched
 
 
 # Tensordict-compatible Functional modules
```

## Comparing `tensordict-0.1.1.dist-info/LICENSE` & `tensordict-0.1.2.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `tensordict-0.1.1.dist-info/METADATA` & `tensordict-0.1.2.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tensordict
-Version: 0.1.1
+Version: 0.1.2
 Home-page: https://github.com/pytorch-labs/tensordict
 Author: tensordict contributors
 Author-email: vmoens@fb.com
 License: BSD
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
@@ -358,15 +358,15 @@
 
 If you're using TensorDict, please refer to this BibTeX entry to cite this work:
 ```
 @software{TensorDict,
   author = {Moens, Vincent},
   title = {{TensorDict: your PyTorch universal data carrier}},
   url = {https://github.com/pytorch-labs/tensordict},
-  version = {0.1.1},
+  version = {0.1.2},
   year = {2023}
 }
 ```
 
 ## Disclaimer
 
 TensorDict is at the *beta*-stage, meaning that there may be bc-breaking changes introduced, but
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: tensordict Version: 0.1.1 Home-page: https://
+Metadata-Version: 2.1 Name: tensordict Version: 0.1.2 Home-page: https://
 github.com/pytorch-labs/tensordict Author: tensordict contributors Author-
 email: vmoens@fb.com License: BSD Classifier: Programming Language :: Python ::
 3.7 Classifier: Programming Language :: Python :: 3.8 Classifier: Programming
 Language :: Python :: 3.9 Classifier: Programming Language :: Python :: 3.10
 Classifier: Development Status :: 4 - Beta Description-Content-Type: text/
 markdown License-File: LICENSE Requires-Dist: torch Requires-Dist: numpy
 Requires-Dist: cloudpickle Provides-Extra: checkpointing Requires-Dist:
@@ -181,13 +181,13 @@
 This will work with Python 3.7 and upward as well as PyTorch 1.12 and upward.
 To enjoy the latest features, one can use ```bash pip install tensordict-
 nightly ``` **With Conda**: Install `tensordict` from `conda-forge` channel.
 ```sh conda install -c conda-forge tensordict ``` ## Citation If you're using
 TensorDict, please refer to this BibTeX entry to cite this work: ``` @software
 {TensorDict, author = {Moens, Vincent}, title = {{TensorDict: your PyTorch
 universal data carrier}}, url = {https://github.com/pytorch-labs/tensordict},
-version = {0.1.1}, year = {2023} } ``` ## Disclaimer TensorDict is at the
+version = {0.1.2}, year = {2023} } ``` ## Disclaimer TensorDict is at the
 *beta*-stage, meaning that there may be bc-breaking changes introduced, but
 they should come with a warranty. Hopefully these should not happen too often,
 as the current roadmap mostly involves adding new features and building
 compatibility with the broader PyTorch ecosystem. ## License TensorDict is
 licensed under the MIT License. See [LICENSE](LICENSE) for details.
```

## Comparing `tensordict-0.1.1.dist-info/RECORD` & `tensordict-0.1.2.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -1,27 +1,27 @@
 tensordict/__init__.py,sha256=dDQidc208swLADInUxPlfvgfERJr2xeVTNC5NRvwN4A,1088
 tensordict/_contextlib.py,sha256=F4b0KH4FSeKsY9dkRuIXgHEn1dL_aNk7lFs1DonDYn4,6000
 tensordict/memmap.py,sha256=sBIRRJVadGiXlT5A8UfxoQqn6EEE1TBUDUaCyz65Yws,29601
 tensordict/persistent.py,sha256=CkF6hVsKAO21Le-7fuUChsLczoUr7Eflj6A6H7Z1XEo,33049
 tensordict/tensorclass.py,sha256=6eGhArep4GwEOeMFrdvv9MyVuy6oc4G58mhI2AVPh8M,30420
-tensordict/tensordict.py,sha256=raNiDj7w5CKompvO7wGDFxaPMfvqGPDR3YnOau0tko4,267125
-tensordict/utils.py,sha256=rZjY_b8mGys_YDWyWIQbZ1xeiJrXvG-u7sUxaSsjqIc,26209
-tensordict/version.py,sha256=jhJ2Sy4GJngPYcrvZZ4zbqaa04WBDg17E9l2N_F3pvk,79
+tensordict/tensordict.py,sha256=lWNqG5grDyCjUU77Dws3XuFJn6AS62r9xFYtR_Q86bY,267149
+tensordict/utils.py,sha256=4ol71UgwHe9jvhiVG7-RH2fFFMWnRD1e8VdUY_g7Ffo,28030
+tensordict/version.py,sha256=DNO1fLz_ajVo0Fra6lzPHjLD_5s4PSHViXOE9JdtDHE,79
 tensordict/nn/__init__.py,sha256=gjahPjJuC1uGPppYt7yZ8Ifusf2hTnOJHZGf8IutgoU,1314
 tensordict/nn/common.py,sha256=ncXtR3RsA3Ma5xxJILMi-W6or_hAmRwqZYsEaBxD208,35649
-tensordict/nn/functional_modules.py,sha256=jGJOUTaqCKO6Pmp8IuzGLWvej5WIOV26akH_0AMU7FI,19188
+tensordict/nn/functional_modules.py,sha256=LjMtRNvf8umx6vbIk0ZlpoeGJl6NSsN3oXB1a-_y1VQ,19059
 tensordict/nn/probabilistic.py,sha256=ZYa7f2PzWqgwTw3TJAcd125HRpD4p6aPc1HD5o709WM,22301
 tensordict/nn/sequence.py,sha256=l5nuYu0Ja11IO9qWSlijvRZH4XDLbUy8lwkFmyAHrHE,19564
 tensordict/nn/utils.py,sha256=Hb8zIWL_wGs8OSaGjqQJ4DAadLqA9d4GARR7EboKOFU,10621
 tensordict/nn/distributions/__init__.py,sha256=sD3yMuMceDJ8EqtptE4HEaS9Q_3keskCB9npPNFKXUo,499
 tensordict/nn/distributions/continuous.py,sha256=Y31G7ozOnlGUgzdqYZaKeXVjDOVMoSW1hIQWtcbyDO0,7073
 tensordict/nn/distributions/discrete.py,sha256=gUzTKs3yO8GkSY0ghBWVaZdHdmFyMMLWd5LV52CfrXY,2580
 tensordict/nn/distributions/truncated_normal.py,sha256=d1ontYbG_Q-W5gcVnWLadvZ1OBBeZGmBb5EUmr3ekak,6504
 tensordict/nn/distributions/utils.py,sha256=fX6NUeNnWKK6kDdOp8NTM43Lls3vMCF5h-S2teVZw3E,1226
 tensordict/prototype/__init__.py,sha256=b9Wmi1tbh2Em_wmKa52IXwxuudd6CUqdLgaob0bSWqQ,381
 tensordict/prototype/fx.py,sha256=Z3X821miRKcrOYwApvBDYt2_hST3IXNVe4v03tVvQKo,7507
 tensordict/prototype/tensorclass.py,sha256=pE53rWFqcPmuJOyOkI7cBZL9sMVfPx8bdQR1hNgYPvU,739
-tensordict-0.1.1.dist-info/LICENSE,sha256=xdjS4_xk-IwnLuIFCvTYTl9Y8aXRejqpmke3dGam_nI,1098
-tensordict-0.1.1.dist-info/METADATA,sha256=4DEZg_Nwe0Z27sKTb_Y44Vu9_-dnsR8oTlm1m4Ol70Y,15197
-tensordict-0.1.1.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-tensordict-0.1.1.dist-info/top_level.txt,sha256=4EMgKpsnmq04uFLPJXf8tMQb1POT8QqR1pR74y5wycc,11
-tensordict-0.1.1.dist-info/RECORD,,
+tensordict-0.1.2.dist-info/LICENSE,sha256=xdjS4_xk-IwnLuIFCvTYTl9Y8aXRejqpmke3dGam_nI,1098
+tensordict-0.1.2.dist-info/METADATA,sha256=xtPQFb19LEJIMi2sl93WVeFeJzW3eMmoo5_d7gRMdEE,15197
+tensordict-0.1.2.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+tensordict-0.1.2.dist-info/top_level.txt,sha256=4EMgKpsnmq04uFLPJXf8tMQb1POT8QqR1pR74y5wycc,11
+tensordict-0.1.2.dist-info/RECORD,,
```

