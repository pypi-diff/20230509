# Comparing `tmp/liba-0.1.1rc4.tar.gz` & `tmp/liba-0.1.1rc5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "liba-0.1.1rc4.tar", last modified: Tue Nov 29 08:14:30 2022, max compression
+gzip compressed data, was "liba-0.1.1rc5.tar", last modified: Tue May  9 18:20:15 2023, max compression
```

## Comparing `liba-0.1.1rc4.tar` & `liba-0.1.1rc5.tar`

### file list

```diff
@@ -1,98 +1,93 @@
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.793584 liba-0.1.1rc4/
--rwxrwxrwx   0 root         (0) root         (0)       87 2022-11-26 11:24:13.000000 liba-0.1.1rc4/MANIFEST.in
--rwxrwxrwx   0 root         (0) root         (0)     5141 2022-11-29 08:14:30.793779 liba-0.1.1rc4/PKG-INFO
--rwxrwxrwx   0 root         (0) root         (0)     3334 2022-10-20 10:09:01.000000 liba-0.1.1rc4/README.md
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.726557 liba-0.1.1rc4/ffi/
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.726644 liba-0.1.1rc4/ffi/python/
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.738997 liba-0.1.1rc4/ffi/python/src/
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.753571 liba-0.1.1rc4/ffi/python/src/a/
--rwxrwxrwx   0 root         (0) root         (0)     1393 2022-11-20 17:52:47.000000 liba-0.1.1rc4/ffi/python/src/a/__init__.pxd
--rwxrwxrwx   0 root         (0) root         (0)       20 2022-11-20 17:52:47.000000 liba-0.1.1rc4/ffi/python/src/a/__init__.pxi
--rwxrwxrwx   0 root         (0) root         (0)     1588 2022-10-29 17:46:29.000000 liba-0.1.1rc4/ffi/python/src/a/fpid.pxd
--rwxrwxrwx   0 root         (0) root         (0)     5102 2022-10-30 12:38:18.000000 liba-0.1.1rc4/ffi/python/src/a/fpid.pxi
--rwxrwxrwx   0 root         (0) root         (0)       81 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/math.pxd
--rwxrwxrwx   0 root         (0) root         (0)      280 2022-10-30 12:38:18.000000 liba-0.1.1rc4/ffi/python/src/a/math.pxi
--rwxrwxrwx   0 root         (0) root         (0)      651 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/mf.pxd
--rwxrwxrwx   0 root         (0) root         (0)     2427 2022-10-30 12:38:18.000000 liba-0.1.1rc4/ffi/python/src/a/mf.pxi
--rwxrwxrwx   0 root         (0) root         (0)     1588 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/pid.pxd
--rwxrwxrwx   0 root         (0) root         (0)     3013 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/pid.pxi
--rwxrwxrwx   0 root         (0) root         (0)      449 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/poly.pxd
--rwxrwxrwx   0 root         (0) root         (0)      710 2022-10-30 12:38:18.000000 liba-0.1.1rc4/ffi/python/src/a/poly.pxi
--rwxrwxrwx   0 root         (0) root         (0)     2798 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/polytrack.pxd
--rwxrwxrwx   0 root         (0) root         (0)    11268 2022-10-30 12:38:18.000000 liba-0.1.1rc4/ffi/python/src/a/polytrack.pxi
--rwxrwxrwx   0 root         (0) root         (0)      504 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/tf.pxd
--rwxrwxrwx   0 root         (0) root         (0)     1293 2022-10-30 12:38:18.000000 liba-0.1.1rc4/ffi/python/src/a/tf.pxi
--rwxrwxrwx   0 root         (0) root         (0)      168 2022-10-20 10:09:01.000000 liba-0.1.1rc4/ffi/python/src/a/version.pxd
--rwxrwxrwx   0 root         (0) root         (0)      481 2022-11-27 12:02:27.000000 liba-0.1.1rc4/ffi/python/src/a/version.pxi
--rwxrwxrwx   0 root         (0) root         (0)  1251389 2022-11-29 07:46:33.000000 liba-0.1.1rc4/ffi/python/src/lib.c
--rwxrwxrwx   0 root         (0) root         (0)      494 2022-11-26 11:24:13.000000 liba-0.1.1rc4/ffi/python/src/lib.pyx
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.727314 liba-0.1.1rc4/include/
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.765371 liba-0.1.1rc4/include/a/
--rwxrwxrwx   0 root         (0) root         (0)    29877 2022-11-26 11:24:13.000000 liba-0.1.1rc4/include/a/a.h
--rwxrwxrwx   0 root         (0) root         (0)     1213 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/a.hpp
--rwxrwxrwx   0 root         (0) root         (0)    10632 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/arr.h
--rwxrwxrwx   0 root         (0) root         (0)    12559 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/complex.h
--rwxrwxrwx   0 root         (0) root         (0)     7538 2022-11-27 12:51:13.000000 liba-0.1.1rc4/include/a/config.h
--rwxrwxrwx   0 root         (0) root         (0)     2011 2022-10-20 10:09:01.000000 liba-0.1.1rc4/include/a/crc.h
--rwxrwxrwx   0 root         (0) root         (0)    10934 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/fpid.h
--rwxrwxrwx   0 root         (0) root         (0)     1478 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/fuzzy.h
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.767339 liba-0.1.1rc4/include/a/host/
--rwxrwxrwx   0 root         (0) root         (0)    10199 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/host/que.h
--rwxrwxrwx   0 root         (0) root         (0)     6547 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/host/str.h
--rwxrwxrwx   0 root         (0) root         (0)    12556 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/host/vec.h
--rwxrwxrwx   0 root         (0) root         (0)    12989 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/host/vector.h
--rwxrwxrwx   0 root         (0) root         (0)    13886 2022-11-06 19:16:03.000000 liba-0.1.1rc4/include/a/list.h
--rwxrwxrwx   0 root         (0) root         (0)     5344 2022-11-26 11:24:13.000000 liba-0.1.1rc4/include/a/math.h
--rwxrwxrwx   0 root         (0) root         (0)     3262 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/mf.h
--rwxrwxrwx   0 root         (0) root         (0)   111672 2022-11-27 12:35:20.000000 liba-0.1.1rc4/include/a/notefreqs.h
--rwxrwxrwx   0 root         (0) root         (0)     3195 2022-10-20 10:09:01.000000 liba-0.1.1rc4/include/a/oop.h
--rwxrwxrwx   0 root         (0) root         (0)     2339 2022-10-20 10:09:01.000000 liba-0.1.1rc4/include/a/operator.h
--rwxrwxrwx   0 root         (0) root         (0)     9162 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/pid.h
--rwxrwxrwx   0 root         (0) root         (0)     1357 2022-10-20 10:09:01.000000 liba-0.1.1rc4/include/a/poly.h
--rwxrwxrwx   0 root         (0) root         (0)    16439 2022-10-20 10:09:01.000000 liba-0.1.1rc4/include/a/polytrack.h
--rwxrwxrwx   0 root         (0) root         (0)     3483 2022-11-20 17:52:47.000000 liba-0.1.1rc4/include/a/real.h
--rwxrwxrwx   0 root         (0) root         (0)     6834 2022-10-21 05:38:14.000000 liba-0.1.1rc4/include/a/slist.h
--rwxrwxrwx   0 root         (0) root         (0)     2304 2022-10-20 10:09:01.000000 liba-0.1.1rc4/include/a/tf.h
--rwxrwxrwx   0 root         (0) root         (0)     2290 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/version.h
--rwxrwxrwx   0 root         (0) root         (0)     1792 2022-11-10 09:35:11.000000 liba-0.1.1rc4/include/a/version.hpp
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.769370 liba-0.1.1rc4/liba.egg-info/
--rwxrwxrwx   0 root         (0) root         (0)     5141 2022-11-29 08:14:30.000000 liba-0.1.1rc4/liba.egg-info/PKG-INFO
--rwxrwxrwx   0 root         (0) root         (0)     1551 2022-11-29 08:14:30.000000 liba-0.1.1rc4/liba.egg-info/SOURCES.txt
--rwxrwxrwx   0 root         (0) root         (0)        1 2022-11-29 08:14:30.000000 liba-0.1.1rc4/liba.egg-info/dependency_links.txt
--rwxrwxrwx   0 root         (0) root         (0)        5 2022-11-29 08:14:30.000000 liba-0.1.1rc4/liba.egg-info/top_level.txt
--rwxrwxrwx   0 root         (0) root         (0)       60 2022-10-20 10:09:01.000000 liba-0.1.1rc4/pyproject.toml
--rwxrwxrwx   0 root         (0) root         (0)      567 2022-11-29 08:14:30.794347 liba-0.1.1rc4/setup.cfg
--rwxrwxrwx   0 root         (0) root         (0)     6102 2022-11-29 08:12:34.000000 liba-0.1.1rc4/setup.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.791244 liba-0.1.1rc4/src/
--rwxrwxrwx   0 root         (0) root         (0)     4485 2022-11-20 17:52:47.000000 liba-0.1.1rc4/src/arr.c
--rwxrwxrwx   0 root         (0) root         (0)    21963 2022-11-27 12:43:12.000000 liba-0.1.1rc4/src/complex.c
--rwxrwxrwx   0 root         (0) root         (0)      648 2022-11-27 12:42:42.000000 liba-0.1.1rc4/src/complex.h
--rwxrwxrwx   0 root         (0) root         (0)     5371 2022-11-10 09:35:11.000000 liba-0.1.1rc4/src/crc.c
--rwxrwxrwx   0 root         (0) root         (0)     7730 2022-11-27 12:30:42.000000 liba-0.1.1rc4/src/fpid.c
--rwxrwxrwx   0 root         (0) root         (0)      467 2022-11-27 12:18:10.000000 liba-0.1.1rc4/src/fpid.h
--rwxrwxrwx   0 root         (0) root         (0)     7855 2022-10-20 10:09:01.000000 liba-0.1.1rc4/src/fpid.rs
--rwxrwxrwx   0 root         (0) root         (0)      757 2022-11-26 11:24:13.000000 liba-0.1.1rc4/src/fuzzy.c
-drwxrwxrwx   0 root         (0) root         (0)        0 2022-11-29 08:14:30.793200 liba-0.1.1rc4/src/host/
--rwxrwxrwx   0 root         (0) root         (0)     9051 2022-11-20 17:52:47.000000 liba-0.1.1rc4/src/host/que.c
--rwxrwxrwx   0 root         (0) root         (0)     4948 2022-11-26 11:24:13.000000 liba-0.1.1rc4/src/host/str.c
--rwxrwxrwx   0 root         (0) root         (0)     6540 2022-11-20 17:52:47.000000 liba-0.1.1rc4/src/host/vec.c
--rwxrwxrwx   0 root         (0) root         (0)     7874 2022-11-20 17:52:47.000000 liba-0.1.1rc4/src/host/vector.c
--rwxrwxrwx   0 root         (0) root         (0)      134 2022-11-27 12:25:43.000000 liba-0.1.1rc4/src/inline.h
--rwxrwxrwx   0 root         (0) root         (0)       49 2022-11-27 12:26:02.000000 liba-0.1.1rc4/src/intern.h
--rwxrwxrwx   0 root         (0) root         (0)      745 2022-11-27 12:29:16.000000 liba-0.1.1rc4/src/lib.c
--rwxrwxrwx   0 root         (0) root         (0)     1881 2022-10-20 10:09:01.000000 liba-0.1.1rc4/src/lib.rs
--rwxrwxrwx   0 root         (0) root         (0)     4129 2022-11-26 11:24:13.000000 liba-0.1.1rc4/src/math.c
--rwxrwxrwx   0 root         (0) root         (0)      248 2022-11-26 11:24:13.000000 liba-0.1.1rc4/src/math.h
--rwxrwxrwx   0 root         (0) root         (0)     2191 2022-11-26 11:24:13.000000 liba-0.1.1rc4/src/mf.c
--rwxrwxrwx   0 root         (0) root         (0)     2204 2022-10-20 10:09:01.000000 liba-0.1.1rc4/src/mf.rs
--rwxrwxrwx   0 root         (0) root         (0)     5168 2022-11-27 12:28:07.000000 liba-0.1.1rc4/src/pid.c
--rwxrwxrwx   0 root         (0) root         (0)      441 2022-10-21 05:38:14.000000 liba-0.1.1rc4/src/pid.h
--rwxrwxrwx   0 root         (0) root         (0)     6078 2022-10-20 10:09:01.000000 liba-0.1.1rc4/src/pid.rs
--rwxrwxrwx   0 root         (0) root         (0)     1353 2022-11-20 17:52:47.000000 liba-0.1.1rc4/src/poly.c
--rwxrwxrwx   0 root         (0) root         (0)    10769 2022-11-20 17:52:47.000000 liba-0.1.1rc4/src/polytrack.c
--rwxrwxrwx   0 root         (0) root         (0)    12729 2022-10-20 10:09:01.000000 liba-0.1.1rc4/src/polytrack.rs
--rwxrwxrwx   0 root         (0) root         (0)      847 2022-11-26 11:24:13.000000 liba-0.1.1rc4/src/real.c
--rwxrwxrwx   0 root         (0) root         (0)     1340 2022-10-21 05:38:14.000000 liba-0.1.1rc4/src/tf.c
--rwxrwxrwx   0 root         (0) root         (0)     3221 2022-10-20 10:09:01.000000 liba-0.1.1rc4/src/tf.rs
--rwxrwxrwx   0 root         (0) root         (0)      100 2022-11-27 12:27:13.000000 liba-0.1.1rc4/src/version.c
--rwxrwxrwx   0 root         (0) root         (0)      110 2022-11-27 12:26:36.000000 liba-0.1.1rc4/src/version.cpp
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.572435 liba-0.1.1rc5/
+-rwxrwxrwx   0 root         (0) root         (0)       87 2023-05-06 04:29:13.000000 liba-0.1.1rc5/MANIFEST.in
+-rwxrwxrwx   0 root         (0) root         (0)     5665 2023-05-09 18:20:15.573433 liba-0.1.1rc5/PKG-INFO
+-rwxrwxrwx   0 root         (0) root         (0)     3770 2023-05-06 04:29:13.000000 liba-0.1.1rc5/README.md
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.484013 liba-0.1.1rc5/include/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.519277 liba-0.1.1rc5/include/a/
+-rwxrwxrwx   0 root         (0) root         (0)    40329 2023-05-07 19:41:55.000000 liba-0.1.1rc5/include/a/a.h
+-rwxrwxrwx   0 root         (0) root         (0)     9641 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/avl.h
+-rwxrwxrwx   0 root         (0) root         (0)    11297 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/buf.h
+-rwxrwxrwx   0 root         (0) root         (0)    12712 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/complex.h
+-rwxrwxrwx   0 root         (0) root         (0)     1949 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/crc.h
+-rwxrwxrwx   0 root         (0) root         (0)    10250 2023-05-08 07:14:56.000000 liba-0.1.1rc5/include/a/fpid.h
+-rwxrwxrwx   0 root         (0) root         (0)     1416 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/fuzzy.h
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.524906 liba-0.1.1rc5/include/a/host/
+-rwxrwxrwx   0 root         (0) root         (0)      731 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/host/a.h
+-rwxrwxrwx   0 root         (0) root         (0)    10149 2023-05-07 16:15:03.000000 liba-0.1.1rc5/include/a/host/que.h
+-rwxrwxrwx   0 root         (0) root         (0)     8826 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/host/str.h
+-rwxrwxrwx   0 root         (0) root         (0)    13105 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/host/vec.h
+-rwxrwxrwx   0 root         (0) root         (0)    13539 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/host/vector.h
+-rwxrwxrwx   0 root         (0) root         (0)    14260 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/list.h
+-rwxrwxrwx   0 root         (0) root         (0)     5324 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/math.h
+-rwxrwxrwx   0 root         (0) root         (0)     3350 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/mf.h
+-rwxrwxrwx   0 root         (0) root         (0)   111610 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/notefreqs.h
+-rwxrwxrwx   0 root         (0) root         (0)     3133 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/oop.h
+-rwxrwxrwx   0 root         (0) root         (0)     2277 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/operator.h
+-rwxrwxrwx   0 root         (0) root         (0)     9574 2023-05-08 06:38:14.000000 liba-0.1.1rc5/include/a/pid.h
+-rwxrwxrwx   0 root         (0) root         (0)     1295 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/poly.h
+-rwxrwxrwx   0 root         (0) root         (0)    16402 2023-05-08 10:18:52.000000 liba-0.1.1rc5/include/a/polytrack.h
+-rwxrwxrwx   0 root         (0) root         (0)     9917 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/rbt.h
+-rwxrwxrwx   0 root         (0) root         (0)     3499 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/real.h
+-rwxrwxrwx   0 root         (0) root         (0)     7095 2023-05-07 15:31:27.000000 liba-0.1.1rc5/include/a/slist.h
+-rwxrwxrwx   0 root         (0) root         (0)     2244 2023-05-09 10:41:29.000000 liba-0.1.1rc5/include/a/tf.h
+-rwxrwxrwx   0 root         (0) root         (0)     1552 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/utf.h
+-rwxrwxrwx   0 root         (0) root         (0)     7698 2023-05-06 04:29:13.000000 liba-0.1.1rc5/include/a/version.h
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.530475 liba-0.1.1rc5/liba.egg-info/
+-rwxrwxrwx   0 root         (0) root         (0)     5665 2023-05-09 18:20:15.000000 liba-0.1.1rc5/liba.egg-info/PKG-INFO
+-rwxrwxrwx   0 root         (0) root         (0)     1405 2023-05-09 18:20:15.000000 liba-0.1.1rc5/liba.egg-info/SOURCES.txt
+-rwxrwxrwx   0 root         (0) root         (0)        1 2023-05-09 18:20:15.000000 liba-0.1.1rc5/liba.egg-info/dependency_links.txt
+-rwxrwxrwx   0 root         (0) root         (0)        5 2023-05-09 18:20:15.000000 liba-0.1.1rc5/liba.egg-info/top_level.txt
+-rwxrwxrwx   0 root         (0) root         (0)       92 2023-05-06 04:29:13.000000 liba-0.1.1rc5/pyproject.toml
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.486369 liba-0.1.1rc5/python/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.532884 liba-0.1.1rc5/python/src/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.551687 liba-0.1.1rc5/python/src/a/
+-rwxrwxrwx   0 root         (0) root         (0)     1393 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/__init__.pxd
+-rwxrwxrwx   0 root         (0) root         (0)       20 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/__init__.pxi
+-rwxrwxrwx   0 root         (0) root         (0)     1457 2023-05-07 22:37:50.000000 liba-0.1.1rc5/python/src/a/fpid.pxd
+-rwxrwxrwx   0 root         (0) root         (0)     4988 2023-05-08 10:34:17.000000 liba-0.1.1rc5/python/src/a/fpid.pxi
+-rwxrwxrwx   0 root         (0) root         (0)      117 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/math.pxd
+-rwxrwxrwx   0 root         (0) root         (0)      544 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/math.pxi
+-rwxrwxrwx   0 root         (0) root         (0)      651 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/mf.pxd
+-rwxrwxrwx   0 root         (0) root         (0)     2427 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/mf.pxi
+-rwxrwxrwx   0 root         (0) root         (0)     1602 2023-05-08 06:55:51.000000 liba-0.1.1rc5/python/src/a/pid.pxd
+-rwxrwxrwx   0 root         (0) root         (0)     3032 2023-05-08 10:34:25.000000 liba-0.1.1rc5/python/src/a/pid.pxi
+-rwxrwxrwx   0 root         (0) root         (0)      449 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/poly.pxd
+-rwxrwxrwx   0 root         (0) root         (0)      710 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/poly.pxi
+-rwxrwxrwx   0 root         (0) root         (0)     2798 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/polytrack.pxd
+-rwxrwxrwx   0 root         (0) root         (0)    11291 2023-05-07 16:37:07.000000 liba-0.1.1rc5/python/src/a/polytrack.pxi
+-rwxrwxrwx   0 root         (0) root         (0)      504 2023-05-09 10:41:29.000000 liba-0.1.1rc5/python/src/a/tf.pxd
+-rwxrwxrwx   0 root         (0) root         (0)     1297 2023-05-09 10:41:29.000000 liba-0.1.1rc5/python/src/a/tf.pxi
+-rwxrwxrwx   0 root         (0) root         (0)      168 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/version.pxd
+-rwxrwxrwx   0 root         (0) root         (0)      481 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a/version.pxi
+-rwxrwxrwx   0 root         (0) root         (0)  1287495 2023-05-09 18:20:10.000000 liba-0.1.1rc5/python/src/a.c
+-rwxrwxrwx   0 root         (0) root         (0)      494 2023-05-06 04:29:13.000000 liba-0.1.1rc5/python/src/a.pyx
+-rwxrwxrwx   0 root         (0) root         (0)      567 2023-05-09 18:20:15.573433 liba-0.1.1rc5/setup.cfg
+-rwxrwxrwx   0 root         (0) root         (0)     6135 2023-05-06 04:29:13.000000 liba-0.1.1rc5/setup.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.567449 liba-0.1.1rc5/src/
+-rwxrwxrwx   0 root         (0) root         (0)     1672 2023-05-06 10:11:24.000000 liba-0.1.1rc5/src/a.c
+-rwxrwxrwx   0 root         (0) root         (0)    25528 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/avl.c
+-rwxrwxrwx   0 root         (0) root         (0)     4688 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/buf.c
+-rwxrwxrwx   0 root         (0) root         (0)    23728 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/complex.c
+-rwxrwxrwx   0 root         (0) root         (0)      648 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/complex.h
+-rwxrwxrwx   0 root         (0) root         (0)     5503 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/crc.c
+-rwxrwxrwx   0 root         (0) root         (0)     7137 2023-05-09 10:41:29.000000 liba-0.1.1rc5/src/fpid.c
+-rwxrwxrwx   0 root         (0) root         (0)      504 2023-05-07 19:03:08.000000 liba-0.1.1rc5/src/fpid.h
+-rwxrwxrwx   0 root         (0) root         (0)      811 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/fuzzy.c
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-09 18:20:15.572435 liba-0.1.1rc5/src/host/
+-rwxrwxrwx   0 root         (0) root         (0)      551 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/host/a.c
+-rwxrwxrwx   0 root         (0) root         (0)     9439 2023-05-07 16:12:39.000000 liba-0.1.1rc5/src/host/que.c
+-rwxrwxrwx   0 root         (0) root         (0)     5684 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/host/str.c
+-rwxrwxrwx   0 root         (0) root         (0)     6897 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/host/vec.c
+-rwxrwxrwx   0 root         (0) root         (0)     8277 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/host/vector.c
+-rwxrwxrwx   0 root         (0) root         (0)     4776 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/math.c
+-rwxrwxrwx   0 root         (0) root         (0)      257 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/math.h
+-rwxrwxrwx   0 root         (0) root         (0)     2329 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/mf.c
+-rwxrwxrwx   0 root         (0) root         (0)     5585 2023-05-08 06:53:04.000000 liba-0.1.1rc5/src/pid.c
+-rwxrwxrwx   0 root         (0) root         (0)      441 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/pid.h
+-rwxrwxrwx   0 root         (0) root         (0)     1407 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/poly.c
+-rwxrwxrwx   0 root         (0) root         (0)    11249 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/polytrack.c
+-rwxrwxrwx   0 root         (0) root         (0)    24524 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/rbt.c
+-rwxrwxrwx   0 root         (0) root         (0)      877 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/real.c
+-rwxrwxrwx   0 root         (0) root         (0)     1432 2023-05-09 10:41:29.000000 liba-0.1.1rc5/src/tf.c
+-rwxrwxrwx   0 root         (0) root         (0)     2887 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/utf.c
+-rwxrwxrwx   0 root         (0) root         (0)     1213 2023-05-06 04:29:13.000000 liba-0.1.1rc5/src/version.c
```

### Comparing `liba-0.1.1rc4/PKG-INFO` & `liba-0.1.1rc5/PKG-INFO`

 * *Files 7% similar despite different names*

```diff
@@ -1,64 +1,81 @@
 Metadata-Version: 2.1
 Name: liba
-Version: 0.1.1rc4
+Version: 0.1.1rc5
 Summary: An algorithm library based on C/C++ language
 Home-page: https://github.com/tqfx/liba.git
 Author: tqfx
 Author-email: tqfx@foxmail.com
 License: MPL-2.0
 Description: # An algorithm library {#mainpage}
         
+        [![docs](https://github.com/tqfx/liba/actions/workflows/docs.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/docs.yml)
         [![conan](https://github.com/tqfx/liba/actions/workflows/conan.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/conan.yml)
         [![xmake](https://github.com/tqfx/liba/actions/workflows/xmake.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/xmake.yml)
+        [![meson](https://github.com/tqfx/liba/actions/workflows/meson.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/meson.yml)
         [![msvc](https://github.com/tqfx/liba/actions/workflows/msvc.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/msvc.yml)
         [![linux](https://github.com/tqfx/liba/actions/workflows/linux.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/linux.yml)
         [![macos](https://github.com/tqfx/liba/actions/workflows/macos.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/macos.yml)
         [![mingw](https://github.com/tqfx/liba/actions/workflows/mingw.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/mingw.yml)
         [![msys2](https://github.com/tqfx/liba/actions/workflows/msys2.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/msys2.yml)
         [![freebsd](https://github.com/tqfx/liba/actions/workflows/freebsd.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/freebsd.yml)
-        [![doxygen](https://github.com/tqfx/liba/actions/workflows/doxygen.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/doxygen.yml)
+        
+        ## documentation
+        
+        - [C/C++](https://tqfx.org/liba/)
+        - [Lua](https://tqfx.org/liba/lua/)
+        - [Java](https://tqfx.org/liba/java/)
+        - [Rust](https://tqfx.org/liba/rust/liba/)
         
         ## required tools
         
-        - C/C++ compiler: [gnu](https://gcc.gnu.org) or [llvm](https://clang.llvm.org) or [msvc](https://visualstudio.microsoft.com/visual-cpp-build-tools) etc
+        - C/C++ compiler: [tcc](https://bellard.org/tcc) or [gnu](https://gcc.gnu.org) or [llvm](https://clang.llvm.org) or [msvc](https://visualstudio.microsoft.com/visual-cpp-build-tools) etc
         
         ## optional tools
         
         - [lua](https://www.lua.org)
         - [java](https://www.oracle.com/java)
         - [rust](https://www.rust-lang.org)
+        - [emsdk](https://emscripten.org)
         - [xmake](https://xmake.io)
         - [cmake](https://cmake.org)
         - [conan](https://conan.io)
         - [vcpkg](https://vcpkg.io)
+        - [meson](https://mesonbuild.com)
         - [python](https://www.python.org)
         
         ## build
         
         ### xmake
         
         ```bash
-        xmake f -m release
-        xmake --build --all
-        xmake install --all
+        xmake f
+        xmake
+        xmake i
         ```
         
         ### cmake
         
         ```bash
         cmake -S . -B build
         cmake --build build
         cmake --install build
         ```
         
+        ### meson
+        
+        ```bash
+        meson setup builddir
+        meson install -C builddir
+        ```
+        
         ### vcpkg
         
         ```bash
-        cmake -S . -B build -DENABLE_VCPKG=ON
+        cmake -S . -B build -DLIBA_VCPKG=1
         ```
         
         ```bash
         cp -r build/vcpkg/* $VCPKG_INSTALLATION_ROOT
         ```
         
         ```pwsh
@@ -79,59 +96,53 @@
         
         ### cython
         
         ```bash
         python setup.py build_ext --inplace
         ```
         
-        ### wheel
-        
-        ```bash
-        python setup.py bdist_wheel
-        ```
-        
         ## usage
         
         ### C/C++
         
         #### xmake.lua
         
         ```lua
         add_requires("a")
         ```
         
         ### CMakeLists.txt
         
         ```cmake
         find_package(liba CONFIG REQUIRED)
-        target_link_libraries(<TARGET> PRIVATE liba::a)
+        target_link_libraries(<TARGET> PRIVATE alib) # static
+        target_link_libraries(<TARGET> PRIVATE liba) # shared
         ```
         
         #### conanfile.txt
         
         ```txt
         [requires]
         liba/[~0.1]
         ```
         
         ### Lua
         
         ```lua
-        local a = require("liba")
-        print("version", a.version())
+        local liba = require("liba")
+        print("version", liba.version())
         ```
         
         ### Java
         
         ```java
-        import liba.a;
         public class test {
             public static void main(String[] args) {
-                a.init();
-                System.out.println("version " + a.version());
+                liba.init();
+                System.out.println("version " + liba.version());
             }
         }
         ```
         
         ### Rust
         
         #### Cargo.toml
```

### Comparing `liba-0.1.1rc4/README.md` & `liba-0.1.1rc5/README.md`

 * *Files 6% similar despite different names*

```diff
@@ -1,56 +1,73 @@
 # An algorithm library {#mainpage}
 
+[![docs](https://github.com/tqfx/liba/actions/workflows/docs.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/docs.yml)
 [![conan](https://github.com/tqfx/liba/actions/workflows/conan.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/conan.yml)
 [![xmake](https://github.com/tqfx/liba/actions/workflows/xmake.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/xmake.yml)
+[![meson](https://github.com/tqfx/liba/actions/workflows/meson.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/meson.yml)
 [![msvc](https://github.com/tqfx/liba/actions/workflows/msvc.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/msvc.yml)
 [![linux](https://github.com/tqfx/liba/actions/workflows/linux.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/linux.yml)
 [![macos](https://github.com/tqfx/liba/actions/workflows/macos.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/macos.yml)
 [![mingw](https://github.com/tqfx/liba/actions/workflows/mingw.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/mingw.yml)
 [![msys2](https://github.com/tqfx/liba/actions/workflows/msys2.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/msys2.yml)
 [![freebsd](https://github.com/tqfx/liba/actions/workflows/freebsd.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/freebsd.yml)
-[![doxygen](https://github.com/tqfx/liba/actions/workflows/doxygen.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/doxygen.yml)
+
+## documentation
+
+- [C/C++](https://tqfx.org/liba/)
+- [Lua](https://tqfx.org/liba/lua/)
+- [Java](https://tqfx.org/liba/java/)
+- [Rust](https://tqfx.org/liba/rust/liba/)
 
 ## required tools
 
-- C/C++ compiler: [gnu](https://gcc.gnu.org) or [llvm](https://clang.llvm.org) or [msvc](https://visualstudio.microsoft.com/visual-cpp-build-tools) etc
+- C/C++ compiler: [tcc](https://bellard.org/tcc) or [gnu](https://gcc.gnu.org) or [llvm](https://clang.llvm.org) or [msvc](https://visualstudio.microsoft.com/visual-cpp-build-tools) etc
 
 ## optional tools
 
 - [lua](https://www.lua.org)
 - [java](https://www.oracle.com/java)
 - [rust](https://www.rust-lang.org)
+- [emsdk](https://emscripten.org)
 - [xmake](https://xmake.io)
 - [cmake](https://cmake.org)
 - [conan](https://conan.io)
 - [vcpkg](https://vcpkg.io)
+- [meson](https://mesonbuild.com)
 - [python](https://www.python.org)
 
 ## build
 
 ### xmake
 
 ```bash
-xmake f -m release
-xmake --build --all
-xmake install --all
+xmake f
+xmake
+xmake i
 ```
 
 ### cmake
 
 ```bash
 cmake -S . -B build
 cmake --build build
 cmake --install build
 ```
 
+### meson
+
+```bash
+meson setup builddir
+meson install -C builddir
+```
+
 ### vcpkg
 
 ```bash
-cmake -S . -B build -DENABLE_VCPKG=ON
+cmake -S . -B build -DLIBA_VCPKG=1
 ```
 
 ```bash
 cp -r build/vcpkg/* $VCPKG_INSTALLATION_ROOT
 ```
 
 ```pwsh
@@ -71,59 +88,53 @@
 
 ### cython
 
 ```bash
 python setup.py build_ext --inplace
 ```
 
-### wheel
-
-```bash
-python setup.py bdist_wheel
-```
-
 ## usage
 
 ### C/C++
 
 #### xmake.lua
 
 ```lua
 add_requires("a")
 ```
 
 ### CMakeLists.txt
 
 ```cmake
 find_package(liba CONFIG REQUIRED)
-target_link_libraries(<TARGET> PRIVATE liba::a)
+target_link_libraries(<TARGET> PRIVATE alib) # static
+target_link_libraries(<TARGET> PRIVATE liba) # shared
 ```
 
 #### conanfile.txt
 
 ```txt
 [requires]
 liba/[~0.1]
 ```
 
 ### Lua
 
 ```lua
-local a = require("liba")
-print("version", a.version())
+local liba = require("liba")
+print("version", liba.version())
 ```
 
 ### Java
 
 ```java
-import liba.a;
 public class test {
     public static void main(String[] args) {
-        a.init();
-        System.out.println("version " + a.version());
+        liba.init();
+        System.out.println("version " + liba.version());
     }
 }
 ```
 
 ### Rust
 
 #### Cargo.toml
```

### Comparing `liba-0.1.1rc4/ffi/python/src/a/__init__.pxd` & `liba-0.1.1rc5/python/src/a/__init__.pxd`

 * *Files 1% similar despite different names*

```diff
@@ -33,17 +33,17 @@
 
     ctypedef          int  a_int_t
     ctypedef unsigned int a_uint_t
 
     ctypedef unsigned char a_byte_t
     ctypedef          char a_char_t
 
-    ctypedef       char * a_str_t
+    ctypedef char       * a_str_t
     ctypedef const char *a_cstr_t
-    ctypedef       void *a_vptr_t
+    ctypedef void       *a_vptr_t
     ctypedef const void *a_cptr_t
 
     ctypedef  float a_f32_t
     ctypedef double a_f64_t
     IF A_SIZE_REAL == 8:
         ctypedef double a_real_t
     IF A_SIZE_REAL == 4:
```

### Comparing `liba-0.1.1rc4/ffi/python/src/a/fpid.pxd` & `liba-0.1.1rc5/python/src/a/fpid.pxd`

 * *Files 19% similar despite different names*

```diff
@@ -1,29 +1,27 @@
 from a.pid cimport *
 
 cdef extern from "a/fpid.h":
     ctypedef struct a_fpid_s:
-        a_pid_s pid[1]
+        a_pid_s pid
         a_real_t kp
         a_real_t ki
         a_real_t kd
     a_size_t A_FPID_BUF1(a_uint_t max)
     a_fpid_s *a_fpid_off(a_fpid_s *ctx)
     a_fpid_s *a_fpid_inc(a_fpid_s *ctx)
     a_fpid_s *a_fpid_pos(a_fpid_s *ctx, a_real_t max)
-    a_fpid_s *a_fpid_ilim(a_fpid_s *ctx, a_real_t min, a_real_t max)
-    a_fpid_s *a_fpid_olim(a_fpid_s *ctx, a_real_t min, a_real_t max)
     a_fpid_s *a_fpid_buf1(a_fpid_s *ctx, a_vptr_t ptr, a_size_t max)
     a_fpid_s *a_fpid_kpid(a_fpid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd)
     a_fpid_s *a_fpid_buff(a_fpid_s *ctx, a_uint_t *idx, a_real_t *mms, a_real_t *mat)
     a_fpid_s *a_fpid_setv(a_fpid_s *ctx, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e)
-    a_fpid_s *a_fpid_base(a_fpid_s *ctx, a_uint_t num, const a_real_t *mmp, const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd)
-    a_fpid_s *a_fpid_init(a_fpid_s *ctx, a_real_t dt, a_uint_t num, const a_real_t *mmp,
-                          const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd,
-                          a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax)
+    a_fpid_s *a_fpid_base(a_fpid_s *ctx, a_uint_t col, const a_real_t *mec, const a_real_t *mec,
+                          const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd)
+    a_fpid_s *a_fpid_init(a_fpid_s *ctx, a_real_t dt, a_uint_t col, const a_real_t *mec, const a_real_t *mec,
+                          const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd, a_real_t min, a_real_t max)
     a_real_t *a_fpid_outp(a_fpid_s *ctx, a_real_t *set, a_real_t *fdb)
     a_real_t a_fpid_outv(a_fpid_s *ctx, a_real_t set, a_real_t fdb)
     a_fpid_s *a_fpid_exit(a_fpid_s *ctx)
     a_fpid_s *a_fpid_zero(a_fpid_s *ctx)
     a_uint_t a_fpid_bufnum(const a_fpid_s *ctx)
     a_vptr_t a_fpid_bufptr(const a_fpid_s *ctx)
     a_uint_t a_fpid_col(const a_fpid_s *ctx)
```

### Comparing `liba-0.1.1rc4/ffi/python/src/a/fpid.pxi` & `liba-0.1.1rc5/python/src/a/fpid.pxi`

 * *Files 8% similar despite different names*

```diff
@@ -1,81 +1,78 @@
 from a cimport *
 from a.fpid cimport *
 
 @cython.wraparound(False)
 @cython.boundscheck(False)
 cdef class fpid:
     '''fuzzy proportional integral derivative controller'''
-    cdef a_fpid_s ctx[1]
+    cdef a_fpid_s ctx
     cdef a_vptr_t ptr
-    cdef array mmp
+    cdef array me
+    cdef array mec
     cdef array mkp
     cdef array mki
     cdef array mkd
-    def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):
-        self.mmp = reals((i for j in mmp for i in j))
+    def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):
+        self.me = reals((i for j in me for i in j))
+        self.mec = reals((i for j in mec for i in j))
         self.mkp = reals((i for j in mkp for i in j))
         self.mki = reals((i for j in mki for i in j))
         self.mkd = reals((i for j in mkd for i in j))
-        cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+        cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+        cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
-        a_fpid_init(self.ctx, dt, <a_uint_t>len(mkp), mp, kp, ki, kd, imin, imax, omin, omax)
+        a_fpid_init(&self.ctx, dt, <a_uint_t>len(mkp), e, ec, kp, ki, kd, min, max)
         if sum:
-            a_fpid_pos(self.ctx, sum)
+            a_fpid_pos(&self.ctx, sum)
         else:
-            a_fpid_inc(self.ctx)
+            a_fpid_inc(&self.ctx)
         self.buf = num
     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:
-        '''process function for fuzzy PID controller'''
-        return a_fpid_outv(self.ctx, set, fdb)
+        '''calculate function for fuzzy PID controller'''
+        return a_fpid_outv(&self.ctx, set, fdb)
     def __dealloc__(self):
         '''terminate function for fuzzy PID controller'''
-        a_fpid_exit(self.ctx)
+        a_fpid_exit(&self.ctx)
         PyMem_Free(self.ptr)
     def zero(self):
         '''zero function for fuzzy PID controller'''
-        a_fpid_zero(self.ctx)
+        a_fpid_zero(&self.ctx)
         return self
-    def base(self, mmp, mkp, mki, mkd):
+    def base(self, me, mec, mkp, mki, mkd):
         '''set rule base for fuzzy PID controller'''
-        self.mmp = reals((i for j in mmp for i in j))
+        self.me = reals((i for j in me for i in j))
+        self.mec = reals((i for j in mec for i in j))
         self.mkp = reals((i for j in mkp for i in j))
         self.mki = reals((i for j in mki for i in j))
         self.mkd = reals((i for j in mkd for i in j))
-        cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+        cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+        cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
-        a_fpid_base(self.ctx, <a_uint_t>len(mkp), mp, kp, ki, kd)
+        a_fpid_base(&self.ctx, <a_uint_t>len(mkp), e, ec, kp, ki, kd)
         return self
     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
         '''set proportional integral derivative constant for fuzzy PID controller'''
-        a_fpid_kpid(self.ctx, kp, ki, kd)
-        return self
-    def olim(self, min: a_real_t, max: a_real_t):
-        '''set output extreme value for fuzzy PID controller'''
-        a_fpid_olim(self.ctx, min, max)
-        return self
-    def ilim(self, min: a_real_t, max: a_real_t):
-        '''set input extreme value for fuzzy PID controller'''
-        a_fpid_ilim(self.ctx, min, max)
+        a_fpid_kpid(&self.ctx, kp, ki, kd)
         return self
     def pos(self, max: a_real_t):
         '''positional fuzzy PID controller'''
-        a_fpid_pos(self.ctx, max)
+        a_fpid_pos(&self.ctx, max)
         return self
     def inc(self):
         '''incremental fuzzy PID controller'''
-        a_fpid_inc(self.ctx)
+        a_fpid_inc(&self.ctx)
         return self
     def off(self):
         '''turn off fuzzy PID controller'''
-        a_fpid_off(self.ctx)
+        a_fpid_off(&self.ctx)
         return self
 
     @property
     def outmin(self) -> a_real_t:
         return self.ctx.pid.outmin
     @outmin.setter
     def outmin(self, outmin: a_real_t):
@@ -93,25 +90,25 @@
         return self.ctx.pid.summax
     @summax.setter
     def summax(self, summax: a_real_t):
         self.ctx.pid.summax = summax
 
     @property
     def mode(self) -> a_uint_t:
-        return a_pid_mode(self.ctx.pid)
+        return a_pid_mode(&self.ctx.pid)
     @mode.setter
     def mode(self, mode: a_uint_t):
-        a_pid_set_mode(self.ctx.pid, mode)
+        a_pid_set_mode(&self.ctx.pid, mode)
 
     @property
     def dt(self) -> a_real_t:
-        return a_pid_dt(self.ctx.pid)
+        return a_pid_dt(&self.ctx.pid)
     @dt.setter
     def dt(self, dt: a_real_t):
-        a_pid_set_dt(self.ctx.pid, dt)
+        a_pid_set_dt(&self.ctx.pid, dt)
 
     @property
     def kp(self) -> a_real_t:
         return self.ctx.kp
     @kp.setter
     def kp(self, kp: a_real_t):
         self.ctx.kp = kp
@@ -128,23 +125,23 @@
         return self.ctx.kd
     @kd.setter
     def kd(self, kd: a_real_t):
         self.ctx.kd = kd
 
     @property
     def buf(self) -> a_uint_t:
-        return a_fpid_bufnum(self.ctx)
+        return a_fpid_bufnum(&self.ctx)
     @buf.setter
     def buf(self, max: a_uint_t):
         self.ptr = PyMem_Realloc(self.ptr, A_FPID_BUF1(max))
-        a_fpid_buf1(self.ctx, self.ptr, max)
+        a_fpid_buf1(&self.ctx, self.ptr, max)
 
     @property
     def col(self) -> a_uint_t:
-        return a_fpid_col(self.ctx)
+        return a_fpid_col(&self.ctx)
     @property
     def out(self) -> a_real_t:
         return self.ctx.pid.out.v
     @property
     def fdb(self) -> a_real_t:
         return self.ctx.pid.fdb.v
     @property
```

### Comparing `liba-0.1.1rc4/ffi/python/src/a/mf.pxd` & `liba-0.1.1rc5/python/src/a/mf.pxd`

 * *Files identical despite different names*

### Comparing `liba-0.1.1rc4/ffi/python/src/a/mf.pxi` & `liba-0.1.1rc5/python/src/a/mf.pxi`

 * *Files identical despite different names*

### Comparing `liba-0.1.1rc4/ffi/python/src/a/pid.pxd` & `liba-0.1.1rc5/python/src/a/pid.pxd`

 * *Files 2% similar despite different names*

```diff
@@ -13,15 +13,15 @@
         a_real_u fdb
         a_real_u ec
         a_real_u e
     a_pid_s *a_pid_off(a_pid_s *ctx)
     a_pid_s *a_pid_inc(a_pid_s *ctx)
     a_pid_s *a_pid_pos(a_pid_s *ctx, a_real_t max)
     a_pid_s *a_pid_kpid(a_pid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd)
-    a_pid_s *a_pid_setv(a_pid_s *ctx, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e)
+    a_pid_s *a_pid_chan(a_pid_s *ctx, a_uint_t num, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e)
     a_pid_s *a_pid_init(a_pid_s *ctx, a_real_t dt, a_real_t min, a_real_t max)
     a_real_t *a_pid_outp(a_pid_s *ctx, a_real_t *set, a_real_t *fdb)
     a_real_t a_pid_outv(a_pid_s *ctx, a_real_t set, a_real_t fdb)
     a_pid_s *a_pid_exit(a_pid_s *ctx)
     a_pid_s *a_pid_zero(a_pid_s *ctx)
     a_void_t a_pid_set_dt(a_pid_s *ctx, a_real_t dt)
     a_real_t a_pid_dt(const a_pid_s *ctx)
```

### Comparing `liba-0.1.1rc4/ffi/python/src/a/pid.pxi` & `liba-0.1.1rc5/python/src/a/pid.pxi`

 * *Files 4% similar despite different names*

```diff
@@ -3,46 +3,46 @@
 @cython.wraparound(False)
 @cython.boundscheck(False)
 cdef class pid:
     '''proportional integral derivative controller'''
     OFF = A_PID_OFF
     POS = A_PID_POS
     INC = A_PID_INC
-    cdef a_pid_s ctx[1]
+    cdef a_pid_s ctx
     def __cinit__(self, a_real_t dt, a_real_t min, a_real_t max, a_real_t sum = 0):
-        a_pid_init(self.ctx, dt, min, max)
+        a_pid_init(&self.ctx, dt, min, max)
         if sum:
-            a_pid_pos(self.ctx, sum)
+            a_pid_pos(&self.ctx, sum)
         else:
-            a_pid_inc(self.ctx)
+            a_pid_inc(&self.ctx)
     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:
-        '''process function for PID controller'''
-        return a_pid_outv(self.ctx, set, fdb)
+        '''calculate function for PID controller'''
+        return a_pid_outv(&self.ctx, set, fdb)
     def __dealloc__(self):
         '''terminate function for PID controller'''
-        a_pid_exit(self.ctx)
+        a_pid_exit(&self.ctx)
     def zero(self):
         '''zero function for PID controller'''
-        a_pid_zero(self.ctx)
+        a_pid_zero(&self.ctx)
         return self
     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
         '''set proportional integral derivative constant for PID controller'''
-        a_pid_kpid(self.ctx, kp, ki, kd)
+        a_pid_kpid(&self.ctx, kp, ki, kd)
         return self
     def pos(self, max: a_real_t):
         '''positional PID controller'''
-        a_pid_pos(self.ctx, max)
+        a_pid_pos(&self.ctx, max)
         return self
     def inc(self):
         '''incremental PID controller'''
-        a_pid_inc(self.ctx)
+        a_pid_inc(&self.ctx)
         return self
     def off(self):
         '''turn off PID controller'''
-        a_pid_off(self.ctx)
+        a_pid_off(&self.ctx)
         return self
 
     @property
     def outmin(self) -> a_real_t:
         return self.ctx.outmin
     @outmin.setter
     def outmin(self, outmin: a_real_t):
@@ -60,46 +60,46 @@
         return self.ctx.summax
     @summax.setter
     def summax(self, summax: a_real_t):
         self.ctx.summax = summax
 
     @property
     def mode(self) -> a_uint_t:
-        return a_pid_mode(self.ctx)
+        return a_pid_mode(&self.ctx)
     @mode.setter
     def mode(self, mode: a_uint_t):
-        a_pid_set_mode(self.ctx, mode)
+        a_pid_set_mode(&self.ctx, mode)
 
     @property
     def dt(self) -> a_real_t:
-        return a_pid_dt(self.ctx)
+        return a_pid_dt(&self.ctx)
     @dt.setter
     def dt(self, dt: a_real_t):
-        a_pid_set_dt(self.ctx, dt)
+        a_pid_set_dt(&self.ctx, dt)
 
     @property
     def kp(self) -> a_real_t:
-        return a_pid_kp(self.ctx)
+        return a_pid_kp(&self.ctx)
     @kp.setter
     def kp(self, kp: a_real_t):
-        a_pid_set_kp(self.ctx, kp)
+        a_pid_set_kp(&self.ctx, kp)
 
     @property
     def ki(self) -> a_real_t:
-        return a_pid_ki(self.ctx)
+        return a_pid_ki(&self.ctx)
     @ki.setter
     def ki(self, ki: a_real_t):
-        a_pid_set_ki(self.ctx, ki)
+        a_pid_set_ki(&self.ctx, ki)
 
     @property
     def kd(self) -> a_real_t:
-        return a_pid_kd(self.ctx)
+        return a_pid_kd(&self.ctx)
     @kd.setter
     def kd(self, kd: a_real_t):
-        a_pid_set_kd(self.ctx, kd)
+        a_pid_set_kd(&self.ctx, kd)
 
     @property
     def out(self) -> a_real_t:
         return self.ctx.out.v
     @property
     def fdb(self) -> a_real_t:
         return self.ctx.fdb.v
```

### Comparing `liba-0.1.1rc4/ffi/python/src/a/poly.pxi` & `liba-0.1.1rc5/python/src/a/poly.pxi`

 * *Files identical despite different names*

### Comparing `liba-0.1.1rc4/ffi/python/src/a/polytrack.pxd` & `liba-0.1.1rc5/python/src/a/polytrack.pxd`

 * *Files identical despite different names*

### Comparing `liba-0.1.1rc4/ffi/python/src/a/polytrack.pxi` & `liba-0.1.1rc5/python/src/a/polytrack.pxi`

 * *Files 6% similar despite different names*

```diff
@@ -1,58 +1,58 @@
 from a.polytrack cimport *
 
 @cython.wraparound(False)
 @cython.boundscheck(False)
 cdef class polytrack3:
     '''cubic polynomial trajectory'''
-    cdef a_polytrack3_s ctx[1]
+    cdef a_polytrack3_s ctx
     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0):
-        a_polytrack3_init(self.ctx, t0, t1, q0, q1, v0, v1)
+        a_polytrack3_init(&self.ctx, t0, t1, q0, q1, v0, v1)
     def __call__(self, ts):
         '''calculate all'''
         cdef a_real_t out[3]
         if iterable(ts):
             p = reals(ts)
             v = reals(ts)
             a = reals(ts)
             for i, it in enumerate(ts):
-                a_polytrack3_out(self.ctx, it, out)
+                a_polytrack3_out(&self.ctx, it, out)
                 p[i] = out[0]
                 v[i] = out[1]
                 a[i] = out[2]
             return p, v, a
-        a_polytrack3_out(self.ctx, ts, out)
+        a_polytrack3_out(&self.ctx, ts, out)
         return out[0], out[1], out[2]
     def pos(self, ts):
         '''calculate position'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack3_pos(self.ctx, it)
+                out[i] = a_polytrack3_pos(&self.ctx, it)
             return out
-        return a_polytrack3_pos(self.ctx, ts)
+        return a_polytrack3_pos(&self.ctx, ts)
     def vec(self, ts):
         '''calculate velocity'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack3_vec(self.ctx, it)
+                out[i] = a_polytrack3_vec(&self.ctx, it)
             return out
-        return a_polytrack3_vec(self.ctx, ts)
+        return a_polytrack3_vec(&self.ctx, ts)
     def acc(self, ts):
         '''calculate acceleration'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack3_acc(self.ctx, it)
+                out[i] = a_polytrack3_acc(&self.ctx, it)
             return out
-        return a_polytrack3_acc(self.ctx, ts)
+        return a_polytrack3_acc(&self.ctx, ts)
     def gen(self):
         '''generation function'''
-        a_polytrack3_gen(self.ctx)
+        a_polytrack3_gen(&self.ctx)
 
     @property
     def k(self):
         return self.ctx.k
 
     @property
     def t(self):
@@ -120,59 +120,59 @@
     def v1(self, val: a_real_t):
         self.ctx.v[1] = val
 
 @cython.wraparound(False)
 @cython.boundscheck(False)
 cdef class polytrack5:
     '''quintic polynomial trajectory'''
-    cdef a_polytrack5_s ctx[1]
+    cdef a_polytrack5_s ctx
     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0):
-        a_polytrack5_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
+        a_polytrack5_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
     def __call__(self, ts):
         '''calculate all'''
         cdef a_real_t out[3]
         if iterable(ts):
             p = reals(ts)
             v = reals(ts)
             a = reals(ts)
             for i, it in enumerate(ts):
-                a_polytrack5_out(self.ctx, it, out)
+                a_polytrack5_out(&self.ctx, it, out)
                 p[i] = out[0]
                 v[i] = out[1]
                 a[i] = out[2]
             return p, v, a
-        a_polytrack5_out(self.ctx, ts, out)
+        a_polytrack5_out(&self.ctx, ts, out)
         return out[0], out[1], out[2]
     def pos(self, ts):
         '''calculate position'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack5_pos(self.ctx, it)
+                out[i] = a_polytrack5_pos(&self.ctx, it)
             return out
-        return a_polytrack5_pos(self.ctx, ts)
+        return a_polytrack5_pos(&self.ctx, ts)
     def vec(self, ts):
         '''calculate velocity'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack5_vec(self.ctx, it)
+                out[i] = a_polytrack5_vec(&self.ctx, it)
             return out
-        return a_polytrack5_vec(self.ctx, ts)
+        return a_polytrack5_vec(&self.ctx, ts)
     def acc(self, ts):
         '''calculate acceleration'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack5_acc(self.ctx, it)
+                out[i] = a_polytrack5_acc(&self.ctx, it)
             return out
-        return a_polytrack5_acc(self.ctx, ts)
+        return a_polytrack5_acc(&self.ctx, ts)
     def gen(self):
         '''generation function'''
-        a_polytrack5_gen(self.ctx)
+        a_polytrack5_gen(&self.ctx)
 
     @property
     def k(self):
         return self.ctx.k
 
     @property
     def t(self):
@@ -262,69 +262,69 @@
     def a1(self, val: a_real_t):
         self.ctx.a[1] = val
 
 @cython.wraparound(False)
 @cython.boundscheck(False)
 cdef class polytrack7:
     '''hepta polynomial trajectory'''
-    cdef a_polytrack7_s ctx[1]
+    cdef a_polytrack7_s ctx
     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0, a_real_t j0 = 0, a_real_t j1 = 0):
-        a_polytrack7_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
+        a_polytrack7_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
     def __call__(self, ts):
         '''calculate all'''
         cdef a_real_t out[4]
         if iterable(ts):
             p = reals(ts)
             v = reals(ts)
             a = reals(ts)
             j = reals(ts)
             for i, it in enumerate(ts):
-                a_polytrack7_out(self.ctx, it, out)
+                a_polytrack7_out(&self.ctx, it, out)
                 p[i] = out[0]
                 v[i] = out[1]
                 a[i] = out[2]
                 j[i] = out[3]
             return p, v, a, j
-        a_polytrack7_out(self.ctx, ts, out)
+        a_polytrack7_out(&self.ctx, ts, out)
         return out[0], out[1], out[2], out[3]
     def pos(self, ts):
         '''calculate position'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack7_pos(self.ctx, it)
+                out[i] = a_polytrack7_pos(&self.ctx, it)
             return out
-        return a_polytrack7_pos(self.ctx, ts)
+        return a_polytrack7_pos(&self.ctx, ts)
     def vec(self, ts):
         '''calculate velocity'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack7_vec(self.ctx, it)
+                out[i] = a_polytrack7_vec(&self.ctx, it)
             return out
-        return a_polytrack7_vec(self.ctx, ts)
+        return a_polytrack7_vec(&self.ctx, ts)
     def acc(self, ts):
         '''calculate acceleration'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack7_acc(self.ctx, it)
+                out[i] = a_polytrack7_acc(&self.ctx, it)
             return out
-        return a_polytrack7_acc(self.ctx, ts)
+        return a_polytrack7_acc(&self.ctx, ts)
     def jer(self, ts):
         '''calculate jerk'''
         if iterable(ts):
             out = reals(ts)
             for i, it in enumerate(ts):
-                out[i] = a_polytrack7_jer(self.ctx, it)
+                out[i] = a_polytrack7_jer(&self.ctx, it)
             return out
-        return a_polytrack7_jer(self.ctx, ts)
+        return a_polytrack7_jer(&self.ctx, ts)
     def gen(self):
         '''generation function'''
-        a_polytrack7_gen(self.ctx)
+        a_polytrack7_gen(&self.ctx)
 
     @property
     def k(self):
         return self.ctx.k
 
     @property
     def t(self):
```

### Comparing `liba-0.1.1rc4/ffi/python/src/a/tf.pxi` & `liba-0.1.1rc5/python/src/a/tf.pxi`

 * *Files 3% similar despite different names*

```diff
@@ -1,44 +1,44 @@
 from a.tf cimport *
 
 @cython.wraparound(False)
 @cython.boundscheck(False)
 cdef class tf:
     '''transfer function'''
-    cdef a_tf_s ctx[1]
+    cdef a_tf_s ctx
     cdef array _num
     cdef array _den
     cdef array _u
     cdef array _v
     def __cinit__(self, num, den):
         self.num = num
         self.den = den
     def __call__(self, x: a_real_t) -> a_real_t:
-        '''process function for transfer function'''
-        return a_tf_proc(self.ctx, x)
+        '''calculate function for transfer function'''
+        return a_tf_iter(&self.ctx, x)
     def __dealloc__(self):
         '''terminate function for transfer function'''
-        a_tf_exit(self.ctx)
+        a_tf_exit(&self.ctx)
     def zero(self):
         '''zero function for transfer function'''
-        a_tf_zero(self.ctx)
+        a_tf_zero(&self.ctx)
         return self
 
     @property
     def num(self):
         return self._num
     @num.setter
     def num(self, num):
         cdef a_uint_t m = <a_uint_t>len(num)
         self._num = reals(num)
         self._u = reals(num)
-        a_tf_set_num(self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)
+        a_tf_set_num(&self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)
 
     @property
     def den(self):
         return self._den
     @den.setter
     def den(self, den):
         cdef a_uint_t n = <a_uint_t>len(den)
         self._den = reals(den)
         self._v = reals(den)
-        a_tf_set_den(self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)
+        a_tf_set_den(&self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)
```

### Comparing `liba-0.1.1rc4/ffi/python/src/lib.c` & `liba-0.1.1rc5/python/src/a.c`

 * *Files 2% similar despite different names*

```diff
@@ -1,49 +1,52 @@
-/* Generated by Cython 0.29.28 */
+/* Generated by Cython 0.29.32 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "define_macros": [
             [
                 "A_HAVE_H",
-                null
+                "\"../build/a.setup.h\""
             ],
             [
                 "A_EXPORTS",
                 null
             ],
             [
                 "A_SIZE_REAL",
                 "8"
             ]
         ],
         "depends": [],
         "include_dirs": [
-            "build",
             "include"
         ],
         "language": "c",
         "name": "liba",
         "sources": [
-            "ffi/python/src/lib.pyx",
-            "src/arr.c",
+            "python/src/a.pyx",
+            "src/a.c",
+            "src/avl.c",
+            "src/buf.c",
             "src/complex.c",
             "src/crc.c",
             "src/fpid.c",
             "src/fuzzy.c",
-            "src/lib.c",
             "src/math.c",
             "src/mf.c",
             "src/pid.c",
             "src/poly.c",
             "src/polytrack.c",
+            "src/rbt.c",
             "src/real.c",
             "src/tf.c",
+            "src/utf.c",
             "src/version.c",
+            "src/host/a.c",
             "src/host/que.c",
             "src/host/str.c",
             "src/host/vec.c",
             "src/host/vector.c"
         ]
     },
     "module_name": "liba"
@@ -55,16 +58,16 @@
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_28"
-#define CYTHON_HEX_VERSION 0x001D1CF0
+#define CYTHON_ABI "0_29_32"
+#define CYTHON_HEX_VERSION 0x001D20F0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -95,14 +98,15 @@
 #ifndef Py_HUGE_VAL
   #define Py_HUGE_VAL HUGE_VAL
 #endif
 #ifdef PYPY_VERSION
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
+  #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
   #define CYTHON_USE_TYPE_SLOTS 0
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #if PY_VERSION_HEX < 0x03050000
     #undef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 0
@@ -131,18 +135,22 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC (PYPY_VERSION_HEX >= 0x07030900)
+  #endif
 #elif defined(PYSTON_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
+  #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #undef CYTHON_USE_ASYNC_SLOTS
   #define CYTHON_USE_ASYNC_SLOTS 0
@@ -172,18 +180,67 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
+  #endif
+#elif defined(PY_NOGIL)
+  #define CYTHON_COMPILING_IN_PYPY 0
+  #define CYTHON_COMPILING_IN_PYSTON 0
+  #define CYTHON_COMPILING_IN_CPYTHON 0
+  #define CYTHON_COMPILING_IN_NOGIL 1
+  #ifndef CYTHON_USE_TYPE_SLOTS
+    #define CYTHON_USE_TYPE_SLOTS 1
+  #endif
+  #undef CYTHON_USE_PYTYPE_LOOKUP
+  #define CYTHON_USE_PYTYPE_LOOKUP 0
+  #ifndef CYTHON_USE_ASYNC_SLOTS
+    #define CYTHON_USE_ASYNC_SLOTS 1
+  #endif
+  #undef CYTHON_USE_PYLIST_INTERNALS
+  #define CYTHON_USE_PYLIST_INTERNALS 0
+  #ifndef CYTHON_USE_UNICODE_INTERNALS
+    #define CYTHON_USE_UNICODE_INTERNALS 1
+  #endif
+  #undef CYTHON_USE_UNICODE_WRITER
+  #define CYTHON_USE_UNICODE_WRITER 0
+  #undef CYTHON_USE_PYLONG_INTERNALS
+  #define CYTHON_USE_PYLONG_INTERNALS 0
+  #ifndef CYTHON_AVOID_BORROWED_REFS
+    #define CYTHON_AVOID_BORROWED_REFS 0
+  #endif
+  #ifndef CYTHON_ASSUME_SAFE_MACROS
+    #define CYTHON_ASSUME_SAFE_MACROS 1
+  #endif
+  #ifndef CYTHON_UNPACK_METHODS
+    #define CYTHON_UNPACK_METHODS 1
+  #endif
+  #undef CYTHON_FAST_THREAD_STATE
+  #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_PYCALL
+  #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
+    #define CYTHON_PEP489_MULTI_PHASE_INIT 1
+  #endif
+  #ifndef CYTHON_USE_TP_FINALIZE
+    #define CYTHON_USE_TP_FINALIZE 1
+  #endif
+  #undef CYTHON_USE_DICT_VERSIONS
+  #define CYTHON_USE_DICT_VERSIONS 0
+  #undef CYTHON_USE_EXC_INFO_STACK
+  #define CYTHON_USE_EXC_INFO_STACK 0
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
+  #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
   #if PY_VERSION_HEX < 0x02070000
     #undef CYTHON_USE_PYTYPE_LOOKUP
     #define CYTHON_USE_PYTYPE_LOOKUP 0
   #elif !defined(CYTHON_USE_PYTYPE_LOOKUP)
@@ -225,15 +282,15 @@
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_FAST_THREAD_STATE
     #define CYTHON_FAST_THREAD_STATE 0
   #elif !defined(CYTHON_FAST_THREAD_STATE)
     #define CYTHON_FAST_THREAD_STATE 1
   #endif
   #ifndef CYTHON_FAST_PYCALL
-    #define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030B00A1)
+    #define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030A0000)
   #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
@@ -242,14 +299,17 @@
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if CYTHON_USE_PYLONG_INTERNALS
   #if PY_MAJOR_VERSION < 3
     #include "longintrepr.h"
@@ -693,16 +753,18 @@
     typedef struct {
         unaryfunc am_await;
         unaryfunc am_aiter;
         unaryfunc am_anext;
     } __Pyx_PyAsyncMethodsStruct;
 #endif
 
-#if defined(WIN32) || defined(MS_WINDOWS)
-  #define _USE_MATH_DEFINES
+#if defined(_WIN32) || defined(WIN32) || defined(MS_WINDOWS)
+  #if !defined(_USE_MATH_DEFINES)
+    #define _USE_MATH_DEFINES
+  #endif
 #endif
 #include <math.h>
 #ifdef NAN
 #define __PYX_NAN() ((float) NAN)
 #else
 static CYTHON_INLINE float __PYX_NAN() {
   float value;
@@ -951,24 +1013,24 @@
 static int __pyx_lineno;
 static int __pyx_clineno = 0;
 static const char * __pyx_cfilenm= __FILE__;
 static const char *__pyx_filename;
 
 
 static const char *__pyx_f[] = {
-  "ffi/python/src/a/mf.pxi",
-  "ffi/python/src/a/math.pxi",
+  "python/src/a/mf.pxi",
+  "python/src/a/math.pxi",
   "stringsource",
-  "ffi/python/src/lib.pyx",
-  "ffi/python/src/a/version.pxi",
-  "ffi/python/src/a/tf.pxi",
-  "ffi/python/src/a/pid.pxi",
-  "ffi/python/src/a/fpid.pxi",
-  "ffi/python/src/a/poly.pxi",
-  "ffi/python/src/a/polytrack.pxi",
+  "python/src/a.pyx",
+  "python/src/a/version.pxi",
+  "python/src/a/tf.pxi",
+  "python/src/a/pid.pxi",
+  "python/src/a/fpid.pxi",
+  "python/src/a/poly.pxi",
+  "python/src/a/polytrack.pxi",
   "array.pxd",
   "type.pxd",
   "bool.pxd",
   "complex.pxd",
 };
 
 /*--- Type declarations ---*/
@@ -984,154 +1046,158 @@
 struct __pyx_obj_4liba_polytrack5;
 struct __pyx_obj_4liba_polytrack7;
 struct __pyx_obj_4liba___pyx_scope_struct____cinit__;
 struct __pyx_obj_4liba___pyx_scope_struct_1_genexpr;
 struct __pyx_obj_4liba___pyx_scope_struct_2_genexpr;
 struct __pyx_obj_4liba___pyx_scope_struct_3_genexpr;
 struct __pyx_obj_4liba___pyx_scope_struct_4_genexpr;
-struct __pyx_obj_4liba___pyx_scope_struct_5_base;
-struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr;
+struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr;
+struct __pyx_obj_4liba___pyx_scope_struct_6_base;
 struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr;
 struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr;
 struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr;
+struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr;
+struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr;
 struct __pyx_opt_args_4liba_reals;
 
-/* "ffi/python/src/lib.pyx":8
+/* "python/src/a.pyx":8
  * 
  * from cpython.array cimport array
  * cdef array reals(object o = ()):             # <<<<<<<<<<<<<<
  *     IF A_SIZE_REAL == 8:
  *         return array('d', o)
  */
 struct __pyx_opt_args_4liba_reals {
   int __pyx_n;
   PyObject *o;
 };
 
-/* "ffi/python/src/a/mf.pxi":5
+/* "python/src/a/mf.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cdef class mf:             # <<<<<<<<<<<<<<
  *     '''membership function'''
  *     NUL   = A_MF_NUL
  */
 struct __pyx_obj_4liba_mf {
   PyObject_HEAD
 };
 
 
-/* "ffi/python/src/a/tf.pxi":5
+/* "python/src/a/tf.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cdef class tf:             # <<<<<<<<<<<<<<
  *     '''transfer function'''
- *     cdef a_tf_s ctx[1]
+ *     cdef a_tf_s ctx
  */
 struct __pyx_obj_4liba_tf {
   PyObject_HEAD
-  a_tf_s ctx[1];
+  a_tf_s ctx;
   arrayobject *_num;
   arrayobject *_den;
   arrayobject *_u;
   arrayobject *_v;
 };
 
 
-/* "ffi/python/src/a/pid.pxi":5
+/* "python/src/a/pid.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cdef class pid:             # <<<<<<<<<<<<<<
  *     '''proportional integral derivative controller'''
  *     OFF = A_PID_OFF
  */
 struct __pyx_obj_4liba_pid {
   PyObject_HEAD
-  a_pid_s ctx[1];
+  a_pid_s ctx;
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":6
+/* "python/src/a/fpid.pxi":6
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cdef class fpid:             # <<<<<<<<<<<<<<
  *     '''fuzzy proportional integral derivative controller'''
- *     cdef a_fpid_s ctx[1]
+ *     cdef a_fpid_s ctx
  */
 struct __pyx_obj_4liba_fpid {
   PyObject_HEAD
-  a_fpid_s ctx[1];
+  a_fpid_s ctx;
   a_vptr_t ptr;
-  arrayobject *mmp;
+  arrayobject *me;
+  arrayobject *mec;
   arrayobject *mkp;
   arrayobject *mki;
   arrayobject *mkd;
 };
 
 
-/* "ffi/python/src/a/polytrack.pxi":5
+/* "python/src/a/polytrack.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cdef class polytrack3:             # <<<<<<<<<<<<<<
  *     '''cubic polynomial trajectory'''
- *     cdef a_polytrack3_s ctx[1]
+ *     cdef a_polytrack3_s ctx
  */
 struct __pyx_obj_4liba_polytrack3 {
   PyObject_HEAD
-  a_polytrack3_s ctx[1];
+  a_polytrack3_s ctx;
 };
 
 
-/* "ffi/python/src/a/polytrack.pxi":125
+/* "python/src/a/polytrack.pxi":125
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cdef class polytrack5:             # <<<<<<<<<<<<<<
  *     '''quintic polynomial trajectory'''
- *     cdef a_polytrack5_s ctx[1]
+ *     cdef a_polytrack5_s ctx
  */
 struct __pyx_obj_4liba_polytrack5 {
   PyObject_HEAD
-  a_polytrack5_s ctx[1];
+  a_polytrack5_s ctx;
 };
 
 
-/* "ffi/python/src/a/polytrack.pxi":267
+/* "python/src/a/polytrack.pxi":267
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cdef class polytrack7:             # <<<<<<<<<<<<<<
  *     '''hepta polynomial trajectory'''
- *     cdef a_polytrack7_s ctx[1]
+ *     cdef a_polytrack7_s ctx
  */
 struct __pyx_obj_4liba_polytrack7 {
   PyObject_HEAD
-  a_polytrack7_s ctx[1];
+  a_polytrack7_s ctx;
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":14
+/* "python/src/a/fpid.pxi":15
  *     cdef array mki
  *     cdef array mkd
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):             # <<<<<<<<<<<<<<
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
  */
 struct __pyx_obj_4liba___pyx_scope_struct____cinit__ {
   PyObject_HEAD
+  PyObject *__pyx_v_me;
+  PyObject *__pyx_v_mec;
   PyObject *__pyx_v_mkd;
   PyObject *__pyx_v_mki;
   PyObject *__pyx_v_mkp;
-  PyObject *__pyx_v_mmp;
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":15
+/* "python/src/a/fpid.pxi":16
  *     cdef array mkd
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):
- *         self.mmp = reals((i for j in mmp for i in j))             # <<<<<<<<<<<<<<
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):
+ *         self.me = reals((i for j in me for i in j))             # <<<<<<<<<<<<<<
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
  */
 struct __pyx_obj_4liba___pyx_scope_struct_1_genexpr {
   PyObject_HEAD
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
@@ -1139,166 +1205,209 @@
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":16
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):
- *         self.mmp = reals((i for j in mmp for i in j))
+/* "python/src/a/fpid.pxi":17
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkp = reals((i for j in mkp for i in j))
+ *         self.mki = reals((i for j in mki for i in j))
+ */
+struct __pyx_obj_4liba___pyx_scope_struct_2_genexpr {
+  PyObject_HEAD
+  struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *__pyx_outer_scope;
+  PyObject *__pyx_v_i;
+  PyObject *__pyx_v_j;
+  PyObject *__pyx_t_0;
+  Py_ssize_t __pyx_t_1;
+  PyObject *(*__pyx_t_2)(PyObject *);
+  PyObject *__pyx_t_3;
+  Py_ssize_t __pyx_t_4;
+  PyObject *(*__pyx_t_5)(PyObject *);
+};
+
+
+/* "python/src/a/fpid.pxi":18
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
  */
-struct __pyx_obj_4liba___pyx_scope_struct_2_genexpr {
+struct __pyx_obj_4liba___pyx_scope_struct_3_genexpr {
   PyObject_HEAD
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":17
- *         self.mmp = reals((i for j in mmp for i in j))
+/* "python/src/a/fpid.pxi":19
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
  */
-struct __pyx_obj_4liba___pyx_scope_struct_3_genexpr {
+struct __pyx_obj_4liba___pyx_scope_struct_4_genexpr {
   PyObject_HEAD
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":18
+/* "python/src/a/fpid.pxi":20
  *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
- *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  */
-struct __pyx_obj_4liba___pyx_scope_struct_4_genexpr {
+struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr {
   PyObject_HEAD
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":40
- *         a_fpid_zero(self.ctx)
+/* "python/src/a/fpid.pxi":43
+ *         a_fpid_zero(&self.ctx)
  *         return self
- *     def base(self, mmp, mkp, mki, mkd):             # <<<<<<<<<<<<<<
+ *     def base(self, me, mec, mkp, mki, mkd):             # <<<<<<<<<<<<<<
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))
+ *         self.me = reals((i for j in me for i in j))
  */
-struct __pyx_obj_4liba___pyx_scope_struct_5_base {
+struct __pyx_obj_4liba___pyx_scope_struct_6_base {
   PyObject_HEAD
+  PyObject *__pyx_v_me;
+  PyObject *__pyx_v_mec;
   PyObject *__pyx_v_mkd;
   PyObject *__pyx_v_mki;
   PyObject *__pyx_v_mkp;
-  PyObject *__pyx_v_mmp;
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":42
- *     def base(self, mmp, mkp, mki, mkd):
+/* "python/src/a/fpid.pxi":45
+ *     def base(self, me, mec, mkp, mki, mkd):
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))             # <<<<<<<<<<<<<<
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
  */
-struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr {
+struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr {
   PyObject_HEAD
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *__pyx_outer_scope;
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":43
+/* "python/src/a/fpid.pxi":46
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkp = reals((i for j in mkp for i in j))
+ *         self.mki = reals((i for j in mki for i in j))
+ */
+struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr {
+  PyObject_HEAD
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *__pyx_outer_scope;
+  PyObject *__pyx_v_i;
+  PyObject *__pyx_v_j;
+  PyObject *__pyx_t_0;
+  Py_ssize_t __pyx_t_1;
+  PyObject *(*__pyx_t_2)(PyObject *);
+  PyObject *__pyx_t_3;
+  Py_ssize_t __pyx_t_4;
+  PyObject *(*__pyx_t_5)(PyObject *);
+};
+
+
+/* "python/src/a/fpid.pxi":47
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
  */
-struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr {
+struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr {
   PyObject_HEAD
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *__pyx_outer_scope;
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":44
- *         self.mmp = reals((i for j in mmp for i in j))
+/* "python/src/a/fpid.pxi":48
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
  */
-struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr {
+struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr {
   PyObject_HEAD
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *__pyx_outer_scope;
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
 };
 
 
-/* "ffi/python/src/a/fpid.pxi":45
+/* "python/src/a/fpid.pxi":49
  *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
- *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  */
-struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr {
+struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr {
   PyObject_HEAD
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *__pyx_outer_scope;
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *__pyx_outer_scope;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_j;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
   PyObject *__pyx_t_3;
   Py_ssize_t __pyx_t_4;
@@ -1547,14 +1656,20 @@
     (sizeof(char [1 - 2*!(cond)]) - 1)
 #ifndef Py_MEMBER_SIZE
 #define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
 #endif
 #if CYTHON_FAST_PYCALL
   static size_t __pyx_pyframe_localsplus_offset = 0;
   #include "frameobject.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
   #define __Pxy_PyFrame_Initialize_Offsets()\
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
@@ -1600,14 +1715,20 @@
     (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
 static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                               int wraparound, int boundscheck);
 static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
 static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                      int is_list, int wraparound, int boundscheck);
 
+/* PySequenceContains.proto */
+static CYTHON_INLINE int __Pyx_PySequence_ContainsTF(PyObject* item, PyObject* seq, int eq) {
+    int result = PySequence_Contains(seq, item);
+    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
+}
+
 /* Import.proto */
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);
 
 /* ImportFrom.proto */
 static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);
 
 /* PyObjectCall2Args.proto */
@@ -2075,19 +2196,21 @@
 static PyTypeObject *__pyx_ptype_4liba_polytrack5 = 0;
 static PyTypeObject *__pyx_ptype_4liba_polytrack7 = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct____cinit__ = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_1_genexpr = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_2_genexpr = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_3_genexpr = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_4_genexpr = 0;
-static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_5_base = 0;
-static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_6_genexpr = 0;
+static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_5_genexpr = 0;
+static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_6_base = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_7_genexpr = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_8_genexpr = 0;
 static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_9_genexpr = 0;
+static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_10_genexpr = 0;
+static PyTypeObject *__pyx_ptype_4liba___pyx_scope_struct_11_genexpr = 0;
 static int __pyx_f_4liba_iterable(PyObject *); /*proto*/
 static arrayobject *__pyx_f_4liba_reals(struct __pyx_opt_args_4liba_reals *__pyx_optional_args); /*proto*/
 static PyObject *__pyx_f_4liba___pyx_unpickle_mf__set_state(struct __pyx_obj_4liba_mf *, PyObject *); /*proto*/
 static CYTHON_INLINE PyObject *__Pyx_carray_to_py_a_real_t(a_real_t *, Py_ssize_t); /*proto*/
 static CYTHON_INLINE PyObject *__Pyx_carray_to_tuple_a_real_t(a_real_t *, Py_ssize_t); /*proto*/
 #define __Pyx_MODULE_NAME "liba"
 extern int __pyx_module_is_main_liba;
@@ -2117,14 +2240,15 @@
 static const char __pyx_k_dt[] = "dt";
 static const char __pyx_k_it[] = "it";
 static const char __pyx_k_j0[] = "j0";
 static const char __pyx_k_j1[] = "j1";
 static const char __pyx_k_kd[] = "kd";
 static const char __pyx_k_ki[] = "ki";
 static const char __pyx_k_kp[] = "kp";
+static const char __pyx_k_me[] = "me";
 static const char __pyx_k_mf[] = "mf";
 static const char __pyx_k_q0[] = "q0";
 static const char __pyx_k_q1[] = "q1";
 static const char __pyx_k_t0[] = "t0";
 static const char __pyx_k_t1[] = "t1";
 static const char __pyx_k_tf[] = "tf";
 static const char __pyx_k_ts[] = "ts";
@@ -2136,38 +2260,34 @@
 static const char __pyx_k_POS[] = "POS";
 static const char __pyx_k_SIG[] = "SIG";
 static const char __pyx_k_TRI[] = "TRI";
 static const char __pyx_k_buf[] = "buf";
 static const char __pyx_k_den[] = "den";
 static const char __pyx_k_fdb[] = "fdb";
 static const char __pyx_k_max[] = "max";
+static const char __pyx_k_mec[] = "mec";
 static const char __pyx_k_min[] = "min";
 static const char __pyx_k_mkd[] = "mkd";
 static const char __pyx_k_mki[] = "mki";
 static const char __pyx_k_mkp[] = "mkp";
-static const char __pyx_k_mmp[] = "mmp";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_num[] = "num";
 static const char __pyx_k_pid[] = "pid";
 static const char __pyx_k_set[] = "set";
 static const char __pyx_k_sig[] = "sig";
 static const char __pyx_k_sum[] = "sum";
 static const char __pyx_k_tri[] = "tri";
 static const char __pyx_k_TRAP[] = "TRAP";
 static const char __pyx_k_args[] = "args";
 static const char __pyx_k_call[] = "__call__";
 static const char __pyx_k_dict[] = "__dict__";
 static const char __pyx_k_fpid[] = "fpid";
-static const char __pyx_k_imax[] = "imax";
-static const char __pyx_k_imin[] = "imin";
 static const char __pyx_k_liba[] = "liba";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_name[] = "__name__";
-static const char __pyx_k_omax[] = "omax";
-static const char __pyx_k_omin[] = "omin";
 static const char __pyx_k_send[] = "send";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_trap[] = "trap";
 static const char __pyx_k_GAUSS[] = "GAUSS";
 static const char __pyx_k_GBELL[] = "GBELL";
 static const char __pyx_k_close[] = "close";
 static const char __pyx_k_gauss[] = "gauss";
@@ -2180,17 +2300,18 @@
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_update[] = "update";
 static const char __pyx_k_genexpr[] = "genexpr";
 static const char __pyx_k_version[] = "version";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_setstate[] = "__setstate__";
-static const char __pyx_k_sqrt_inv[] = "sqrt_inv";
 static const char __pyx_k_TypeError[] = "TypeError";
 static const char __pyx_k_enumerate[] = "enumerate";
+static const char __pyx_k_f32_rsqrt[] = "f32_rsqrt";
+static const char __pyx_k_f64_rsqrt[] = "f64_rsqrt";
 static const char __pyx_k_poly_eval[] = "poly_eval";
 static const char __pyx_k_poly_evar[] = "poly_evar";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_polytrack3[] = "polytrack3";
 static const char __pyx_k_polytrack5[] = "polytrack5";
 static const char __pyx_k_polytrack7[] = "polytrack7";
@@ -2205,25 +2326,25 @@
 static const char __pyx_k_version_minor[] = "version_minor";
 static const char __pyx_k_version_patch[] = "version_patch";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_pyx_unpickle_mf[] = "__pyx_unpickle_mf";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_base_locals_genexpr[] = "base.<locals>.genexpr";
+static const char __pyx_k_python_src_a_mf_pxi[] = "python/src/a/mf.pxi";
+static const char __pyx_k_python_src_a_math_pxi[] = "python/src/a/math.pxi";
+static const char __pyx_k_python_src_a_poly_pxi[] = "python/src/a/poly.pxi";
 static const char __pyx_k_cinit___locals_genexpr[] = "__cinit__.<locals>.genexpr";
-static const char __pyx_k_ffi_python_src_a_mf_pxi[] = "ffi/python/src/a/mf.pxi";
-static const char __pyx_k_ffi_python_src_a_math_pxi[] = "ffi/python/src/a/math.pxi";
-static const char __pyx_k_ffi_python_src_a_poly_pxi[] = "ffi/python/src/a/poly.pxi";
-static const char __pyx_k_ffi_python_src_a_version_pxi[] = "ffi/python/src/a/version.pxi";
-static const char __pyx_k_Incompatible_checksums_s_vs_0xd4[] = "Incompatible checksums (%s vs 0xd41d8cd = ())";
+static const char __pyx_k_python_src_a_version_pxi[] = "python/src/a/version.pxi";
+static const char __pyx_k_Incompatible_checksums_0x_x_vs_0[] = "Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static PyObject *__pyx_n_s_GAUSS;
 static PyObject *__pyx_n_s_GBELL;
 static PyObject *__pyx_n_s_INC;
-static PyObject *__pyx_kp_s_Incompatible_checksums_s_vs_0xd4;
+static PyObject *__pyx_kp_s_Incompatible_checksums_0x_x_vs_0;
 static PyObject *__pyx_n_s_MemoryError;
 static PyObject *__pyx_n_s_NUL;
 static PyObject *__pyx_n_s_OFF;
 static PyObject *__pyx_n_s_POS;
 static PyObject *__pyx_n_s_PickleError;
 static PyObject *__pyx_n_s_SIG;
 static PyObject *__pyx_n_s_TRAP;
@@ -2245,58 +2366,57 @@
 static PyObject *__pyx_n_s_d;
 static PyObject *__pyx_n_u_d;
 static PyObject *__pyx_n_s_den;
 static PyObject *__pyx_n_s_dict;
 static PyObject *__pyx_n_s_dt;
 static PyObject *__pyx_n_s_e;
 static PyObject *__pyx_n_s_enumerate;
+static PyObject *__pyx_n_s_f32_rsqrt;
+static PyObject *__pyx_n_s_f64_rsqrt;
 static PyObject *__pyx_n_s_fdb;
-static PyObject *__pyx_kp_s_ffi_python_src_a_math_pxi;
-static PyObject *__pyx_kp_s_ffi_python_src_a_mf_pxi;
-static PyObject *__pyx_kp_s_ffi_python_src_a_poly_pxi;
-static PyObject *__pyx_kp_s_ffi_python_src_a_version_pxi;
 static PyObject *__pyx_n_s_fpid;
 static PyObject *__pyx_n_s_gauss;
 static PyObject *__pyx_n_s_gbell;
 static PyObject *__pyx_n_s_genexpr;
 static PyObject *__pyx_n_s_getstate;
 static PyObject *__pyx_n_s_i;
-static PyObject *__pyx_n_s_imax;
-static PyObject *__pyx_n_s_imin;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_it;
 static PyObject *__pyx_n_s_j0;
 static PyObject *__pyx_n_s_j1;
 static PyObject *__pyx_n_s_kd;
 static PyObject *__pyx_n_s_ki;
 static PyObject *__pyx_n_s_kp;
 static PyObject *__pyx_n_s_liba;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_max;
+static PyObject *__pyx_n_s_me;
+static PyObject *__pyx_n_s_mec;
 static PyObject *__pyx_n_s_mf;
 static PyObject *__pyx_n_s_min;
 static PyObject *__pyx_n_s_mkd;
 static PyObject *__pyx_n_s_mki;
 static PyObject *__pyx_n_s_mkp;
-static PyObject *__pyx_n_s_mmp;
 static PyObject *__pyx_n_s_n;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_new;
 static PyObject *__pyx_kp_s_no_default___reduce___due_to_non;
 static PyObject *__pyx_n_s_num;
-static PyObject *__pyx_n_s_omax;
-static PyObject *__pyx_n_s_omin;
 static PyObject *__pyx_n_s_p;
 static PyObject *__pyx_n_s_pickle;
 static PyObject *__pyx_n_s_pid;
 static PyObject *__pyx_n_s_poly_eval;
 static PyObject *__pyx_n_s_poly_evar;
 static PyObject *__pyx_n_s_polytrack3;
 static PyObject *__pyx_n_s_polytrack5;
 static PyObject *__pyx_n_s_polytrack7;
+static PyObject *__pyx_kp_s_python_src_a_math_pxi;
+static PyObject *__pyx_kp_s_python_src_a_mf_pxi;
+static PyObject *__pyx_kp_s_python_src_a_poly_pxi;
+static PyObject *__pyx_kp_s_python_src_a_version_pxi;
 static PyObject *__pyx_n_s_pyx_PickleError;
 static PyObject *__pyx_n_s_pyx_checksum;
 static PyObject *__pyx_n_s_pyx_result;
 static PyObject *__pyx_n_s_pyx_state;
 static PyObject *__pyx_n_s_pyx_type;
 static PyObject *__pyx_n_s_pyx_unpickle_mf;
 static PyObject *__pyx_n_s_q0;
@@ -2307,15 +2427,14 @@
 static PyObject *__pyx_n_s_reduce_ex;
 static PyObject *__pyx_n_s_send;
 static PyObject *__pyx_n_s_set;
 static PyObject *__pyx_n_s_setstate;
 static PyObject *__pyx_n_s_setstate_cython;
 static PyObject *__pyx_n_s_sig;
 static PyObject *__pyx_n_s_sigma;
-static PyObject *__pyx_n_s_sqrt_inv;
 static PyObject *__pyx_n_s_staticmethod;
 static PyObject *__pyx_kp_s_stringsource;
 static PyObject *__pyx_n_s_sum;
 static PyObject *__pyx_n_s_t0;
 static PyObject *__pyx_n_s_t1;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_n_s_tf;
@@ -2334,15 +2453,16 @@
 static PyObject *__pyx_n_s_x;
 static PyObject *__pyx_n_s_y;
 static PyObject *__pyx_n_s_z;
 static PyObject *__pyx_pf_4liba_version(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_2version_major(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_4version_minor(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_6version_patch(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
-static PyObject *__pyx_pf_4liba_8sqrt_inv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
+static PyObject *__pyx_pf_4liba_8f32_rsqrt(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
+static PyObject *__pyx_pf_4liba_10f64_rsqrt(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
 static PyObject *__pyx_pf_4liba_2mf___call__(a_mf_e __pyx_v_e, PyObject *__pyx_v_x, PyObject *__pyx_v_a); /* proto */
 static PyObject *__pyx_pf_4liba_2mf_2gauss(PyObject *__pyx_v_x, a_real_t __pyx_v_sigma, a_real_t __pyx_v_c); /* proto */
 static PyObject *__pyx_pf_4liba_2mf_4gbell(PyObject *__pyx_v_x, a_real_t __pyx_v_a, a_real_t __pyx_v_b, a_real_t __pyx_v_c); /* proto */
 static PyObject *__pyx_pf_4liba_2mf_6sig(PyObject *__pyx_v_x, a_real_t __pyx_v_a, a_real_t __pyx_v_c); /* proto */
 static PyObject *__pyx_pf_4liba_2mf_8trap(PyObject *__pyx_v_x, a_real_t __pyx_v_a, a_real_t __pyx_v_b, a_real_t __pyx_v_c, a_real_t __pyx_v_d); /* proto */
 static PyObject *__pyx_pf_4liba_2mf_10tri(PyObject *__pyx_v_x, a_real_t __pyx_v_a, a_real_t __pyx_v_b, a_real_t __pyx_v_c); /* proto */
 static PyObject *__pyx_pf_4liba_2mf_12z(PyObject *__pyx_v_x, a_real_t __pyx_v_a, a_real_t __pyx_v_b); /* proto */
@@ -2388,29 +2508,29 @@
 static PyObject *__pyx_pf_4liba_3pid_1e___get__(struct __pyx_obj_4liba_pid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_3pid_16__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_pid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_3pid_18__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_pid *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___3genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___6genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___9genexpr(PyObject *__pyx_self); /* proto */
-static int __pyx_pf_4liba_4fpid___cinit__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_uint_t __pyx_v_num, a_real_t __pyx_v_dt, PyObject *__pyx_v_mmp, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd, a_real_t __pyx_v_imin, a_real_t __pyx_v_imax, a_real_t __pyx_v_omin, a_real_t __pyx_v_omax, a_real_t __pyx_v_sum); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_9__cinit___12genexpr(PyObject *__pyx_self); /* proto */
+static int __pyx_pf_4liba_4fpid___cinit__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_uint_t __pyx_v_num, a_real_t __pyx_v_dt, PyObject *__pyx_v_me, PyObject *__pyx_v_mec, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd, a_real_t __pyx_v_min, a_real_t __pyx_v_max, a_real_t __pyx_v_sum); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_2__call__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_set, a_real_t __pyx_v_fdb); /* proto */
 static void __pyx_pf_4liba_4fpid_4__dealloc__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_6zero(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_4base_genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_4base_3genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_4base_6genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_4base_9genexpr(PyObject *__pyx_self); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_8base(struct __pyx_obj_4liba_fpid *__pyx_v_self, PyObject *__pyx_v_mmp, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_4base_12genexpr(PyObject *__pyx_self); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_8base(struct __pyx_obj_4liba_fpid *__pyx_v_self, PyObject *__pyx_v_me, PyObject *__pyx_v_mec, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_10kpid(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_kp, a_real_t __pyx_v_ki, a_real_t __pyx_v_kd); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_12olim(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_min, a_real_t __pyx_v_max); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_14ilim(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_min, a_real_t __pyx_v_max); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_16pos(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_max); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_18inc(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_20off(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_12pos(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_max); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_14inc(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_16off(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_6outmin___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static int __pyx_pf_4liba_4fpid_6outmin_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_outmin); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_6outmax___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static int __pyx_pf_4liba_4fpid_6outmax_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_outmax); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_6summax___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static int __pyx_pf_4liba_4fpid_6summax_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_summax); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_4mode___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
@@ -2426,18 +2546,18 @@
 static PyObject *__pyx_pf_4liba_4fpid_3buf___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static int __pyx_pf_4liba_4fpid_3buf_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_uint_t __pyx_v_max); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_3col___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_3out___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_3fdb___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_2ec___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_4fpid_1e___get__(struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_22__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_4liba_4fpid_24__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_pf_4liba_10poly_eval(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a); /* proto */
-static PyObject *__pyx_pf_4liba_12poly_evar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_18__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_4liba_4fpid_20__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static PyObject *__pyx_pf_4liba_12poly_eval(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a); /* proto */
+static PyObject *__pyx_pf_4liba_14poly_evar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a); /* proto */
 static int __pyx_pf_4liba_10polytrack3___cinit__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_t0, a_real_t __pyx_v_t1, a_real_t __pyx_v_q0, a_real_t __pyx_v_q1, a_real_t __pyx_v_v0, a_real_t __pyx_v_v1); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack3_2__call__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, PyObject *__pyx_v_ts); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack3_4pos(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, PyObject *__pyx_v_ts); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack3_6vec(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, PyObject *__pyx_v_ts); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack3_8acc(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, PyObject *__pyx_v_ts); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack3_10gen(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack3_1k___get__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self); /* proto */
@@ -2530,115 +2650,122 @@
 static int __pyx_pf_4liba_10polytrack7_2v1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack7_2a1___get__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self); /* proto */
 static int __pyx_pf_4liba_10polytrack7_2a1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack7_2j1___get__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self); /* proto */
 static int __pyx_pf_4liba_10polytrack7_2j1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack7_14__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_polytrack7 *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_4liba_10polytrack7_16__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_pf_4liba_14__pyx_unpickle_mf(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
+static PyObject *__pyx_pf_4liba_16__pyx_unpickle_mf(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
 static int __pyx_pf_7cpython_5array_5array___getbuffer__(arrayobject *__pyx_v_self, Py_buffer *__pyx_v_info, CYTHON_UNUSED int __pyx_v_flags); /* proto */
 static void __pyx_pf_7cpython_5array_5array_2__releasebuffer__(CYTHON_UNUSED arrayobject *__pyx_v_self, Py_buffer *__pyx_v_info); /* proto */
 static PyObject *__pyx_tp_new_4liba_mf(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba_tf(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba_pid(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba_fpid(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba_polytrack3(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba_polytrack5(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba_polytrack7(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct____cinit__(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_1_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_2_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_3_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_4_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
-static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_5_base(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
-static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_6_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_5_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_6_base(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_7_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_8_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_9_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_10_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_11_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_222419149;
+static PyObject *__pyx_int_228825662;
+static PyObject *__pyx_int_238750788;
 static PyObject *__pyx_tuple_;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__4;
 static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__6;
 static PyObject *__pyx_tuple__7;
 static PyObject *__pyx_tuple__8;
 static PyObject *__pyx_tuple__9;
 static PyObject *__pyx_tuple__10;
 static PyObject *__pyx_tuple__11;
 static PyObject *__pyx_tuple__12;
-static PyObject *__pyx_tuple__17;
-static PyObject *__pyx_tuple__19;
-static PyObject *__pyx_tuple__21;
-static PyObject *__pyx_tuple__23;
-static PyObject *__pyx_tuple__25;
-static PyObject *__pyx_tuple__27;
-static PyObject *__pyx_tuple__29;
-static PyObject *__pyx_tuple__31;
-static PyObject *__pyx_tuple__33;
-static PyObject *__pyx_tuple__35;
-static PyObject *__pyx_tuple__37;
-static PyObject *__pyx_codeobj__13;
+static PyObject *__pyx_tuple__13;
+static PyObject *__pyx_tuple__18;
+static PyObject *__pyx_tuple__20;
+static PyObject *__pyx_tuple__22;
+static PyObject *__pyx_tuple__24;
+static PyObject *__pyx_tuple__26;
+static PyObject *__pyx_tuple__28;
+static PyObject *__pyx_tuple__30;
+static PyObject *__pyx_tuple__32;
+static PyObject *__pyx_tuple__34;
+static PyObject *__pyx_tuple__36;
+static PyObject *__pyx_tuple__38;
+static PyObject *__pyx_tuple__40;
 static PyObject *__pyx_codeobj__14;
 static PyObject *__pyx_codeobj__15;
 static PyObject *__pyx_codeobj__16;
-static PyObject *__pyx_codeobj__18;
-static PyObject *__pyx_codeobj__20;
-static PyObject *__pyx_codeobj__22;
-static PyObject *__pyx_codeobj__24;
-static PyObject *__pyx_codeobj__26;
-static PyObject *__pyx_codeobj__28;
-static PyObject *__pyx_codeobj__30;
-static PyObject *__pyx_codeobj__32;
-static PyObject *__pyx_codeobj__34;
-static PyObject *__pyx_codeobj__36;
-static PyObject *__pyx_codeobj__38;
+static PyObject *__pyx_codeobj__17;
+static PyObject *__pyx_codeobj__19;
+static PyObject *__pyx_codeobj__21;
+static PyObject *__pyx_codeobj__23;
+static PyObject *__pyx_codeobj__25;
+static PyObject *__pyx_codeobj__27;
+static PyObject *__pyx_codeobj__29;
+static PyObject *__pyx_codeobj__31;
+static PyObject *__pyx_codeobj__33;
+static PyObject *__pyx_codeobj__35;
+static PyObject *__pyx_codeobj__37;
+static PyObject *__pyx_codeobj__39;
+static PyObject *__pyx_codeobj__41;
 /* Late includes */
 
-/* "ffi/python/src/lib.pyx":4
+/* "python/src/a.pyx":4
  * 
  * from cpython cimport *
  * cdef bint iterable(object o):             # <<<<<<<<<<<<<<
  *     return PyObject_HasAttrString(o, "__contains__")
  * 
  */
 
 static int __pyx_f_4liba_iterable(PyObject *__pyx_v_o) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("iterable", 0);
 
-  /* "ffi/python/src/lib.pyx":5
+  /* "python/src/a.pyx":5
  * from cpython cimport *
  * cdef bint iterable(object o):
  *     return PyObject_HasAttrString(o, "__contains__")             # <<<<<<<<<<<<<<
  * 
  * from cpython.array cimport array
  */
   __pyx_r = PyObject_HasAttrString(__pyx_v_o, ((char const *)"__contains__"));
   goto __pyx_L0;
 
-  /* "ffi/python/src/lib.pyx":4
+  /* "python/src/a.pyx":4
  * 
  * from cpython cimport *
  * cdef bint iterable(object o):             # <<<<<<<<<<<<<<
  *     return PyObject_HasAttrString(o, "__contains__")
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/lib.pyx":8
+/* "python/src/a.pyx":8
  * 
  * from cpython.array cimport array
  * cdef array reals(object o = ()):             # <<<<<<<<<<<<<<
  *     IF A_SIZE_REAL == 8:
  *         return array('d', o)
  */
 
@@ -2654,15 +2781,15 @@
   __Pyx_RefNannySetupContext("reals", 0);
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_o = __pyx_optional_args->o;
     }
   }
 
-  /* "ffi/python/src/lib.pyx":10
+  /* "python/src/a.pyx":10
  * cdef array reals(object o = ()):
  *     IF A_SIZE_REAL == 8:
  *         return array('d', o)             # <<<<<<<<<<<<<<
  *     IF A_SIZE_REAL == 4:
  *         return array('f', o)
  */
   __Pyx_XDECREF(((PyObject *)__pyx_r));
@@ -2677,15 +2804,15 @@
   __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(3, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/lib.pyx":8
+  /* "python/src/a.pyx":8
  * 
  * from cpython.array cimport array
  * cdef array reals(object o = ()):             # <<<<<<<<<<<<<<
  *     IF A_SIZE_REAL == 8:
  *         return array('d', o)
  */
 
@@ -2697,15 +2824,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/version.pxi":3
+/* "python/src/a/version.pxi":3
  * from a.version cimport *
  * 
  * def version():             # <<<<<<<<<<<<<<
  *     '''algorithm library version'''
  *     if PY_MAJOR_VERSION >= 3:
  */
 
@@ -2731,25 +2858,25 @@
   a_cstr_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("version", 0);
 
-  /* "ffi/python/src/a/version.pxi":5
+  /* "python/src/a/version.pxi":5
  * def version():
  *     '''algorithm library version'''
  *     if PY_MAJOR_VERSION >= 3:             # <<<<<<<<<<<<<<
  *         return a_version().decode()
  *     return a_version()
  */
   __pyx_t_1 = ((PY_MAJOR_VERSION >= 3) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/version.pxi":6
+    /* "python/src/a/version.pxi":6
  *     '''algorithm library version'''
  *     if PY_MAJOR_VERSION >= 3:
  *         return a_version().decode()             # <<<<<<<<<<<<<<
  *     return a_version()
  * 
  */
     __Pyx_XDECREF(__pyx_r);
@@ -2757,38 +2884,38 @@
     __pyx_t_3 = __Pyx_decode_c_string(__pyx_t_2, 0, strlen(__pyx_t_2), NULL, NULL, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(4, 6, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/version.pxi":5
+    /* "python/src/a/version.pxi":5
  * def version():
  *     '''algorithm library version'''
  *     if PY_MAJOR_VERSION >= 3:             # <<<<<<<<<<<<<<
  *         return a_version().decode()
  *     return a_version()
  */
   }
 
-  /* "ffi/python/src/a/version.pxi":7
+  /* "python/src/a/version.pxi":7
  *     if PY_MAJOR_VERSION >= 3:
  *         return a_version().decode()
  *     return a_version()             # <<<<<<<<<<<<<<
  * 
  * def version_major() -> a_uint_t:
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_3 = __Pyx_PyBytes_FromString(a_version()); if (unlikely(!__pyx_t_3)) __PYX_ERR(4, 7, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/version.pxi":3
+  /* "python/src/a/version.pxi":3
  * from a.version cimport *
  * 
  * def version():             # <<<<<<<<<<<<<<
  *     '''algorithm library version'''
  *     if PY_MAJOR_VERSION >= 3:
  */
 
@@ -2799,15 +2926,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/version.pxi":9
+/* "python/src/a/version.pxi":9
  *     return a_version()
  * 
  * def version_major() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version major'''
  *     return a_version_major()
  */
 
@@ -2831,29 +2958,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("version_major", 0);
 
-  /* "ffi/python/src/a/version.pxi":11
+  /* "python/src/a/version.pxi":11
  * def version_major() -> a_uint_t:
  *     '''algorithm library version major'''
  *     return a_version_major()             # <<<<<<<<<<<<<<
  * 
  * def version_minor() -> a_uint_t:
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_version_major()); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/version.pxi":9
+  /* "python/src/a/version.pxi":9
  *     return a_version()
  * 
  * def version_major() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version major'''
  *     return a_version_major()
  */
 
@@ -2864,15 +2991,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/version.pxi":13
+/* "python/src/a/version.pxi":13
  *     return a_version_major()
  * 
  * def version_minor() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version minor'''
  *     return a_version_minor()
  */
 
@@ -2896,29 +3023,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("version_minor", 0);
 
-  /* "ffi/python/src/a/version.pxi":15
+  /* "python/src/a/version.pxi":15
  * def version_minor() -> a_uint_t:
  *     '''algorithm library version minor'''
  *     return a_version_minor()             # <<<<<<<<<<<<<<
  * 
  * def version_patch() -> a_uint_t:
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_version_minor()); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/version.pxi":13
+  /* "python/src/a/version.pxi":13
  *     return a_version_major()
  * 
  * def version_minor() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version minor'''
  *     return a_version_minor()
  */
 
@@ -2929,15 +3056,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/version.pxi":17
+/* "python/src/a/version.pxi":17
  *     return a_version_minor()
  * 
  * def version_patch() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version patch'''
  *     return a_version_patch()
  */
 
@@ -2961,27 +3088,27 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("version_patch", 0);
 
-  /* "ffi/python/src/a/version.pxi":19
+  /* "python/src/a/version.pxi":19
  * def version_patch() -> a_uint_t:
  *     '''algorithm library version patch'''
  *     return a_version_patch()             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_version_patch()); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/version.pxi":17
+  /* "python/src/a/version.pxi":17
  *     return a_version_minor()
  * 
  * def version_patch() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version patch'''
  *     return a_version_patch()
  */
 
@@ -2992,38 +3119,38 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/math.pxi":5
+/* "python/src/a/math.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
- * def sqrt_inv(x):             # <<<<<<<<<<<<<<
+ * def f32_rsqrt(x):             # <<<<<<<<<<<<<<
  *     '''fast inverse square-root'''
  *     if iterable(x):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_9sqrt_inv(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
-static char __pyx_doc_4liba_8sqrt_inv[] = "fast inverse square-root";
-static PyMethodDef __pyx_mdef_4liba_9sqrt_inv = {"sqrt_inv", (PyCFunction)__pyx_pw_4liba_9sqrt_inv, METH_O, __pyx_doc_4liba_8sqrt_inv};
-static PyObject *__pyx_pw_4liba_9sqrt_inv(PyObject *__pyx_self, PyObject *__pyx_v_x) {
+static PyObject *__pyx_pw_4liba_9f32_rsqrt(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
+static char __pyx_doc_4liba_8f32_rsqrt[] = "fast inverse square-root";
+static PyMethodDef __pyx_mdef_4liba_9f32_rsqrt = {"f32_rsqrt", (PyCFunction)__pyx_pw_4liba_9f32_rsqrt, METH_O, __pyx_doc_4liba_8f32_rsqrt};
+static PyObject *__pyx_pw_4liba_9f32_rsqrt(PyObject *__pyx_self, PyObject *__pyx_v_x) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("sqrt_inv (wrapper)", 0);
-  __pyx_r = __pyx_pf_4liba_8sqrt_inv(__pyx_self, ((PyObject *)__pyx_v_x));
+  __Pyx_RefNannySetupContext("f32_rsqrt (wrapper)", 0);
+  __pyx_r = __pyx_pf_4liba_8f32_rsqrt(__pyx_self, ((PyObject *)__pyx_v_x));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_8sqrt_inv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
+static PyObject *__pyx_pf_4liba_8f32_rsqrt(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
   arrayobject *__pyx_v_y = NULL;
   PyObject *__pyx_v_i = NULL;
   PyObject *__pyx_v_it = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -3032,45 +3159,45 @@
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
   PyObject *__pyx_t_7 = NULL;
   a_f32_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("sqrt_inv", 0);
+  __Pyx_RefNannySetupContext("f32_rsqrt", 0);
 
-  /* "ffi/python/src/a/math.pxi":7
- * def sqrt_inv(x):
+  /* "python/src/a/math.pxi":7
+ * def f32_rsqrt(x):
  *     '''fast inverse square-root'''
  *     if iterable(x):             # <<<<<<<<<<<<<<
  *         y = reals(x)
  *         for i, it in enumerate(x):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/math.pxi":8
+    /* "python/src/a/math.pxi":8
  *     '''fast inverse square-root'''
  *     if iterable(x):
  *         y = reals(x)             # <<<<<<<<<<<<<<
  *         for i, it in enumerate(x):
- *             y[i] = a_sqrt_inv(it)
+ *             y[i] = a_f32_rsqrt(it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_x;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 8, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_y = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/math.pxi":9
+    /* "python/src/a/math.pxi":9
  *     if iterable(x):
  *         y = reals(x)
  *         for i, it in enumerate(x):             # <<<<<<<<<<<<<<
- *             y[i] = a_sqrt_inv(it)
+ *             y[i] = a_f32_rsqrt(it)
  *         return y
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
       __pyx_t_4 = __pyx_v_x; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -3116,96 +3243,304 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 9, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/math.pxi":10
+      /* "python/src/a/math.pxi":10
  *         y = reals(x)
  *         for i, it in enumerate(x):
- *             y[i] = a_sqrt_inv(it)             # <<<<<<<<<<<<<<
+ *             y[i] = a_f32_rsqrt(it)             # <<<<<<<<<<<<<<
  *         return y
- *     return a_sqrt_inv(x)
+ *     return a_f32_rsqrt(x)
  */
       __pyx_t_8 = __pyx_PyFloat_AsFloat(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_f32_t)-1)) && PyErr_Occurred())) __PYX_ERR(1, 10, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_sqrt_inv(__pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 10, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_f32_rsqrt(__pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 10, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(1, 10, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/math.pxi":9
+      /* "python/src/a/math.pxi":9
  *     if iterable(x):
  *         y = reals(x)
  *         for i, it in enumerate(x):             # <<<<<<<<<<<<<<
- *             y[i] = a_sqrt_inv(it)
+ *             y[i] = a_f32_rsqrt(it)
  *         return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/math.pxi":11
+    /* "python/src/a/math.pxi":11
  *         for i, it in enumerate(x):
- *             y[i] = a_sqrt_inv(it)
+ *             y[i] = a_f32_rsqrt(it)
  *         return y             # <<<<<<<<<<<<<<
- *     return a_sqrt_inv(x)
+ *     return a_f32_rsqrt(x)
+ * 
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/math.pxi":7
- * def sqrt_inv(x):
+    /* "python/src/a/math.pxi":7
+ * def f32_rsqrt(x):
  *     '''fast inverse square-root'''
  *     if iterable(x):             # <<<<<<<<<<<<<<
  *         y = reals(x)
  *         for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/math.pxi":12
- *             y[i] = a_sqrt_inv(it)
+  /* "python/src/a/math.pxi":12
+ *             y[i] = a_f32_rsqrt(it)
  *         return y
- *     return a_sqrt_inv(x)             # <<<<<<<<<<<<<<
+ *     return a_f32_rsqrt(x)             # <<<<<<<<<<<<<<
+ * 
+ * @cython.wraparound(False)
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsFloat(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_f32_t)-1)) && PyErr_Occurred())) __PYX_ERR(1, 12, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_sqrt_inv(__pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 12, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_f32_rsqrt(__pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/math.pxi":5
+  /* "python/src/a/math.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
- * def sqrt_inv(x):             # <<<<<<<<<<<<<<
+ * def f32_rsqrt(x):             # <<<<<<<<<<<<<<
  *     '''fast inverse square-root'''
  *     if iterable(x):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_AddTraceback("liba.sqrt_inv", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("liba.f32_rsqrt", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_y);
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/mf.pxi":15
+/* "python/src/a/math.pxi":16
+ * @cython.wraparound(False)
+ * @cython.boundscheck(False)
+ * def f64_rsqrt(x):             # <<<<<<<<<<<<<<
+ *     '''fast inverse square-root'''
+ *     if iterable(x):
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_4liba_11f64_rsqrt(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
+static char __pyx_doc_4liba_10f64_rsqrt[] = "fast inverse square-root";
+static PyMethodDef __pyx_mdef_4liba_11f64_rsqrt = {"f64_rsqrt", (PyCFunction)__pyx_pw_4liba_11f64_rsqrt, METH_O, __pyx_doc_4liba_10f64_rsqrt};
+static PyObject *__pyx_pw_4liba_11f64_rsqrt(PyObject *__pyx_self, PyObject *__pyx_v_x) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("f64_rsqrt (wrapper)", 0);
+  __pyx_r = __pyx_pf_4liba_10f64_rsqrt(__pyx_self, ((PyObject *)__pyx_v_x));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_4liba_10f64_rsqrt(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
+  arrayobject *__pyx_v_y = NULL;
+  PyObject *__pyx_v_i = NULL;
+  PyObject *__pyx_v_it = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  struct __pyx_opt_args_4liba_reals __pyx_t_3;
+  PyObject *__pyx_t_4 = NULL;
+  Py_ssize_t __pyx_t_5;
+  PyObject *(*__pyx_t_6)(PyObject *);
+  PyObject *__pyx_t_7 = NULL;
+  a_f64_t __pyx_t_8;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("f64_rsqrt", 0);
+
+  /* "python/src/a/math.pxi":18
+ * def f64_rsqrt(x):
+ *     '''fast inverse square-root'''
+ *     if iterable(x):             # <<<<<<<<<<<<<<
+ *         y = reals(x)
+ *         for i, it in enumerate(x):
+ */
+  __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
+  if (__pyx_t_1) {
+
+    /* "python/src/a/math.pxi":19
+ *     '''fast inverse square-root'''
+ *     if iterable(x):
+ *         y = reals(x)             # <<<<<<<<<<<<<<
+ *         for i, it in enumerate(x):
+ *             y[i] = a_f64_rsqrt(it)
+ */
+    __pyx_t_3.__pyx_n = 1;
+    __pyx_t_3.o = __pyx_v_x;
+    __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_v_y = ((arrayobject *)__pyx_t_2);
+    __pyx_t_2 = 0;
+
+    /* "python/src/a/math.pxi":20
+ *     if iterable(x):
+ *         y = reals(x)
+ *         for i, it in enumerate(x):             # <<<<<<<<<<<<<<
+ *             y[i] = a_f64_rsqrt(it)
+ *         return y
+ */
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_2 = __pyx_int_0;
+    if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
+      __pyx_t_4 = __pyx_v_x; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
+      __pyx_t_6 = NULL;
+    } else {
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 20, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 20, __pyx_L1_error)
+    }
+    for (;;) {
+      if (likely(!__pyx_t_6)) {
+        if (likely(PyList_CheckExact(__pyx_t_4))) {
+          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 20, __pyx_L1_error)
+          #else
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 20, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
+          #endif
+        } else {
+          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(1, 20, __pyx_L1_error)
+          #else
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 20, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
+          #endif
+        }
+      } else {
+        __pyx_t_7 = __pyx_t_6(__pyx_t_4);
+        if (unlikely(!__pyx_t_7)) {
+          PyObject* exc_type = PyErr_Occurred();
+          if (exc_type) {
+            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+            else __PYX_ERR(1, 20, __pyx_L1_error)
+          }
+          break;
+        }
+        __Pyx_GOTREF(__pyx_t_7);
+      }
+      __Pyx_XDECREF_SET(__pyx_v_it, __pyx_t_7);
+      __pyx_t_7 = 0;
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
+      __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 20, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_2);
+      __pyx_t_2 = __pyx_t_7;
+      __pyx_t_7 = 0;
+
+      /* "python/src/a/math.pxi":21
+ *         y = reals(x)
+ *         for i, it in enumerate(x):
+ *             y[i] = a_f64_rsqrt(it)             # <<<<<<<<<<<<<<
+ *         return y
+ *     return a_f64_rsqrt(x)
+ */
+      __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_f64_t)-1)) && PyErr_Occurred())) __PYX_ERR(1, 21, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_f64_rsqrt(__pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 21, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(1, 21, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+      /* "python/src/a/math.pxi":20
+ *     if iterable(x):
+ *         y = reals(x)
+ *         for i, it in enumerate(x):             # <<<<<<<<<<<<<<
+ *             y[i] = a_f64_rsqrt(it)
+ *         return y
+ */
+    }
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+    /* "python/src/a/math.pxi":22
+ *         for i, it in enumerate(x):
+ *             y[i] = a_f64_rsqrt(it)
+ *         return y             # <<<<<<<<<<<<<<
+ *     return a_f64_rsqrt(x)
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_INCREF(((PyObject *)__pyx_v_y));
+    __pyx_r = ((PyObject *)__pyx_v_y);
+    goto __pyx_L0;
+
+    /* "python/src/a/math.pxi":18
+ * def f64_rsqrt(x):
+ *     '''fast inverse square-root'''
+ *     if iterable(x):             # <<<<<<<<<<<<<<
+ *         y = reals(x)
+ *         for i, it in enumerate(x):
+ */
+  }
+
+  /* "python/src/a/math.pxi":23
+ *             y[i] = a_f64_rsqrt(it)
+ *         return y
+ *     return a_f64_rsqrt(x)             # <<<<<<<<<<<<<<
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_f64_t)-1)) && PyErr_Occurred())) __PYX_ERR(1, 23, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_f64_rsqrt(__pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 23, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
+  goto __pyx_L0;
+
+  /* "python/src/a/math.pxi":16
+ * @cython.wraparound(False)
+ * @cython.boundscheck(False)
+ * def f64_rsqrt(x):             # <<<<<<<<<<<<<<
+ *     '''fast inverse square-root'''
+ *     if iterable(x):
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_AddTraceback("liba.f64_rsqrt", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF((PyObject *)__pyx_v_y);
+  __Pyx_XDECREF(__pyx_v_i);
+  __Pyx_XDECREF(__pyx_v_it);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "python/src/a/mf.pxi":15
  *     Z     = A_MF_Z
  *     @staticmethod
  *     def __call__(e: a_mf_e, x, a):             # <<<<<<<<<<<<<<
  *         cdef array d = reals(a)
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  */
 
@@ -3302,62 +3637,62 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__call__", 0);
 
-  /* "ffi/python/src/a/mf.pxi":16
+  /* "python/src/a/mf.pxi":16
  *     @staticmethod
  *     def __call__(e: a_mf_e, x, a):
  *         cdef array d = reals(a)             # <<<<<<<<<<<<<<
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  *         if iterable(x):
  */
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.o = __pyx_v_a;
   __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_d = ((arrayobject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/mf.pxi":17
+  /* "python/src/a/mf.pxi":17
  *     def __call__(e: a_mf_e, x, a):
  *         cdef array d = reals(a)
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr             # <<<<<<<<<<<<<<
  *         if iterable(x):
  *             y = reals(x)
  */
   __pyx_v_v = ((a_real_t *)__pyx_v_d->data.as_voidptr);
 
-  /* "ffi/python/src/a/mf.pxi":18
+  /* "python/src/a/mf.pxi":18
  *         cdef array d = reals(a)
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   __pyx_t_3 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_3) {
 
-    /* "ffi/python/src/a/mf.pxi":19
+    /* "python/src/a/mf.pxi":19
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  *         if iterable(x):
  *             y = reals(x)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf(e, it, v)
  */
     __pyx_t_2.__pyx_n = 1;
     __pyx_t_2.o = __pyx_v_x;
     __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_y = ((arrayobject *)__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":20
+    /* "python/src/a/mf.pxi":20
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf(e, it, v)
  *             return y
  */
     __Pyx_INCREF(__pyx_int_0);
@@ -3407,75 +3742,75 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 20, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1);
       __pyx_t_1 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":21
+      /* "python/src/a/mf.pxi":21
  *             y = reals(x)
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf(e, it, v)             # <<<<<<<<<<<<<<
  *             return y
  *         return a_mf(e, x, v)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 21, __pyx_L1_error)
       __pyx_t_7 = PyFloat_FromDouble(a_mf(__pyx_v_e, __pyx_t_8, __pyx_v_v)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 21, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(0, 21, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":20
+      /* "python/src/a/mf.pxi":20
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf(e, it, v)
  *             return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":22
+    /* "python/src/a/mf.pxi":22
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf(e, it, v)
  *             return y             # <<<<<<<<<<<<<<
  *         return a_mf(e, x, v)
  *     @staticmethod
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/mf.pxi":18
+    /* "python/src/a/mf.pxi":18
  *         cdef array d = reals(a)
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/mf.pxi":23
+  /* "python/src/a/mf.pxi":23
  *                 y[i] = a_mf(e, it, v)
  *             return y
  *         return a_mf(e, x, v)             # <<<<<<<<<<<<<<
  *     @staticmethod
  *     def gauss(x, sigma: a_real_t, c: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L1_error)
   __pyx_t_1 = PyFloat_FromDouble(a_mf(__pyx_v_e, __pyx_t_8, __pyx_v_v)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/mf.pxi":15
+  /* "python/src/a/mf.pxi":15
  *     Z     = A_MF_Z
  *     @staticmethod
  *     def __call__(e: a_mf_e, x, a):             # <<<<<<<<<<<<<<
  *         cdef array d = reals(a)
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  */
 
@@ -3492,15 +3827,15 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/mf.pxi":25
+/* "python/src/a/mf.pxi":25
  *         return a_mf(e, x, v)
  *     @staticmethod
  *     def gauss(x, sigma: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Gaussian membership function'''
  *         if iterable(x):
  */
 
@@ -3596,39 +3931,39 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("gauss", 0);
 
-  /* "ffi/python/src/a/mf.pxi":27
+  /* "python/src/a/mf.pxi":27
  *     def gauss(x, sigma: a_real_t, c: a_real_t):
  *         '''Gaussian membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/mf.pxi":28
+    /* "python/src/a/mf.pxi":28
  *         '''Gaussian membership function'''
  *         if iterable(x):
  *             y = reals(x)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_gauss(it, sigma, c)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_x;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_y = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":29
+    /* "python/src/a/mf.pxi":29
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_gauss(it, sigma, c)
  *             return y
  */
     __Pyx_INCREF(__pyx_int_0);
@@ -3678,75 +4013,75 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 29, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":30
+      /* "python/src/a/mf.pxi":30
  *             y = reals(x)
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_gauss(it, sigma, c)             # <<<<<<<<<<<<<<
  *             return y
  *         return a_mf_gauss(x, sigma, c)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 30, __pyx_L1_error)
       __pyx_t_7 = PyFloat_FromDouble(a_mf_gauss(__pyx_t_8, __pyx_v_sigma, __pyx_v_c)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 30, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(0, 30, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":29
+      /* "python/src/a/mf.pxi":29
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_gauss(it, sigma, c)
  *             return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":31
+    /* "python/src/a/mf.pxi":31
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_gauss(it, sigma, c)
  *             return y             # <<<<<<<<<<<<<<
  *         return a_mf_gauss(x, sigma, c)
  *     @staticmethod
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/mf.pxi":27
+    /* "python/src/a/mf.pxi":27
  *     def gauss(x, sigma: a_real_t, c: a_real_t):
  *         '''Gaussian membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/mf.pxi":32
+  /* "python/src/a/mf.pxi":32
  *                 y[i] = a_mf_gauss(it, sigma, c)
  *             return y
  *         return a_mf_gauss(x, sigma, c)             # <<<<<<<<<<<<<<
  *     @staticmethod
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 32, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(a_mf_gauss(__pyx_t_8, __pyx_v_sigma, __pyx_v_c)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 32, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/mf.pxi":25
+  /* "python/src/a/mf.pxi":25
  *         return a_mf(e, x, v)
  *     @staticmethod
  *     def gauss(x, sigma: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Gaussian membership function'''
  *         if iterable(x):
  */
 
@@ -3762,15 +4097,15 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/mf.pxi":34
+/* "python/src/a/mf.pxi":34
  *         return a_mf_gauss(x, sigma, c)
  *     @staticmethod
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Generalized bell-shaped membership function'''
  *         if iterable(x):
  */
 
@@ -3877,39 +4212,39 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("gbell", 0);
 
-  /* "ffi/python/src/a/mf.pxi":36
+  /* "python/src/a/mf.pxi":36
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):
  *         '''Generalized bell-shaped membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/mf.pxi":37
+    /* "python/src/a/mf.pxi":37
  *         '''Generalized bell-shaped membership function'''
  *         if iterable(x):
  *             y = reals(x)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_gbell(it, a, b, c)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_x;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_y = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":38
+    /* "python/src/a/mf.pxi":38
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_gbell(it, a, b, c)
  *             return y
  */
     __Pyx_INCREF(__pyx_int_0);
@@ -3959,75 +4294,75 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 38, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":39
+      /* "python/src/a/mf.pxi":39
  *             y = reals(x)
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_gbell(it, a, b, c)             # <<<<<<<<<<<<<<
  *             return y
  *         return a_mf_gbell(x, a, b, c)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 39, __pyx_L1_error)
       __pyx_t_7 = PyFloat_FromDouble(a_mf_gbell(__pyx_t_8, __pyx_v_a, __pyx_v_b, __pyx_v_c)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 39, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(0, 39, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":38
+      /* "python/src/a/mf.pxi":38
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_gbell(it, a, b, c)
  *             return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":40
+    /* "python/src/a/mf.pxi":40
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_gbell(it, a, b, c)
  *             return y             # <<<<<<<<<<<<<<
  *         return a_mf_gbell(x, a, b, c)
  *     @staticmethod
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/mf.pxi":36
+    /* "python/src/a/mf.pxi":36
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):
  *         '''Generalized bell-shaped membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/mf.pxi":41
+  /* "python/src/a/mf.pxi":41
  *                 y[i] = a_mf_gbell(it, a, b, c)
  *             return y
  *         return a_mf_gbell(x, a, b, c)             # <<<<<<<<<<<<<<
  *     @staticmethod
  *     def sig(x, a: a_real_t, c: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 41, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(a_mf_gbell(__pyx_t_8, __pyx_v_a, __pyx_v_b, __pyx_v_c)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/mf.pxi":34
+  /* "python/src/a/mf.pxi":34
  *         return a_mf_gauss(x, sigma, c)
  *     @staticmethod
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Generalized bell-shaped membership function'''
  *         if iterable(x):
  */
 
@@ -4043,15 +4378,15 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/mf.pxi":43
+/* "python/src/a/mf.pxi":43
  *         return a_mf_gbell(x, a, b, c)
  *     @staticmethod
  *     def sig(x, a: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Sigmoidal membership function'''
  *         if iterable(x):
  */
 
@@ -4147,39 +4482,39 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("sig", 0);
 
-  /* "ffi/python/src/a/mf.pxi":45
+  /* "python/src/a/mf.pxi":45
  *     def sig(x, a: a_real_t, c: a_real_t):
  *         '''Sigmoidal membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/mf.pxi":46
+    /* "python/src/a/mf.pxi":46
  *         '''Sigmoidal membership function'''
  *         if iterable(x):
  *             y = reals(x)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_sig(it, a, c)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_x;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 46, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_y = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":47
+    /* "python/src/a/mf.pxi":47
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_sig(it, a, c)
  *             return y
  */
     __Pyx_INCREF(__pyx_int_0);
@@ -4229,75 +4564,75 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 47, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":48
+      /* "python/src/a/mf.pxi":48
  *             y = reals(x)
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_sig(it, a, c)             # <<<<<<<<<<<<<<
  *             return y
  *         return a_mf_sig(x, a, c)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 48, __pyx_L1_error)
       __pyx_t_7 = PyFloat_FromDouble(a_mf_sig(__pyx_t_8, __pyx_v_a, __pyx_v_c)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 48, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(0, 48, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":47
+      /* "python/src/a/mf.pxi":47
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_sig(it, a, c)
  *             return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":49
+    /* "python/src/a/mf.pxi":49
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_sig(it, a, c)
  *             return y             # <<<<<<<<<<<<<<
  *         return a_mf_sig(x, a, c)
  *     @staticmethod
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/mf.pxi":45
+    /* "python/src/a/mf.pxi":45
  *     def sig(x, a: a_real_t, c: a_real_t):
  *         '''Sigmoidal membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/mf.pxi":50
+  /* "python/src/a/mf.pxi":50
  *                 y[i] = a_mf_sig(it, a, c)
  *             return y
  *         return a_mf_sig(x, a, c)             # <<<<<<<<<<<<<<
  *     @staticmethod
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(a_mf_sig(__pyx_t_8, __pyx_v_a, __pyx_v_c)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 50, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/mf.pxi":43
+  /* "python/src/a/mf.pxi":43
  *         return a_mf_gbell(x, a, b, c)
  *     @staticmethod
  *     def sig(x, a: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Sigmoidal membership function'''
  *         if iterable(x):
  */
 
@@ -4313,15 +4648,15 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/mf.pxi":52
+/* "python/src/a/mf.pxi":52
  *         return a_mf_sig(x, a, c)
  *     @staticmethod
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Trapezoidal membership function'''
  *         if iterable(x):
  */
 
@@ -4439,39 +4774,39 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("trap", 0);
 
-  /* "ffi/python/src/a/mf.pxi":54
+  /* "python/src/a/mf.pxi":54
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):
  *         '''Trapezoidal membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/mf.pxi":55
+    /* "python/src/a/mf.pxi":55
  *         '''Trapezoidal membership function'''
  *         if iterable(x):
  *             y = reals(x)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_trap(it, a, b, c, d)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_x;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 55, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_y = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":56
+    /* "python/src/a/mf.pxi":56
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_trap(it, a, b, c, d)
  *             return y
  */
     __Pyx_INCREF(__pyx_int_0);
@@ -4521,75 +4856,75 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 56, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":57
+      /* "python/src/a/mf.pxi":57
  *             y = reals(x)
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_trap(it, a, b, c, d)             # <<<<<<<<<<<<<<
  *             return y
  *         return a_mf_trap(x, a, b, c, d)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 57, __pyx_L1_error)
       __pyx_t_7 = PyFloat_FromDouble(a_mf_trap(__pyx_t_8, __pyx_v_a, __pyx_v_b, __pyx_v_c, __pyx_v_d)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 57, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(0, 57, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":56
+      /* "python/src/a/mf.pxi":56
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_trap(it, a, b, c, d)
  *             return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":58
+    /* "python/src/a/mf.pxi":58
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_trap(it, a, b, c, d)
  *             return y             # <<<<<<<<<<<<<<
  *         return a_mf_trap(x, a, b, c, d)
  *     @staticmethod
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/mf.pxi":54
+    /* "python/src/a/mf.pxi":54
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):
  *         '''Trapezoidal membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/mf.pxi":59
+  /* "python/src/a/mf.pxi":59
  *                 y[i] = a_mf_trap(it, a, b, c, d)
  *             return y
  *         return a_mf_trap(x, a, b, c, d)             # <<<<<<<<<<<<<<
  *     @staticmethod
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 59, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(a_mf_trap(__pyx_t_8, __pyx_v_a, __pyx_v_b, __pyx_v_c, __pyx_v_d)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/mf.pxi":52
+  /* "python/src/a/mf.pxi":52
  *         return a_mf_sig(x, a, c)
  *     @staticmethod
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Trapezoidal membership function'''
  *         if iterable(x):
  */
 
@@ -4605,15 +4940,15 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/mf.pxi":61
+/* "python/src/a/mf.pxi":61
  *         return a_mf_trap(x, a, b, c, d)
  *     @staticmethod
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Triangular membership function'''
  *         if iterable(x):
  */
 
@@ -4720,39 +5055,39 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("tri", 0);
 
-  /* "ffi/python/src/a/mf.pxi":63
+  /* "python/src/a/mf.pxi":63
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):
  *         '''Triangular membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/mf.pxi":64
+    /* "python/src/a/mf.pxi":64
  *         '''Triangular membership function'''
  *         if iterable(x):
  *             y = reals(x)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_tri(it, a, b, c)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_x;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 64, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_y = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":65
+    /* "python/src/a/mf.pxi":65
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_tri(it, a, b, c)
  *             return y
  */
     __Pyx_INCREF(__pyx_int_0);
@@ -4802,75 +5137,75 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 65, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":66
+      /* "python/src/a/mf.pxi":66
  *             y = reals(x)
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_tri(it, a, b, c)             # <<<<<<<<<<<<<<
  *             return y
  *         return a_mf_tri(x, a, b, c)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 66, __pyx_L1_error)
       __pyx_t_7 = PyFloat_FromDouble(a_mf_tri(__pyx_t_8, __pyx_v_a, __pyx_v_b, __pyx_v_c)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 66, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(0, 66, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":65
+      /* "python/src/a/mf.pxi":65
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_tri(it, a, b, c)
  *             return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":67
+    /* "python/src/a/mf.pxi":67
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_tri(it, a, b, c)
  *             return y             # <<<<<<<<<<<<<<
  *         return a_mf_tri(x, a, b, c)
  *     @staticmethod
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/mf.pxi":63
+    /* "python/src/a/mf.pxi":63
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):
  *         '''Triangular membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/mf.pxi":68
+  /* "python/src/a/mf.pxi":68
  *                 y[i] = a_mf_tri(it, a, b, c)
  *             return y
  *         return a_mf_tri(x, a, b, c)             # <<<<<<<<<<<<<<
  *     @staticmethod
  *     def z(x, a: a_real_t, b: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 68, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(a_mf_tri(__pyx_t_8, __pyx_v_a, __pyx_v_b, __pyx_v_c)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 68, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/mf.pxi":61
+  /* "python/src/a/mf.pxi":61
  *         return a_mf_trap(x, a, b, c, d)
  *     @staticmethod
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Triangular membership function'''
  *         if iterable(x):
  */
 
@@ -4886,15 +5221,15 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/mf.pxi":70
+/* "python/src/a/mf.pxi":70
  *         return a_mf_tri(x, a, b, c)
  *     @staticmethod
  *     def z(x, a: a_real_t, b: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Z-shaped membership function'''
  *         if iterable(x):
  */
 
@@ -4990,39 +5325,39 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("z", 0);
 
-  /* "ffi/python/src/a/mf.pxi":72
+  /* "python/src/a/mf.pxi":72
  *     def z(x, a: a_real_t, b: a_real_t):
  *         '''Z-shaped membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/mf.pxi":73
+    /* "python/src/a/mf.pxi":73
  *         '''Z-shaped membership function'''
  *         if iterable(x):
  *             y = reals(x)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_z(it, a, b)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_x;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 73, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_y = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":74
+    /* "python/src/a/mf.pxi":74
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_z(it, a, b)
  *             return y
  */
     __Pyx_INCREF(__pyx_int_0);
@@ -5072,72 +5407,72 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 74, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":75
+      /* "python/src/a/mf.pxi":75
  *             y = reals(x)
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_z(it, a, b)             # <<<<<<<<<<<<<<
  *             return y
  *         return a_mf_z(x, a, b)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 75, __pyx_L1_error)
       __pyx_t_7 = PyFloat_FromDouble(a_mf_z(__pyx_t_8, __pyx_v_a, __pyx_v_b)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_y), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/mf.pxi":74
+      /* "python/src/a/mf.pxi":74
  *         if iterable(x):
  *             y = reals(x)
  *             for i, it in enumerate(x):             # <<<<<<<<<<<<<<
  *                 y[i] = a_mf_z(it, a, b)
  *             return y
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/mf.pxi":76
+    /* "python/src/a/mf.pxi":76
  *             for i, it in enumerate(x):
  *                 y[i] = a_mf_z(it, a, b)
  *             return y             # <<<<<<<<<<<<<<
  *         return a_mf_z(x, a, b)
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/mf.pxi":72
+    /* "python/src/a/mf.pxi":72
  *     def z(x, a: a_real_t, b: a_real_t):
  *         '''Z-shaped membership function'''
  *         if iterable(x):             # <<<<<<<<<<<<<<
  *             y = reals(x)
  *             for i, it in enumerate(x):
  */
   }
 
-  /* "ffi/python/src/a/mf.pxi":77
+  /* "python/src/a/mf.pxi":77
  *                 y[i] = a_mf_z(it, a, b)
  *             return y
  *         return a_mf_z(x, a, b)             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 77, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(a_mf_z(__pyx_t_8, __pyx_v_a, __pyx_v_b)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 77, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/mf.pxi":70
+  /* "python/src/a/mf.pxi":70
  *         return a_mf_tri(x, a, b, c)
  *     @staticmethod
  *     def z(x, a: a_real_t, b: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Z-shaped membership function'''
  *         if iterable(x):
  */
 
@@ -5444,15 +5779,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/tf.pxi":12
+/* "python/src/a/tf.pxi":12
  *     cdef array _u
  *     cdef array _v
  *     def __cinit__(self, num, den):             # <<<<<<<<<<<<<<
  *         self.num = num
  *         self.den = den
  */
 
@@ -5524,33 +5859,33 @@
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "ffi/python/src/a/tf.pxi":13
+  /* "python/src/a/tf.pxi":13
  *     cdef array _v
  *     def __cinit__(self, num, den):
  *         self.num = num             # <<<<<<<<<<<<<<
  *         self.den = den
  *     def __call__(self, x: a_real_t) -> a_real_t:
  */
   if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_num, __pyx_v_num) < 0) __PYX_ERR(5, 13, __pyx_L1_error)
 
-  /* "ffi/python/src/a/tf.pxi":14
+  /* "python/src/a/tf.pxi":14
  *     def __cinit__(self, num, den):
  *         self.num = num
  *         self.den = den             # <<<<<<<<<<<<<<
  *     def __call__(self, x: a_real_t) -> a_real_t:
- *         '''process function for transfer function'''
+ *         '''calculate function for transfer function'''
  */
   if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_den, __pyx_v_den) < 0) __PYX_ERR(5, 14, __pyx_L1_error)
 
-  /* "ffi/python/src/a/tf.pxi":12
+  /* "python/src/a/tf.pxi":12
  *     cdef array _u
  *     cdef array _v
  *     def __cinit__(self, num, den):             # <<<<<<<<<<<<<<
  *         self.num = num
  *         self.den = den
  */
 
@@ -5561,26 +5896,26 @@
   __Pyx_AddTraceback("liba.tf.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/tf.pxi":15
+/* "python/src/a/tf.pxi":15
  *         self.num = num
  *         self.den = den
  *     def __call__(self, x: a_real_t) -> a_real_t:             # <<<<<<<<<<<<<<
- *         '''process function for transfer function'''
- *         return a_tf_proc(self.ctx, x)
+ *         '''calculate function for transfer function'''
+ *         return a_tf_iter(&self.ctx, x)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_2tf_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_4liba_2tf_2__call__[] = "process function for transfer function";
-#if CYTHON_COMPILING_IN_CPYTHON
+static char __pyx_doc_4liba_2tf_2__call__[] = "calculate function for transfer function";
+#if CYTHON_UPDATE_DESCRIPTOR_DOC
 struct wrapperbase __pyx_wrapperbase_4liba_2tf_2__call__;
 #endif
 static PyObject *__pyx_pw_4liba_2tf_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_x;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
@@ -5635,53 +5970,53 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__call__", 0);
 
-  /* "ffi/python/src/a/tf.pxi":17
+  /* "python/src/a/tf.pxi":17
  *     def __call__(self, x: a_real_t) -> a_real_t:
- *         '''process function for transfer function'''
- *         return a_tf_proc(self.ctx, x)             # <<<<<<<<<<<<<<
+ *         '''calculate function for transfer function'''
+ *         return a_tf_iter(&self.ctx, x)             # <<<<<<<<<<<<<<
  *     def __dealloc__(self):
  *         '''terminate function for transfer function'''
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_tf_proc(__pyx_v_self->ctx, __pyx_v_x)); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 17, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_tf_iter((&__pyx_v_self->ctx), __pyx_v_x)); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/tf.pxi":15
+  /* "python/src/a/tf.pxi":15
  *         self.num = num
  *         self.den = den
  *     def __call__(self, x: a_real_t) -> a_real_t:             # <<<<<<<<<<<<<<
- *         '''process function for transfer function'''
- *         return a_tf_proc(self.ctx, x)
+ *         '''calculate function for transfer function'''
+ *         return a_tf_iter(&self.ctx, x)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.tf.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/tf.pxi":18
- *         '''process function for transfer function'''
- *         return a_tf_proc(self.ctx, x)
+/* "python/src/a/tf.pxi":18
+ *         '''calculate function for transfer function'''
+ *         return a_tf_iter(&self.ctx, x)
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         '''terminate function for transfer function'''
- *         a_tf_exit(self.ctx)
+ *         a_tf_exit(&self.ctx)
  */
 
 /* Python wrapper */
 static void __pyx_pw_4liba_2tf_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
 static void __pyx_pw_4liba_2tf_5__dealloc__(PyObject *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
@@ -5691,41 +6026,41 @@
   __Pyx_RefNannyFinishContext();
 }
 
 static void __pyx_pf_4liba_2tf_4__dealloc__(struct __pyx_obj_4liba_tf *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "ffi/python/src/a/tf.pxi":20
+  /* "python/src/a/tf.pxi":20
  *     def __dealloc__(self):
  *         '''terminate function for transfer function'''
- *         a_tf_exit(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_tf_exit(&self.ctx)             # <<<<<<<<<<<<<<
  *     def zero(self):
  *         '''zero function for transfer function'''
  */
-  (void)(a_tf_exit(__pyx_v_self->ctx));
+  (void)(a_tf_exit((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/tf.pxi":18
- *         '''process function for transfer function'''
- *         return a_tf_proc(self.ctx, x)
+  /* "python/src/a/tf.pxi":18
+ *         '''calculate function for transfer function'''
+ *         return a_tf_iter(&self.ctx, x)
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         '''terminate function for transfer function'''
- *         a_tf_exit(self.ctx)
+ *         a_tf_exit(&self.ctx)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "ffi/python/src/a/tf.pxi":21
+/* "python/src/a/tf.pxi":21
  *         '''terminate function for transfer function'''
- *         a_tf_exit(self.ctx)
+ *         a_tf_exit(&self.ctx)
  *     def zero(self):             # <<<<<<<<<<<<<<
  *         '''zero function for transfer function'''
- *         a_tf_zero(self.ctx)
+ *         a_tf_zero(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_2tf_7zero(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_2tf_6zero[] = "zero function for transfer function";
 static PyObject *__pyx_pw_4liba_2tf_7zero(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -5739,51 +6074,51 @@
 }
 
 static PyObject *__pyx_pf_4liba_2tf_6zero(struct __pyx_obj_4liba_tf *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("zero", 0);
 
-  /* "ffi/python/src/a/tf.pxi":23
+  /* "python/src/a/tf.pxi":23
  *     def zero(self):
  *         '''zero function for transfer function'''
- *         a_tf_zero(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_tf_zero(&self.ctx)             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
-  (void)(a_tf_zero(__pyx_v_self->ctx));
+  (void)(a_tf_zero((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/tf.pxi":24
+  /* "python/src/a/tf.pxi":24
  *         '''zero function for transfer function'''
- *         a_tf_zero(self.ctx)
+ *         a_tf_zero(&self.ctx)
  *         return self             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/tf.pxi":21
+  /* "python/src/a/tf.pxi":21
  *         '''terminate function for transfer function'''
- *         a_tf_exit(self.ctx)
+ *         a_tf_exit(&self.ctx)
  *     def zero(self):             # <<<<<<<<<<<<<<
  *         '''zero function for transfer function'''
- *         a_tf_zero(self.ctx)
+ *         a_tf_zero(&self.ctx)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/tf.pxi":27
+/* "python/src/a/tf.pxi":27
  * 
  *     @property
  *     def num(self):             # <<<<<<<<<<<<<<
  *         return self._num
  *     @num.setter
  */
 
@@ -5801,42 +6136,42 @@
 }
 
 static PyObject *__pyx_pf_4liba_2tf_3num___get__(struct __pyx_obj_4liba_tf *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/tf.pxi":28
+  /* "python/src/a/tf.pxi":28
  *     @property
  *     def num(self):
  *         return self._num             # <<<<<<<<<<<<<<
  *     @num.setter
  *     def num(self, num):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->_num));
   __pyx_r = ((PyObject *)__pyx_v_self->_num);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/tf.pxi":27
+  /* "python/src/a/tf.pxi":27
  * 
  *     @property
  *     def num(self):             # <<<<<<<<<<<<<<
  *         return self._num
  *     @num.setter
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/tf.pxi":30
+/* "python/src/a/tf.pxi":30
  *         return self._num
  *     @num.setter
  *     def num(self, num):             # <<<<<<<<<<<<<<
  *         cdef a_uint_t m = <a_uint_t>len(num)
  *         self._num = reals(num)
  */
 
@@ -5861,68 +6196,68 @@
   PyObject *__pyx_t_2 = NULL;
   struct __pyx_opt_args_4liba_reals __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/tf.pxi":31
+  /* "python/src/a/tf.pxi":31
  *     @num.setter
  *     def num(self, num):
  *         cdef a_uint_t m = <a_uint_t>len(num)             # <<<<<<<<<<<<<<
  *         self._num = reals(num)
  *         self._u = reals(num)
  */
   __pyx_t_1 = PyObject_Length(__pyx_v_num); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(5, 31, __pyx_L1_error)
   __pyx_v_m = ((a_uint_t)__pyx_t_1);
 
-  /* "ffi/python/src/a/tf.pxi":32
+  /* "python/src/a/tf.pxi":32
  *     def num(self, num):
  *         cdef a_uint_t m = <a_uint_t>len(num)
  *         self._num = reals(num)             # <<<<<<<<<<<<<<
  *         self._u = reals(num)
- *         a_tf_set_num(self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)
+ *         a_tf_set_num(&self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)
  */
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_v_num;
   __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(5, 32, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->_num);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->_num));
   __pyx_v_self->_num = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/tf.pxi":33
+  /* "python/src/a/tf.pxi":33
  *         cdef a_uint_t m = <a_uint_t>len(num)
  *         self._num = reals(num)
  *         self._u = reals(num)             # <<<<<<<<<<<<<<
- *         a_tf_set_num(self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)
+ *         a_tf_set_num(&self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)
  * 
  */
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_v_num;
   __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(5, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->_u);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->_u));
   __pyx_v_self->_u = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/tf.pxi":34
+  /* "python/src/a/tf.pxi":34
  *         self._num = reals(num)
  *         self._u = reals(num)
- *         a_tf_set_num(self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)             # <<<<<<<<<<<<<<
+ *         a_tf_set_num(&self.ctx, m, <a_real_t *>self._num.data.as_voidptr, <a_real_t *>self._u.data.as_voidptr)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_tf_set_num(__pyx_v_self->ctx, __pyx_v_m, ((a_real_t *)__pyx_v_self->_num->data.as_voidptr), ((a_real_t *)__pyx_v_self->_u->data.as_voidptr));
+  a_tf_set_num((&__pyx_v_self->ctx), __pyx_v_m, ((a_real_t *)__pyx_v_self->_num->data.as_voidptr), ((a_real_t *)__pyx_v_self->_u->data.as_voidptr));
 
-  /* "ffi/python/src/a/tf.pxi":30
+  /* "python/src/a/tf.pxi":30
  *         return self._num
  *     @num.setter
  *     def num(self, num):             # <<<<<<<<<<<<<<
  *         cdef a_uint_t m = <a_uint_t>len(num)
  *         self._num = reals(num)
  */
 
@@ -5934,15 +6269,15 @@
   __Pyx_AddTraceback("liba.tf.num.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/tf.pxi":37
+/* "python/src/a/tf.pxi":37
  * 
  *     @property
  *     def den(self):             # <<<<<<<<<<<<<<
  *         return self._den
  *     @den.setter
  */
 
@@ -5960,42 +6295,42 @@
 }
 
 static PyObject *__pyx_pf_4liba_2tf_3den___get__(struct __pyx_obj_4liba_tf *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/tf.pxi":38
+  /* "python/src/a/tf.pxi":38
  *     @property
  *     def den(self):
  *         return self._den             # <<<<<<<<<<<<<<
  *     @den.setter
  *     def den(self, den):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->_den));
   __pyx_r = ((PyObject *)__pyx_v_self->_den);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/tf.pxi":37
+  /* "python/src/a/tf.pxi":37
  * 
  *     @property
  *     def den(self):             # <<<<<<<<<<<<<<
  *         return self._den
  *     @den.setter
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/tf.pxi":40
+/* "python/src/a/tf.pxi":40
  *         return self._den
  *     @den.setter
  *     def den(self, den):             # <<<<<<<<<<<<<<
  *         cdef a_uint_t n = <a_uint_t>len(den)
  *         self._den = reals(den)
  */
 
@@ -6020,65 +6355,65 @@
   PyObject *__pyx_t_2 = NULL;
   struct __pyx_opt_args_4liba_reals __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/tf.pxi":41
+  /* "python/src/a/tf.pxi":41
  *     @den.setter
  *     def den(self, den):
  *         cdef a_uint_t n = <a_uint_t>len(den)             # <<<<<<<<<<<<<<
  *         self._den = reals(den)
  *         self._v = reals(den)
  */
   __pyx_t_1 = PyObject_Length(__pyx_v_den); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(5, 41, __pyx_L1_error)
   __pyx_v_n = ((a_uint_t)__pyx_t_1);
 
-  /* "ffi/python/src/a/tf.pxi":42
+  /* "python/src/a/tf.pxi":42
  *     def den(self, den):
  *         cdef a_uint_t n = <a_uint_t>len(den)
  *         self._den = reals(den)             # <<<<<<<<<<<<<<
  *         self._v = reals(den)
- *         a_tf_set_den(self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)
+ *         a_tf_set_den(&self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)
  */
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_v_den;
   __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(5, 42, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->_den);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->_den));
   __pyx_v_self->_den = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/tf.pxi":43
+  /* "python/src/a/tf.pxi":43
  *         cdef a_uint_t n = <a_uint_t>len(den)
  *         self._den = reals(den)
  *         self._v = reals(den)             # <<<<<<<<<<<<<<
- *         a_tf_set_den(self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)
+ *         a_tf_set_den(&self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)
  */
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_v_den;
   __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(5, 43, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->_v);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->_v));
   __pyx_v_self->_v = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/tf.pxi":44
+  /* "python/src/a/tf.pxi":44
  *         self._den = reals(den)
  *         self._v = reals(den)
- *         a_tf_set_den(self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)             # <<<<<<<<<<<<<<
+ *         a_tf_set_den(&self.ctx, n, <a_real_t *>self._den.data.as_voidptr, <a_real_t *>self._v.data.as_voidptr)             # <<<<<<<<<<<<<<
  */
-  a_tf_set_den(__pyx_v_self->ctx, __pyx_v_n, ((a_real_t *)__pyx_v_self->_den->data.as_voidptr), ((a_real_t *)__pyx_v_self->_v->data.as_voidptr));
+  a_tf_set_den((&__pyx_v_self->ctx), __pyx_v_n, ((a_real_t *)__pyx_v_self->_den->data.as_voidptr), ((a_real_t *)__pyx_v_self->_v->data.as_voidptr));
 
-  /* "ffi/python/src/a/tf.pxi":40
+  /* "python/src/a/tf.pxi":40
  *         return self._den
  *     @den.setter
  *     def den(self, den):             # <<<<<<<<<<<<<<
  *         cdef a_uint_t n = <a_uint_t>len(den)
  *         self._den = reals(den)
  */
 
@@ -6203,19 +6538,19 @@
   __Pyx_AddTraceback("liba.tf.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":11
+/* "python/src/a/pid.pxi":11
  *     INC = A_PID_INC
- *     cdef a_pid_s ctx[1]
+ *     cdef a_pid_s ctx
  *     def __cinit__(self, a_real_t dt, a_real_t min, a_real_t max, a_real_t sum = 0):             # <<<<<<<<<<<<<<
- *         a_pid_init(self.ctx, dt, min, max)
+ *         a_pid_init(&self.ctx, dt, min, max)
  *         if sum:
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_3pid_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_pw_4liba_3pid_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_dt;
@@ -6310,90 +6645,90 @@
 
 static int __pyx_pf_4liba_3pid___cinit__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_dt, a_real_t __pyx_v_min, a_real_t __pyx_v_max, a_real_t __pyx_v_sum) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":12
- *     cdef a_pid_s ctx[1]
+  /* "python/src/a/pid.pxi":12
+ *     cdef a_pid_s ctx
  *     def __cinit__(self, a_real_t dt, a_real_t min, a_real_t max, a_real_t sum = 0):
- *         a_pid_init(self.ctx, dt, min, max)             # <<<<<<<<<<<<<<
+ *         a_pid_init(&self.ctx, dt, min, max)             # <<<<<<<<<<<<<<
  *         if sum:
- *             a_pid_pos(self.ctx, sum)
+ *             a_pid_pos(&self.ctx, sum)
  */
-  (void)(a_pid_init(__pyx_v_self->ctx, __pyx_v_dt, __pyx_v_min, __pyx_v_max));
+  (void)(a_pid_init((&__pyx_v_self->ctx), __pyx_v_dt, __pyx_v_min, __pyx_v_max));
 
-  /* "ffi/python/src/a/pid.pxi":13
+  /* "python/src/a/pid.pxi":13
  *     def __cinit__(self, a_real_t dt, a_real_t min, a_real_t max, a_real_t sum = 0):
- *         a_pid_init(self.ctx, dt, min, max)
+ *         a_pid_init(&self.ctx, dt, min, max)
  *         if sum:             # <<<<<<<<<<<<<<
- *             a_pid_pos(self.ctx, sum)
+ *             a_pid_pos(&self.ctx, sum)
  *         else:
  */
   __pyx_t_1 = (__pyx_v_sum != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/pid.pxi":14
- *         a_pid_init(self.ctx, dt, min, max)
+    /* "python/src/a/pid.pxi":14
+ *         a_pid_init(&self.ctx, dt, min, max)
  *         if sum:
- *             a_pid_pos(self.ctx, sum)             # <<<<<<<<<<<<<<
+ *             a_pid_pos(&self.ctx, sum)             # <<<<<<<<<<<<<<
  *         else:
- *             a_pid_inc(self.ctx)
+ *             a_pid_inc(&self.ctx)
  */
-    (void)(a_pid_pos(__pyx_v_self->ctx, __pyx_v_sum));
+    (void)(a_pid_pos((&__pyx_v_self->ctx), __pyx_v_sum));
 
-    /* "ffi/python/src/a/pid.pxi":13
+    /* "python/src/a/pid.pxi":13
  *     def __cinit__(self, a_real_t dt, a_real_t min, a_real_t max, a_real_t sum = 0):
- *         a_pid_init(self.ctx, dt, min, max)
+ *         a_pid_init(&self.ctx, dt, min, max)
  *         if sum:             # <<<<<<<<<<<<<<
- *             a_pid_pos(self.ctx, sum)
+ *             a_pid_pos(&self.ctx, sum)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "ffi/python/src/a/pid.pxi":16
- *             a_pid_pos(self.ctx, sum)
+  /* "python/src/a/pid.pxi":16
+ *             a_pid_pos(&self.ctx, sum)
  *         else:
- *             a_pid_inc(self.ctx)             # <<<<<<<<<<<<<<
+ *             a_pid_inc(&self.ctx)             # <<<<<<<<<<<<<<
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:
- *         '''process function for PID controller'''
+ *         '''calculate function for PID controller'''
  */
   /*else*/ {
-    (void)(a_pid_inc(__pyx_v_self->ctx));
+    (void)(a_pid_inc((&__pyx_v_self->ctx)));
   }
   __pyx_L3:;
 
-  /* "ffi/python/src/a/pid.pxi":11
+  /* "python/src/a/pid.pxi":11
  *     INC = A_PID_INC
- *     cdef a_pid_s ctx[1]
+ *     cdef a_pid_s ctx
  *     def __cinit__(self, a_real_t dt, a_real_t min, a_real_t max, a_real_t sum = 0):             # <<<<<<<<<<<<<<
- *         a_pid_init(self.ctx, dt, min, max)
+ *         a_pid_init(&self.ctx, dt, min, max)
  *         if sum:
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":17
+/* "python/src/a/pid.pxi":17
  *         else:
- *             a_pid_inc(self.ctx)
+ *             a_pid_inc(&self.ctx)
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:             # <<<<<<<<<<<<<<
- *         '''process function for PID controller'''
- *         return a_pid_outv(self.ctx, set, fdb)
+ *         '''calculate function for PID controller'''
+ *         return a_pid_outv(&self.ctx, set, fdb)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_4liba_3pid_2__call__[] = "process function for PID controller";
-#if CYTHON_COMPILING_IN_CPYTHON
+static char __pyx_doc_4liba_3pid_2__call__[] = "calculate function for PID controller";
+#if CYTHON_UPDATE_DESCRIPTOR_DOC
 struct wrapperbase __pyx_wrapperbase_4liba_3pid_2__call__;
 #endif
 static PyObject *__pyx_pw_4liba_3pid_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_set;
   a_real_t __pyx_v_fdb;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -6459,53 +6794,53 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__call__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":19
+  /* "python/src/a/pid.pxi":19
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:
- *         '''process function for PID controller'''
- *         return a_pid_outv(self.ctx, set, fdb)             # <<<<<<<<<<<<<<
+ *         '''calculate function for PID controller'''
+ *         return a_pid_outv(&self.ctx, set, fdb)             # <<<<<<<<<<<<<<
  *     def __dealloc__(self):
  *         '''terminate function for PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_pid_outv(__pyx_v_self->ctx, __pyx_v_set, __pyx_v_fdb)); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 19, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_pid_outv((&__pyx_v_self->ctx), __pyx_v_set, __pyx_v_fdb)); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":17
+  /* "python/src/a/pid.pxi":17
  *         else:
- *             a_pid_inc(self.ctx)
+ *             a_pid_inc(&self.ctx)
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:             # <<<<<<<<<<<<<<
- *         '''process function for PID controller'''
- *         return a_pid_outv(self.ctx, set, fdb)
+ *         '''calculate function for PID controller'''
+ *         return a_pid_outv(&self.ctx, set, fdb)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.pid.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":20
- *         '''process function for PID controller'''
- *         return a_pid_outv(self.ctx, set, fdb)
+/* "python/src/a/pid.pxi":20
+ *         '''calculate function for PID controller'''
+ *         return a_pid_outv(&self.ctx, set, fdb)
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         '''terminate function for PID controller'''
- *         a_pid_exit(self.ctx)
+ *         a_pid_exit(&self.ctx)
  */
 
 /* Python wrapper */
 static void __pyx_pw_4liba_3pid_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
 static void __pyx_pw_4liba_3pid_5__dealloc__(PyObject *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
@@ -6515,41 +6850,41 @@
   __Pyx_RefNannyFinishContext();
 }
 
 static void __pyx_pf_4liba_3pid_4__dealloc__(struct __pyx_obj_4liba_pid *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":22
+  /* "python/src/a/pid.pxi":22
  *     def __dealloc__(self):
  *         '''terminate function for PID controller'''
- *         a_pid_exit(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_pid_exit(&self.ctx)             # <<<<<<<<<<<<<<
  *     def zero(self):
  *         '''zero function for PID controller'''
  */
-  (void)(a_pid_exit(__pyx_v_self->ctx));
+  (void)(a_pid_exit((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/pid.pxi":20
- *         '''process function for PID controller'''
- *         return a_pid_outv(self.ctx, set, fdb)
+  /* "python/src/a/pid.pxi":20
+ *         '''calculate function for PID controller'''
+ *         return a_pid_outv(&self.ctx, set, fdb)
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         '''terminate function for PID controller'''
- *         a_pid_exit(self.ctx)
+ *         a_pid_exit(&self.ctx)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "ffi/python/src/a/pid.pxi":23
+/* "python/src/a/pid.pxi":23
  *         '''terminate function for PID controller'''
- *         a_pid_exit(self.ctx)
+ *         a_pid_exit(&self.ctx)
  *     def zero(self):             # <<<<<<<<<<<<<<
  *         '''zero function for PID controller'''
- *         a_pid_zero(self.ctx)
+ *         a_pid_zero(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_7zero(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_3pid_6zero[] = "zero function for PID controller";
 static PyObject *__pyx_pw_4liba_3pid_7zero(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -6563,56 +6898,56 @@
 }
 
 static PyObject *__pyx_pf_4liba_3pid_6zero(struct __pyx_obj_4liba_pid *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("zero", 0);
 
-  /* "ffi/python/src/a/pid.pxi":25
+  /* "python/src/a/pid.pxi":25
  *     def zero(self):
  *         '''zero function for PID controller'''
- *         a_pid_zero(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_pid_zero(&self.ctx)             # <<<<<<<<<<<<<<
  *         return self
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
  */
-  (void)(a_pid_zero(__pyx_v_self->ctx));
+  (void)(a_pid_zero((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/pid.pxi":26
+  /* "python/src/a/pid.pxi":26
  *         '''zero function for PID controller'''
- *         a_pid_zero(self.ctx)
+ *         a_pid_zero(&self.ctx)
  *         return self             # <<<<<<<<<<<<<<
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
  *         '''set proportional integral derivative constant for PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":23
+  /* "python/src/a/pid.pxi":23
  *         '''terminate function for PID controller'''
- *         a_pid_exit(self.ctx)
+ *         a_pid_exit(&self.ctx)
  *     def zero(self):             # <<<<<<<<<<<<<<
  *         '''zero function for PID controller'''
- *         a_pid_zero(self.ctx)
+ *         a_pid_zero(&self.ctx)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":27
- *         a_pid_zero(self.ctx)
+/* "python/src/a/pid.pxi":27
+ *         a_pid_zero(&self.ctx)
  *         return self
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):             # <<<<<<<<<<<<<<
  *         '''set proportional integral derivative constant for PID controller'''
- *         a_pid_kpid(self.ctx, kp, ki, kd)
+ *         a_pid_kpid(&self.ctx, kp, ki, kd)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_9kpid(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_4liba_3pid_8kpid[] = "set proportional integral derivative constant for PID controller";
 static PyObject *__pyx_pw_4liba_3pid_9kpid(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_kp;
@@ -6688,56 +7023,56 @@
 }
 
 static PyObject *__pyx_pf_4liba_3pid_8kpid(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_kp, a_real_t __pyx_v_ki, a_real_t __pyx_v_kd) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("kpid", 0);
 
-  /* "ffi/python/src/a/pid.pxi":29
+  /* "python/src/a/pid.pxi":29
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
  *         '''set proportional integral derivative constant for PID controller'''
- *         a_pid_kpid(self.ctx, kp, ki, kd)             # <<<<<<<<<<<<<<
+ *         a_pid_kpid(&self.ctx, kp, ki, kd)             # <<<<<<<<<<<<<<
  *         return self
  *     def pos(self, max: a_real_t):
  */
-  (void)(a_pid_kpid(__pyx_v_self->ctx, __pyx_v_kp, __pyx_v_ki, __pyx_v_kd));
+  (void)(a_pid_kpid((&__pyx_v_self->ctx), __pyx_v_kp, __pyx_v_ki, __pyx_v_kd));
 
-  /* "ffi/python/src/a/pid.pxi":30
+  /* "python/src/a/pid.pxi":30
  *         '''set proportional integral derivative constant for PID controller'''
- *         a_pid_kpid(self.ctx, kp, ki, kd)
+ *         a_pid_kpid(&self.ctx, kp, ki, kd)
  *         return self             # <<<<<<<<<<<<<<
  *     def pos(self, max: a_real_t):
  *         '''positional PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":27
- *         a_pid_zero(self.ctx)
+  /* "python/src/a/pid.pxi":27
+ *         a_pid_zero(&self.ctx)
  *         return self
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):             # <<<<<<<<<<<<<<
  *         '''set proportional integral derivative constant for PID controller'''
- *         a_pid_kpid(self.ctx, kp, ki, kd)
+ *         a_pid_kpid(&self.ctx, kp, ki, kd)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":31
- *         a_pid_kpid(self.ctx, kp, ki, kd)
+/* "python/src/a/pid.pxi":31
+ *         a_pid_kpid(&self.ctx, kp, ki, kd)
  *         return self
  *     def pos(self, max: a_real_t):             # <<<<<<<<<<<<<<
  *         '''positional PID controller'''
- *         a_pid_pos(self.ctx, max)
+ *         a_pid_pos(&self.ctx, max)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_11pos(PyObject *__pyx_v_self, PyObject *__pyx_arg_max); /*proto*/
 static char __pyx_doc_4liba_3pid_10pos[] = "positional PID controller";
 static PyObject *__pyx_pw_4liba_3pid_11pos(PyObject *__pyx_v_self, PyObject *__pyx_arg_max) {
   a_real_t __pyx_v_max;
@@ -6764,56 +7099,56 @@
 }
 
 static PyObject *__pyx_pf_4liba_3pid_10pos(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_max) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("pos", 0);
 
-  /* "ffi/python/src/a/pid.pxi":33
+  /* "python/src/a/pid.pxi":33
  *     def pos(self, max: a_real_t):
  *         '''positional PID controller'''
- *         a_pid_pos(self.ctx, max)             # <<<<<<<<<<<<<<
+ *         a_pid_pos(&self.ctx, max)             # <<<<<<<<<<<<<<
  *         return self
  *     def inc(self):
  */
-  (void)(a_pid_pos(__pyx_v_self->ctx, __pyx_v_max));
+  (void)(a_pid_pos((&__pyx_v_self->ctx), __pyx_v_max));
 
-  /* "ffi/python/src/a/pid.pxi":34
+  /* "python/src/a/pid.pxi":34
  *         '''positional PID controller'''
- *         a_pid_pos(self.ctx, max)
+ *         a_pid_pos(&self.ctx, max)
  *         return self             # <<<<<<<<<<<<<<
  *     def inc(self):
  *         '''incremental PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":31
- *         a_pid_kpid(self.ctx, kp, ki, kd)
+  /* "python/src/a/pid.pxi":31
+ *         a_pid_kpid(&self.ctx, kp, ki, kd)
  *         return self
  *     def pos(self, max: a_real_t):             # <<<<<<<<<<<<<<
  *         '''positional PID controller'''
- *         a_pid_pos(self.ctx, max)
+ *         a_pid_pos(&self.ctx, max)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":35
- *         a_pid_pos(self.ctx, max)
+/* "python/src/a/pid.pxi":35
+ *         a_pid_pos(&self.ctx, max)
  *         return self
  *     def inc(self):             # <<<<<<<<<<<<<<
  *         '''incremental PID controller'''
- *         a_pid_inc(self.ctx)
+ *         a_pid_inc(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_13inc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_3pid_12inc[] = "incremental PID controller";
 static PyObject *__pyx_pw_4liba_3pid_13inc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -6827,56 +7162,56 @@
 }
 
 static PyObject *__pyx_pf_4liba_3pid_12inc(struct __pyx_obj_4liba_pid *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("inc", 0);
 
-  /* "ffi/python/src/a/pid.pxi":37
+  /* "python/src/a/pid.pxi":37
  *     def inc(self):
  *         '''incremental PID controller'''
- *         a_pid_inc(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_pid_inc(&self.ctx)             # <<<<<<<<<<<<<<
  *         return self
  *     def off(self):
  */
-  (void)(a_pid_inc(__pyx_v_self->ctx));
+  (void)(a_pid_inc((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/pid.pxi":38
+  /* "python/src/a/pid.pxi":38
  *         '''incremental PID controller'''
- *         a_pid_inc(self.ctx)
+ *         a_pid_inc(&self.ctx)
  *         return self             # <<<<<<<<<<<<<<
  *     def off(self):
  *         '''turn off PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":35
- *         a_pid_pos(self.ctx, max)
+  /* "python/src/a/pid.pxi":35
+ *         a_pid_pos(&self.ctx, max)
  *         return self
  *     def inc(self):             # <<<<<<<<<<<<<<
  *         '''incremental PID controller'''
- *         a_pid_inc(self.ctx)
+ *         a_pid_inc(&self.ctx)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":39
- *         a_pid_inc(self.ctx)
+/* "python/src/a/pid.pxi":39
+ *         a_pid_inc(&self.ctx)
  *         return self
  *     def off(self):             # <<<<<<<<<<<<<<
  *         '''turn off PID controller'''
- *         a_pid_off(self.ctx)
+ *         a_pid_off(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_15off(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_3pid_14off[] = "turn off PID controller";
 static PyObject *__pyx_pw_4liba_3pid_15off(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -6890,51 +7225,51 @@
 }
 
 static PyObject *__pyx_pf_4liba_3pid_14off(struct __pyx_obj_4liba_pid *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("off", 0);
 
-  /* "ffi/python/src/a/pid.pxi":41
+  /* "python/src/a/pid.pxi":41
  *     def off(self):
  *         '''turn off PID controller'''
- *         a_pid_off(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_pid_off(&self.ctx)             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
-  (void)(a_pid_off(__pyx_v_self->ctx));
+  (void)(a_pid_off((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/pid.pxi":42
+  /* "python/src/a/pid.pxi":42
  *         '''turn off PID controller'''
- *         a_pid_off(self.ctx)
+ *         a_pid_off(&self.ctx)
  *         return self             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":39
- *         a_pid_inc(self.ctx)
+  /* "python/src/a/pid.pxi":39
+ *         a_pid_inc(&self.ctx)
  *         return self
  *     def off(self):             # <<<<<<<<<<<<<<
  *         '''turn off PID controller'''
- *         a_pid_off(self.ctx)
+ *         a_pid_off(&self.ctx)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":45
+/* "python/src/a/pid.pxi":45
  * 
  *     @property
  *     def outmin(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.outmin
  *     @outmin.setter
  */
 
@@ -6956,29 +7291,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":46
+  /* "python/src/a/pid.pxi":46
  *     @property
  *     def outmin(self) -> a_real_t:
  *         return self.ctx.outmin             # <<<<<<<<<<<<<<
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->outmin); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 46, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.outmin); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 46, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":45
+  /* "python/src/a/pid.pxi":45
  * 
  *     @property
  *     def outmin(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.outmin
  *     @outmin.setter
  */
 
@@ -6989,15 +7324,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":48
+/* "python/src/a/pid.pxi":48
  *         return self.ctx.outmin
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.outmin = outmin
  * 
  */
 
@@ -7028,38 +7363,38 @@
 }
 
 static int __pyx_pf_4liba_3pid_6outmin_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_outmin) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":49
+  /* "python/src/a/pid.pxi":49
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):
  *         self.ctx.outmin = outmin             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->outmin = __pyx_v_outmin;
+  __pyx_v_self->ctx.outmin = __pyx_v_outmin;
 
-  /* "ffi/python/src/a/pid.pxi":48
+  /* "python/src/a/pid.pxi":48
  *         return self.ctx.outmin
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.outmin = outmin
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":52
+/* "python/src/a/pid.pxi":52
  * 
  *     @property
  *     def outmax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.outmax
  *     @outmax.setter
  */
 
@@ -7081,29 +7416,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":53
+  /* "python/src/a/pid.pxi":53
  *     @property
  *     def outmax(self) -> a_real_t:
  *         return self.ctx.outmax             # <<<<<<<<<<<<<<
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->outmax); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 53, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.outmax); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 53, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":52
+  /* "python/src/a/pid.pxi":52
  * 
  *     @property
  *     def outmax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.outmax
  *     @outmax.setter
  */
 
@@ -7114,15 +7449,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":55
+/* "python/src/a/pid.pxi":55
  *         return self.ctx.outmax
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.outmax = outmax
  * 
  */
 
@@ -7153,38 +7488,38 @@
 }
 
 static int __pyx_pf_4liba_3pid_6outmax_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_outmax) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":56
+  /* "python/src/a/pid.pxi":56
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):
  *         self.ctx.outmax = outmax             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->outmax = __pyx_v_outmax;
+  __pyx_v_self->ctx.outmax = __pyx_v_outmax;
 
-  /* "ffi/python/src/a/pid.pxi":55
+  /* "python/src/a/pid.pxi":55
  *         return self.ctx.outmax
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.outmax = outmax
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":59
+/* "python/src/a/pid.pxi":59
  * 
  *     @property
  *     def summax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.summax
  *     @summax.setter
  */
 
@@ -7206,29 +7541,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":60
+  /* "python/src/a/pid.pxi":60
  *     @property
  *     def summax(self) -> a_real_t:
  *         return self.ctx.summax             # <<<<<<<<<<<<<<
  *     @summax.setter
  *     def summax(self, summax: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->summax); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 60, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.summax); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 60, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":59
+  /* "python/src/a/pid.pxi":59
  * 
  *     @property
  *     def summax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.summax
  *     @summax.setter
  */
 
@@ -7239,15 +7574,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":62
+/* "python/src/a/pid.pxi":62
  *         return self.ctx.summax
  *     @summax.setter
  *     def summax(self, summax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.summax = summax
  * 
  */
 
@@ -7278,42 +7613,42 @@
 }
 
 static int __pyx_pf_4liba_3pid_6summax_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_summax) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":63
+  /* "python/src/a/pid.pxi":63
  *     @summax.setter
  *     def summax(self, summax: a_real_t):
  *         self.ctx.summax = summax             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->summax = __pyx_v_summax;
+  __pyx_v_self->ctx.summax = __pyx_v_summax;
 
-  /* "ffi/python/src/a/pid.pxi":62
+  /* "python/src/a/pid.pxi":62
  *         return self.ctx.summax
  *     @summax.setter
  *     def summax(self, summax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.summax = summax
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":66
+/* "python/src/a/pid.pxi":66
  * 
  *     @property
  *     def mode(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_pid_mode(self.ctx)
+ *         return a_pid_mode(&self.ctx)
  *     @mode.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_4mode_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_3pid_4mode_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -7331,52 +7666,52 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":67
+  /* "python/src/a/pid.pxi":67
  *     @property
  *     def mode(self) -> a_uint_t:
- *         return a_pid_mode(self.ctx)             # <<<<<<<<<<<<<<
+ *         return a_pid_mode(&self.ctx)             # <<<<<<<<<<<<<<
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_pid_mode(__pyx_v_self->ctx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 67, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_pid_mode((&__pyx_v_self->ctx))); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 67, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":66
+  /* "python/src/a/pid.pxi":66
  * 
  *     @property
  *     def mode(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_pid_mode(self.ctx)
+ *         return a_pid_mode(&self.ctx)
  *     @mode.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.pid.mode.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":69
- *         return a_pid_mode(self.ctx)
+/* "python/src/a/pid.pxi":69
+ *         return a_pid_mode(&self.ctx)
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_mode(self.ctx, mode)
+ *         a_pid_set_mode(&self.ctx, mode)
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_3pid_4mode_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_mode); /*proto*/
 static int __pyx_pw_4liba_3pid_4mode_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_mode) {
   a_uint_t __pyx_v_mode;
@@ -7403,42 +7738,42 @@
 }
 
 static int __pyx_pf_4liba_3pid_4mode_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_uint_t __pyx_v_mode) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":70
+  /* "python/src/a/pid.pxi":70
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):
- *         a_pid_set_mode(self.ctx, mode)             # <<<<<<<<<<<<<<
+ *         a_pid_set_mode(&self.ctx, mode)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_pid_set_mode(__pyx_v_self->ctx, __pyx_v_mode);
+  a_pid_set_mode((&__pyx_v_self->ctx), __pyx_v_mode);
 
-  /* "ffi/python/src/a/pid.pxi":69
- *         return a_pid_mode(self.ctx)
+  /* "python/src/a/pid.pxi":69
+ *         return a_pid_mode(&self.ctx)
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_mode(self.ctx, mode)
+ *         a_pid_set_mode(&self.ctx, mode)
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":73
+/* "python/src/a/pid.pxi":73
  * 
  *     @property
  *     def dt(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_dt(self.ctx)
+ *         return a_pid_dt(&self.ctx)
  *     @dt.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_2dt_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_3pid_2dt_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -7456,52 +7791,52 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":74
+  /* "python/src/a/pid.pxi":74
  *     @property
  *     def dt(self) -> a_real_t:
- *         return a_pid_dt(self.ctx)             # <<<<<<<<<<<<<<
+ *         return a_pid_dt(&self.ctx)             # <<<<<<<<<<<<<<
  *     @dt.setter
  *     def dt(self, dt: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_pid_dt(__pyx_v_self->ctx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 74, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_pid_dt((&__pyx_v_self->ctx))); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 74, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":73
+  /* "python/src/a/pid.pxi":73
  * 
  *     @property
  *     def dt(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_dt(self.ctx)
+ *         return a_pid_dt(&self.ctx)
  *     @dt.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.pid.dt.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":76
- *         return a_pid_dt(self.ctx)
+/* "python/src/a/pid.pxi":76
+ *         return a_pid_dt(&self.ctx)
  *     @dt.setter
  *     def dt(self, dt: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_dt(self.ctx, dt)
+ *         a_pid_set_dt(&self.ctx, dt)
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_3pid_2dt_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_dt); /*proto*/
 static int __pyx_pw_4liba_3pid_2dt_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_dt) {
   a_real_t __pyx_v_dt;
@@ -7528,42 +7863,42 @@
 }
 
 static int __pyx_pf_4liba_3pid_2dt_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_dt) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":77
+  /* "python/src/a/pid.pxi":77
  *     @dt.setter
  *     def dt(self, dt: a_real_t):
- *         a_pid_set_dt(self.ctx, dt)             # <<<<<<<<<<<<<<
+ *         a_pid_set_dt(&self.ctx, dt)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_pid_set_dt(__pyx_v_self->ctx, __pyx_v_dt);
+  a_pid_set_dt((&__pyx_v_self->ctx), __pyx_v_dt);
 
-  /* "ffi/python/src/a/pid.pxi":76
- *         return a_pid_dt(self.ctx)
+  /* "python/src/a/pid.pxi":76
+ *         return a_pid_dt(&self.ctx)
  *     @dt.setter
  *     def dt(self, dt: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_dt(self.ctx, dt)
+ *         a_pid_set_dt(&self.ctx, dt)
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":80
+/* "python/src/a/pid.pxi":80
  * 
  *     @property
  *     def kp(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_kp(self.ctx)
+ *         return a_pid_kp(&self.ctx)
  *     @kp.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_2kp_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_3pid_2kp_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -7581,52 +7916,52 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":81
+  /* "python/src/a/pid.pxi":81
  *     @property
  *     def kp(self) -> a_real_t:
- *         return a_pid_kp(self.ctx)             # <<<<<<<<<<<<<<
+ *         return a_pid_kp(&self.ctx)             # <<<<<<<<<<<<<<
  *     @kp.setter
  *     def kp(self, kp: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_pid_kp(__pyx_v_self->ctx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 81, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_pid_kp((&__pyx_v_self->ctx))); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 81, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":80
+  /* "python/src/a/pid.pxi":80
  * 
  *     @property
  *     def kp(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_kp(self.ctx)
+ *         return a_pid_kp(&self.ctx)
  *     @kp.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.pid.kp.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":83
- *         return a_pid_kp(self.ctx)
+/* "python/src/a/pid.pxi":83
+ *         return a_pid_kp(&self.ctx)
  *     @kp.setter
  *     def kp(self, kp: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_kp(self.ctx, kp)
+ *         a_pid_set_kp(&self.ctx, kp)
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_3pid_2kp_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_kp); /*proto*/
 static int __pyx_pw_4liba_3pid_2kp_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_kp) {
   a_real_t __pyx_v_kp;
@@ -7653,42 +7988,42 @@
 }
 
 static int __pyx_pf_4liba_3pid_2kp_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_kp) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":84
+  /* "python/src/a/pid.pxi":84
  *     @kp.setter
  *     def kp(self, kp: a_real_t):
- *         a_pid_set_kp(self.ctx, kp)             # <<<<<<<<<<<<<<
+ *         a_pid_set_kp(&self.ctx, kp)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_pid_set_kp(__pyx_v_self->ctx, __pyx_v_kp);
+  a_pid_set_kp((&__pyx_v_self->ctx), __pyx_v_kp);
 
-  /* "ffi/python/src/a/pid.pxi":83
- *         return a_pid_kp(self.ctx)
+  /* "python/src/a/pid.pxi":83
+ *         return a_pid_kp(&self.ctx)
  *     @kp.setter
  *     def kp(self, kp: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_kp(self.ctx, kp)
+ *         a_pid_set_kp(&self.ctx, kp)
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":87
+/* "python/src/a/pid.pxi":87
  * 
  *     @property
  *     def ki(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_ki(self.ctx)
+ *         return a_pid_ki(&self.ctx)
  *     @ki.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_2ki_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_3pid_2ki_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -7706,52 +8041,52 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":88
+  /* "python/src/a/pid.pxi":88
  *     @property
  *     def ki(self) -> a_real_t:
- *         return a_pid_ki(self.ctx)             # <<<<<<<<<<<<<<
+ *         return a_pid_ki(&self.ctx)             # <<<<<<<<<<<<<<
  *     @ki.setter
  *     def ki(self, ki: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_pid_ki(__pyx_v_self->ctx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 88, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_pid_ki((&__pyx_v_self->ctx))); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 88, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":87
+  /* "python/src/a/pid.pxi":87
  * 
  *     @property
  *     def ki(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_ki(self.ctx)
+ *         return a_pid_ki(&self.ctx)
  *     @ki.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.pid.ki.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":90
- *         return a_pid_ki(self.ctx)
+/* "python/src/a/pid.pxi":90
+ *         return a_pid_ki(&self.ctx)
  *     @ki.setter
  *     def ki(self, ki: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_ki(self.ctx, ki)
+ *         a_pid_set_ki(&self.ctx, ki)
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_3pid_2ki_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_ki); /*proto*/
 static int __pyx_pw_4liba_3pid_2ki_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_ki) {
   a_real_t __pyx_v_ki;
@@ -7778,42 +8113,42 @@
 }
 
 static int __pyx_pf_4liba_3pid_2ki_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_ki) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":91
+  /* "python/src/a/pid.pxi":91
  *     @ki.setter
  *     def ki(self, ki: a_real_t):
- *         a_pid_set_ki(self.ctx, ki)             # <<<<<<<<<<<<<<
+ *         a_pid_set_ki(&self.ctx, ki)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_pid_set_ki(__pyx_v_self->ctx, __pyx_v_ki);
+  a_pid_set_ki((&__pyx_v_self->ctx), __pyx_v_ki);
 
-  /* "ffi/python/src/a/pid.pxi":90
- *         return a_pid_ki(self.ctx)
+  /* "python/src/a/pid.pxi":90
+ *         return a_pid_ki(&self.ctx)
  *     @ki.setter
  *     def ki(self, ki: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_ki(self.ctx, ki)
+ *         a_pid_set_ki(&self.ctx, ki)
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":94
+/* "python/src/a/pid.pxi":94
  * 
  *     @property
  *     def kd(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_kd(self.ctx)
+ *         return a_pid_kd(&self.ctx)
  *     @kd.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_3pid_2kd_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_3pid_2kd_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -7831,52 +8166,52 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":95
+  /* "python/src/a/pid.pxi":95
  *     @property
  *     def kd(self) -> a_real_t:
- *         return a_pid_kd(self.ctx)             # <<<<<<<<<<<<<<
+ *         return a_pid_kd(&self.ctx)             # <<<<<<<<<<<<<<
  *     @kd.setter
  *     def kd(self, kd: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_pid_kd(__pyx_v_self->ctx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 95, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_pid_kd((&__pyx_v_self->ctx))); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 95, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":94
+  /* "python/src/a/pid.pxi":94
  * 
  *     @property
  *     def kd(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_kd(self.ctx)
+ *         return a_pid_kd(&self.ctx)
  *     @kd.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.pid.kd.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":97
- *         return a_pid_kd(self.ctx)
+/* "python/src/a/pid.pxi":97
+ *         return a_pid_kd(&self.ctx)
  *     @kd.setter
  *     def kd(self, kd: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_kd(self.ctx, kd)
+ *         a_pid_set_kd(&self.ctx, kd)
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_3pid_2kd_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_kd); /*proto*/
 static int __pyx_pw_4liba_3pid_2kd_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_kd) {
   a_real_t __pyx_v_kd;
@@ -7903,38 +8238,38 @@
 }
 
 static int __pyx_pf_4liba_3pid_2kd_2__set__(struct __pyx_obj_4liba_pid *__pyx_v_self, a_real_t __pyx_v_kd) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":98
+  /* "python/src/a/pid.pxi":98
  *     @kd.setter
  *     def kd(self, kd: a_real_t):
- *         a_pid_set_kd(self.ctx, kd)             # <<<<<<<<<<<<<<
+ *         a_pid_set_kd(&self.ctx, kd)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_pid_set_kd(__pyx_v_self->ctx, __pyx_v_kd);
+  a_pid_set_kd((&__pyx_v_self->ctx), __pyx_v_kd);
 
-  /* "ffi/python/src/a/pid.pxi":97
- *         return a_pid_kd(self.ctx)
+  /* "python/src/a/pid.pxi":97
+ *         return a_pid_kd(&self.ctx)
  *     @kd.setter
  *     def kd(self, kd: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_kd(self.ctx, kd)
+ *         a_pid_set_kd(&self.ctx, kd)
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":101
+/* "python/src/a/pid.pxi":101
  * 
  *     @property
  *     def out(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.out.v
  *     @property
  */
 
@@ -7956,29 +8291,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":102
+  /* "python/src/a/pid.pxi":102
  *     @property
  *     def out(self) -> a_real_t:
  *         return self.ctx.out.v             # <<<<<<<<<<<<<<
  *     @property
  *     def fdb(self) -> a_real_t:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->out.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 102, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.out.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":101
+  /* "python/src/a/pid.pxi":101
  * 
  *     @property
  *     def out(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.out.v
  *     @property
  */
 
@@ -7989,15 +8324,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":104
+/* "python/src/a/pid.pxi":104
  *         return self.ctx.out.v
  *     @property
  *     def fdb(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.fdb.v
  *     @property
  */
 
@@ -8019,29 +8354,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":105
+  /* "python/src/a/pid.pxi":105
  *     @property
  *     def fdb(self) -> a_real_t:
  *         return self.ctx.fdb.v             # <<<<<<<<<<<<<<
  *     @property
  *     def ec(self) -> a_real_t:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->fdb.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 105, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.fdb.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 105, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":104
+  /* "python/src/a/pid.pxi":104
  *         return self.ctx.out.v
  *     @property
  *     def fdb(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.fdb.v
  *     @property
  */
 
@@ -8052,15 +8387,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":107
+/* "python/src/a/pid.pxi":107
  *         return self.ctx.fdb.v
  *     @property
  *     def ec(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.ec.v
  *     @property
  */
 
@@ -8082,29 +8417,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":108
+  /* "python/src/a/pid.pxi":108
  *     @property
  *     def ec(self) -> a_real_t:
  *         return self.ctx.ec.v             # <<<<<<<<<<<<<<
  *     @property
  *     def e(self) -> a_real_t:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->ec.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 108, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.ec.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":107
+  /* "python/src/a/pid.pxi":107
  *         return self.ctx.fdb.v
  *     @property
  *     def ec(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.ec.v
  *     @property
  */
 
@@ -8115,15 +8450,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/pid.pxi":110
+/* "python/src/a/pid.pxi":110
  *         return self.ctx.ec.v
  *     @property
  *     def e(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.e.v
  */
 
 /* Python wrapper */
@@ -8144,27 +8479,27 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/pid.pxi":111
+  /* "python/src/a/pid.pxi":111
  *     @property
  *     def e(self) -> a_real_t:
  *         return self.ctx.e.v             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->e.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 111, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.e.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/pid.pxi":110
+  /* "python/src/a/pid.pxi":110
  *         return self.ctx.ec.v
  *     @property
  *     def e(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.e.v
  */
 
   /* function exit code */
@@ -8287,51 +8622,48 @@
   __Pyx_AddTraceback("liba.pid.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":14
+/* "python/src/a/fpid.pxi":15
  *     cdef array mki
  *     cdef array mkd
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):             # <<<<<<<<<<<<<<
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_4fpid_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_pw_4liba_4fpid_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_uint_t __pyx_v_num;
   a_real_t __pyx_v_dt;
-  PyObject *__pyx_v_mmp = 0;
+  PyObject *__pyx_v_me = 0;
+  PyObject *__pyx_v_mec = 0;
   PyObject *__pyx_v_mkp = 0;
   PyObject *__pyx_v_mki = 0;
   PyObject *__pyx_v_mkd = 0;
-  a_real_t __pyx_v_imin;
-  a_real_t __pyx_v_imax;
-  a_real_t __pyx_v_omin;
-  a_real_t __pyx_v_omax;
+  a_real_t __pyx_v_min;
+  a_real_t __pyx_v_max;
   a_real_t __pyx_v_sum;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_num,&__pyx_n_s_dt,&__pyx_n_s_mmp,&__pyx_n_s_mkp,&__pyx_n_s_mki,&__pyx_n_s_mkd,&__pyx_n_s_imin,&__pyx_n_s_imax,&__pyx_n_s_omin,&__pyx_n_s_omax,&__pyx_n_s_sum,0};
-    PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_num,&__pyx_n_s_dt,&__pyx_n_s_me,&__pyx_n_s_mec,&__pyx_n_s_mkp,&__pyx_n_s_mki,&__pyx_n_s_mkd,&__pyx_n_s_min,&__pyx_n_s_max,&__pyx_n_s_sum,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
-        CYTHON_FALLTHROUGH;
         case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
         CYTHON_FALLTHROUGH;
         case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
         case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
         CYTHON_FALLTHROUGH;
         case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
@@ -8356,153 +8688,145 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dt)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 1); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 1); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mmp)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_me)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 2); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 2); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkp)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 3); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 3); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
-        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mki)) != 0)) kw_args--;
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkp)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 4); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 4); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
-        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkd)) != 0)) kw_args--;
+        if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mki)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 5); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 5); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
-        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_imin)) != 0)) kw_args--;
+        if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkd)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 6); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 6); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_imax)) != 0)) kw_args--;
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_min)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 7); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 7); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_omin)) != 0)) kw_args--;
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_max)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 8); __PYX_ERR(7, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, 8); __PYX_ERR(7, 15, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_omax)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, 9); __PYX_ERR(7, 14, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case 10:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sum);
-          if (value) { values[10] = value; kw_args--; }
+          if (value) { values[9] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(7, 14, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(7, 15, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
-        case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
-        CYTHON_FALLTHROUGH;
         case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-        values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
         values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
         values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_num = __Pyx_PyInt_As_a_uint_t(values[0]); if (unlikely((__pyx_v_num == ((a_uint_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 14, __pyx_L3_error)
-    __pyx_v_dt = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_dt == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 14, __pyx_L3_error)
-    __pyx_v_mmp = values[2];
-    __pyx_v_mkp = values[3];
-    __pyx_v_mki = values[4];
-    __pyx_v_mkd = values[5];
-    __pyx_v_imin = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_imin == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 14, __pyx_L3_error)
-    __pyx_v_imax = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_imax == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 14, __pyx_L3_error)
-    __pyx_v_omin = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_omin == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 14, __pyx_L3_error)
-    __pyx_v_omax = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_omax == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 14, __pyx_L3_error)
-    if (values[10]) {
-      __pyx_v_sum = __pyx_PyFloat_AsDouble(values[10]); if (unlikely((__pyx_v_sum == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 14, __pyx_L3_error)
+    __pyx_v_num = __Pyx_PyInt_As_a_uint_t(values[0]); if (unlikely((__pyx_v_num == ((a_uint_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 15, __pyx_L3_error)
+    __pyx_v_dt = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_dt == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 15, __pyx_L3_error)
+    __pyx_v_me = values[2];
+    __pyx_v_mec = values[3];
+    __pyx_v_mkp = values[4];
+    __pyx_v_mki = values[5];
+    __pyx_v_mkd = values[6];
+    __pyx_v_min = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_min == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 15, __pyx_L3_error)
+    __pyx_v_max = __pyx_PyFloat_AsDouble(values[8]); if (unlikely((__pyx_v_max == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 15, __pyx_L3_error)
+    if (values[9]) {
+      __pyx_v_sum = __pyx_PyFloat_AsDouble(values[9]); if (unlikely((__pyx_v_sum == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 15, __pyx_L3_error)
     } else {
       __pyx_v_sum = ((a_real_t)0.0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 10, 11, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 14, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 9, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 15, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_4fpid___cinit__(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_num, __pyx_v_dt, __pyx_v_mmp, __pyx_v_mkp, __pyx_v_mki, __pyx_v_mkd, __pyx_v_imin, __pyx_v_imax, __pyx_v_omin, __pyx_v_omax, __pyx_v_sum);
+  __pyx_r = __pyx_pf_4liba_4fpid___cinit__(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_num, __pyx_v_dt, __pyx_v_me, __pyx_v_mec, __pyx_v_mkp, __pyx_v_mki, __pyx_v_mkd, __pyx_v_min, __pyx_v_max, __pyx_v_sum);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_4liba_4fpid_9__cinit___2generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":15
+/* "python/src/a/fpid.pxi":16
  *     cdef array mkd
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):
- *         self.mmp = reals((i for j in mmp for i in j))             # <<<<<<<<<<<<<<
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):
+ *         self.me = reals((i for j in me for i in j))             # <<<<<<<<<<<<<<
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
  */
 
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_4liba___pyx_scope_struct_1_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_1_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_1_genexpr(__pyx_ptype_4liba___pyx_scope_struct_1_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_1_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 15, __pyx_L1_error)
+    __PYX_ERR(7, 16, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___2generator, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 15, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___2generator, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 16, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -8534,93 +8858,93 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 15, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp)) { __Pyx_RaiseClosureNameError("mmp"); __PYX_ERR(7, 15, __pyx_L1_error) }
-  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp)) {
-    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 16, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me)) { __Pyx_RaiseClosureNameError("me"); __PYX_ERR(7, 16, __pyx_L1_error) }
+  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me)) {
+    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_me; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 15, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 16, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 15, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 16, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 15, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 15, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 16, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 15, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 15, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 16, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 15, __pyx_L1_error)
+          else __PYX_ERR(7, 16, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 15, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 16, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 15, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 16, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 15, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 15, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 16, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 15, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 15, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 16, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 15, __pyx_L1_error)
+            else __PYX_ERR(7, 16, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -8649,15 +8973,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 15, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 16, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -8676,43 +9000,43 @@
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_4liba_4fpid_9__cinit___5generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":16
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
+/* "python/src/a/fpid.pxi":17
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))
- *         self.mkd = reals((i for j in mkd for i in j))
  */
 
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___3genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_4liba___pyx_scope_struct_2_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_2_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_2_genexpr(__pyx_ptype_4liba___pyx_scope_struct_2_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_2_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 16, __pyx_L1_error)
+    __PYX_ERR(7, 17, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___5generator1, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 16, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___5generator1, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 17, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -8744,93 +9068,93 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 16, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) { __Pyx_RaiseClosureNameError("mkp"); __PYX_ERR(7, 16, __pyx_L1_error) }
-  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) {
-    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 17, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec)) { __Pyx_RaiseClosureNameError("mec"); __PYX_ERR(7, 17, __pyx_L1_error) }
+  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec)) {
+    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 16, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 17, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 16, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 17, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 16, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 16, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 17, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 16, __pyx_L1_error)
+          else __PYX_ERR(7, 17, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 16, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 17, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 16, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 17, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 16, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 17, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 16, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 16, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 17, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 16, __pyx_L1_error)
+            else __PYX_ERR(7, 17, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -8859,15 +9183,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 16, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 17, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -8886,43 +9210,43 @@
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_4liba_4fpid_9__cinit___8generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":17
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
+/* "python/src/a/fpid.pxi":18
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
+ *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
+ *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
  */
 
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___6genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_4liba___pyx_scope_struct_3_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_3_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_3_genexpr(__pyx_ptype_4liba___pyx_scope_struct_3_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_3_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 17, __pyx_L1_error)
+    __PYX_ERR(7, 18, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___8generator2, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 17, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___8generator2, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 18, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -8954,93 +9278,93 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 17, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) { __Pyx_RaiseClosureNameError("mki"); __PYX_ERR(7, 17, __pyx_L1_error) }
-  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) {
-    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 18, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) { __Pyx_RaiseClosureNameError("mkp"); __PYX_ERR(7, 18, __pyx_L1_error) }
+  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) {
+    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 17, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 18, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 17, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 18, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 17, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 18, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 17, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 18, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 17, __pyx_L1_error)
+          else __PYX_ERR(7, 18, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 17, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 18, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 17, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 18, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 17, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 18, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 17, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 17, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 18, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 17, __pyx_L1_error)
+            else __PYX_ERR(7, 18, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -9069,15 +9393,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 17, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 18, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -9096,43 +9420,43 @@
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_4liba_4fpid_9__cinit___11generator3(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":18
+/* "python/src/a/fpid.pxi":19
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
- *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
- *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkd = reals((i for j in mkd for i in j))
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
  */
 
 static PyObject *__pyx_pf_4liba_4fpid_9__cinit___9genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_4liba___pyx_scope_struct_4_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_4_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_4_genexpr(__pyx_ptype_4liba___pyx_scope_struct_4_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_4_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 18, __pyx_L1_error)
+    __PYX_ERR(7, 19, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___11generator3, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 18, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___11generator3, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 19, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -9164,93 +9488,303 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 18, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) { __Pyx_RaiseClosureNameError("mkd"); __PYX_ERR(7, 18, __pyx_L1_error) }
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 19, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) { __Pyx_RaiseClosureNameError("mki"); __PYX_ERR(7, 19, __pyx_L1_error) }
+  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) {
+    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
+    __pyx_t_3 = NULL;
+  } else {
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 19, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 19, __pyx_L1_error)
+  }
+  for (;;) {
+    if (likely(!__pyx_t_3)) {
+      if (likely(PyList_CheckExact(__pyx_t_1))) {
+        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
+        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 19, __pyx_L1_error)
+        #else
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        #endif
+      } else {
+        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 19, __pyx_L1_error)
+        #else
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 19, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        #endif
+      }
+    } else {
+      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
+      if (unlikely(!__pyx_t_4)) {
+        PyObject* exc_type = PyErr_Occurred();
+        if (exc_type) {
+          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+          else __PYX_ERR(7, 19, __pyx_L1_error)
+        }
+        break;
+      }
+      __Pyx_GOTREF(__pyx_t_4);
+    }
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_4);
+    __pyx_t_4 = 0;
+    if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
+      __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
+      __pyx_t_6 = NULL;
+    } else {
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 19, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 19, __pyx_L1_error)
+    }
+    for (;;) {
+      if (likely(!__pyx_t_6)) {
+        if (likely(PyList_CheckExact(__pyx_t_4))) {
+          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 19, __pyx_L1_error)
+          #else
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 19, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
+          #endif
+        } else {
+          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 19, __pyx_L1_error)
+          #else
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 19, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
+          #endif
+        }
+      } else {
+        __pyx_t_7 = __pyx_t_6(__pyx_t_4);
+        if (unlikely(!__pyx_t_7)) {
+          PyObject* exc_type = PyErr_Occurred();
+          if (exc_type) {
+            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+            else __PYX_ERR(7, 19, __pyx_L1_error)
+          }
+          break;
+        }
+        __Pyx_GOTREF(__pyx_t_7);
+      }
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
+      __Pyx_GIVEREF(__pyx_t_7);
+      __pyx_t_7 = 0;
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_i);
+      __pyx_r = __pyx_cur_scope->__pyx_v_i;
+      __Pyx_XGIVEREF(__pyx_t_1);
+      __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
+      __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
+      __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
+      __Pyx_XGIVEREF(__pyx_t_4);
+      __pyx_cur_scope->__pyx_t_3 = __pyx_t_4;
+      __pyx_cur_scope->__pyx_t_4 = __pyx_t_5;
+      __pyx_cur_scope->__pyx_t_5 = __pyx_t_6;
+      __Pyx_XGIVEREF(__pyx_r);
+      __Pyx_RefNannyFinishContext();
+      __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+      /* return from generator, yielding value */
+      __pyx_generator->resume_label = 1;
+      return __pyx_r;
+      __pyx_L8_resume_from_yield:;
+      __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
+      __pyx_cur_scope->__pyx_t_0 = 0;
+      __Pyx_XGOTREF(__pyx_t_1);
+      __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
+      __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
+      __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
+      __pyx_cur_scope->__pyx_t_3 = 0;
+      __Pyx_XGOTREF(__pyx_t_4);
+      __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
+      __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 19, __pyx_L1_error)
+    }
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  }
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
+
+  /* function exit code */
+  PyErr_SetNone(PyExc_StopIteration);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_AddTraceback("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
+  #if !CYTHON_USE_EXC_INFO_STACK
+  __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+  #endif
+  __pyx_generator->resume_label = -1;
+  __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+static PyObject *__pyx_gb_4liba_4fpid_9__cinit___14generator4(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+
+/* "python/src/a/fpid.pxi":20
+ *         self.mkp = reals((i for j in mkp for i in j))
+ *         self.mki = reals((i for j in mki for i in j))
+ *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
+ */
+
+static PyObject *__pyx_pf_4liba_4fpid_9__cinit___12genexpr(PyObject *__pyx_self) {
+  struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *__pyx_cur_scope;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("genexpr", 0);
+  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_5_genexpr(__pyx_ptype_4liba___pyx_scope_struct_5_genexpr, __pyx_empty_tuple, NULL);
+  if (unlikely(!__pyx_cur_scope)) {
+    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *)Py_None);
+    __Pyx_INCREF(Py_None);
+    __PYX_ERR(7, 20, __pyx_L1_error)
+  } else {
+    __Pyx_GOTREF(__pyx_cur_scope);
+  }
+  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *) __pyx_self;
+  __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
+  {
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_9__cinit___14generator4, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_cinit___locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 20, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_cur_scope);
+    __Pyx_RefNannyFinishContext();
+    return (PyObject *) gen;
+  }
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("liba.fpid.__cinit__.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_gb_4liba_4fpid_9__cinit___14generator4(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+{
+  struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *)__pyx_generator->closure);
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  Py_ssize_t __pyx_t_2;
+  PyObject *(*__pyx_t_3)(PyObject *);
+  PyObject *__pyx_t_4 = NULL;
+  Py_ssize_t __pyx_t_5;
+  PyObject *(*__pyx_t_6)(PyObject *);
+  PyObject *__pyx_t_7 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("genexpr", 0);
+  switch (__pyx_generator->resume_label) {
+    case 0: goto __pyx_L3_first_run;
+    case 1: goto __pyx_L8_resume_from_yield;
+    default: /* CPython raises the right error here */
+    __Pyx_RefNannyFinishContext();
+    return NULL;
+  }
+  __pyx_L3_first_run:;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 20, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) { __Pyx_RaiseClosureNameError("mkd"); __PYX_ERR(7, 20, __pyx_L1_error) }
   if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) {
     __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 18, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 20, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 18, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 20, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 20, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 18, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 20, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 20, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 18, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 20, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 18, __pyx_L1_error)
+          else __PYX_ERR(7, 20, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 18, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 20, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 18, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 20, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 20, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 18, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 20, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 18, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 20, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 18, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 20, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 18, __pyx_L1_error)
+            else __PYX_ERR(7, 20, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -9279,15 +9813,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 18, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 20, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -9305,32 +9839,34 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":14
+/* "python/src/a/fpid.pxi":15
  *     cdef array mki
  *     cdef array mkd
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):             # <<<<<<<<<<<<<<
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
  */
 
-static int __pyx_pf_4liba_4fpid___cinit__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_uint_t __pyx_v_num, a_real_t __pyx_v_dt, PyObject *__pyx_v_mmp, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd, a_real_t __pyx_v_imin, a_real_t __pyx_v_imax, a_real_t __pyx_v_omin, a_real_t __pyx_v_omax, a_real_t __pyx_v_sum) {
+static int __pyx_pf_4liba_4fpid___cinit__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_uint_t __pyx_v_num, a_real_t __pyx_v_dt, PyObject *__pyx_v_me, PyObject *__pyx_v_mec, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd, a_real_t __pyx_v_min, a_real_t __pyx_v_max, a_real_t __pyx_v_sum) {
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *__pyx_cur_scope;
-  a_real_t *__pyx_v_mp;
+  a_real_t *__pyx_v_e;
+  a_real_t *__pyx_v_ec;
   a_real_t *__pyx_v_kp;
   a_real_t *__pyx_v_ki;
   a_real_t *__pyx_v_kd;
   PyObject *__pyx_gb_4liba_4fpid_9__cinit___2generator = 0;
   PyObject *__pyx_gb_4liba_4fpid_9__cinit___5generator1 = 0;
   PyObject *__pyx_gb_4liba_4fpid_9__cinit___8generator2 = 0;
   PyObject *__pyx_gb_4liba_4fpid_9__cinit___11generator3 = 0;
+  PyObject *__pyx_gb_4liba_4fpid_9__cinit___14generator4 = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   struct __pyx_opt_args_4liba_reals __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   int __pyx_t_5;
@@ -9338,219 +9874,251 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
   __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *)__pyx_tp_new_4liba___pyx_scope_struct____cinit__(__pyx_ptype_4liba___pyx_scope_struct____cinit__, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 14, __pyx_L1_error)
+    __PYX_ERR(7, 15, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_v_mmp = __pyx_v_mmp;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mmp);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mmp);
+  __pyx_cur_scope->__pyx_v_me = __pyx_v_me;
+  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_me);
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_me);
+  __pyx_cur_scope->__pyx_v_mec = __pyx_v_mec;
+  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mec);
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mec);
   __pyx_cur_scope->__pyx_v_mkp = __pyx_v_mkp;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mkp);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mkp);
   __pyx_cur_scope->__pyx_v_mki = __pyx_v_mki;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mki);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mki);
   __pyx_cur_scope->__pyx_v_mkd = __pyx_v_mkd;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mkd);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mkd);
 
-  /* "ffi/python/src/a/fpid.pxi":15
+  /* "python/src/a/fpid.pxi":16
  *     cdef array mkd
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):
- *         self.mmp = reals((i for j in mmp for i in j))             # <<<<<<<<<<<<<<
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):
+ *         self.me = reals((i for j in me for i in j))             # <<<<<<<<<<<<<<
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
  */
-  __pyx_t_1 = __pyx_pf_4liba_4fpid_9__cinit___genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 15, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_4liba_4fpid_9__cinit___genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_1;
-  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 15, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
-  __Pyx_GOTREF(__pyx_v_self->mmp);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->mmp));
-  __pyx_v_self->mmp = ((arrayobject *)__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->me);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->me));
+  __pyx_v_self->me = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":16
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
+  /* "python/src/a/fpid.pxi":17
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))
- *         self.mkd = reals((i for j in mkd for i in j))
  */
-  __pyx_t_2 = __pyx_pf_4liba_4fpid_9__cinit___3genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 16, __pyx_L1_error)
+  __pyx_t_2 = __pyx_pf_4liba_4fpid_9__cinit___3genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_2;
-  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 16, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
-  __Pyx_GOTREF(__pyx_v_self->mkp);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->mkp));
-  __pyx_v_self->mkp = ((arrayobject *)__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->mec);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->mec));
+  __pyx_v_self->mec = ((arrayobject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":17
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
+  /* "python/src/a/fpid.pxi":18
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
+ *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
+ *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
  */
-  __pyx_t_1 = __pyx_pf_4liba_4fpid_9__cinit___6genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 17, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_4liba_4fpid_9__cinit___6genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 18, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_1;
-  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 17, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 18, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
-  __Pyx_GOTREF(__pyx_v_self->mki);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->mki));
-  __pyx_v_self->mki = ((arrayobject *)__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->mkp);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->mkp));
+  __pyx_v_self->mkp = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":18
+  /* "python/src/a/fpid.pxi":19
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
- *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
- *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkd = reals((i for j in mkd for i in j))
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
  */
-  __pyx_t_2 = __pyx_pf_4liba_4fpid_9__cinit___9genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 18, __pyx_L1_error)
+  __pyx_t_2 = __pyx_pf_4liba_4fpid_9__cinit___9genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_2;
-  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 18, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->mki);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->mki));
+  __pyx_v_self->mki = ((arrayobject *)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "python/src/a/fpid.pxi":20
+ *         self.mkp = reals((i for j in mkp for i in j))
+ *         self.mki = reals((i for j in mki for i in j))
+ *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
+ */
+  __pyx_t_1 = __pyx_pf_4liba_4fpid_9__cinit___12genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 20, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3.__pyx_n = 1;
+  __pyx_t_3.o = __pyx_t_1;
+  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 20, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->mkd);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->mkd));
-  __pyx_v_self->mkd = ((arrayobject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_v_self->mkd = ((arrayobject *)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":19
+  /* "python/src/a/fpid.pxi":21
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
- *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  */
-  __pyx_v_mp = ((a_real_t *)__pyx_v_self->mmp->data.as_voidptr);
+  __pyx_v_e = ((a_real_t *)__pyx_v_self->me->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":20
+  /* "python/src/a/fpid.pxi":22
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
+ */
+  __pyx_v_ec = ((a_real_t *)__pyx_v_self->mec->data.as_voidptr);
+
+  /* "python/src/a/fpid.pxi":23
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr             # <<<<<<<<<<<<<<
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
  */
   __pyx_v_kp = ((a_real_t *)__pyx_v_self->mkp->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":21
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+  /* "python/src/a/fpid.pxi":24
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr             # <<<<<<<<<<<<<<
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
- *         a_fpid_init(self.ctx, dt, <a_uint_t>len(mkp), mp, kp, ki, kd, imin, imax, omin, omax)
+ *         a_fpid_init(&self.ctx, dt, <a_uint_t>len(mkp), e, ec, kp, ki, kd, min, max)
  */
   __pyx_v_ki = ((a_real_t *)__pyx_v_self->mki->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":22
+  /* "python/src/a/fpid.pxi":25
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr             # <<<<<<<<<<<<<<
- *         a_fpid_init(self.ctx, dt, <a_uint_t>len(mkp), mp, kp, ki, kd, imin, imax, omin, omax)
+ *         a_fpid_init(&self.ctx, dt, <a_uint_t>len(mkp), e, ec, kp, ki, kd, min, max)
  *         if sum:
  */
   __pyx_v_kd = ((a_real_t *)__pyx_v_self->mkd->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":23
+  /* "python/src/a/fpid.pxi":26
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
- *         a_fpid_init(self.ctx, dt, <a_uint_t>len(mkp), mp, kp, ki, kd, imin, imax, omin, omax)             # <<<<<<<<<<<<<<
+ *         a_fpid_init(&self.ctx, dt, <a_uint_t>len(mkp), e, ec, kp, ki, kd, min, max)             # <<<<<<<<<<<<<<
  *         if sum:
- *             a_fpid_pos(self.ctx, sum)
+ *             a_fpid_pos(&self.ctx, sum)
  */
-  __pyx_t_1 = __pyx_cur_scope->__pyx_v_mkp;
-  __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(7, 23, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (void)(a_fpid_init(__pyx_v_self->ctx, __pyx_v_dt, ((a_uint_t)__pyx_t_4), __pyx_v_mp, __pyx_v_kp, __pyx_v_ki, __pyx_v_kd, __pyx_v_imin, __pyx_v_imax, __pyx_v_omin, __pyx_v_omax));
+  __pyx_t_2 = __pyx_cur_scope->__pyx_v_mkp;
+  __Pyx_INCREF(__pyx_t_2);
+  __pyx_t_4 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(7, 26, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  (void)(a_fpid_init((&__pyx_v_self->ctx), __pyx_v_dt, ((a_uint_t)__pyx_t_4), __pyx_v_e, __pyx_v_ec, __pyx_v_kp, __pyx_v_ki, __pyx_v_kd, __pyx_v_min, __pyx_v_max));
 
-  /* "ffi/python/src/a/fpid.pxi":24
+  /* "python/src/a/fpid.pxi":27
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
- *         a_fpid_init(self.ctx, dt, <a_uint_t>len(mkp), mp, kp, ki, kd, imin, imax, omin, omax)
+ *         a_fpid_init(&self.ctx, dt, <a_uint_t>len(mkp), e, ec, kp, ki, kd, min, max)
  *         if sum:             # <<<<<<<<<<<<<<
- *             a_fpid_pos(self.ctx, sum)
+ *             a_fpid_pos(&self.ctx, sum)
  *         else:
  */
   __pyx_t_5 = (__pyx_v_sum != 0);
   if (__pyx_t_5) {
 
-    /* "ffi/python/src/a/fpid.pxi":25
- *         a_fpid_init(self.ctx, dt, <a_uint_t>len(mkp), mp, kp, ki, kd, imin, imax, omin, omax)
+    /* "python/src/a/fpid.pxi":28
+ *         a_fpid_init(&self.ctx, dt, <a_uint_t>len(mkp), e, ec, kp, ki, kd, min, max)
  *         if sum:
- *             a_fpid_pos(self.ctx, sum)             # <<<<<<<<<<<<<<
+ *             a_fpid_pos(&self.ctx, sum)             # <<<<<<<<<<<<<<
  *         else:
- *             a_fpid_inc(self.ctx)
+ *             a_fpid_inc(&self.ctx)
  */
-    (void)(a_fpid_pos(__pyx_v_self->ctx, __pyx_v_sum));
+    (void)(a_fpid_pos((&__pyx_v_self->ctx), __pyx_v_sum));
 
-    /* "ffi/python/src/a/fpid.pxi":24
+    /* "python/src/a/fpid.pxi":27
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
- *         a_fpid_init(self.ctx, dt, <a_uint_t>len(mkp), mp, kp, ki, kd, imin, imax, omin, omax)
+ *         a_fpid_init(&self.ctx, dt, <a_uint_t>len(mkp), e, ec, kp, ki, kd, min, max)
  *         if sum:             # <<<<<<<<<<<<<<
- *             a_fpid_pos(self.ctx, sum)
+ *             a_fpid_pos(&self.ctx, sum)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "ffi/python/src/a/fpid.pxi":27
- *             a_fpid_pos(self.ctx, sum)
+  /* "python/src/a/fpid.pxi":30
+ *             a_fpid_pos(&self.ctx, sum)
  *         else:
- *             a_fpid_inc(self.ctx)             # <<<<<<<<<<<<<<
+ *             a_fpid_inc(&self.ctx)             # <<<<<<<<<<<<<<
  *         self.buf = num
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:
  */
   /*else*/ {
-    (void)(a_fpid_inc(__pyx_v_self->ctx));
+    (void)(a_fpid_inc((&__pyx_v_self->ctx)));
   }
   __pyx_L3:;
 
-  /* "ffi/python/src/a/fpid.pxi":28
+  /* "python/src/a/fpid.pxi":31
  *         else:
- *             a_fpid_inc(self.ctx)
+ *             a_fpid_inc(&self.ctx)
  *         self.buf = num             # <<<<<<<<<<<<<<
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:
- *         '''process function for fuzzy PID controller'''
+ *         '''calculate function for fuzzy PID controller'''
  */
-  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(__pyx_v_num); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 28, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_buf, __pyx_t_1) < 0) __PYX_ERR(7, 28, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_a_uint_t(__pyx_v_num); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 31, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_buf, __pyx_t_2) < 0) __PYX_ERR(7, 31, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":14
+  /* "python/src/a/fpid.pxi":15
  *     cdef array mki
  *     cdef array mkd
- *     def __cinit__(self, a_uint_t num, a_real_t dt, mmp, mkp, mki, mkd, a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax, a_real_t sum = 0):             # <<<<<<<<<<<<<<
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))
+ *     def __cinit__(self, a_uint_t num, a_real_t dt, me, mec, mkp, mki, mkd, a_real_t min, a_real_t max, a_real_t sum = 0):             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
  */
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -9558,31 +10126,32 @@
   __Pyx_AddTraceback("liba.fpid.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_gb_4liba_4fpid_9__cinit___2generator);
   __Pyx_XDECREF(__pyx_gb_4liba_4fpid_9__cinit___5generator1);
   __Pyx_XDECREF(__pyx_gb_4liba_4fpid_9__cinit___8generator2);
   __Pyx_XDECREF(__pyx_gb_4liba_4fpid_9__cinit___11generator3);
+  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_9__cinit___14generator4);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":29
- *             a_fpid_inc(self.ctx)
+/* "python/src/a/fpid.pxi":32
+ *             a_fpid_inc(&self.ctx)
  *         self.buf = num
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:             # <<<<<<<<<<<<<<
- *         '''process function for fuzzy PID controller'''
- *         return a_fpid_outv(self.ctx, set, fdb)
+ *         '''calculate function for fuzzy PID controller'''
+ *         return a_fpid_outv(&self.ctx, set, fdb)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_4liba_4fpid_2__call__[] = "process function for fuzzy PID controller";
-#if CYTHON_COMPILING_IN_CPYTHON
+static char __pyx_doc_4liba_4fpid_2__call__[] = "calculate function for fuzzy PID controller";
+#if CYTHON_UPDATE_DESCRIPTOR_DOC
 struct wrapperbase __pyx_wrapperbase_4liba_4fpid_2__call__;
 #endif
 static PyObject *__pyx_pw_4liba_4fpid_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_set;
   a_real_t __pyx_v_fdb;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -9609,32 +10178,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_set)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fdb)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__call__", 1, 2, 2, 1); __PYX_ERR(7, 29, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__call__", 1, 2, 2, 1); __PYX_ERR(7, 32, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") < 0)) __PYX_ERR(7, 29, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") < 0)) __PYX_ERR(7, 32, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_set = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_set == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 29, __pyx_L3_error)
-    __pyx_v_fdb = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_fdb == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 29, __pyx_L3_error)
+    __pyx_v_set = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_set == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 32, __pyx_L3_error)
+    __pyx_v_fdb = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_fdb == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 32, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__call__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 29, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__call__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 32, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_4liba_4fpid_2__call__(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_set, __pyx_v_fdb);
 
@@ -9648,53 +10217,53 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__call__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":31
+  /* "python/src/a/fpid.pxi":34
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:
- *         '''process function for fuzzy PID controller'''
- *         return a_fpid_outv(self.ctx, set, fdb)             # <<<<<<<<<<<<<<
+ *         '''calculate function for fuzzy PID controller'''
+ *         return a_fpid_outv(&self.ctx, set, fdb)             # <<<<<<<<<<<<<<
  *     def __dealloc__(self):
  *         '''terminate function for fuzzy PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_fpid_outv(__pyx_v_self->ctx, __pyx_v_set, __pyx_v_fdb)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 31, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_fpid_outv((&__pyx_v_self->ctx), __pyx_v_set, __pyx_v_fdb)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":29
- *             a_fpid_inc(self.ctx)
+  /* "python/src/a/fpid.pxi":32
+ *             a_fpid_inc(&self.ctx)
  *         self.buf = num
  *     def __call__(self, set: a_real_t, fdb: a_real_t) -> a_real_t:             # <<<<<<<<<<<<<<
- *         '''process function for fuzzy PID controller'''
- *         return a_fpid_outv(self.ctx, set, fdb)
+ *         '''calculate function for fuzzy PID controller'''
+ *         return a_fpid_outv(&self.ctx, set, fdb)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.fpid.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":32
- *         '''process function for fuzzy PID controller'''
- *         return a_fpid_outv(self.ctx, set, fdb)
+/* "python/src/a/fpid.pxi":35
+ *         '''calculate function for fuzzy PID controller'''
+ *         return a_fpid_outv(&self.ctx, set, fdb)
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         '''terminate function for fuzzy PID controller'''
- *         a_fpid_exit(self.ctx)
+ *         a_fpid_exit(&self.ctx)
  */
 
 /* Python wrapper */
 static void __pyx_pw_4liba_4fpid_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
 static void __pyx_pw_4liba_4fpid_5__dealloc__(PyObject *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
@@ -9704,50 +10273,50 @@
   __Pyx_RefNannyFinishContext();
 }
 
 static void __pyx_pf_4liba_4fpid_4__dealloc__(struct __pyx_obj_4liba_fpid *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":34
+  /* "python/src/a/fpid.pxi":37
  *     def __dealloc__(self):
  *         '''terminate function for fuzzy PID controller'''
- *         a_fpid_exit(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_fpid_exit(&self.ctx)             # <<<<<<<<<<<<<<
  *         PyMem_Free(self.ptr)
  *     def zero(self):
  */
-  (void)(a_fpid_exit(__pyx_v_self->ctx));
+  (void)(a_fpid_exit((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/fpid.pxi":35
+  /* "python/src/a/fpid.pxi":38
  *         '''terminate function for fuzzy PID controller'''
- *         a_fpid_exit(self.ctx)
+ *         a_fpid_exit(&self.ctx)
  *         PyMem_Free(self.ptr)             # <<<<<<<<<<<<<<
  *     def zero(self):
  *         '''zero function for fuzzy PID controller'''
  */
   PyMem_Free(__pyx_v_self->ptr);
 
-  /* "ffi/python/src/a/fpid.pxi":32
- *         '''process function for fuzzy PID controller'''
- *         return a_fpid_outv(self.ctx, set, fdb)
+  /* "python/src/a/fpid.pxi":35
+ *         '''calculate function for fuzzy PID controller'''
+ *         return a_fpid_outv(&self.ctx, set, fdb)
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         '''terminate function for fuzzy PID controller'''
- *         a_fpid_exit(self.ctx)
+ *         a_fpid_exit(&self.ctx)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "ffi/python/src/a/fpid.pxi":36
- *         a_fpid_exit(self.ctx)
+/* "python/src/a/fpid.pxi":39
+ *         a_fpid_exit(&self.ctx)
  *         PyMem_Free(self.ptr)
  *     def zero(self):             # <<<<<<<<<<<<<<
  *         '''zero function for fuzzy PID controller'''
- *         a_fpid_zero(self.ctx)
+ *         a_fpid_zero(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_7zero(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_4fpid_6zero[] = "zero function for fuzzy PID controller";
 static PyObject *__pyx_pw_4liba_4fpid_7zero(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -9761,175 +10330,186 @@
 }
 
 static PyObject *__pyx_pf_4liba_4fpid_6zero(struct __pyx_obj_4liba_fpid *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("zero", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":38
+  /* "python/src/a/fpid.pxi":41
  *     def zero(self):
  *         '''zero function for fuzzy PID controller'''
- *         a_fpid_zero(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_fpid_zero(&self.ctx)             # <<<<<<<<<<<<<<
  *         return self
- *     def base(self, mmp, mkp, mki, mkd):
+ *     def base(self, me, mec, mkp, mki, mkd):
  */
-  (void)(a_fpid_zero(__pyx_v_self->ctx));
+  (void)(a_fpid_zero((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/fpid.pxi":39
+  /* "python/src/a/fpid.pxi":42
  *         '''zero function for fuzzy PID controller'''
- *         a_fpid_zero(self.ctx)
+ *         a_fpid_zero(&self.ctx)
  *         return self             # <<<<<<<<<<<<<<
- *     def base(self, mmp, mkp, mki, mkd):
+ *     def base(self, me, mec, mkp, mki, mkd):
  *         '''set rule base for fuzzy PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":36
- *         a_fpid_exit(self.ctx)
+  /* "python/src/a/fpid.pxi":39
+ *         a_fpid_exit(&self.ctx)
  *         PyMem_Free(self.ptr)
  *     def zero(self):             # <<<<<<<<<<<<<<
  *         '''zero function for fuzzy PID controller'''
- *         a_fpid_zero(self.ctx)
+ *         a_fpid_zero(&self.ctx)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":40
- *         a_fpid_zero(self.ctx)
+/* "python/src/a/fpid.pxi":43
+ *         a_fpid_zero(&self.ctx)
  *         return self
- *     def base(self, mmp, mkp, mki, mkd):             # <<<<<<<<<<<<<<
+ *     def base(self, me, mec, mkp, mki, mkd):             # <<<<<<<<<<<<<<
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))
+ *         self.me = reals((i for j in me for i in j))
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_9base(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_4liba_4fpid_8base[] = "set rule base for fuzzy PID controller";
 static PyObject *__pyx_pw_4liba_4fpid_9base(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_mmp = 0;
+  PyObject *__pyx_v_me = 0;
+  PyObject *__pyx_v_mec = 0;
   PyObject *__pyx_v_mkp = 0;
   PyObject *__pyx_v_mki = 0;
   PyObject *__pyx_v_mkd = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("base (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_mmp,&__pyx_n_s_mkp,&__pyx_n_s_mki,&__pyx_n_s_mkd,0};
-    PyObject* values[4] = {0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_me,&__pyx_n_s_mec,&__pyx_n_s_mkp,&__pyx_n_s_mki,&__pyx_n_s_mkd,0};
+    PyObject* values[5] = {0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mmp)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_me)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkp)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("base", 1, 4, 4, 1); __PYX_ERR(7, 40, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("base", 1, 5, 5, 1); __PYX_ERR(7, 43, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mki)) != 0)) kw_args--;
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkp)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("base", 1, 4, 4, 2); __PYX_ERR(7, 40, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("base", 1, 5, 5, 2); __PYX_ERR(7, 43, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkd)) != 0)) kw_args--;
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mki)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("base", 1, 5, 5, 3); __PYX_ERR(7, 43, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mkd)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("base", 1, 4, 4, 3); __PYX_ERR(7, 40, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("base", 1, 5, 5, 4); __PYX_ERR(7, 43, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "base") < 0)) __PYX_ERR(7, 40, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "base") < 0)) __PYX_ERR(7, 43, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
     }
-    __pyx_v_mmp = values[0];
-    __pyx_v_mkp = values[1];
-    __pyx_v_mki = values[2];
-    __pyx_v_mkd = values[3];
+    __pyx_v_me = values[0];
+    __pyx_v_mec = values[1];
+    __pyx_v_mkp = values[2];
+    __pyx_v_mki = values[3];
+    __pyx_v_mkd = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("base", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 40, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("base", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 43, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_4fpid_8base(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_mmp, __pyx_v_mkp, __pyx_v_mki, __pyx_v_mkd);
+  __pyx_r = __pyx_pf_4liba_4fpid_8base(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_me, __pyx_v_mec, __pyx_v_mkp, __pyx_v_mki, __pyx_v_mkd);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_4liba_4fpid_4base_2generator4(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_4liba_4fpid_4base_2generator5(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":42
- *     def base(self, mmp, mkp, mki, mkd):
+/* "python/src/a/fpid.pxi":45
+ *     def base(self, me, mec, mkp, mki, mkd):
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))             # <<<<<<<<<<<<<<
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
  */
 
 static PyObject *__pyx_pf_4liba_4fpid_4base_genexpr(PyObject *__pyx_self) {
-  struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *__pyx_cur_scope;
+  struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
-  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_6_genexpr(__pyx_ptype_4liba___pyx_scope_struct_6_genexpr, __pyx_empty_tuple, NULL);
+  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_7_genexpr(__pyx_ptype_4liba___pyx_scope_struct_7_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 42, __pyx_L1_error)
+    __PYX_ERR(7, 45, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *) __pyx_self;
+  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_2generator4, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 42, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_2generator5, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 45, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -9937,17 +10517,17 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_4liba_4fpid_4base_2generator4(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_4liba_4fpid_4base_2generator5(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
-  struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *)__pyx_generator->closure);
+  struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   PyObject *(*__pyx_t_3)(PyObject *);
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
@@ -9961,93 +10541,93 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 42, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp)) { __Pyx_RaiseClosureNameError("mmp"); __PYX_ERR(7, 42, __pyx_L1_error) }
-  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp)) {
-    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 45, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me)) { __Pyx_RaiseClosureNameError("me"); __PYX_ERR(7, 45, __pyx_L1_error) }
+  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me)) {
+    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_me; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mmp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 42, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_me); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 45, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 42, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 45, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 42, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 42, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 45, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 42, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 42, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 45, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 42, __pyx_L1_error)
+          else __PYX_ERR(7, 45, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 42, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 45, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 42, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 45, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 42, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 42, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 45, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 42, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 42, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 45, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 42, __pyx_L1_error)
+            else __PYX_ERR(7, 45, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -10076,15 +10656,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 42, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 45, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -10101,45 +10681,255 @@
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_4liba_4fpid_4base_5generator5(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_4liba_4fpid_4base_5generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":43
+/* "python/src/a/fpid.pxi":46
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkp = reals((i for j in mkp for i in j))
+ *         self.mki = reals((i for j in mki for i in j))
+ */
+
+static PyObject *__pyx_pf_4liba_4fpid_4base_3genexpr(PyObject *__pyx_self) {
+  struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *__pyx_cur_scope;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("genexpr", 0);
+  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_8_genexpr(__pyx_ptype_4liba___pyx_scope_struct_8_genexpr, __pyx_empty_tuple, NULL);
+  if (unlikely(!__pyx_cur_scope)) {
+    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *)Py_None);
+    __Pyx_INCREF(Py_None);
+    __PYX_ERR(7, 46, __pyx_L1_error)
+  } else {
+    __Pyx_GOTREF(__pyx_cur_scope);
+  }
+  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *) __pyx_self;
+  __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
+  {
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_5generator6, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 46, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_cur_scope);
+    __Pyx_RefNannyFinishContext();
+    return (PyObject *) gen;
+  }
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("liba.fpid.base.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_gb_4liba_4fpid_4base_5generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+{
+  struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *)__pyx_generator->closure);
+  PyObject *__pyx_r = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  Py_ssize_t __pyx_t_2;
+  PyObject *(*__pyx_t_3)(PyObject *);
+  PyObject *__pyx_t_4 = NULL;
+  Py_ssize_t __pyx_t_5;
+  PyObject *(*__pyx_t_6)(PyObject *);
+  PyObject *__pyx_t_7 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("genexpr", 0);
+  switch (__pyx_generator->resume_label) {
+    case 0: goto __pyx_L3_first_run;
+    case 1: goto __pyx_L8_resume_from_yield;
+    default: /* CPython raises the right error here */
+    __Pyx_RefNannyFinishContext();
+    return NULL;
+  }
+  __pyx_L3_first_run:;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 46, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec)) { __Pyx_RaiseClosureNameError("mec"); __PYX_ERR(7, 46, __pyx_L1_error) }
+  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec)) {
+    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
+    __pyx_t_3 = NULL;
+  } else {
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mec); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 46, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 46, __pyx_L1_error)
+  }
+  for (;;) {
+    if (likely(!__pyx_t_3)) {
+      if (likely(PyList_CheckExact(__pyx_t_1))) {
+        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
+        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 46, __pyx_L1_error)
+        #else
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 46, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        #endif
+      } else {
+        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 46, __pyx_L1_error)
+        #else
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 46, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        #endif
+      }
+    } else {
+      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
+      if (unlikely(!__pyx_t_4)) {
+        PyObject* exc_type = PyErr_Occurred();
+        if (exc_type) {
+          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+          else __PYX_ERR(7, 46, __pyx_L1_error)
+        }
+        break;
+      }
+      __Pyx_GOTREF(__pyx_t_4);
+    }
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_4);
+    __pyx_t_4 = 0;
+    if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
+      __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
+      __pyx_t_6 = NULL;
+    } else {
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 46, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 46, __pyx_L1_error)
+    }
+    for (;;) {
+      if (likely(!__pyx_t_6)) {
+        if (likely(PyList_CheckExact(__pyx_t_4))) {
+          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 46, __pyx_L1_error)
+          #else
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 46, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
+          #endif
+        } else {
+          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 46, __pyx_L1_error)
+          #else
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 46, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
+          #endif
+        }
+      } else {
+        __pyx_t_7 = __pyx_t_6(__pyx_t_4);
+        if (unlikely(!__pyx_t_7)) {
+          PyObject* exc_type = PyErr_Occurred();
+          if (exc_type) {
+            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+            else __PYX_ERR(7, 46, __pyx_L1_error)
+          }
+          break;
+        }
+        __Pyx_GOTREF(__pyx_t_7);
+      }
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
+      __Pyx_GIVEREF(__pyx_t_7);
+      __pyx_t_7 = 0;
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_i);
+      __pyx_r = __pyx_cur_scope->__pyx_v_i;
+      __Pyx_XGIVEREF(__pyx_t_1);
+      __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
+      __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
+      __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
+      __Pyx_XGIVEREF(__pyx_t_4);
+      __pyx_cur_scope->__pyx_t_3 = __pyx_t_4;
+      __pyx_cur_scope->__pyx_t_4 = __pyx_t_5;
+      __pyx_cur_scope->__pyx_t_5 = __pyx_t_6;
+      __Pyx_XGIVEREF(__pyx_r);
+      __Pyx_RefNannyFinishContext();
+      __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+      /* return from generator, yielding value */
+      __pyx_generator->resume_label = 1;
+      return __pyx_r;
+      __pyx_L8_resume_from_yield:;
+      __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
+      __pyx_cur_scope->__pyx_t_0 = 0;
+      __Pyx_XGOTREF(__pyx_t_1);
+      __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
+      __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
+      __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
+      __pyx_cur_scope->__pyx_t_3 = 0;
+      __Pyx_XGOTREF(__pyx_t_4);
+      __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
+      __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 46, __pyx_L1_error)
+    }
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  }
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
+
+  /* function exit code */
+  PyErr_SetNone(PyExc_StopIteration);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_AddTraceback("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
+  #if !CYTHON_USE_EXC_INFO_STACK
+  __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+  #endif
+  __pyx_generator->resume_label = -1;
+  __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+static PyObject *__pyx_gb_4liba_4fpid_4base_8generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+
+/* "python/src/a/fpid.pxi":47
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
  */
 
-static PyObject *__pyx_pf_4liba_4fpid_4base_3genexpr(PyObject *__pyx_self) {
-  struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *__pyx_cur_scope;
+static PyObject *__pyx_pf_4liba_4fpid_4base_6genexpr(PyObject *__pyx_self) {
+  struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
-  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_7_genexpr(__pyx_ptype_4liba___pyx_scope_struct_7_genexpr, __pyx_empty_tuple, NULL);
+  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_9_genexpr(__pyx_ptype_4liba___pyx_scope_struct_9_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 43, __pyx_L1_error)
+    __PYX_ERR(7, 47, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *) __pyx_self;
+  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_5generator5, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 43, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_8generator7, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 47, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -10147,17 +10937,17 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_4liba_4fpid_4base_5generator5(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_4liba_4fpid_4base_8generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
-  struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_7_genexpr *)__pyx_generator->closure);
+  struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   PyObject *(*__pyx_t_3)(PyObject *);
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
@@ -10171,93 +10961,93 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 43, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) { __Pyx_RaiseClosureNameError("mkp"); __PYX_ERR(7, 43, __pyx_L1_error) }
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 47, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) { __Pyx_RaiseClosureNameError("mkp"); __PYX_ERR(7, 47, __pyx_L1_error) }
   if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp)) {
     __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 43, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 47, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 43, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 47, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 43, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 47, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 43, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 47, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 43, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 47, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 43, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 47, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 43, __pyx_L1_error)
+          else __PYX_ERR(7, 47, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 43, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 47, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 43, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 47, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 43, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 47, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 43, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 47, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 43, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 47, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 43, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 47, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 43, __pyx_L1_error)
+            else __PYX_ERR(7, 47, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -10286,15 +11076,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 43, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 47, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -10311,45 +11101,45 @@
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_4liba_4fpid_4base_8generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_4liba_4fpid_4base_11generator8(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":44
- *         self.mmp = reals((i for j in mmp for i in j))
+/* "python/src/a/fpid.pxi":48
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
  */
 
-static PyObject *__pyx_pf_4liba_4fpid_4base_6genexpr(PyObject *__pyx_self) {
-  struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *__pyx_cur_scope;
+static PyObject *__pyx_pf_4liba_4fpid_4base_9genexpr(PyObject *__pyx_self) {
+  struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
-  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_8_genexpr(__pyx_ptype_4liba___pyx_scope_struct_8_genexpr, __pyx_empty_tuple, NULL);
+  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_10_genexpr(__pyx_ptype_4liba___pyx_scope_struct_10_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 44, __pyx_L1_error)
+    __PYX_ERR(7, 48, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *) __pyx_self;
+  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_8generator6, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 44, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_11generator8, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 48, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -10357,17 +11147,17 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_4liba_4fpid_4base_8generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_4liba_4fpid_4base_11generator8(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
-  struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_8_genexpr *)__pyx_generator->closure);
+  struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   PyObject *(*__pyx_t_3)(PyObject *);
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
@@ -10381,93 +11171,93 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 44, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) { __Pyx_RaiseClosureNameError("mki"); __PYX_ERR(7, 44, __pyx_L1_error) }
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 48, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) { __Pyx_RaiseClosureNameError("mki"); __PYX_ERR(7, 48, __pyx_L1_error) }
   if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki)) {
     __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 44, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mki); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 48, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 44, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 48, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 44, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 48, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 44, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 48, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 44, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 48, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 44, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 48, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 44, __pyx_L1_error)
+          else __PYX_ERR(7, 48, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 44, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 48, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 44, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 48, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 44, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 48, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 44, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 48, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 44, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 48, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 44, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 48, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 44, __pyx_L1_error)
+            else __PYX_ERR(7, 48, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -10496,15 +11286,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 44, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 48, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -10521,45 +11311,45 @@
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_4liba_4fpid_4base_11generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_4liba_4fpid_4base_14generator9(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "ffi/python/src/a/fpid.pxi":45
+/* "python/src/a/fpid.pxi":49
  *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
- *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  */
 
-static PyObject *__pyx_pf_4liba_4fpid_4base_9genexpr(PyObject *__pyx_self) {
-  struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *__pyx_cur_scope;
+static PyObject *__pyx_pf_4liba_4fpid_4base_12genexpr(PyObject *__pyx_self) {
+  struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
-  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_9_genexpr(__pyx_ptype_4liba___pyx_scope_struct_9_genexpr, __pyx_empty_tuple, NULL);
+  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *)__pyx_tp_new_4liba___pyx_scope_struct_11_genexpr(__pyx_ptype_4liba___pyx_scope_struct_11_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 45, __pyx_L1_error)
+    __PYX_ERR(7, 49, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *) __pyx_self;
+  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_11generator7, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 45, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_4liba_4fpid_4base_14generator9, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_base_locals_genexpr, __pyx_n_s_liba); if (unlikely(!gen)) __PYX_ERR(7, 49, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -10567,17 +11357,17 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_4liba_4fpid_4base_11generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_4liba_4fpid_4base_14generator9(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
-  struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_9_genexpr *)__pyx_generator->closure);
+  struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *__pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   PyObject *(*__pyx_t_3)(PyObject *);
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
@@ -10591,93 +11381,93 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L8_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 45, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) { __Pyx_RaiseClosureNameError("mkd"); __PYX_ERR(7, 45, __pyx_L1_error) }
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 49, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) { __Pyx_RaiseClosureNameError("mkd"); __PYX_ERR(7, 49, __pyx_L1_error) }
   if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd)) {
     __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 45, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_mkd); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 49, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 45, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(7, 49, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 49, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 45, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 49, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(7, 49, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 45, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 49, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(7, 45, __pyx_L1_error)
+          else __PYX_ERR(7, 49, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_j)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_j)) {
       __pyx_t_4 = __pyx_cur_scope->__pyx_v_j; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 45, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(7, 49, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 45, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(7, 49, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 49, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 45, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 49, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 45, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(7, 49, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 45, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(7, 49, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(7, 45, __pyx_L1_error)
+            else __PYX_ERR(7, 49, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_7);
@@ -10706,15 +11496,15 @@
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
       __pyx_cur_scope->__pyx_t_3 = 0;
       __Pyx_XGOTREF(__pyx_t_4);
       __pyx_t_5 = __pyx_cur_scope->__pyx_t_4;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_5;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 45, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(7, 49, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
@@ -10732,235 +11522,270 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":40
- *         a_fpid_zero(self.ctx)
+/* "python/src/a/fpid.pxi":43
+ *         a_fpid_zero(&self.ctx)
  *         return self
- *     def base(self, mmp, mkp, mki, mkd):             # <<<<<<<<<<<<<<
+ *     def base(self, me, mec, mkp, mki, mkd):             # <<<<<<<<<<<<<<
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))
+ *         self.me = reals((i for j in me for i in j))
  */
 
-static PyObject *__pyx_pf_4liba_4fpid_8base(struct __pyx_obj_4liba_fpid *__pyx_v_self, PyObject *__pyx_v_mmp, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd) {
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *__pyx_cur_scope;
-  a_real_t *__pyx_v_mp;
+static PyObject *__pyx_pf_4liba_4fpid_8base(struct __pyx_obj_4liba_fpid *__pyx_v_self, PyObject *__pyx_v_me, PyObject *__pyx_v_mec, PyObject *__pyx_v_mkp, PyObject *__pyx_v_mki, PyObject *__pyx_v_mkd) {
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *__pyx_cur_scope;
+  a_real_t *__pyx_v_e;
+  a_real_t *__pyx_v_ec;
   a_real_t *__pyx_v_kp;
   a_real_t *__pyx_v_ki;
   a_real_t *__pyx_v_kd;
-  PyObject *__pyx_gb_4liba_4fpid_4base_2generator4 = 0;
-  PyObject *__pyx_gb_4liba_4fpid_4base_5generator5 = 0;
-  PyObject *__pyx_gb_4liba_4fpid_4base_8generator6 = 0;
-  PyObject *__pyx_gb_4liba_4fpid_4base_11generator7 = 0;
+  PyObject *__pyx_gb_4liba_4fpid_4base_2generator5 = 0;
+  PyObject *__pyx_gb_4liba_4fpid_4base_5generator6 = 0;
+  PyObject *__pyx_gb_4liba_4fpid_4base_8generator7 = 0;
+  PyObject *__pyx_gb_4liba_4fpid_4base_11generator8 = 0;
+  PyObject *__pyx_gb_4liba_4fpid_4base_14generator9 = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   struct __pyx_opt_args_4liba_reals __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("base", 0);
-  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *)__pyx_tp_new_4liba___pyx_scope_struct_5_base(__pyx_ptype_4liba___pyx_scope_struct_5_base, __pyx_empty_tuple, NULL);
+  __pyx_cur_scope = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *)__pyx_tp_new_4liba___pyx_scope_struct_6_base(__pyx_ptype_4liba___pyx_scope_struct_6_base, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_5_base *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_4liba___pyx_scope_struct_6_base *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(7, 40, __pyx_L1_error)
+    __PYX_ERR(7, 43, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_v_mmp = __pyx_v_mmp;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mmp);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mmp);
+  __pyx_cur_scope->__pyx_v_me = __pyx_v_me;
+  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_me);
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_me);
+  __pyx_cur_scope->__pyx_v_mec = __pyx_v_mec;
+  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mec);
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mec);
   __pyx_cur_scope->__pyx_v_mkp = __pyx_v_mkp;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mkp);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mkp);
   __pyx_cur_scope->__pyx_v_mki = __pyx_v_mki;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mki);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mki);
   __pyx_cur_scope->__pyx_v_mkd = __pyx_v_mkd;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mkd);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mkd);
 
-  /* "ffi/python/src/a/fpid.pxi":42
- *     def base(self, mmp, mkp, mki, mkd):
+  /* "python/src/a/fpid.pxi":45
+ *     def base(self, me, mec, mkp, mki, mkd):
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))             # <<<<<<<<<<<<<<
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
  */
-  __pyx_t_1 = __pyx_pf_4liba_4fpid_4base_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 42, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_4liba_4fpid_4base_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 45, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_1;
-  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 42, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 45, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
-  __Pyx_GOTREF(__pyx_v_self->mmp);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->mmp));
-  __pyx_v_self->mmp = ((arrayobject *)__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->me);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->me));
+  __pyx_v_self->me = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":43
+  /* "python/src/a/fpid.pxi":46
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkp = reals((i for j in mkp for i in j))
  *         self.mki = reals((i for j in mki for i in j))
- *         self.mkd = reals((i for j in mkd for i in j))
  */
-  __pyx_t_2 = __pyx_pf_4liba_4fpid_4base_3genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 43, __pyx_L1_error)
+  __pyx_t_2 = __pyx_pf_4liba_4fpid_4base_3genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 46, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_2;
-  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 43, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 46, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
-  __Pyx_GOTREF(__pyx_v_self->mkp);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->mkp));
-  __pyx_v_self->mkp = ((arrayobject *)__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->mec);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->mec));
+  __pyx_v_self->mec = ((arrayobject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":44
- *         self.mmp = reals((i for j in mmp for i in j))
- *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
+  /* "python/src/a/fpid.pxi":47
+ *         self.me = reals((i for j in me for i in j))
+ *         self.mec = reals((i for j in mec for i in j))
+ *         self.mkp = reals((i for j in mkp for i in j))             # <<<<<<<<<<<<<<
+ *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
  */
-  __pyx_t_1 = __pyx_pf_4liba_4fpid_4base_6genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 44, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_4liba_4fpid_4base_6genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 47, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_1;
-  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 44, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 47, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
-  __Pyx_GOTREF(__pyx_v_self->mki);
-  __Pyx_DECREF(((PyObject *)__pyx_v_self->mki));
-  __pyx_v_self->mki = ((arrayobject *)__pyx_t_2);
+  __Pyx_GOTREF(__pyx_v_self->mkp);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->mkp));
+  __pyx_v_self->mkp = ((arrayobject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":45
+  /* "python/src/a/fpid.pxi":48
+ *         self.mec = reals((i for j in mec for i in j))
  *         self.mkp = reals((i for j in mkp for i in j))
- *         self.mki = reals((i for j in mki for i in j))
- *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
- *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         self.mki = reals((i for j in mki for i in j))             # <<<<<<<<<<<<<<
+ *         self.mkd = reals((i for j in mkd for i in j))
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
  */
-  __pyx_t_2 = __pyx_pf_4liba_4fpid_4base_9genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 45, __pyx_L1_error)
+  __pyx_t_2 = __pyx_pf_4liba_4fpid_4base_9genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 48, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3.__pyx_n = 1;
   __pyx_t_3.o = __pyx_t_2;
-  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 45, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 48, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
+  __Pyx_GOTREF(__pyx_v_self->mki);
+  __Pyx_DECREF(((PyObject *)__pyx_v_self->mki));
+  __pyx_v_self->mki = ((arrayobject *)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "python/src/a/fpid.pxi":49
+ *         self.mkp = reals((i for j in mkp for i in j))
+ *         self.mki = reals((i for j in mki for i in j))
+ *         self.mkd = reals((i for j in mkd for i in j))             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
+ */
+  __pyx_t_1 = __pyx_pf_4liba_4fpid_4base_12genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3.__pyx_n = 1;
+  __pyx_t_3.o = __pyx_t_1;
+  __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(7, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->mkd);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->mkd));
-  __pyx_v_self->mkd = ((arrayobject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_v_self->mkd = ((arrayobject *)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/fpid.pxi":46
+  /* "python/src/a/fpid.pxi":50
  *         self.mki = reals((i for j in mki for i in j))
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
- *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  */
-  __pyx_v_mp = ((a_real_t *)__pyx_v_self->mmp->data.as_voidptr);
+  __pyx_v_e = ((a_real_t *)__pyx_v_self->me->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":47
+  /* "python/src/a/fpid.pxi":51
  *         self.mkd = reals((i for j in mkd for i in j))
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr             # <<<<<<<<<<<<<<
+ *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
+ *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
+ */
+  __pyx_v_ec = ((a_real_t *)__pyx_v_self->mec->data.as_voidptr);
+
+  /* "python/src/a/fpid.pxi":52
+ *         cdef a_real_t *e = <a_real_t *>self.me.data.as_voidptr
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr             # <<<<<<<<<<<<<<
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
  */
   __pyx_v_kp = ((a_real_t *)__pyx_v_self->mkp->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":48
- *         cdef a_real_t *mp = <a_real_t *>self.mmp.data.as_voidptr
+  /* "python/src/a/fpid.pxi":53
+ *         cdef a_real_t *ec = <a_real_t *>self.mec.data.as_voidptr
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr             # <<<<<<<<<<<<<<
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
- *         a_fpid_base(self.ctx, <a_uint_t>len(mkp), mp, kp, ki, kd)
+ *         a_fpid_base(&self.ctx, <a_uint_t>len(mkp), e, ec, kp, ki, kd)
  */
   __pyx_v_ki = ((a_real_t *)__pyx_v_self->mki->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":49
+  /* "python/src/a/fpid.pxi":54
  *         cdef a_real_t *kp = <a_real_t *>self.mkp.data.as_voidptr
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr             # <<<<<<<<<<<<<<
- *         a_fpid_base(self.ctx, <a_uint_t>len(mkp), mp, kp, ki, kd)
+ *         a_fpid_base(&self.ctx, <a_uint_t>len(mkp), e, ec, kp, ki, kd)
  *         return self
  */
   __pyx_v_kd = ((a_real_t *)__pyx_v_self->mkd->data.as_voidptr);
 
-  /* "ffi/python/src/a/fpid.pxi":50
+  /* "python/src/a/fpid.pxi":55
  *         cdef a_real_t *ki = <a_real_t *>self.mki.data.as_voidptr
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
- *         a_fpid_base(self.ctx, <a_uint_t>len(mkp), mp, kp, ki, kd)             # <<<<<<<<<<<<<<
+ *         a_fpid_base(&self.ctx, <a_uint_t>len(mkp), e, ec, kp, ki, kd)             # <<<<<<<<<<<<<<
  *         return self
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
  */
-  __pyx_t_1 = __pyx_cur_scope->__pyx_v_mkp;
-  __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(7, 50, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (void)(a_fpid_base(__pyx_v_self->ctx, ((a_uint_t)__pyx_t_4), __pyx_v_mp, __pyx_v_kp, __pyx_v_ki, __pyx_v_kd));
+  __pyx_t_2 = __pyx_cur_scope->__pyx_v_mkp;
+  __Pyx_INCREF(__pyx_t_2);
+  __pyx_t_4 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(7, 55, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  (void)(a_fpid_base((&__pyx_v_self->ctx), ((a_uint_t)__pyx_t_4), __pyx_v_e, __pyx_v_ec, __pyx_v_kp, __pyx_v_ki, __pyx_v_kd));
 
-  /* "ffi/python/src/a/fpid.pxi":51
+  /* "python/src/a/fpid.pxi":56
  *         cdef a_real_t *kd = <a_real_t *>self.mkd.data.as_voidptr
- *         a_fpid_base(self.ctx, <a_uint_t>len(mkp), mp, kp, ki, kd)
+ *         a_fpid_base(&self.ctx, <a_uint_t>len(mkp), e, ec, kp, ki, kd)
  *         return self             # <<<<<<<<<<<<<<
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
  *         '''set proportional integral derivative constant for fuzzy PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":40
- *         a_fpid_zero(self.ctx)
+  /* "python/src/a/fpid.pxi":43
+ *         a_fpid_zero(&self.ctx)
  *         return self
- *     def base(self, mmp, mkp, mki, mkd):             # <<<<<<<<<<<<<<
+ *     def base(self, me, mec, mkp, mki, mkd):             # <<<<<<<<<<<<<<
  *         '''set rule base for fuzzy PID controller'''
- *         self.mmp = reals((i for j in mmp for i in j))
+ *         self.me = reals((i for j in me for i in j))
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("liba.fpid.base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_2generator4);
-  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_5generator5);
-  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_8generator6);
-  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_11generator7);
+  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_2generator5);
+  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_5generator6);
+  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_8generator7);
+  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_11generator8);
+  __Pyx_XDECREF(__pyx_gb_4liba_4fpid_4base_14generator9);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":52
- *         a_fpid_base(self.ctx, <a_uint_t>len(mkp), mp, kp, ki, kd)
+/* "python/src/a/fpid.pxi":57
+ *         a_fpid_base(&self.ctx, <a_uint_t>len(mkp), e, ec, kp, ki, kd)
  *         return self
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):             # <<<<<<<<<<<<<<
  *         '''set proportional integral derivative constant for fuzzy PID controller'''
- *         a_fpid_kpid(self.ctx, kp, ki, kd)
+ *         a_fpid_kpid(&self.ctx, kp, ki, kd)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_11kpid(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_4liba_4fpid_10kpid[] = "set proportional integral derivative constant for fuzzy PID controller";
 static PyObject *__pyx_pw_4liba_4fpid_11kpid(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_kp;
@@ -10993,40 +11818,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kp)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_ki)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("kpid", 1, 3, 3, 1); __PYX_ERR(7, 52, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("kpid", 1, 3, 3, 1); __PYX_ERR(7, 57, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kd)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("kpid", 1, 3, 3, 2); __PYX_ERR(7, 52, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("kpid", 1, 3, 3, 2); __PYX_ERR(7, 57, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "kpid") < 0)) __PYX_ERR(7, 52, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "kpid") < 0)) __PYX_ERR(7, 57, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
-    __pyx_v_kp = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_kp == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 52, __pyx_L3_error)
-    __pyx_v_ki = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_ki == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 52, __pyx_L3_error)
-    __pyx_v_kd = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_kd == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 52, __pyx_L3_error)
+    __pyx_v_kp = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_kp == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 57, __pyx_L3_error)
+    __pyx_v_ki = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_ki == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 57, __pyx_L3_error)
+    __pyx_v_kd = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_kd == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 57, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("kpid", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 52, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("kpid", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 57, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.kpid", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_4liba_4fpid_10kpid(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_kp, __pyx_v_ki, __pyx_v_kd);
 
@@ -11036,481 +11861,253 @@
 }
 
 static PyObject *__pyx_pf_4liba_4fpid_10kpid(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_kp, a_real_t __pyx_v_ki, a_real_t __pyx_v_kd) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("kpid", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":54
+  /* "python/src/a/fpid.pxi":59
  *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):
  *         '''set proportional integral derivative constant for fuzzy PID controller'''
- *         a_fpid_kpid(self.ctx, kp, ki, kd)             # <<<<<<<<<<<<<<
- *         return self
- *     def olim(self, min: a_real_t, max: a_real_t):
- */
-  (void)(a_fpid_kpid(__pyx_v_self->ctx, __pyx_v_kp, __pyx_v_ki, __pyx_v_kd));
-
-  /* "ffi/python/src/a/fpid.pxi":55
- *         '''set proportional integral derivative constant for fuzzy PID controller'''
- *         a_fpid_kpid(self.ctx, kp, ki, kd)
- *         return self             # <<<<<<<<<<<<<<
- *     def olim(self, min: a_real_t, max: a_real_t):
- *         '''set output extreme value for fuzzy PID controller'''
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_self));
-  __pyx_r = ((PyObject *)__pyx_v_self);
-  goto __pyx_L0;
-
-  /* "ffi/python/src/a/fpid.pxi":52
- *         a_fpid_base(self.ctx, <a_uint_t>len(mkp), mp, kp, ki, kd)
- *         return self
- *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):             # <<<<<<<<<<<<<<
- *         '''set proportional integral derivative constant for fuzzy PID controller'''
- *         a_fpid_kpid(self.ctx, kp, ki, kd)
- */
-
-  /* function exit code */
-  __pyx_L0:;
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "ffi/python/src/a/fpid.pxi":56
- *         a_fpid_kpid(self.ctx, kp, ki, kd)
- *         return self
- *     def olim(self, min: a_real_t, max: a_real_t):             # <<<<<<<<<<<<<<
- *         '''set output extreme value for fuzzy PID controller'''
- *         a_fpid_olim(self.ctx, min, max)
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_4liba_4fpid_13olim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_4liba_4fpid_12olim[] = "set output extreme value for fuzzy PID controller";
-static PyObject *__pyx_pw_4liba_4fpid_13olim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  a_real_t __pyx_v_min;
-  a_real_t __pyx_v_max;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("olim (wrapper)", 0);
-  {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_min,&__pyx_n_s_max,0};
-    PyObject* values[2] = {0,0};
-    if (unlikely(__pyx_kwds)) {
-      Py_ssize_t kw_args;
-      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
-      switch (pos_args) {
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = PyDict_Size(__pyx_kwds);
-      switch (pos_args) {
-        case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_min)) != 0)) kw_args--;
-        else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_max)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("olim", 1, 2, 2, 1); __PYX_ERR(7, 56, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "olim") < 0)) __PYX_ERR(7, 56, __pyx_L3_error)
-      }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-    }
-    __pyx_v_min = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_min == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 56, __pyx_L3_error)
-    __pyx_v_max = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_max == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 56, __pyx_L3_error)
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("olim", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 56, __pyx_L3_error)
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("liba.fpid.olim", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_4fpid_12olim(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_min, __pyx_v_max);
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static PyObject *__pyx_pf_4liba_4fpid_12olim(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_min, a_real_t __pyx_v_max) {
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("olim", 0);
-
-  /* "ffi/python/src/a/fpid.pxi":58
- *     def olim(self, min: a_real_t, max: a_real_t):
- *         '''set output extreme value for fuzzy PID controller'''
- *         a_fpid_olim(self.ctx, min, max)             # <<<<<<<<<<<<<<
- *         return self
- *     def ilim(self, min: a_real_t, max: a_real_t):
- */
-  (void)(a_fpid_olim(__pyx_v_self->ctx, __pyx_v_min, __pyx_v_max));
-
-  /* "ffi/python/src/a/fpid.pxi":59
- *         '''set output extreme value for fuzzy PID controller'''
- *         a_fpid_olim(self.ctx, min, max)
- *         return self             # <<<<<<<<<<<<<<
- *     def ilim(self, min: a_real_t, max: a_real_t):
- *         '''set input extreme value for fuzzy PID controller'''
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(((PyObject *)__pyx_v_self));
-  __pyx_r = ((PyObject *)__pyx_v_self);
-  goto __pyx_L0;
-
-  /* "ffi/python/src/a/fpid.pxi":56
- *         a_fpid_kpid(self.ctx, kp, ki, kd)
- *         return self
- *     def olim(self, min: a_real_t, max: a_real_t):             # <<<<<<<<<<<<<<
- *         '''set output extreme value for fuzzy PID controller'''
- *         a_fpid_olim(self.ctx, min, max)
- */
-
-  /* function exit code */
-  __pyx_L0:;
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "ffi/python/src/a/fpid.pxi":60
- *         a_fpid_olim(self.ctx, min, max)
- *         return self
- *     def ilim(self, min: a_real_t, max: a_real_t):             # <<<<<<<<<<<<<<
- *         '''set input extreme value for fuzzy PID controller'''
- *         a_fpid_ilim(self.ctx, min, max)
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_4liba_4fpid_15ilim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_4liba_4fpid_14ilim[] = "set input extreme value for fuzzy PID controller";
-static PyObject *__pyx_pw_4liba_4fpid_15ilim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  a_real_t __pyx_v_min;
-  a_real_t __pyx_v_max;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("ilim (wrapper)", 0);
-  {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_min,&__pyx_n_s_max,0};
-    PyObject* values[2] = {0,0};
-    if (unlikely(__pyx_kwds)) {
-      Py_ssize_t kw_args;
-      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
-      switch (pos_args) {
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = PyDict_Size(__pyx_kwds);
-      switch (pos_args) {
-        case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_min)) != 0)) kw_args--;
-        else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_max)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("ilim", 1, 2, 2, 1); __PYX_ERR(7, 60, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ilim") < 0)) __PYX_ERR(7, 60, __pyx_L3_error)
-      }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-    }
-    __pyx_v_min = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_min == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 60, __pyx_L3_error)
-    __pyx_v_max = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_max == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 60, __pyx_L3_error)
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ilim", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(7, 60, __pyx_L3_error)
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("liba.fpid.ilim", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_4fpid_14ilim(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), __pyx_v_min, __pyx_v_max);
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static PyObject *__pyx_pf_4liba_4fpid_14ilim(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_min, a_real_t __pyx_v_max) {
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("ilim", 0);
-
-  /* "ffi/python/src/a/fpid.pxi":62
- *     def ilim(self, min: a_real_t, max: a_real_t):
- *         '''set input extreme value for fuzzy PID controller'''
- *         a_fpid_ilim(self.ctx, min, max)             # <<<<<<<<<<<<<<
+ *         a_fpid_kpid(&self.ctx, kp, ki, kd)             # <<<<<<<<<<<<<<
  *         return self
  *     def pos(self, max: a_real_t):
  */
-  (void)(a_fpid_ilim(__pyx_v_self->ctx, __pyx_v_min, __pyx_v_max));
+  (void)(a_fpid_kpid((&__pyx_v_self->ctx), __pyx_v_kp, __pyx_v_ki, __pyx_v_kd));
 
-  /* "ffi/python/src/a/fpid.pxi":63
- *         '''set input extreme value for fuzzy PID controller'''
- *         a_fpid_ilim(self.ctx, min, max)
+  /* "python/src/a/fpid.pxi":60
+ *         '''set proportional integral derivative constant for fuzzy PID controller'''
+ *         a_fpid_kpid(&self.ctx, kp, ki, kd)
  *         return self             # <<<<<<<<<<<<<<
  *     def pos(self, max: a_real_t):
  *         '''positional fuzzy PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":60
- *         a_fpid_olim(self.ctx, min, max)
+  /* "python/src/a/fpid.pxi":57
+ *         a_fpid_base(&self.ctx, <a_uint_t>len(mkp), e, ec, kp, ki, kd)
  *         return self
- *     def ilim(self, min: a_real_t, max: a_real_t):             # <<<<<<<<<<<<<<
- *         '''set input extreme value for fuzzy PID controller'''
- *         a_fpid_ilim(self.ctx, min, max)
+ *     def kpid(self, kp: a_real_t, ki: a_real_t, kd: a_real_t):             # <<<<<<<<<<<<<<
+ *         '''set proportional integral derivative constant for fuzzy PID controller'''
+ *         a_fpid_kpid(&self.ctx, kp, ki, kd)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":64
- *         a_fpid_ilim(self.ctx, min, max)
+/* "python/src/a/fpid.pxi":61
+ *         a_fpid_kpid(&self.ctx, kp, ki, kd)
  *         return self
  *     def pos(self, max: a_real_t):             # <<<<<<<<<<<<<<
  *         '''positional fuzzy PID controller'''
- *         a_fpid_pos(self.ctx, max)
+ *         a_fpid_pos(&self.ctx, max)
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_4fpid_17pos(PyObject *__pyx_v_self, PyObject *__pyx_arg_max); /*proto*/
-static char __pyx_doc_4liba_4fpid_16pos[] = "positional fuzzy PID controller";
-static PyObject *__pyx_pw_4liba_4fpid_17pos(PyObject *__pyx_v_self, PyObject *__pyx_arg_max) {
+static PyObject *__pyx_pw_4liba_4fpid_13pos(PyObject *__pyx_v_self, PyObject *__pyx_arg_max); /*proto*/
+static char __pyx_doc_4liba_4fpid_12pos[] = "positional fuzzy PID controller";
+static PyObject *__pyx_pw_4liba_4fpid_13pos(PyObject *__pyx_v_self, PyObject *__pyx_arg_max) {
   a_real_t __pyx_v_max;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("pos (wrapper)", 0);
   assert(__pyx_arg_max); {
-    __pyx_v_max = __pyx_PyFloat_AsDouble(__pyx_arg_max); if (unlikely((__pyx_v_max == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 64, __pyx_L3_error)
+    __pyx_v_max = __pyx_PyFloat_AsDouble(__pyx_arg_max); if (unlikely((__pyx_v_max == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 61, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.pos", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_4fpid_16pos(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), ((a_real_t)__pyx_v_max));
+  __pyx_r = __pyx_pf_4liba_4fpid_12pos(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), ((a_real_t)__pyx_v_max));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_4fpid_16pos(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_max) {
+static PyObject *__pyx_pf_4liba_4fpid_12pos(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_max) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("pos", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":66
+  /* "python/src/a/fpid.pxi":63
  *     def pos(self, max: a_real_t):
  *         '''positional fuzzy PID controller'''
- *         a_fpid_pos(self.ctx, max)             # <<<<<<<<<<<<<<
+ *         a_fpid_pos(&self.ctx, max)             # <<<<<<<<<<<<<<
  *         return self
  *     def inc(self):
  */
-  (void)(a_fpid_pos(__pyx_v_self->ctx, __pyx_v_max));
+  (void)(a_fpid_pos((&__pyx_v_self->ctx), __pyx_v_max));
 
-  /* "ffi/python/src/a/fpid.pxi":67
+  /* "python/src/a/fpid.pxi":64
  *         '''positional fuzzy PID controller'''
- *         a_fpid_pos(self.ctx, max)
+ *         a_fpid_pos(&self.ctx, max)
  *         return self             # <<<<<<<<<<<<<<
  *     def inc(self):
  *         '''incremental fuzzy PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":64
- *         a_fpid_ilim(self.ctx, min, max)
+  /* "python/src/a/fpid.pxi":61
+ *         a_fpid_kpid(&self.ctx, kp, ki, kd)
  *         return self
  *     def pos(self, max: a_real_t):             # <<<<<<<<<<<<<<
  *         '''positional fuzzy PID controller'''
- *         a_fpid_pos(self.ctx, max)
+ *         a_fpid_pos(&self.ctx, max)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":68
- *         a_fpid_pos(self.ctx, max)
+/* "python/src/a/fpid.pxi":65
+ *         a_fpid_pos(&self.ctx, max)
  *         return self
  *     def inc(self):             # <<<<<<<<<<<<<<
  *         '''incremental fuzzy PID controller'''
- *         a_fpid_inc(self.ctx)
+ *         a_fpid_inc(&self.ctx)
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_4fpid_19inc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
-static char __pyx_doc_4liba_4fpid_18inc[] = "incremental fuzzy PID controller";
-static PyObject *__pyx_pw_4liba_4fpid_19inc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+static PyObject *__pyx_pw_4liba_4fpid_15inc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static char __pyx_doc_4liba_4fpid_14inc[] = "incremental fuzzy PID controller";
+static PyObject *__pyx_pw_4liba_4fpid_15inc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("inc (wrapper)", 0);
-  __pyx_r = __pyx_pf_4liba_4fpid_18inc(((struct __pyx_obj_4liba_fpid *)__pyx_v_self));
+  __pyx_r = __pyx_pf_4liba_4fpid_14inc(((struct __pyx_obj_4liba_fpid *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_4fpid_18inc(struct __pyx_obj_4liba_fpid *__pyx_v_self) {
+static PyObject *__pyx_pf_4liba_4fpid_14inc(struct __pyx_obj_4liba_fpid *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("inc", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":70
+  /* "python/src/a/fpid.pxi":67
  *     def inc(self):
  *         '''incremental fuzzy PID controller'''
- *         a_fpid_inc(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_fpid_inc(&self.ctx)             # <<<<<<<<<<<<<<
  *         return self
  *     def off(self):
  */
-  (void)(a_fpid_inc(__pyx_v_self->ctx));
+  (void)(a_fpid_inc((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/fpid.pxi":71
+  /* "python/src/a/fpid.pxi":68
  *         '''incremental fuzzy PID controller'''
- *         a_fpid_inc(self.ctx)
+ *         a_fpid_inc(&self.ctx)
  *         return self             # <<<<<<<<<<<<<<
  *     def off(self):
  *         '''turn off fuzzy PID controller'''
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":68
- *         a_fpid_pos(self.ctx, max)
+  /* "python/src/a/fpid.pxi":65
+ *         a_fpid_pos(&self.ctx, max)
  *         return self
  *     def inc(self):             # <<<<<<<<<<<<<<
  *         '''incremental fuzzy PID controller'''
- *         a_fpid_inc(self.ctx)
+ *         a_fpid_inc(&self.ctx)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":72
- *         a_fpid_inc(self.ctx)
+/* "python/src/a/fpid.pxi":69
+ *         a_fpid_inc(&self.ctx)
  *         return self
  *     def off(self):             # <<<<<<<<<<<<<<
  *         '''turn off fuzzy PID controller'''
- *         a_fpid_off(self.ctx)
+ *         a_fpid_off(&self.ctx)
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_4fpid_21off(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
-static char __pyx_doc_4liba_4fpid_20off[] = "turn off fuzzy PID controller";
-static PyObject *__pyx_pw_4liba_4fpid_21off(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+static PyObject *__pyx_pw_4liba_4fpid_17off(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static char __pyx_doc_4liba_4fpid_16off[] = "turn off fuzzy PID controller";
+static PyObject *__pyx_pw_4liba_4fpid_17off(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("off (wrapper)", 0);
-  __pyx_r = __pyx_pf_4liba_4fpid_20off(((struct __pyx_obj_4liba_fpid *)__pyx_v_self));
+  __pyx_r = __pyx_pf_4liba_4fpid_16off(((struct __pyx_obj_4liba_fpid *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_4fpid_20off(struct __pyx_obj_4liba_fpid *__pyx_v_self) {
+static PyObject *__pyx_pf_4liba_4fpid_16off(struct __pyx_obj_4liba_fpid *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("off", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":74
+  /* "python/src/a/fpid.pxi":71
  *     def off(self):
  *         '''turn off fuzzy PID controller'''
- *         a_fpid_off(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_fpid_off(&self.ctx)             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
-  (void)(a_fpid_off(__pyx_v_self->ctx));
+  (void)(a_fpid_off((&__pyx_v_self->ctx)));
 
-  /* "ffi/python/src/a/fpid.pxi":75
+  /* "python/src/a/fpid.pxi":72
  *         '''turn off fuzzy PID controller'''
- *         a_fpid_off(self.ctx)
+ *         a_fpid_off(&self.ctx)
  *         return self             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":72
- *         a_fpid_inc(self.ctx)
+  /* "python/src/a/fpid.pxi":69
+ *         a_fpid_inc(&self.ctx)
  *         return self
  *     def off(self):             # <<<<<<<<<<<<<<
  *         '''turn off fuzzy PID controller'''
- *         a_fpid_off(self.ctx)
+ *         a_fpid_off(&self.ctx)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":78
+/* "python/src/a/fpid.pxi":75
  * 
  *     @property
  *     def outmin(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.outmin
  *     @outmin.setter
  */
 
@@ -11532,29 +12129,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":79
+  /* "python/src/a/fpid.pxi":76
  *     @property
  *     def outmin(self) -> a_real_t:
  *         return self.ctx.pid.outmin             # <<<<<<<<<<<<<<
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->pid->outmin); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 79, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.pid.outmin); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 76, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":78
+  /* "python/src/a/fpid.pxi":75
  * 
  *     @property
  *     def outmin(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.outmin
  *     @outmin.setter
  */
 
@@ -11565,15 +12162,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":81
+/* "python/src/a/fpid.pxi":78
  *         return self.ctx.pid.outmin
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.pid.outmin = outmin
  * 
  */
 
@@ -11584,15 +12181,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_outmin); {
-    __pyx_v_outmin = __pyx_PyFloat_AsDouble(__pyx_arg_outmin); if (unlikely((__pyx_v_outmin == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 81, __pyx_L3_error)
+    __pyx_v_outmin = __pyx_PyFloat_AsDouble(__pyx_arg_outmin); if (unlikely((__pyx_v_outmin == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 78, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.outmin.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -11604,38 +12201,38 @@
 }
 
 static int __pyx_pf_4liba_4fpid_6outmin_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_outmin) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":82
+  /* "python/src/a/fpid.pxi":79
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):
  *         self.ctx.pid.outmin = outmin             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->pid->outmin = __pyx_v_outmin;
+  __pyx_v_self->ctx.pid.outmin = __pyx_v_outmin;
 
-  /* "ffi/python/src/a/fpid.pxi":81
+  /* "python/src/a/fpid.pxi":78
  *         return self.ctx.pid.outmin
  *     @outmin.setter
  *     def outmin(self, outmin: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.pid.outmin = outmin
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":85
+/* "python/src/a/fpid.pxi":82
  * 
  *     @property
  *     def outmax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.outmax
  *     @outmax.setter
  */
 
@@ -11657,29 +12254,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":86
+  /* "python/src/a/fpid.pxi":83
  *     @property
  *     def outmax(self) -> a_real_t:
  *         return self.ctx.pid.outmax             # <<<<<<<<<<<<<<
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->pid->outmax); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 86, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.pid.outmax); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 83, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":85
+  /* "python/src/a/fpid.pxi":82
  * 
  *     @property
  *     def outmax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.outmax
  *     @outmax.setter
  */
 
@@ -11690,15 +12287,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":88
+/* "python/src/a/fpid.pxi":85
  *         return self.ctx.pid.outmax
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.pid.outmax = outmax
  * 
  */
 
@@ -11709,15 +12306,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_outmax); {
-    __pyx_v_outmax = __pyx_PyFloat_AsDouble(__pyx_arg_outmax); if (unlikely((__pyx_v_outmax == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 88, __pyx_L3_error)
+    __pyx_v_outmax = __pyx_PyFloat_AsDouble(__pyx_arg_outmax); if (unlikely((__pyx_v_outmax == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 85, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.outmax.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -11729,38 +12326,38 @@
 }
 
 static int __pyx_pf_4liba_4fpid_6outmax_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_outmax) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":89
+  /* "python/src/a/fpid.pxi":86
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):
  *         self.ctx.pid.outmax = outmax             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->pid->outmax = __pyx_v_outmax;
+  __pyx_v_self->ctx.pid.outmax = __pyx_v_outmax;
 
-  /* "ffi/python/src/a/fpid.pxi":88
+  /* "python/src/a/fpid.pxi":85
  *         return self.ctx.pid.outmax
  *     @outmax.setter
  *     def outmax(self, outmax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.pid.outmax = outmax
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":92
+/* "python/src/a/fpid.pxi":89
  * 
  *     @property
  *     def summax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.summax
  *     @summax.setter
  */
 
@@ -11782,29 +12379,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":93
+  /* "python/src/a/fpid.pxi":90
  *     @property
  *     def summax(self) -> a_real_t:
  *         return self.ctx.pid.summax             # <<<<<<<<<<<<<<
  *     @summax.setter
  *     def summax(self, summax: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->pid->summax); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 93, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.pid.summax); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 90, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":92
+  /* "python/src/a/fpid.pxi":89
  * 
  *     @property
  *     def summax(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.summax
  *     @summax.setter
  */
 
@@ -11815,15 +12412,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":95
+/* "python/src/a/fpid.pxi":92
  *         return self.ctx.pid.summax
  *     @summax.setter
  *     def summax(self, summax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.pid.summax = summax
  * 
  */
 
@@ -11834,15 +12431,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_summax); {
-    __pyx_v_summax = __pyx_PyFloat_AsDouble(__pyx_arg_summax); if (unlikely((__pyx_v_summax == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 95, __pyx_L3_error)
+    __pyx_v_summax = __pyx_PyFloat_AsDouble(__pyx_arg_summax); if (unlikely((__pyx_v_summax == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 92, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.summax.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -11854,42 +12451,42 @@
 }
 
 static int __pyx_pf_4liba_4fpid_6summax_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_summax) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":96
+  /* "python/src/a/fpid.pxi":93
  *     @summax.setter
  *     def summax(self, summax: a_real_t):
  *         self.ctx.pid.summax = summax             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->pid->summax = __pyx_v_summax;
+  __pyx_v_self->ctx.pid.summax = __pyx_v_summax;
 
-  /* "ffi/python/src/a/fpid.pxi":95
+  /* "python/src/a/fpid.pxi":92
  *         return self.ctx.pid.summax
  *     @summax.setter
  *     def summax(self, summax: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.pid.summax = summax
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":99
+/* "python/src/a/fpid.pxi":96
  * 
  *     @property
  *     def mode(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_pid_mode(self.ctx.pid)
+ *         return a_pid_mode(&self.ctx.pid)
  *     @mode.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_4mode_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_4fpid_4mode_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -11907,67 +12504,67 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":100
+  /* "python/src/a/fpid.pxi":97
  *     @property
  *     def mode(self) -> a_uint_t:
- *         return a_pid_mode(self.ctx.pid)             # <<<<<<<<<<<<<<
+ *         return a_pid_mode(&self.ctx.pid)             # <<<<<<<<<<<<<<
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_pid_mode(__pyx_v_self->ctx->pid)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 100, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_pid_mode((&__pyx_v_self->ctx.pid))); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 97, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":99
+  /* "python/src/a/fpid.pxi":96
  * 
  *     @property
  *     def mode(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_pid_mode(self.ctx.pid)
+ *         return a_pid_mode(&self.ctx.pid)
  *     @mode.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.fpid.mode.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":102
- *         return a_pid_mode(self.ctx.pid)
+/* "python/src/a/fpid.pxi":99
+ *         return a_pid_mode(&self.ctx.pid)
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_mode(self.ctx.pid, mode)
+ *         a_pid_set_mode(&self.ctx.pid, mode)
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_4fpid_4mode_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_mode); /*proto*/
 static int __pyx_pw_4liba_4fpid_4mode_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_mode) {
   a_uint_t __pyx_v_mode;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_mode); {
-    __pyx_v_mode = __Pyx_PyInt_As_a_uint_t(__pyx_arg_mode); if (unlikely((__pyx_v_mode == ((a_uint_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 102, __pyx_L3_error)
+    __pyx_v_mode = __Pyx_PyInt_As_a_uint_t(__pyx_arg_mode); if (unlikely((__pyx_v_mode == ((a_uint_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 99, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.mode.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -11979,42 +12576,42 @@
 }
 
 static int __pyx_pf_4liba_4fpid_4mode_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_uint_t __pyx_v_mode) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":103
+  /* "python/src/a/fpid.pxi":100
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):
- *         a_pid_set_mode(self.ctx.pid, mode)             # <<<<<<<<<<<<<<
+ *         a_pid_set_mode(&self.ctx.pid, mode)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_pid_set_mode(__pyx_v_self->ctx->pid, __pyx_v_mode);
+  a_pid_set_mode((&__pyx_v_self->ctx.pid), __pyx_v_mode);
 
-  /* "ffi/python/src/a/fpid.pxi":102
- *         return a_pid_mode(self.ctx.pid)
+  /* "python/src/a/fpid.pxi":99
+ *         return a_pid_mode(&self.ctx.pid)
  *     @mode.setter
  *     def mode(self, mode: a_uint_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_mode(self.ctx.pid, mode)
+ *         a_pid_set_mode(&self.ctx.pid, mode)
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":106
+/* "python/src/a/fpid.pxi":103
  * 
  *     @property
  *     def dt(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_dt(self.ctx.pid)
+ *         return a_pid_dt(&self.ctx.pid)
  *     @dt.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_2dt_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_4fpid_2dt_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -12032,67 +12629,67 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":107
+  /* "python/src/a/fpid.pxi":104
  *     @property
  *     def dt(self) -> a_real_t:
- *         return a_pid_dt(self.ctx.pid)             # <<<<<<<<<<<<<<
+ *         return a_pid_dt(&self.ctx.pid)             # <<<<<<<<<<<<<<
  *     @dt.setter
  *     def dt(self, dt: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(a_pid_dt(__pyx_v_self->ctx->pid)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 107, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(a_pid_dt((&__pyx_v_self->ctx.pid))); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":106
+  /* "python/src/a/fpid.pxi":103
  * 
  *     @property
  *     def dt(self) -> a_real_t:             # <<<<<<<<<<<<<<
- *         return a_pid_dt(self.ctx.pid)
+ *         return a_pid_dt(&self.ctx.pid)
  *     @dt.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.fpid.dt.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":109
- *         return a_pid_dt(self.ctx.pid)
+/* "python/src/a/fpid.pxi":106
+ *         return a_pid_dt(&self.ctx.pid)
  *     @dt.setter
  *     def dt(self, dt: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_dt(self.ctx.pid, dt)
+ *         a_pid_set_dt(&self.ctx.pid, dt)
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_4fpid_2dt_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_dt); /*proto*/
 static int __pyx_pw_4liba_4fpid_2dt_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_dt) {
   a_real_t __pyx_v_dt;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_dt); {
-    __pyx_v_dt = __pyx_PyFloat_AsDouble(__pyx_arg_dt); if (unlikely((__pyx_v_dt == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 109, __pyx_L3_error)
+    __pyx_v_dt = __pyx_PyFloat_AsDouble(__pyx_arg_dt); if (unlikely((__pyx_v_dt == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 106, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.dt.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -12104,38 +12701,38 @@
 }
 
 static int __pyx_pf_4liba_4fpid_2dt_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_dt) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":110
+  /* "python/src/a/fpid.pxi":107
  *     @dt.setter
  *     def dt(self, dt: a_real_t):
- *         a_pid_set_dt(self.ctx.pid, dt)             # <<<<<<<<<<<<<<
+ *         a_pid_set_dt(&self.ctx.pid, dt)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_pid_set_dt(__pyx_v_self->ctx->pid, __pyx_v_dt);
+  a_pid_set_dt((&__pyx_v_self->ctx.pid), __pyx_v_dt);
 
-  /* "ffi/python/src/a/fpid.pxi":109
- *         return a_pid_dt(self.ctx.pid)
+  /* "python/src/a/fpid.pxi":106
+ *         return a_pid_dt(&self.ctx.pid)
  *     @dt.setter
  *     def dt(self, dt: a_real_t):             # <<<<<<<<<<<<<<
- *         a_pid_set_dt(self.ctx.pid, dt)
+ *         a_pid_set_dt(&self.ctx.pid, dt)
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":113
+/* "python/src/a/fpid.pxi":110
  * 
  *     @property
  *     def kp(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.kp
  *     @kp.setter
  */
 
@@ -12157,29 +12754,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":114
+  /* "python/src/a/fpid.pxi":111
  *     @property
  *     def kp(self) -> a_real_t:
  *         return self.ctx.kp             # <<<<<<<<<<<<<<
  *     @kp.setter
  *     def kp(self, kp: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->kp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 114, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.kp); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":113
+  /* "python/src/a/fpid.pxi":110
  * 
  *     @property
  *     def kp(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.kp
  *     @kp.setter
  */
 
@@ -12190,15 +12787,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":116
+/* "python/src/a/fpid.pxi":113
  *         return self.ctx.kp
  *     @kp.setter
  *     def kp(self, kp: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.kp = kp
  * 
  */
 
@@ -12209,15 +12806,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_kp); {
-    __pyx_v_kp = __pyx_PyFloat_AsDouble(__pyx_arg_kp); if (unlikely((__pyx_v_kp == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 116, __pyx_L3_error)
+    __pyx_v_kp = __pyx_PyFloat_AsDouble(__pyx_arg_kp); if (unlikely((__pyx_v_kp == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 113, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.kp.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -12229,38 +12826,38 @@
 }
 
 static int __pyx_pf_4liba_4fpid_2kp_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_kp) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":117
+  /* "python/src/a/fpid.pxi":114
  *     @kp.setter
  *     def kp(self, kp: a_real_t):
  *         self.ctx.kp = kp             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->kp = __pyx_v_kp;
+  __pyx_v_self->ctx.kp = __pyx_v_kp;
 
-  /* "ffi/python/src/a/fpid.pxi":116
+  /* "python/src/a/fpid.pxi":113
  *         return self.ctx.kp
  *     @kp.setter
  *     def kp(self, kp: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.kp = kp
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":120
+/* "python/src/a/fpid.pxi":117
  * 
  *     @property
  *     def ki(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.ki
  *     @ki.setter
  */
 
@@ -12282,29 +12879,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":121
+  /* "python/src/a/fpid.pxi":118
  *     @property
  *     def ki(self) -> a_real_t:
  *         return self.ctx.ki             # <<<<<<<<<<<<<<
  *     @ki.setter
  *     def ki(self, ki: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->ki); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 121, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.ki); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":120
+  /* "python/src/a/fpid.pxi":117
  * 
  *     @property
  *     def ki(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.ki
  *     @ki.setter
  */
 
@@ -12315,15 +12912,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":123
+/* "python/src/a/fpid.pxi":120
  *         return self.ctx.ki
  *     @ki.setter
  *     def ki(self, ki: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.ki = ki
  * 
  */
 
@@ -12334,15 +12931,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_ki); {
-    __pyx_v_ki = __pyx_PyFloat_AsDouble(__pyx_arg_ki); if (unlikely((__pyx_v_ki == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 123, __pyx_L3_error)
+    __pyx_v_ki = __pyx_PyFloat_AsDouble(__pyx_arg_ki); if (unlikely((__pyx_v_ki == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 120, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.ki.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -12354,38 +12951,38 @@
 }
 
 static int __pyx_pf_4liba_4fpid_2ki_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_ki) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":124
+  /* "python/src/a/fpid.pxi":121
  *     @ki.setter
  *     def ki(self, ki: a_real_t):
  *         self.ctx.ki = ki             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->ki = __pyx_v_ki;
+  __pyx_v_self->ctx.ki = __pyx_v_ki;
 
-  /* "ffi/python/src/a/fpid.pxi":123
+  /* "python/src/a/fpid.pxi":120
  *         return self.ctx.ki
  *     @ki.setter
  *     def ki(self, ki: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.ki = ki
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":127
+/* "python/src/a/fpid.pxi":124
  * 
  *     @property
  *     def kd(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.kd
  *     @kd.setter
  */
 
@@ -12407,29 +13004,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":128
+  /* "python/src/a/fpid.pxi":125
  *     @property
  *     def kd(self) -> a_real_t:
  *         return self.ctx.kd             # <<<<<<<<<<<<<<
  *     @kd.setter
  *     def kd(self, kd: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->kd); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 128, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.kd); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 125, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":127
+  /* "python/src/a/fpid.pxi":124
  * 
  *     @property
  *     def kd(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.kd
  *     @kd.setter
  */
 
@@ -12440,15 +13037,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":130
+/* "python/src/a/fpid.pxi":127
  *         return self.ctx.kd
  *     @kd.setter
  *     def kd(self, kd: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.kd = kd
  * 
  */
 
@@ -12459,15 +13056,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_kd); {
-    __pyx_v_kd = __pyx_PyFloat_AsDouble(__pyx_arg_kd); if (unlikely((__pyx_v_kd == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 130, __pyx_L3_error)
+    __pyx_v_kd = __pyx_PyFloat_AsDouble(__pyx_arg_kd); if (unlikely((__pyx_v_kd == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 127, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.kd.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -12479,42 +13076,42 @@
 }
 
 static int __pyx_pf_4liba_4fpid_2kd_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_real_t __pyx_v_kd) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":131
+  /* "python/src/a/fpid.pxi":128
  *     @kd.setter
  *     def kd(self, kd: a_real_t):
  *         self.ctx.kd = kd             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_v_self->ctx->kd = __pyx_v_kd;
+  __pyx_v_self->ctx.kd = __pyx_v_kd;
 
-  /* "ffi/python/src/a/fpid.pxi":130
+  /* "python/src/a/fpid.pxi":127
  *         return self.ctx.kd
  *     @kd.setter
  *     def kd(self, kd: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.kd = kd
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":134
+/* "python/src/a/fpid.pxi":131
  * 
  *     @property
  *     def buf(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_fpid_bufnum(self.ctx)
+ *         return a_fpid_bufnum(&self.ctx)
  *     @buf.setter
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_3buf_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_4fpid_3buf_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -12532,67 +13129,67 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":135
+  /* "python/src/a/fpid.pxi":132
  *     @property
  *     def buf(self) -> a_uint_t:
- *         return a_fpid_bufnum(self.ctx)             # <<<<<<<<<<<<<<
+ *         return a_fpid_bufnum(&self.ctx)             # <<<<<<<<<<<<<<
  *     @buf.setter
  *     def buf(self, max: a_uint_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_fpid_bufnum(__pyx_v_self->ctx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 135, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_fpid_bufnum((&__pyx_v_self->ctx))); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":134
+  /* "python/src/a/fpid.pxi":131
  * 
  *     @property
  *     def buf(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_fpid_bufnum(self.ctx)
+ *         return a_fpid_bufnum(&self.ctx)
  *     @buf.setter
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.fpid.buf.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":137
- *         return a_fpid_bufnum(self.ctx)
+/* "python/src/a/fpid.pxi":134
+ *         return a_fpid_bufnum(&self.ctx)
  *     @buf.setter
  *     def buf(self, max: a_uint_t):             # <<<<<<<<<<<<<<
  *         self.ptr = PyMem_Realloc(self.ptr, A_FPID_BUF1(max))
- *         a_fpid_buf1(self.ctx, self.ptr, max)
+ *         a_fpid_buf1(&self.ctx, self.ptr, max)
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_4fpid_3buf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_max); /*proto*/
 static int __pyx_pw_4liba_4fpid_3buf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_max) {
   a_uint_t __pyx_v_max;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   assert(__pyx_arg_max); {
-    __pyx_v_max = __Pyx_PyInt_As_a_uint_t(__pyx_arg_max); if (unlikely((__pyx_v_max == ((a_uint_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 137, __pyx_L3_error)
+    __pyx_v_max = __Pyx_PyInt_As_a_uint_t(__pyx_arg_max); if (unlikely((__pyx_v_max == ((a_uint_t)-1)) && PyErr_Occurred())) __PYX_ERR(7, 134, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.fpid.buf.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -12604,51 +13201,51 @@
 }
 
 static int __pyx_pf_4liba_4fpid_3buf_2__set__(struct __pyx_obj_4liba_fpid *__pyx_v_self, a_uint_t __pyx_v_max) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":138
+  /* "python/src/a/fpid.pxi":135
  *     @buf.setter
  *     def buf(self, max: a_uint_t):
  *         self.ptr = PyMem_Realloc(self.ptr, A_FPID_BUF1(max))             # <<<<<<<<<<<<<<
- *         a_fpid_buf1(self.ctx, self.ptr, max)
+ *         a_fpid_buf1(&self.ctx, self.ptr, max)
  * 
  */
   __pyx_v_self->ptr = PyMem_Realloc(__pyx_v_self->ptr, A_FPID_BUF1(__pyx_v_max));
 
-  /* "ffi/python/src/a/fpid.pxi":139
+  /* "python/src/a/fpid.pxi":136
  *     def buf(self, max: a_uint_t):
  *         self.ptr = PyMem_Realloc(self.ptr, A_FPID_BUF1(max))
- *         a_fpid_buf1(self.ctx, self.ptr, max)             # <<<<<<<<<<<<<<
+ *         a_fpid_buf1(&self.ctx, self.ptr, max)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (void)(a_fpid_buf1(__pyx_v_self->ctx, __pyx_v_self->ptr, __pyx_v_max));
+  (void)(a_fpid_buf1((&__pyx_v_self->ctx), __pyx_v_self->ptr, __pyx_v_max));
 
-  /* "ffi/python/src/a/fpid.pxi":137
- *         return a_fpid_bufnum(self.ctx)
+  /* "python/src/a/fpid.pxi":134
+ *         return a_fpid_bufnum(&self.ctx)
  *     @buf.setter
  *     def buf(self, max: a_uint_t):             # <<<<<<<<<<<<<<
  *         self.ptr = PyMem_Realloc(self.ptr, A_FPID_BUF1(max))
- *         a_fpid_buf1(self.ctx, self.ptr, max)
+ *         a_fpid_buf1(&self.ctx, self.ptr, max)
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":142
+/* "python/src/a/fpid.pxi":139
  * 
  *     @property
  *     def col(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_fpid_col(self.ctx)
+ *         return a_fpid_col(&self.ctx)
  *     @property
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_4fpid_3col_1__get__(PyObject *__pyx_v_self); /*proto*/
 static PyObject *__pyx_pw_4liba_4fpid_3col_1__get__(PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -12666,49 +13263,49 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":143
+  /* "python/src/a/fpid.pxi":140
  *     @property
  *     def col(self) -> a_uint_t:
- *         return a_fpid_col(self.ctx)             # <<<<<<<<<<<<<<
+ *         return a_fpid_col(&self.ctx)             # <<<<<<<<<<<<<<
  *     @property
  *     def out(self) -> a_real_t:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_fpid_col(__pyx_v_self->ctx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 143, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_a_uint_t(a_fpid_col((&__pyx_v_self->ctx))); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 140, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":142
+  /* "python/src/a/fpid.pxi":139
  * 
  *     @property
  *     def col(self) -> a_uint_t:             # <<<<<<<<<<<<<<
- *         return a_fpid_col(self.ctx)
+ *         return a_fpid_col(&self.ctx)
  *     @property
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("liba.fpid.col.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":145
- *         return a_fpid_col(self.ctx)
+/* "python/src/a/fpid.pxi":142
+ *         return a_fpid_col(&self.ctx)
  *     @property
  *     def out(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.out.v
  *     @property
  */
 
 /* Python wrapper */
@@ -12729,30 +13326,30 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":146
+  /* "python/src/a/fpid.pxi":143
  *     @property
  *     def out(self) -> a_real_t:
  *         return self.ctx.pid.out.v             # <<<<<<<<<<<<<<
  *     @property
  *     def fdb(self) -> a_real_t:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->pid->out.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 146, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.pid.out.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 143, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":145
- *         return a_fpid_col(self.ctx)
+  /* "python/src/a/fpid.pxi":142
+ *         return a_fpid_col(&self.ctx)
  *     @property
  *     def out(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.out.v
  *     @property
  */
 
   /* function exit code */
@@ -12762,15 +13359,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":148
+/* "python/src/a/fpid.pxi":145
  *         return self.ctx.pid.out.v
  *     @property
  *     def fdb(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.fdb.v
  *     @property
  */
 
@@ -12792,29 +13389,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":149
+  /* "python/src/a/fpid.pxi":146
  *     @property
  *     def fdb(self) -> a_real_t:
  *         return self.ctx.pid.fdb.v             # <<<<<<<<<<<<<<
  *     @property
  *     def ec(self) -> a_real_t:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->pid->fdb.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 149, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.pid.fdb.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 146, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":148
+  /* "python/src/a/fpid.pxi":145
  *         return self.ctx.pid.out.v
  *     @property
  *     def fdb(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.fdb.v
  *     @property
  */
 
@@ -12825,15 +13422,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":151
+/* "python/src/a/fpid.pxi":148
  *         return self.ctx.pid.fdb.v
  *     @property
  *     def ec(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.ec.v
  *     @property
  */
 
@@ -12855,29 +13452,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":152
+  /* "python/src/a/fpid.pxi":149
  *     @property
  *     def ec(self) -> a_real_t:
  *         return self.ctx.pid.ec.v             # <<<<<<<<<<<<<<
  *     @property
  *     def e(self) -> a_real_t:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->pid->ec.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 152, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.pid.ec.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 149, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":151
+  /* "python/src/a/fpid.pxi":148
  *         return self.ctx.pid.fdb.v
  *     @property
  *     def ec(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.ec.v
  *     @property
  */
 
@@ -12888,15 +13485,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/fpid.pxi":154
+/* "python/src/a/fpid.pxi":151
  *         return self.ctx.pid.ec.v
  *     @property
  *     def e(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.e.v
  */
 
 /* Python wrapper */
@@ -12917,27 +13514,27 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/fpid.pxi":155
+  /* "python/src/a/fpid.pxi":152
  *     @property
  *     def e(self) -> a_real_t:
  *         return self.ctx.pid.e.v             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx->pid->e.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 155, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->ctx.pid.e.v); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/fpid.pxi":154
+  /* "python/src/a/fpid.pxi":151
  *         return self.ctx.pid.ec.v
  *     @property
  *     def e(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.pid.e.v
  */
 
   /* function exit code */
@@ -12954,27 +13551,27 @@
 /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_4fpid_23__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
-static PyObject *__pyx_pw_4liba_4fpid_23__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+static PyObject *__pyx_pw_4liba_4fpid_19__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_4liba_4fpid_19__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_4liba_4fpid_22__reduce_cython__(((struct __pyx_obj_4liba_fpid *)__pyx_v_self));
+  __pyx_r = __pyx_pf_4liba_4fpid_18__reduce_cython__(((struct __pyx_obj_4liba_fpid *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_4fpid_22__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self) {
+static PyObject *__pyx_pf_4liba_4fpid_18__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
@@ -13011,27 +13608,27 @@
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_4fpid_25__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
-static PyObject *__pyx_pw_4liba_4fpid_25__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
+static PyObject *__pyx_pw_4liba_4fpid_21__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_4liba_4fpid_21__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
-  __pyx_r = __pyx_pf_4liba_4fpid_24__setstate_cython__(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+  __pyx_r = __pyx_pf_4liba_4fpid_20__setstate_cython__(((struct __pyx_obj_4liba_fpid *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_4fpid_24__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+static PyObject *__pyx_pf_4liba_4fpid_20__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_4liba_fpid *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
@@ -13060,26 +13657,26 @@
   __Pyx_AddTraceback("liba.fpid.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/poly.pxi":5
+/* "python/src/a/poly.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_eval(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_11poly_eval(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4liba_11poly_eval = {"poly_eval", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_11poly_eval, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4liba_11poly_eval(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4liba_13poly_eval(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4liba_13poly_eval = {"poly_eval", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_13poly_eval, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4liba_13poly_eval(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_x = 0;
   PyObject *__pyx_v_a = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -13128,23 +13725,23 @@
   __Pyx_RaiseArgtupleInvalid("poly_eval", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(8, 5, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_a); __pyx_v_a = 0;
   __Pyx_AddTraceback("liba.poly_eval", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_10poly_eval(__pyx_self, __pyx_v_x, __pyx_v_a);
+  __pyx_r = __pyx_pf_4liba_12poly_eval(__pyx_self, __pyx_v_x, __pyx_v_a);
 
   /* function exit code */
   __Pyx_XDECREF(__pyx_v_a);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_10poly_eval(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a) {
+static PyObject *__pyx_pf_4liba_12poly_eval(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a) {
   arrayobject *__pyx_v_d = NULL;
   Py_ssize_t __pyx_v_n;
   a_real_t *__pyx_v_p;
   arrayobject *__pyx_v_y = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
@@ -13153,15 +13750,15 @@
   int __pyx_t_4;
   a_real_t __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("poly_eval", 0);
 
-  /* "ffi/python/src/a/poly.pxi":6
+  /* "python/src/a/poly.pxi":6
  * @cython.boundscheck(False)
  * def poly_eval(x, *a):
  *     d, n = reals(a), len(a)             # <<<<<<<<<<<<<<
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):
  */
   __pyx_t_2.__pyx_n = 1;
@@ -13169,94 +13766,94 @@
   __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(8, 6, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = PyTuple_GET_SIZE(__pyx_v_a); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(8, 6, __pyx_L1_error)
   __pyx_v_d = ((arrayobject *)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_v_n = __pyx_t_3;
 
-  /* "ffi/python/src/a/poly.pxi":7
+  /* "python/src/a/poly.pxi":7
  * def poly_eval(x, *a):
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr             # <<<<<<<<<<<<<<
  *     if iterable(x):
  *         y = reals(x)
  */
   __pyx_v_p = ((a_real_t *)__pyx_v_d->data.as_voidptr);
 
-  /* "ffi/python/src/a/poly.pxi":8
+  /* "python/src/a/poly.pxi":8
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):             # <<<<<<<<<<<<<<
  *         y = reals(x)
  *         a_poly_evaln(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  */
   __pyx_t_4 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_4) {
 
-    /* "ffi/python/src/a/poly.pxi":9
+    /* "python/src/a/poly.pxi":9
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):
  *         y = reals(x)             # <<<<<<<<<<<<<<
  *         a_poly_evaln(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  *         return y
  */
     __pyx_t_2.__pyx_n = 1;
     __pyx_t_2.o = __pyx_v_x;
     __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(8, 9, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_y = ((arrayobject *)__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "ffi/python/src/a/poly.pxi":10
+    /* "python/src/a/poly.pxi":10
  *     if iterable(x):
  *         y = reals(x)
  *         a_poly_evaln(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)             # <<<<<<<<<<<<<<
  *         return y
  *     return a_poly_eval(p, n, x)
  */
     __pyx_t_3 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(8, 10, __pyx_L1_error)
     (void)(a_poly_evaln(__pyx_v_p, __pyx_v_n, ((a_real_t *)__pyx_v_y->data.as_voidptr), __pyx_t_3, ((a_real_t *)__pyx_v_y->data.as_voidptr)));
 
-    /* "ffi/python/src/a/poly.pxi":11
+    /* "python/src/a/poly.pxi":11
  *         y = reals(x)
  *         a_poly_evaln(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  *         return y             # <<<<<<<<<<<<<<
  *     return a_poly_eval(p, n, x)
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/poly.pxi":8
+    /* "python/src/a/poly.pxi":8
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):             # <<<<<<<<<<<<<<
  *         y = reals(x)
  *         a_poly_evaln(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  */
   }
 
-  /* "ffi/python/src/a/poly.pxi":12
+  /* "python/src/a/poly.pxi":12
  *         a_poly_evaln(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  *         return y
  *     return a_poly_eval(p, n, x)             # <<<<<<<<<<<<<<
  * 
  * @cython.wraparound(False)
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_5 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(8, 12, __pyx_L1_error)
   __pyx_t_1 = PyFloat_FromDouble(a_poly_eval(__pyx_v_p, __pyx_v_n, __pyx_t_5)); if (unlikely(!__pyx_t_1)) __PYX_ERR(8, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/poly.pxi":5
+  /* "python/src/a/poly.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_eval(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
 
@@ -13269,26 +13866,26 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_d);
   __Pyx_XDECREF((PyObject *)__pyx_v_y);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/poly.pxi":16
+/* "python/src/a/poly.pxi":16
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_evar(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_13poly_evar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4liba_13poly_evar = {"poly_evar", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_13poly_evar, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4liba_13poly_evar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4liba_15poly_evar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4liba_15poly_evar = {"poly_evar", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_15poly_evar, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4liba_15poly_evar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_x = 0;
   PyObject *__pyx_v_a = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -13337,23 +13934,23 @@
   __Pyx_RaiseArgtupleInvalid("poly_evar", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(8, 16, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_a); __pyx_v_a = 0;
   __Pyx_AddTraceback("liba.poly_evar", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_12poly_evar(__pyx_self, __pyx_v_x, __pyx_v_a);
+  __pyx_r = __pyx_pf_4liba_14poly_evar(__pyx_self, __pyx_v_x, __pyx_v_a);
 
   /* function exit code */
   __Pyx_XDECREF(__pyx_v_a);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_12poly_evar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a) {
+static PyObject *__pyx_pf_4liba_14poly_evar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a) {
   arrayobject *__pyx_v_d = NULL;
   Py_ssize_t __pyx_v_n;
   a_real_t *__pyx_v_p;
   arrayobject *__pyx_v_y = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
@@ -13362,15 +13959,15 @@
   int __pyx_t_4;
   a_real_t __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("poly_evar", 0);
 
-  /* "ffi/python/src/a/poly.pxi":17
+  /* "python/src/a/poly.pxi":17
  * @cython.boundscheck(False)
  * def poly_evar(x, *a):
  *     d, n = reals(a), len(a)             # <<<<<<<<<<<<<<
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):
  */
   __pyx_t_2.__pyx_n = 1;
@@ -13378,91 +13975,91 @@
   __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(8, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = PyTuple_GET_SIZE(__pyx_v_a); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(8, 17, __pyx_L1_error)
   __pyx_v_d = ((arrayobject *)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_v_n = __pyx_t_3;
 
-  /* "ffi/python/src/a/poly.pxi":18
+  /* "python/src/a/poly.pxi":18
  * def poly_evar(x, *a):
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr             # <<<<<<<<<<<<<<
  *     if iterable(x):
  *         y = reals(x)
  */
   __pyx_v_p = ((a_real_t *)__pyx_v_d->data.as_voidptr);
 
-  /* "ffi/python/src/a/poly.pxi":19
+  /* "python/src/a/poly.pxi":19
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):             # <<<<<<<<<<<<<<
  *         y = reals(x)
  *         a_poly_evarn(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  */
   __pyx_t_4 = (__pyx_f_4liba_iterable(__pyx_v_x) != 0);
   if (__pyx_t_4) {
 
-    /* "ffi/python/src/a/poly.pxi":20
+    /* "python/src/a/poly.pxi":20
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):
  *         y = reals(x)             # <<<<<<<<<<<<<<
  *         a_poly_evarn(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  *         return y
  */
     __pyx_t_2.__pyx_n = 1;
     __pyx_t_2.o = __pyx_v_x;
     __pyx_t_1 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(8, 20, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_y = ((arrayobject *)__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "ffi/python/src/a/poly.pxi":21
+    /* "python/src/a/poly.pxi":21
  *     if iterable(x):
  *         y = reals(x)
  *         a_poly_evarn(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)             # <<<<<<<<<<<<<<
  *         return y
  *     return a_poly_evar(p, n, x)
  */
     __pyx_t_3 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(8, 21, __pyx_L1_error)
     (void)(a_poly_evarn(__pyx_v_p, __pyx_v_n, ((a_real_t *)__pyx_v_y->data.as_voidptr), __pyx_t_3, ((a_real_t *)__pyx_v_y->data.as_voidptr)));
 
-    /* "ffi/python/src/a/poly.pxi":22
+    /* "python/src/a/poly.pxi":22
  *         y = reals(x)
  *         a_poly_evarn(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  *         return y             # <<<<<<<<<<<<<<
  *     return a_poly_evar(p, n, x)
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_y));
     __pyx_r = ((PyObject *)__pyx_v_y);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/poly.pxi":19
+    /* "python/src/a/poly.pxi":19
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  *     if iterable(x):             # <<<<<<<<<<<<<<
  *         y = reals(x)
  *         a_poly_evarn(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  */
   }
 
-  /* "ffi/python/src/a/poly.pxi":23
+  /* "python/src/a/poly.pxi":23
  *         a_poly_evarn(p, n, <a_real_t *>y.data.as_voidptr, len(x), <a_real_t *>y.data.as_voidptr)
  *         return y
  *     return a_poly_evar(p, n, x)             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_v_x); if (unlikely((__pyx_t_5 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(8, 23, __pyx_L1_error)
   __pyx_t_1 = PyFloat_FromDouble(a_poly_evar(__pyx_v_p, __pyx_v_n, __pyx_t_5)); if (unlikely(!__pyx_t_1)) __PYX_ERR(8, 23, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/poly.pxi":16
+  /* "python/src/a/poly.pxi":16
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_evar(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
 
@@ -13475,19 +14072,19 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_d);
   __Pyx_XDECREF((PyObject *)__pyx_v_y);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":8
+/* "python/src/a/polytrack.pxi":8
  *     '''cubic polynomial trajectory'''
- *     cdef a_polytrack3_s ctx[1]
+ *     cdef a_polytrack3_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0):             # <<<<<<<<<<<<<<
- *         a_polytrack3_init(self.ctx, t0, t1, q0, q1, v0, v1)
+ *         a_polytrack3_init(&self.ctx, t0, t1, q0, q1, v0, v1)
  *     def __call__(self, ts):
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_10polytrack3_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_pw_4liba_10polytrack3_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_t0;
@@ -13608,49 +14205,49 @@
 }
 
 static int __pyx_pf_4liba_10polytrack3___cinit__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_t0, a_real_t __pyx_v_t1, a_real_t __pyx_v_q0, a_real_t __pyx_v_q1, a_real_t __pyx_v_v0, a_real_t __pyx_v_v1) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":9
- *     cdef a_polytrack3_s ctx[1]
+  /* "python/src/a/polytrack.pxi":9
+ *     cdef a_polytrack3_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0):
- *         a_polytrack3_init(self.ctx, t0, t1, q0, q1, v0, v1)             # <<<<<<<<<<<<<<
+ *         a_polytrack3_init(&self.ctx, t0, t1, q0, q1, v0, v1)             # <<<<<<<<<<<<<<
  *     def __call__(self, ts):
  *         '''calculate all'''
  */
-  a_polytrack3_init(__pyx_v_self->ctx, __pyx_v_t0, __pyx_v_t1, __pyx_v_q0, __pyx_v_q1, __pyx_v_v0, __pyx_v_v1);
+  a_polytrack3_init((&__pyx_v_self->ctx), __pyx_v_t0, __pyx_v_t1, __pyx_v_q0, __pyx_v_q1, __pyx_v_v0, __pyx_v_v1);
 
-  /* "ffi/python/src/a/polytrack.pxi":8
+  /* "python/src/a/polytrack.pxi":8
  *     '''cubic polynomial trajectory'''
- *     cdef a_polytrack3_s ctx[1]
+ *     cdef a_polytrack3_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0):             # <<<<<<<<<<<<<<
- *         a_polytrack3_init(self.ctx, t0, t1, q0, q1, v0, v1)
+ *         a_polytrack3_init(&self.ctx, t0, t1, q0, q1, v0, v1)
  *     def __call__(self, ts):
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":10
+/* "python/src/a/polytrack.pxi":10
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0):
- *         a_polytrack3_init(self.ctx, t0, t1, q0, q1, v0, v1)
+ *         a_polytrack3_init(&self.ctx, t0, t1, q0, q1, v0, v1)
  *     def __call__(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack3_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_4liba_10polytrack3_2__call__[] = "calculate all";
-#if CYTHON_COMPILING_IN_CPYTHON
+#if CYTHON_UPDATE_DESCRIPTOR_DOC
 struct wrapperbase __pyx_wrapperbase_4liba_10polytrack3_2__call__;
 #endif
 static PyObject *__pyx_pw_4liba_10polytrack3_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_ts = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
@@ -13719,71 +14316,71 @@
   a_real_t __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__call__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":13
+  /* "python/src/a/polytrack.pxi":13
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             p = reals(ts)
  *             v = reals(ts)
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":14
+    /* "python/src/a/polytrack.pxi":14
  *         cdef a_real_t out[3]
  *         if iterable(ts):
  *             p = reals(ts)             # <<<<<<<<<<<<<<
  *             v = reals(ts)
  *             a = reals(ts)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 14, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_p = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":15
+    /* "python/src/a/polytrack.pxi":15
  *         if iterable(ts):
  *             p = reals(ts)
  *             v = reals(ts)             # <<<<<<<<<<<<<<
  *             a = reals(ts)
  *             for i, it in enumerate(ts):
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 15, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_v = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":16
+    /* "python/src/a/polytrack.pxi":16
  *             p = reals(ts)
  *             v = reals(ts)
  *             a = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 a_polytrack3_out(self.ctx, it, out)
+ *                 a_polytrack3_out(&self.ctx, it, out)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 16, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_a = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":17
+    /* "python/src/a/polytrack.pxi":17
  *             v = reals(ts)
  *             a = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 a_polytrack3_out(self.ctx, it, out)
+ *                 a_polytrack3_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -13829,76 +14426,76 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 17, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":18
+      /* "python/src/a/polytrack.pxi":18
  *             a = reals(ts)
  *             for i, it in enumerate(ts):
- *                 a_polytrack3_out(self.ctx, it, out)             # <<<<<<<<<<<<<<
+ *                 a_polytrack3_out(&self.ctx, it, out)             # <<<<<<<<<<<<<<
  *                 p[i] = out[0]
  *                 v[i] = out[1]
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 18, __pyx_L1_error)
-      a_polytrack3_out(__pyx_v_self->ctx, __pyx_t_8, __pyx_v_out);
+      a_polytrack3_out((&__pyx_v_self->ctx), __pyx_t_8, __pyx_v_out);
 
-      /* "ffi/python/src/a/polytrack.pxi":19
+      /* "python/src/a/polytrack.pxi":19
  *             for i, it in enumerate(ts):
- *                 a_polytrack3_out(self.ctx, it, out)
+ *                 a_polytrack3_out(&self.ctx, it, out)
  *                 p[i] = out[0]             # <<<<<<<<<<<<<<
  *                 v[i] = out[1]
  *                 a[i] = out[2]
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 19, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_p), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 19, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":20
- *                 a_polytrack3_out(self.ctx, it, out)
+      /* "python/src/a/polytrack.pxi":20
+ *                 a_polytrack3_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  *                 v[i] = out[1]             # <<<<<<<<<<<<<<
  *                 a[i] = out[2]
  *             return p, v, a
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 20, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_v), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 20, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":21
+      /* "python/src/a/polytrack.pxi":21
  *                 p[i] = out[0]
  *                 v[i] = out[1]
  *                 a[i] = out[2]             # <<<<<<<<<<<<<<
  *             return p, v, a
- *         a_polytrack3_out(self.ctx, ts, out)
+ *         a_polytrack3_out(&self.ctx, ts, out)
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[2])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 21, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_a), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 21, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":17
+      /* "python/src/a/polytrack.pxi":17
  *             v = reals(ts)
  *             a = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 a_polytrack3_out(self.ctx, it, out)
+ *                 a_polytrack3_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":22
+    /* "python/src/a/polytrack.pxi":22
  *                 v[i] = out[1]
  *                 a[i] = out[2]
  *             return p, v, a             # <<<<<<<<<<<<<<
- *         a_polytrack3_out(self.ctx, ts, out)
+ *         a_polytrack3_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 22, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_p));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_p));
@@ -13909,36 +14506,36 @@
     __Pyx_INCREF(((PyObject *)__pyx_v_a));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_a));
     PyTuple_SET_ITEM(__pyx_t_2, 2, ((PyObject *)__pyx_v_a));
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":13
+    /* "python/src/a/polytrack.pxi":13
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             p = reals(ts)
  *             v = reals(ts)
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":23
+  /* "python/src/a/polytrack.pxi":23
  *                 a[i] = out[2]
  *             return p, v, a
- *         a_polytrack3_out(self.ctx, ts, out)             # <<<<<<<<<<<<<<
+ *         a_polytrack3_out(&self.ctx, ts, out)             # <<<<<<<<<<<<<<
  *         return out[0], out[1], out[2]
  *     def pos(self, ts):
  */
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 23, __pyx_L1_error)
-  a_polytrack3_out(__pyx_v_self->ctx, __pyx_t_8, __pyx_v_out);
+  a_polytrack3_out((&__pyx_v_self->ctx), __pyx_t_8, __pyx_v_out);
 
-  /* "ffi/python/src/a/polytrack.pxi":24
+  /* "python/src/a/polytrack.pxi":24
  *             return p, v, a
- *         a_polytrack3_out(self.ctx, ts, out)
+ *         a_polytrack3_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]             # <<<<<<<<<<<<<<
  *     def pos(self, ts):
  *         '''calculate position'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2 = PyFloat_FromDouble((__pyx_v_out[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 24, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -13957,17 +14554,17 @@
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
   __pyx_t_7 = 0;
   __pyx_r = __pyx_t_9;
   __pyx_t_9 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":10
+  /* "python/src/a/polytrack.pxi":10
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0):
- *         a_polytrack3_init(self.ctx, t0, t1, q0, q1, v0, v1)
+ *         a_polytrack3_init(&self.ctx, t0, t1, q0, q1, v0, v1)
  *     def __call__(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13984,16 +14581,16 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":25
- *         a_polytrack3_out(self.ctx, ts, out)
+/* "python/src/a/polytrack.pxi":25
+ *         a_polytrack3_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]
  *     def pos(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate position'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
@@ -14025,43 +14622,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("pos", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":27
+  /* "python/src/a/polytrack.pxi":27
  *     def pos(self, ts):
  *         '''calculate position'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":28
+    /* "python/src/a/polytrack.pxi":28
  *         '''calculate position'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_pos(self.ctx, it)
+ *                 out[i] = a_polytrack3_pos(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 28, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":29
+    /* "python/src/a/polytrack.pxi":29
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack3_pos(self.ctx, it)
+ *                 out[i] = a_polytrack3_pos(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -14107,76 +14704,76 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 29, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":30
+      /* "python/src/a/polytrack.pxi":30
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_pos(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack3_pos(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack3_pos(self.ctx, ts)
+ *         return a_polytrack3_pos(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 30, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack3_pos(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 30, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack3_pos((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 30, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 30, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":29
+      /* "python/src/a/polytrack.pxi":29
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack3_pos(self.ctx, it)
+ *                 out[i] = a_polytrack3_pos(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":31
+    /* "python/src/a/polytrack.pxi":31
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_pos(self.ctx, it)
+ *                 out[i] = a_polytrack3_pos(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack3_pos(self.ctx, ts)
+ *         return a_polytrack3_pos(&self.ctx, ts)
  *     def vec(self, ts):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":27
+    /* "python/src/a/polytrack.pxi":27
  *     def pos(self, ts):
  *         '''calculate position'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":32
- *                 out[i] = a_polytrack3_pos(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":32
+ *                 out[i] = a_polytrack3_pos(&self.ctx, it)
  *             return out
- *         return a_polytrack3_pos(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack3_pos(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def vec(self, ts):
  *         '''calculate velocity'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 32, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack3_pos(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 32, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack3_pos((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 32, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":25
- *         a_polytrack3_out(self.ctx, ts, out)
+  /* "python/src/a/polytrack.pxi":25
+ *         a_polytrack3_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]
  *     def pos(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate position'''
  *         if iterable(ts):
  */
 
   /* function exit code */
@@ -14191,17 +14788,17 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":33
+/* "python/src/a/polytrack.pxi":33
  *             return out
- *         return a_polytrack3_pos(self.ctx, ts)
+ *         return a_polytrack3_pos(&self.ctx, ts)
  *     def vec(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate velocity'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack3_7vec(PyObject *__pyx_v_self, PyObject *__pyx_v_ts); /*proto*/
@@ -14232,43 +14829,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("vec", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":35
+  /* "python/src/a/polytrack.pxi":35
  *     def vec(self, ts):
  *         '''calculate velocity'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":36
+    /* "python/src/a/polytrack.pxi":36
  *         '''calculate velocity'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_vec(self.ctx, it)
+ *                 out[i] = a_polytrack3_vec(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 36, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":37
+    /* "python/src/a/polytrack.pxi":37
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack3_vec(self.ctx, it)
+ *                 out[i] = a_polytrack3_vec(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -14314,77 +14911,77 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 37, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":38
+      /* "python/src/a/polytrack.pxi":38
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_vec(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack3_vec(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack3_vec(self.ctx, ts)
+ *         return a_polytrack3_vec(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 38, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack3_vec(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 38, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack3_vec((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 38, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 38, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":37
+      /* "python/src/a/polytrack.pxi":37
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack3_vec(self.ctx, it)
+ *                 out[i] = a_polytrack3_vec(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":39
+    /* "python/src/a/polytrack.pxi":39
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_vec(self.ctx, it)
+ *                 out[i] = a_polytrack3_vec(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack3_vec(self.ctx, ts)
+ *         return a_polytrack3_vec(&self.ctx, ts)
  *     def acc(self, ts):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":35
+    /* "python/src/a/polytrack.pxi":35
  *     def vec(self, ts):
  *         '''calculate velocity'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":40
- *                 out[i] = a_polytrack3_vec(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":40
+ *                 out[i] = a_polytrack3_vec(&self.ctx, it)
  *             return out
- *         return a_polytrack3_vec(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack3_vec(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 40, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack3_vec(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 40, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack3_vec((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 40, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":33
+  /* "python/src/a/polytrack.pxi":33
  *             return out
- *         return a_polytrack3_pos(self.ctx, ts)
+ *         return a_polytrack3_pos(&self.ctx, ts)
  *     def vec(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate velocity'''
  *         if iterable(ts):
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14398,17 +14995,17 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":41
+/* "python/src/a/polytrack.pxi":41
  *             return out
- *         return a_polytrack3_vec(self.ctx, ts)
+ *         return a_polytrack3_vec(&self.ctx, ts)
  *     def acc(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate acceleration'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack3_9acc(PyObject *__pyx_v_self, PyObject *__pyx_v_ts); /*proto*/
@@ -14439,43 +15036,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("acc", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":43
+  /* "python/src/a/polytrack.pxi":43
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":44
+    /* "python/src/a/polytrack.pxi":44
  *         '''calculate acceleration'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_acc(self.ctx, it)
+ *                 out[i] = a_polytrack3_acc(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 44, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":45
+    /* "python/src/a/polytrack.pxi":45
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack3_acc(self.ctx, it)
+ *                 out[i] = a_polytrack3_acc(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -14521,77 +15118,77 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 45, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":46
+      /* "python/src/a/polytrack.pxi":46
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_acc(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack3_acc(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack3_acc(self.ctx, ts)
+ *         return a_polytrack3_acc(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 46, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack3_acc(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 46, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack3_acc((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 46, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 46, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":45
+      /* "python/src/a/polytrack.pxi":45
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack3_acc(self.ctx, it)
+ *                 out[i] = a_polytrack3_acc(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":47
+    /* "python/src/a/polytrack.pxi":47
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack3_acc(self.ctx, it)
+ *                 out[i] = a_polytrack3_acc(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack3_acc(self.ctx, ts)
+ *         return a_polytrack3_acc(&self.ctx, ts)
  *     def gen(self):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":43
+    /* "python/src/a/polytrack.pxi":43
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":48
- *                 out[i] = a_polytrack3_acc(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":48
+ *                 out[i] = a_polytrack3_acc(&self.ctx, it)
  *             return out
- *         return a_polytrack3_acc(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack3_acc(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def gen(self):
  *         '''generation function'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 48, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack3_acc(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 48, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack3_acc((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 48, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":41
+  /* "python/src/a/polytrack.pxi":41
  *             return out
- *         return a_polytrack3_vec(self.ctx, ts)
+ *         return a_polytrack3_vec(&self.ctx, ts)
  *     def acc(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate acceleration'''
  *         if iterable(ts):
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14605,20 +15202,20 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":49
+/* "python/src/a/polytrack.pxi":49
  *             return out
- *         return a_polytrack3_acc(self.ctx, ts)
+ *         return a_polytrack3_acc(&self.ctx, ts)
  *     def gen(self):             # <<<<<<<<<<<<<<
  *         '''generation function'''
- *         a_polytrack3_gen(self.ctx)
+ *         a_polytrack3_gen(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack3_11gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_10polytrack3_10gen[] = "generation function";
 static PyObject *__pyx_pw_4liba_10polytrack3_11gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -14632,39 +15229,39 @@
 }
 
 static PyObject *__pyx_pf_4liba_10polytrack3_10gen(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("gen", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":51
+  /* "python/src/a/polytrack.pxi":51
  *     def gen(self):
  *         '''generation function'''
- *         a_polytrack3_gen(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_polytrack3_gen(&self.ctx)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_polytrack3_gen(__pyx_v_self->ctx);
+  a_polytrack3_gen((&__pyx_v_self->ctx));
 
-  /* "ffi/python/src/a/polytrack.pxi":49
+  /* "python/src/a/polytrack.pxi":49
  *             return out
- *         return a_polytrack3_acc(self.ctx, ts)
+ *         return a_polytrack3_acc(&self.ctx, ts)
  *     def gen(self):             # <<<<<<<<<<<<<<
  *         '''generation function'''
- *         a_polytrack3_gen(self.ctx)
+ *         a_polytrack3_gen(&self.ctx)
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":54
+/* "python/src/a/polytrack.pxi":54
  * 
  *     @property
  *     def k(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.k
  * 
  */
 
@@ -14686,29 +15283,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":55
+  /* "python/src/a/polytrack.pxi":55
  *     @property
  *     def k(self):
  *         return self.ctx.k             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->k, 4); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 55, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.k, 4); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":54
+  /* "python/src/a/polytrack.pxi":54
  * 
  *     @property
  *     def k(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.k
  * 
  */
 
@@ -14719,15 +15316,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":58
+/* "python/src/a/polytrack.pxi":58
  * 
  *     @property
  *     def t(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.t
  *     @t.setter
  */
 
@@ -14749,29 +15346,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":59
+  /* "python/src/a/polytrack.pxi":59
  *     @property
  *     def t(self):
  *         return self.ctx.t             # <<<<<<<<<<<<<<
  *     @t.setter
  *     def t(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->t, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 59, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.t, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":58
+  /* "python/src/a/polytrack.pxi":58
  * 
  *     @property
  *     def t(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.t
  *     @t.setter
  */
 
@@ -14782,15 +15379,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":61
+/* "python/src/a/polytrack.pxi":61
  *         return self.ctx.t
  *     @t.setter
  *     def t(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]
  */
 
@@ -14813,41 +15410,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":62
+  /* "python/src/a/polytrack.pxi":62
  *     @t.setter
  *     def t(self, val):
  *         self.ctx.t[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 62, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 62, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->t[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.t[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":63
+  /* "python/src/a/polytrack.pxi":63
  *     def t(self, val):
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 63, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 63, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->t[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.t[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":61
+  /* "python/src/a/polytrack.pxi":61
  *         return self.ctx.t
  *     @t.setter
  *     def t(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]
  */
 
@@ -14859,15 +15456,15 @@
   __Pyx_AddTraceback("liba.polytrack3.t.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":66
+/* "python/src/a/polytrack.pxi":66
  * 
  *     @property
  *     def q(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.q
  *     @q.setter
  */
 
@@ -14889,29 +15486,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":67
+  /* "python/src/a/polytrack.pxi":67
  *     @property
  *     def q(self):
  *         return self.ctx.q             # <<<<<<<<<<<<<<
  *     @q.setter
  *     def q(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->q, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 67, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.q, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 67, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":66
+  /* "python/src/a/polytrack.pxi":66
  * 
  *     @property
  *     def q(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.q
  *     @q.setter
  */
 
@@ -14922,15 +15519,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":69
+/* "python/src/a/polytrack.pxi":69
  *         return self.ctx.q
  *     @q.setter
  *     def q(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]
  */
 
@@ -14953,41 +15550,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":70
+  /* "python/src/a/polytrack.pxi":70
  *     @q.setter
  *     def q(self, val):
  *         self.ctx.q[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 70, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 70, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->q[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.q[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":71
+  /* "python/src/a/polytrack.pxi":71
  *     def q(self, val):
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 71, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 71, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->q[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.q[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":69
+  /* "python/src/a/polytrack.pxi":69
  *         return self.ctx.q
  *     @q.setter
  *     def q(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]
  */
 
@@ -14999,15 +15596,15 @@
   __Pyx_AddTraceback("liba.polytrack3.q.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":74
+/* "python/src/a/polytrack.pxi":74
  * 
  *     @property
  *     def v(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.v
  *     @v.setter
  */
 
@@ -15029,29 +15626,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":75
+  /* "python/src/a/polytrack.pxi":75
  *     @property
  *     def v(self):
  *         return self.ctx.v             # <<<<<<<<<<<<<<
  *     @v.setter
  *     def v(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->v, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 75, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.v, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 75, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":74
+  /* "python/src/a/polytrack.pxi":74
  * 
  *     @property
  *     def v(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.v
  *     @v.setter
  */
 
@@ -15062,15 +15659,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":77
+/* "python/src/a/polytrack.pxi":77
  *         return self.ctx.v
  *     @v.setter
  *     def v(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]
  */
 
@@ -15093,41 +15690,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":78
+  /* "python/src/a/polytrack.pxi":78
  *     @v.setter
  *     def v(self, val):
  *         self.ctx.v[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 78, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 78, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->v[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.v[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":79
+  /* "python/src/a/polytrack.pxi":79
  *     def v(self, val):
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 79, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 79, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->v[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.v[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":77
+  /* "python/src/a/polytrack.pxi":77
  *         return self.ctx.v
  *     @v.setter
  *     def v(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]
  */
 
@@ -15139,15 +15736,15 @@
   __Pyx_AddTraceback("liba.polytrack3.v.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":82
+/* "python/src/a/polytrack.pxi":82
  * 
  *     @property
  *     def t0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[0]
  *     @t0.setter
  */
 
@@ -15169,29 +15766,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":83
+  /* "python/src/a/polytrack.pxi":83
  *     @property
  *     def t0(self) -> a_real_t:
  *         return self.ctx.t[0]             # <<<<<<<<<<<<<<
  *     @t0.setter
  *     def t0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->t[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 83, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.t[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 83, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":82
+  /* "python/src/a/polytrack.pxi":82
  * 
  *     @property
  *     def t0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[0]
  *     @t0.setter
  */
 
@@ -15202,15 +15799,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":85
+/* "python/src/a/polytrack.pxi":85
  *         return self.ctx.t[0]
  *     @t0.setter
  *     def t0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val
  * 
  */
 
@@ -15241,38 +15838,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack3_2t0_2__set__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":86
+  /* "python/src/a/polytrack.pxi":86
  *     @t0.setter
  *     def t0(self, val: a_real_t):
  *         self.ctx.t[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->t[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.t[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":85
+  /* "python/src/a/polytrack.pxi":85
  *         return self.ctx.t[0]
  *     @t0.setter
  *     def t0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":89
+/* "python/src/a/polytrack.pxi":89
  * 
  *     @property
  *     def q0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[0]
  *     @q0.setter
  */
 
@@ -15294,29 +15891,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":90
+  /* "python/src/a/polytrack.pxi":90
  *     @property
  *     def q0(self) -> a_real_t:
  *         return self.ctx.q[0]             # <<<<<<<<<<<<<<
  *     @q0.setter
  *     def q0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->q[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 90, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.q[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 90, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":89
+  /* "python/src/a/polytrack.pxi":89
  * 
  *     @property
  *     def q0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[0]
  *     @q0.setter
  */
 
@@ -15327,15 +15924,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":92
+/* "python/src/a/polytrack.pxi":92
  *         return self.ctx.q[0]
  *     @q0.setter
  *     def q0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val
  * 
  */
 
@@ -15366,38 +15963,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack3_2q0_2__set__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":93
+  /* "python/src/a/polytrack.pxi":93
  *     @q0.setter
  *     def q0(self, val: a_real_t):
  *         self.ctx.q[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->q[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.q[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":92
+  /* "python/src/a/polytrack.pxi":92
  *         return self.ctx.q[0]
  *     @q0.setter
  *     def q0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":96
+/* "python/src/a/polytrack.pxi":96
  * 
  *     @property
  *     def v0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[0]
  *     @v0.setter
  */
 
@@ -15419,29 +16016,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":97
+  /* "python/src/a/polytrack.pxi":97
  *     @property
  *     def v0(self) -> a_real_t:
  *         return self.ctx.v[0]             # <<<<<<<<<<<<<<
  *     @v0.setter
  *     def v0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->v[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 97, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.v[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 97, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":96
+  /* "python/src/a/polytrack.pxi":96
  * 
  *     @property
  *     def v0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[0]
  *     @v0.setter
  */
 
@@ -15452,15 +16049,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":99
+/* "python/src/a/polytrack.pxi":99
  *         return self.ctx.v[0]
  *     @v0.setter
  *     def v0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val
  * 
  */
 
@@ -15491,38 +16088,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack3_2v0_2__set__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":100
+  /* "python/src/a/polytrack.pxi":100
  *     @v0.setter
  *     def v0(self, val: a_real_t):
  *         self.ctx.v[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->v[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.v[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":99
+  /* "python/src/a/polytrack.pxi":99
  *         return self.ctx.v[0]
  *     @v0.setter
  *     def v0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":103
+/* "python/src/a/polytrack.pxi":103
  * 
  *     @property
  *     def t1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[1]
  *     @t1.setter
  */
 
@@ -15544,29 +16141,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":104
+  /* "python/src/a/polytrack.pxi":104
  *     @property
  *     def t1(self) -> a_real_t:
  *         return self.ctx.t[1]             # <<<<<<<<<<<<<<
  *     @t1.setter
  *     def t1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->t[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 104, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.t[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":103
+  /* "python/src/a/polytrack.pxi":103
  * 
  *     @property
  *     def t1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[1]
  *     @t1.setter
  */
 
@@ -15577,15 +16174,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":106
+/* "python/src/a/polytrack.pxi":106
  *         return self.ctx.t[1]
  *     @t1.setter
  *     def t1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val
  * 
  */
 
@@ -15616,38 +16213,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack3_2t1_2__set__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":107
+  /* "python/src/a/polytrack.pxi":107
  *     @t1.setter
  *     def t1(self, val: a_real_t):
  *         self.ctx.t[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->t[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.t[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":106
+  /* "python/src/a/polytrack.pxi":106
  *         return self.ctx.t[1]
  *     @t1.setter
  *     def t1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":110
+/* "python/src/a/polytrack.pxi":110
  * 
  *     @property
  *     def q1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[1]
  *     @q1.setter
  */
 
@@ -15669,29 +16266,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":111
+  /* "python/src/a/polytrack.pxi":111
  *     @property
  *     def q1(self) -> a_real_t:
  *         return self.ctx.q[1]             # <<<<<<<<<<<<<<
  *     @q1.setter
  *     def q1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->q[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 111, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.q[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":110
+  /* "python/src/a/polytrack.pxi":110
  * 
  *     @property
  *     def q1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[1]
  *     @q1.setter
  */
 
@@ -15702,15 +16299,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":113
+/* "python/src/a/polytrack.pxi":113
  *         return self.ctx.q[1]
  *     @q1.setter
  *     def q1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val
  * 
  */
 
@@ -15741,38 +16338,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack3_2q1_2__set__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":114
+  /* "python/src/a/polytrack.pxi":114
  *     @q1.setter
  *     def q1(self, val: a_real_t):
  *         self.ctx.q[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->q[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.q[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":113
+  /* "python/src/a/polytrack.pxi":113
  *         return self.ctx.q[1]
  *     @q1.setter
  *     def q1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":117
+/* "python/src/a/polytrack.pxi":117
  * 
  *     @property
  *     def v1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[1]
  *     @v1.setter
  */
 
@@ -15794,29 +16391,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":118
+  /* "python/src/a/polytrack.pxi":118
  *     @property
  *     def v1(self) -> a_real_t:
  *         return self.ctx.v[1]             # <<<<<<<<<<<<<<
  *     @v1.setter
  *     def v1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->v[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 118, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.v[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":117
+  /* "python/src/a/polytrack.pxi":117
  * 
  *     @property
  *     def v1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[1]
  *     @v1.setter
  */
 
@@ -15827,15 +16424,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":120
+/* "python/src/a/polytrack.pxi":120
  *         return self.ctx.v[1]
  *     @v1.setter
  *     def v1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val
  * 
  */
 
@@ -15866,24 +16463,24 @@
 }
 
 static int __pyx_pf_4liba_10polytrack3_2v1_2__set__(struct __pyx_obj_4liba_polytrack3 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":121
+  /* "python/src/a/polytrack.pxi":121
  *     @v1.setter
  *     def v1(self, val: a_real_t):
  *         self.ctx.v[1] = val             # <<<<<<<<<<<<<<
  * 
  * @cython.wraparound(False)
  */
-  (__pyx_v_self->ctx->v[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.v[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":120
+  /* "python/src/a/polytrack.pxi":120
  *         return self.ctx.v[1]
  *     @v1.setter
  *     def v1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val
  * 
  */
 
@@ -16002,19 +16599,19 @@
   __Pyx_AddTraceback("liba.polytrack3.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":128
+/* "python/src/a/polytrack.pxi":128
  *     '''quintic polynomial trajectory'''
- *     cdef a_polytrack5_s ctx[1]
+ *     cdef a_polytrack5_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0):             # <<<<<<<<<<<<<<
- *         a_polytrack5_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
+ *         a_polytrack5_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
  *     def __call__(self, ts):
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_10polytrack5_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_pw_4liba_10polytrack5_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_t0;
@@ -16167,49 +16764,49 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5___cinit__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_t0, a_real_t __pyx_v_t1, a_real_t __pyx_v_q0, a_real_t __pyx_v_q1, a_real_t __pyx_v_v0, a_real_t __pyx_v_v1, a_real_t __pyx_v_a0, a_real_t __pyx_v_a1) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":129
- *     cdef a_polytrack5_s ctx[1]
+  /* "python/src/a/polytrack.pxi":129
+ *     cdef a_polytrack5_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0):
- *         a_polytrack5_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)             # <<<<<<<<<<<<<<
+ *         a_polytrack5_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)             # <<<<<<<<<<<<<<
  *     def __call__(self, ts):
  *         '''calculate all'''
  */
-  a_polytrack5_init(__pyx_v_self->ctx, __pyx_v_t0, __pyx_v_t1, __pyx_v_q0, __pyx_v_q1, __pyx_v_v0, __pyx_v_v1, __pyx_v_a0, __pyx_v_a1);
+  a_polytrack5_init((&__pyx_v_self->ctx), __pyx_v_t0, __pyx_v_t1, __pyx_v_q0, __pyx_v_q1, __pyx_v_v0, __pyx_v_v1, __pyx_v_a0, __pyx_v_a1);
 
-  /* "ffi/python/src/a/polytrack.pxi":128
+  /* "python/src/a/polytrack.pxi":128
  *     '''quintic polynomial trajectory'''
- *     cdef a_polytrack5_s ctx[1]
+ *     cdef a_polytrack5_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0):             # <<<<<<<<<<<<<<
- *         a_polytrack5_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
+ *         a_polytrack5_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
  *     def __call__(self, ts):
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":130
+/* "python/src/a/polytrack.pxi":130
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0):
- *         a_polytrack5_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
+ *         a_polytrack5_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
  *     def __call__(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack5_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_4liba_10polytrack5_2__call__[] = "calculate all";
-#if CYTHON_COMPILING_IN_CPYTHON
+#if CYTHON_UPDATE_DESCRIPTOR_DOC
 struct wrapperbase __pyx_wrapperbase_4liba_10polytrack5_2__call__;
 #endif
 static PyObject *__pyx_pw_4liba_10polytrack5_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_ts = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
@@ -16278,71 +16875,71 @@
   a_real_t __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__call__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":133
+  /* "python/src/a/polytrack.pxi":133
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             p = reals(ts)
  *             v = reals(ts)
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":134
+    /* "python/src/a/polytrack.pxi":134
  *         cdef a_real_t out[3]
  *         if iterable(ts):
  *             p = reals(ts)             # <<<<<<<<<<<<<<
  *             v = reals(ts)
  *             a = reals(ts)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_p = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":135
+    /* "python/src/a/polytrack.pxi":135
  *         if iterable(ts):
  *             p = reals(ts)
  *             v = reals(ts)             # <<<<<<<<<<<<<<
  *             a = reals(ts)
  *             for i, it in enumerate(ts):
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 135, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_v = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":136
+    /* "python/src/a/polytrack.pxi":136
  *             p = reals(ts)
  *             v = reals(ts)
  *             a = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 a_polytrack5_out(self.ctx, it, out)
+ *                 a_polytrack5_out(&self.ctx, it, out)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 136, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_a = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":137
+    /* "python/src/a/polytrack.pxi":137
  *             v = reals(ts)
  *             a = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 a_polytrack5_out(self.ctx, it, out)
+ *                 a_polytrack5_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -16388,76 +16985,76 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 137, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":138
+      /* "python/src/a/polytrack.pxi":138
  *             a = reals(ts)
  *             for i, it in enumerate(ts):
- *                 a_polytrack5_out(self.ctx, it, out)             # <<<<<<<<<<<<<<
+ *                 a_polytrack5_out(&self.ctx, it, out)             # <<<<<<<<<<<<<<
  *                 p[i] = out[0]
  *                 v[i] = out[1]
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 138, __pyx_L1_error)
-      a_polytrack5_out(__pyx_v_self->ctx, __pyx_t_8, __pyx_v_out);
+      a_polytrack5_out((&__pyx_v_self->ctx), __pyx_t_8, __pyx_v_out);
 
-      /* "ffi/python/src/a/polytrack.pxi":139
+      /* "python/src/a/polytrack.pxi":139
  *             for i, it in enumerate(ts):
- *                 a_polytrack5_out(self.ctx, it, out)
+ *                 a_polytrack5_out(&self.ctx, it, out)
  *                 p[i] = out[0]             # <<<<<<<<<<<<<<
  *                 v[i] = out[1]
  *                 a[i] = out[2]
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 139, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_p), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 139, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":140
- *                 a_polytrack5_out(self.ctx, it, out)
+      /* "python/src/a/polytrack.pxi":140
+ *                 a_polytrack5_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  *                 v[i] = out[1]             # <<<<<<<<<<<<<<
  *                 a[i] = out[2]
  *             return p, v, a
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 140, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_v), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 140, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":141
+      /* "python/src/a/polytrack.pxi":141
  *                 p[i] = out[0]
  *                 v[i] = out[1]
  *                 a[i] = out[2]             # <<<<<<<<<<<<<<
  *             return p, v, a
- *         a_polytrack5_out(self.ctx, ts, out)
+ *         a_polytrack5_out(&self.ctx, ts, out)
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[2])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 141, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_a), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 141, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":137
+      /* "python/src/a/polytrack.pxi":137
  *             v = reals(ts)
  *             a = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 a_polytrack5_out(self.ctx, it, out)
+ *                 a_polytrack5_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":142
+    /* "python/src/a/polytrack.pxi":142
  *                 v[i] = out[1]
  *                 a[i] = out[2]
  *             return p, v, a             # <<<<<<<<<<<<<<
- *         a_polytrack5_out(self.ctx, ts, out)
+ *         a_polytrack5_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 142, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_p));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_p));
@@ -16468,36 +17065,36 @@
     __Pyx_INCREF(((PyObject *)__pyx_v_a));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_a));
     PyTuple_SET_ITEM(__pyx_t_2, 2, ((PyObject *)__pyx_v_a));
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":133
+    /* "python/src/a/polytrack.pxi":133
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             p = reals(ts)
  *             v = reals(ts)
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":143
+  /* "python/src/a/polytrack.pxi":143
  *                 a[i] = out[2]
  *             return p, v, a
- *         a_polytrack5_out(self.ctx, ts, out)             # <<<<<<<<<<<<<<
+ *         a_polytrack5_out(&self.ctx, ts, out)             # <<<<<<<<<<<<<<
  *         return out[0], out[1], out[2]
  *     def pos(self, ts):
  */
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 143, __pyx_L1_error)
-  a_polytrack5_out(__pyx_v_self->ctx, __pyx_t_8, __pyx_v_out);
+  a_polytrack5_out((&__pyx_v_self->ctx), __pyx_t_8, __pyx_v_out);
 
-  /* "ffi/python/src/a/polytrack.pxi":144
+  /* "python/src/a/polytrack.pxi":144
  *             return p, v, a
- *         a_polytrack5_out(self.ctx, ts, out)
+ *         a_polytrack5_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]             # <<<<<<<<<<<<<<
  *     def pos(self, ts):
  *         '''calculate position'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2 = PyFloat_FromDouble((__pyx_v_out[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 144, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -16516,17 +17113,17 @@
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
   __pyx_t_7 = 0;
   __pyx_r = __pyx_t_9;
   __pyx_t_9 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":130
+  /* "python/src/a/polytrack.pxi":130
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0):
- *         a_polytrack5_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
+ *         a_polytrack5_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1)
  *     def __call__(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate all'''
  *         cdef a_real_t out[3]
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -16543,16 +17140,16 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":145
- *         a_polytrack5_out(self.ctx, ts, out)
+/* "python/src/a/polytrack.pxi":145
+ *         a_polytrack5_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]
  *     def pos(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate position'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
@@ -16584,43 +17181,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("pos", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":147
+  /* "python/src/a/polytrack.pxi":147
  *     def pos(self, ts):
  *         '''calculate position'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":148
+    /* "python/src/a/polytrack.pxi":148
  *         '''calculate position'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_pos(self.ctx, it)
+ *                 out[i] = a_polytrack5_pos(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":149
+    /* "python/src/a/polytrack.pxi":149
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack5_pos(self.ctx, it)
+ *                 out[i] = a_polytrack5_pos(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -16666,76 +17263,76 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 149, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":150
+      /* "python/src/a/polytrack.pxi":150
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_pos(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack5_pos(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack5_pos(self.ctx, ts)
+ *         return a_polytrack5_pos(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 150, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack5_pos(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 150, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack5_pos((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 150, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 150, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":149
+      /* "python/src/a/polytrack.pxi":149
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack5_pos(self.ctx, it)
+ *                 out[i] = a_polytrack5_pos(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":151
+    /* "python/src/a/polytrack.pxi":151
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_pos(self.ctx, it)
+ *                 out[i] = a_polytrack5_pos(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack5_pos(self.ctx, ts)
+ *         return a_polytrack5_pos(&self.ctx, ts)
  *     def vec(self, ts):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":147
+    /* "python/src/a/polytrack.pxi":147
  *     def pos(self, ts):
  *         '''calculate position'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":152
- *                 out[i] = a_polytrack5_pos(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":152
+ *                 out[i] = a_polytrack5_pos(&self.ctx, it)
  *             return out
- *         return a_polytrack5_pos(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack5_pos(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def vec(self, ts):
  *         '''calculate velocity'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 152, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack5_pos(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 152, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack5_pos((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":145
- *         a_polytrack5_out(self.ctx, ts, out)
+  /* "python/src/a/polytrack.pxi":145
+ *         a_polytrack5_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2]
  *     def pos(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate position'''
  *         if iterable(ts):
  */
 
   /* function exit code */
@@ -16750,17 +17347,17 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":153
+/* "python/src/a/polytrack.pxi":153
  *             return out
- *         return a_polytrack5_pos(self.ctx, ts)
+ *         return a_polytrack5_pos(&self.ctx, ts)
  *     def vec(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate velocity'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack5_7vec(PyObject *__pyx_v_self, PyObject *__pyx_v_ts); /*proto*/
@@ -16791,43 +17388,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("vec", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":155
+  /* "python/src/a/polytrack.pxi":155
  *     def vec(self, ts):
  *         '''calculate velocity'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":156
+    /* "python/src/a/polytrack.pxi":156
  *         '''calculate velocity'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_vec(self.ctx, it)
+ *                 out[i] = a_polytrack5_vec(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 156, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":157
+    /* "python/src/a/polytrack.pxi":157
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack5_vec(self.ctx, it)
+ *                 out[i] = a_polytrack5_vec(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -16873,77 +17470,77 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 157, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":158
+      /* "python/src/a/polytrack.pxi":158
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_vec(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack5_vec(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack5_vec(self.ctx, ts)
+ *         return a_polytrack5_vec(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 158, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack5_vec(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 158, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack5_vec((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 158, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 158, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":157
+      /* "python/src/a/polytrack.pxi":157
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack5_vec(self.ctx, it)
+ *                 out[i] = a_polytrack5_vec(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":159
+    /* "python/src/a/polytrack.pxi":159
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_vec(self.ctx, it)
+ *                 out[i] = a_polytrack5_vec(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack5_vec(self.ctx, ts)
+ *         return a_polytrack5_vec(&self.ctx, ts)
  *     def acc(self, ts):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":155
+    /* "python/src/a/polytrack.pxi":155
  *     def vec(self, ts):
  *         '''calculate velocity'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":160
- *                 out[i] = a_polytrack5_vec(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":160
+ *                 out[i] = a_polytrack5_vec(&self.ctx, it)
  *             return out
- *         return a_polytrack5_vec(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack5_vec(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 160, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack5_vec(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 160, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack5_vec((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 160, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":153
+  /* "python/src/a/polytrack.pxi":153
  *             return out
- *         return a_polytrack5_pos(self.ctx, ts)
+ *         return a_polytrack5_pos(&self.ctx, ts)
  *     def vec(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate velocity'''
  *         if iterable(ts):
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -16957,17 +17554,17 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":161
+/* "python/src/a/polytrack.pxi":161
  *             return out
- *         return a_polytrack5_vec(self.ctx, ts)
+ *         return a_polytrack5_vec(&self.ctx, ts)
  *     def acc(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate acceleration'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack5_9acc(PyObject *__pyx_v_self, PyObject *__pyx_v_ts); /*proto*/
@@ -16998,43 +17595,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("acc", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":163
+  /* "python/src/a/polytrack.pxi":163
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":164
+    /* "python/src/a/polytrack.pxi":164
  *         '''calculate acceleration'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_acc(self.ctx, it)
+ *                 out[i] = a_polytrack5_acc(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 164, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":165
+    /* "python/src/a/polytrack.pxi":165
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack5_acc(self.ctx, it)
+ *                 out[i] = a_polytrack5_acc(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -17080,77 +17677,77 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 165, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":166
+      /* "python/src/a/polytrack.pxi":166
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_acc(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack5_acc(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack5_acc(self.ctx, ts)
+ *         return a_polytrack5_acc(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 166, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack5_acc(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 166, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack5_acc((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 166, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 166, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":165
+      /* "python/src/a/polytrack.pxi":165
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack5_acc(self.ctx, it)
+ *                 out[i] = a_polytrack5_acc(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":167
+    /* "python/src/a/polytrack.pxi":167
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack5_acc(self.ctx, it)
+ *                 out[i] = a_polytrack5_acc(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack5_acc(self.ctx, ts)
+ *         return a_polytrack5_acc(&self.ctx, ts)
  *     def gen(self):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":163
+    /* "python/src/a/polytrack.pxi":163
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":168
- *                 out[i] = a_polytrack5_acc(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":168
+ *                 out[i] = a_polytrack5_acc(&self.ctx, it)
  *             return out
- *         return a_polytrack5_acc(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack5_acc(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def gen(self):
  *         '''generation function'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 168, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack5_acc(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 168, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack5_acc((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":161
+  /* "python/src/a/polytrack.pxi":161
  *             return out
- *         return a_polytrack5_vec(self.ctx, ts)
+ *         return a_polytrack5_vec(&self.ctx, ts)
  *     def acc(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate acceleration'''
  *         if iterable(ts):
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -17164,20 +17761,20 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":169
+/* "python/src/a/polytrack.pxi":169
  *             return out
- *         return a_polytrack5_acc(self.ctx, ts)
+ *         return a_polytrack5_acc(&self.ctx, ts)
  *     def gen(self):             # <<<<<<<<<<<<<<
  *         '''generation function'''
- *         a_polytrack5_gen(self.ctx)
+ *         a_polytrack5_gen(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack5_11gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_10polytrack5_10gen[] = "generation function";
 static PyObject *__pyx_pw_4liba_10polytrack5_11gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -17191,39 +17788,39 @@
 }
 
 static PyObject *__pyx_pf_4liba_10polytrack5_10gen(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("gen", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":171
+  /* "python/src/a/polytrack.pxi":171
  *     def gen(self):
  *         '''generation function'''
- *         a_polytrack5_gen(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_polytrack5_gen(&self.ctx)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_polytrack5_gen(__pyx_v_self->ctx);
+  a_polytrack5_gen((&__pyx_v_self->ctx));
 
-  /* "ffi/python/src/a/polytrack.pxi":169
+  /* "python/src/a/polytrack.pxi":169
  *             return out
- *         return a_polytrack5_acc(self.ctx, ts)
+ *         return a_polytrack5_acc(&self.ctx, ts)
  *     def gen(self):             # <<<<<<<<<<<<<<
  *         '''generation function'''
- *         a_polytrack5_gen(self.ctx)
+ *         a_polytrack5_gen(&self.ctx)
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":174
+/* "python/src/a/polytrack.pxi":174
  * 
  *     @property
  *     def k(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.k
  * 
  */
 
@@ -17245,29 +17842,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":175
+  /* "python/src/a/polytrack.pxi":175
  *     @property
  *     def k(self):
  *         return self.ctx.k             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->k, 6); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 175, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.k, 6); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 175, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":174
+  /* "python/src/a/polytrack.pxi":174
  * 
  *     @property
  *     def k(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.k
  * 
  */
 
@@ -17278,15 +17875,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":178
+/* "python/src/a/polytrack.pxi":178
  * 
  *     @property
  *     def t(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.t
  *     @t.setter
  */
 
@@ -17308,29 +17905,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":179
+  /* "python/src/a/polytrack.pxi":179
  *     @property
  *     def t(self):
  *         return self.ctx.t             # <<<<<<<<<<<<<<
  *     @t.setter
  *     def t(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->t, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 179, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.t, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 179, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":178
+  /* "python/src/a/polytrack.pxi":178
  * 
  *     @property
  *     def t(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.t
  *     @t.setter
  */
 
@@ -17341,15 +17938,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":181
+/* "python/src/a/polytrack.pxi":181
  *         return self.ctx.t
  *     @t.setter
  *     def t(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]
  */
 
@@ -17372,41 +17969,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":182
+  /* "python/src/a/polytrack.pxi":182
  *     @t.setter
  *     def t(self, val):
  *         self.ctx.t[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 182, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->t[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.t[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":183
+  /* "python/src/a/polytrack.pxi":183
  *     def t(self, val):
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 183, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 183, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->t[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.t[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":181
+  /* "python/src/a/polytrack.pxi":181
  *         return self.ctx.t
  *     @t.setter
  *     def t(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]
  */
 
@@ -17418,15 +18015,15 @@
   __Pyx_AddTraceback("liba.polytrack5.t.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":186
+/* "python/src/a/polytrack.pxi":186
  * 
  *     @property
  *     def q(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.q
  *     @q.setter
  */
 
@@ -17448,29 +18045,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":187
+  /* "python/src/a/polytrack.pxi":187
  *     @property
  *     def q(self):
  *         return self.ctx.q             # <<<<<<<<<<<<<<
  *     @q.setter
  *     def q(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->q, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 187, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.q, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":186
+  /* "python/src/a/polytrack.pxi":186
  * 
  *     @property
  *     def q(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.q
  *     @q.setter
  */
 
@@ -17481,15 +18078,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":189
+/* "python/src/a/polytrack.pxi":189
  *         return self.ctx.q
  *     @q.setter
  *     def q(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]
  */
 
@@ -17512,41 +18109,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":190
+  /* "python/src/a/polytrack.pxi":190
  *     @q.setter
  *     def q(self, val):
  *         self.ctx.q[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 190, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->q[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.q[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":191
+  /* "python/src/a/polytrack.pxi":191
  *     def q(self, val):
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 191, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->q[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.q[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":189
+  /* "python/src/a/polytrack.pxi":189
  *         return self.ctx.q
  *     @q.setter
  *     def q(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]
  */
 
@@ -17558,15 +18155,15 @@
   __Pyx_AddTraceback("liba.polytrack5.q.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":194
+/* "python/src/a/polytrack.pxi":194
  * 
  *     @property
  *     def v(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.v
  *     @v.setter
  */
 
@@ -17588,29 +18185,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":195
+  /* "python/src/a/polytrack.pxi":195
  *     @property
  *     def v(self):
  *         return self.ctx.v             # <<<<<<<<<<<<<<
  *     @v.setter
  *     def v(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->v, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 195, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.v, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 195, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":194
+  /* "python/src/a/polytrack.pxi":194
  * 
  *     @property
  *     def v(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.v
  *     @v.setter
  */
 
@@ -17621,15 +18218,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":197
+/* "python/src/a/polytrack.pxi":197
  *         return self.ctx.v
  *     @v.setter
  *     def v(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]
  */
 
@@ -17652,41 +18249,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":198
+  /* "python/src/a/polytrack.pxi":198
  *     @v.setter
  *     def v(self, val):
  *         self.ctx.v[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 198, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->v[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.v[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":199
+  /* "python/src/a/polytrack.pxi":199
  *     def v(self, val):
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 199, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->v[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.v[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":197
+  /* "python/src/a/polytrack.pxi":197
  *         return self.ctx.v
  *     @v.setter
  *     def v(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]
  */
 
@@ -17698,15 +18295,15 @@
   __Pyx_AddTraceback("liba.polytrack5.v.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":202
+/* "python/src/a/polytrack.pxi":202
  * 
  *     @property
  *     def a(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.a
  *     @a.setter
  */
 
@@ -17728,29 +18325,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":203
+  /* "python/src/a/polytrack.pxi":203
  *     @property
  *     def a(self):
  *         return self.ctx.a             # <<<<<<<<<<<<<<
  *     @a.setter
  *     def a(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->a, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 203, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.a, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":202
+  /* "python/src/a/polytrack.pxi":202
  * 
  *     @property
  *     def a(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.a
  *     @a.setter
  */
 
@@ -17761,15 +18358,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":205
+/* "python/src/a/polytrack.pxi":205
  *         return self.ctx.a
  *     @a.setter
  *     def a(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val[0]
  *         self.ctx.a[1] = val[1]
  */
 
@@ -17792,41 +18389,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":206
+  /* "python/src/a/polytrack.pxi":206
  *     @a.setter
  *     def a(self, val):
  *         self.ctx.a[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.a[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 206, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 206, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->a[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.a[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":207
+  /* "python/src/a/polytrack.pxi":207
  *     def a(self, val):
  *         self.ctx.a[0] = val[0]
  *         self.ctx.a[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 207, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->a[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.a[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":205
+  /* "python/src/a/polytrack.pxi":205
  *         return self.ctx.a
  *     @a.setter
  *     def a(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val[0]
  *         self.ctx.a[1] = val[1]
  */
 
@@ -17838,15 +18435,15 @@
   __Pyx_AddTraceback("liba.polytrack5.a.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":210
+/* "python/src/a/polytrack.pxi":210
  * 
  *     @property
  *     def t0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[0]
  *     @t0.setter
  */
 
@@ -17868,29 +18465,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":211
+  /* "python/src/a/polytrack.pxi":211
  *     @property
  *     def t0(self) -> a_real_t:
  *         return self.ctx.t[0]             # <<<<<<<<<<<<<<
  *     @t0.setter
  *     def t0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->t[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 211, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.t[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":210
+  /* "python/src/a/polytrack.pxi":210
  * 
  *     @property
  *     def t0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[0]
  *     @t0.setter
  */
 
@@ -17901,15 +18498,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":213
+/* "python/src/a/polytrack.pxi":213
  *         return self.ctx.t[0]
  *     @t0.setter
  *     def t0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val
  * 
  */
 
@@ -17940,38 +18537,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2t0_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":214
+  /* "python/src/a/polytrack.pxi":214
  *     @t0.setter
  *     def t0(self, val: a_real_t):
  *         self.ctx.t[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->t[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.t[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":213
+  /* "python/src/a/polytrack.pxi":213
  *         return self.ctx.t[0]
  *     @t0.setter
  *     def t0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":217
+/* "python/src/a/polytrack.pxi":217
  * 
  *     @property
  *     def q0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[0]
  *     @q0.setter
  */
 
@@ -17993,29 +18590,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":218
+  /* "python/src/a/polytrack.pxi":218
  *     @property
  *     def q0(self) -> a_real_t:
  *         return self.ctx.q[0]             # <<<<<<<<<<<<<<
  *     @q0.setter
  *     def q0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->q[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 218, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.q[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 218, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":217
+  /* "python/src/a/polytrack.pxi":217
  * 
  *     @property
  *     def q0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[0]
  *     @q0.setter
  */
 
@@ -18026,15 +18623,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":220
+/* "python/src/a/polytrack.pxi":220
  *         return self.ctx.q[0]
  *     @q0.setter
  *     def q0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val
  * 
  */
 
@@ -18065,38 +18662,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2q0_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":221
+  /* "python/src/a/polytrack.pxi":221
  *     @q0.setter
  *     def q0(self, val: a_real_t):
  *         self.ctx.q[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->q[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.q[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":220
+  /* "python/src/a/polytrack.pxi":220
  *         return self.ctx.q[0]
  *     @q0.setter
  *     def q0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":224
+/* "python/src/a/polytrack.pxi":224
  * 
  *     @property
  *     def v0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[0]
  *     @v0.setter
  */
 
@@ -18118,29 +18715,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":225
+  /* "python/src/a/polytrack.pxi":225
  *     @property
  *     def v0(self) -> a_real_t:
  *         return self.ctx.v[0]             # <<<<<<<<<<<<<<
  *     @v0.setter
  *     def v0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->v[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 225, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.v[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":224
+  /* "python/src/a/polytrack.pxi":224
  * 
  *     @property
  *     def v0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[0]
  *     @v0.setter
  */
 
@@ -18151,15 +18748,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":227
+/* "python/src/a/polytrack.pxi":227
  *         return self.ctx.v[0]
  *     @v0.setter
  *     def v0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val
  * 
  */
 
@@ -18190,38 +18787,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2v0_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":228
+  /* "python/src/a/polytrack.pxi":228
  *     @v0.setter
  *     def v0(self, val: a_real_t):
  *         self.ctx.v[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->v[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.v[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":227
+  /* "python/src/a/polytrack.pxi":227
  *         return self.ctx.v[0]
  *     @v0.setter
  *     def v0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":231
+/* "python/src/a/polytrack.pxi":231
  * 
  *     @property
  *     def a0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[0]
  *     @a0.setter
  */
 
@@ -18243,29 +18840,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":232
+  /* "python/src/a/polytrack.pxi":232
  *     @property
  *     def a0(self) -> a_real_t:
  *         return self.ctx.a[0]             # <<<<<<<<<<<<<<
  *     @a0.setter
  *     def a0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->a[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 232, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.a[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 232, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":231
+  /* "python/src/a/polytrack.pxi":231
  * 
  *     @property
  *     def a0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[0]
  *     @a0.setter
  */
 
@@ -18276,15 +18873,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":234
+/* "python/src/a/polytrack.pxi":234
  *         return self.ctx.a[0]
  *     @a0.setter
  *     def a0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val
  * 
  */
 
@@ -18315,38 +18912,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2a0_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":235
+  /* "python/src/a/polytrack.pxi":235
  *     @a0.setter
  *     def a0(self, val: a_real_t):
  *         self.ctx.a[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->a[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.a[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":234
+  /* "python/src/a/polytrack.pxi":234
  *         return self.ctx.a[0]
  *     @a0.setter
  *     def a0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":238
+/* "python/src/a/polytrack.pxi":238
  * 
  *     @property
  *     def t1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[1]
  *     @t1.setter
  */
 
@@ -18368,29 +18965,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":239
+  /* "python/src/a/polytrack.pxi":239
  *     @property
  *     def t1(self) -> a_real_t:
  *         return self.ctx.t[1]             # <<<<<<<<<<<<<<
  *     @t1.setter
  *     def t1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->t[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 239, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.t[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 239, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":238
+  /* "python/src/a/polytrack.pxi":238
  * 
  *     @property
  *     def t1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[1]
  *     @t1.setter
  */
 
@@ -18401,15 +18998,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":241
+/* "python/src/a/polytrack.pxi":241
  *         return self.ctx.t[1]
  *     @t1.setter
  *     def t1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val
  * 
  */
 
@@ -18440,38 +19037,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2t1_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":242
+  /* "python/src/a/polytrack.pxi":242
  *     @t1.setter
  *     def t1(self, val: a_real_t):
  *         self.ctx.t[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->t[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.t[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":241
+  /* "python/src/a/polytrack.pxi":241
  *         return self.ctx.t[1]
  *     @t1.setter
  *     def t1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":245
+/* "python/src/a/polytrack.pxi":245
  * 
  *     @property
  *     def q1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[1]
  *     @q1.setter
  */
 
@@ -18493,29 +19090,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":246
+  /* "python/src/a/polytrack.pxi":246
  *     @property
  *     def q1(self) -> a_real_t:
  *         return self.ctx.q[1]             # <<<<<<<<<<<<<<
  *     @q1.setter
  *     def q1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->q[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 246, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.q[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":245
+  /* "python/src/a/polytrack.pxi":245
  * 
  *     @property
  *     def q1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[1]
  *     @q1.setter
  */
 
@@ -18526,15 +19123,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":248
+/* "python/src/a/polytrack.pxi":248
  *         return self.ctx.q[1]
  *     @q1.setter
  *     def q1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val
  * 
  */
 
@@ -18565,38 +19162,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2q1_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":249
+  /* "python/src/a/polytrack.pxi":249
  *     @q1.setter
  *     def q1(self, val: a_real_t):
  *         self.ctx.q[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->q[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.q[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":248
+  /* "python/src/a/polytrack.pxi":248
  *         return self.ctx.q[1]
  *     @q1.setter
  *     def q1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":252
+/* "python/src/a/polytrack.pxi":252
  * 
  *     @property
  *     def v1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[1]
  *     @v1.setter
  */
 
@@ -18618,29 +19215,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":253
+  /* "python/src/a/polytrack.pxi":253
  *     @property
  *     def v1(self) -> a_real_t:
  *         return self.ctx.v[1]             # <<<<<<<<<<<<<<
  *     @v1.setter
  *     def v1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->v[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 253, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.v[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":252
+  /* "python/src/a/polytrack.pxi":252
  * 
  *     @property
  *     def v1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[1]
  *     @v1.setter
  */
 
@@ -18651,15 +19248,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":255
+/* "python/src/a/polytrack.pxi":255
  *         return self.ctx.v[1]
  *     @v1.setter
  *     def v1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val
  * 
  */
 
@@ -18690,38 +19287,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2v1_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":256
+  /* "python/src/a/polytrack.pxi":256
  *     @v1.setter
  *     def v1(self, val: a_real_t):
  *         self.ctx.v[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->v[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.v[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":255
+  /* "python/src/a/polytrack.pxi":255
  *         return self.ctx.v[1]
  *     @v1.setter
  *     def v1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":259
+/* "python/src/a/polytrack.pxi":259
  * 
  *     @property
  *     def a1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[1]
  *     @a1.setter
  */
 
@@ -18743,29 +19340,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":260
+  /* "python/src/a/polytrack.pxi":260
  *     @property
  *     def a1(self) -> a_real_t:
  *         return self.ctx.a[1]             # <<<<<<<<<<<<<<
  *     @a1.setter
  *     def a1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->a[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 260, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.a[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":259
+  /* "python/src/a/polytrack.pxi":259
  * 
  *     @property
  *     def a1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[1]
  *     @a1.setter
  */
 
@@ -18776,15 +19373,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":262
+/* "python/src/a/polytrack.pxi":262
  *         return self.ctx.a[1]
  *     @a1.setter
  *     def a1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[1] = val
  * 
  */
 
@@ -18815,24 +19412,24 @@
 }
 
 static int __pyx_pf_4liba_10polytrack5_2a1_2__set__(struct __pyx_obj_4liba_polytrack5 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":263
+  /* "python/src/a/polytrack.pxi":263
  *     @a1.setter
  *     def a1(self, val: a_real_t):
  *         self.ctx.a[1] = val             # <<<<<<<<<<<<<<
  * 
  * @cython.wraparound(False)
  */
-  (__pyx_v_self->ctx->a[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.a[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":262
+  /* "python/src/a/polytrack.pxi":262
  *         return self.ctx.a[1]
  *     @a1.setter
  *     def a1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[1] = val
  * 
  */
 
@@ -18951,19 +19548,19 @@
   __Pyx_AddTraceback("liba.polytrack5.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":270
+/* "python/src/a/polytrack.pxi":270
  *     '''hepta polynomial trajectory'''
- *     cdef a_polytrack7_s ctx[1]
+ *     cdef a_polytrack7_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0, a_real_t j0 = 0, a_real_t j1 = 0):             # <<<<<<<<<<<<<<
- *         a_polytrack7_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
+ *         a_polytrack7_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
  *     def __call__(self, ts):
  */
 
 /* Python wrapper */
 static int __pyx_pw_4liba_10polytrack7_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_pw_4liba_10polytrack7_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   a_real_t __pyx_v_t0;
@@ -19148,49 +19745,49 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7___cinit__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_t0, a_real_t __pyx_v_t1, a_real_t __pyx_v_q0, a_real_t __pyx_v_q1, a_real_t __pyx_v_v0, a_real_t __pyx_v_v1, a_real_t __pyx_v_a0, a_real_t __pyx_v_a1, a_real_t __pyx_v_j0, a_real_t __pyx_v_j1) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":271
- *     cdef a_polytrack7_s ctx[1]
+  /* "python/src/a/polytrack.pxi":271
+ *     cdef a_polytrack7_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0, a_real_t j0 = 0, a_real_t j1 = 0):
- *         a_polytrack7_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)             # <<<<<<<<<<<<<<
+ *         a_polytrack7_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)             # <<<<<<<<<<<<<<
  *     def __call__(self, ts):
  *         '''calculate all'''
  */
-  a_polytrack7_init(__pyx_v_self->ctx, __pyx_v_t0, __pyx_v_t1, __pyx_v_q0, __pyx_v_q1, __pyx_v_v0, __pyx_v_v1, __pyx_v_a0, __pyx_v_a1, __pyx_v_j0, __pyx_v_j1);
+  a_polytrack7_init((&__pyx_v_self->ctx), __pyx_v_t0, __pyx_v_t1, __pyx_v_q0, __pyx_v_q1, __pyx_v_v0, __pyx_v_v1, __pyx_v_a0, __pyx_v_a1, __pyx_v_j0, __pyx_v_j1);
 
-  /* "ffi/python/src/a/polytrack.pxi":270
+  /* "python/src/a/polytrack.pxi":270
  *     '''hepta polynomial trajectory'''
- *     cdef a_polytrack7_s ctx[1]
+ *     cdef a_polytrack7_s ctx
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0, a_real_t j0 = 0, a_real_t j1 = 0):             # <<<<<<<<<<<<<<
- *         a_polytrack7_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
+ *         a_polytrack7_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
  *     def __call__(self, ts):
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":272
+/* "python/src/a/polytrack.pxi":272
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0, a_real_t j0 = 0, a_real_t j1 = 0):
- *         a_polytrack7_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
+ *         a_polytrack7_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
  *     def __call__(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate all'''
  *         cdef a_real_t out[4]
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack7_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_4liba_10polytrack7_2__call__[] = "calculate all";
-#if CYTHON_COMPILING_IN_CPYTHON
+#if CYTHON_UPDATE_DESCRIPTOR_DOC
 struct wrapperbase __pyx_wrapperbase_4liba_10polytrack7_2__call__;
 #endif
 static PyObject *__pyx_pw_4liba_10polytrack7_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_ts = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
@@ -19261,85 +19858,85 @@
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__call__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":275
+  /* "python/src/a/polytrack.pxi":275
  *         '''calculate all'''
  *         cdef a_real_t out[4]
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             p = reals(ts)
  *             v = reals(ts)
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":276
+    /* "python/src/a/polytrack.pxi":276
  *         cdef a_real_t out[4]
  *         if iterable(ts):
  *             p = reals(ts)             # <<<<<<<<<<<<<<
  *             v = reals(ts)
  *             a = reals(ts)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 276, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_p = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":277
+    /* "python/src/a/polytrack.pxi":277
  *         if iterable(ts):
  *             p = reals(ts)
  *             v = reals(ts)             # <<<<<<<<<<<<<<
  *             a = reals(ts)
  *             j = reals(ts)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_v = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":278
+    /* "python/src/a/polytrack.pxi":278
  *             p = reals(ts)
  *             v = reals(ts)
  *             a = reals(ts)             # <<<<<<<<<<<<<<
  *             j = reals(ts)
  *             for i, it in enumerate(ts):
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_a = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":279
+    /* "python/src/a/polytrack.pxi":279
  *             v = reals(ts)
  *             a = reals(ts)
  *             j = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 a_polytrack7_out(self.ctx, it, out)
+ *                 a_polytrack7_out(&self.ctx, it, out)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 279, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_j = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":280
+    /* "python/src/a/polytrack.pxi":280
  *             a = reals(ts)
  *             j = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 a_polytrack7_out(self.ctx, it, out)
+ *                 a_polytrack7_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -19385,88 +19982,88 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 280, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":281
+      /* "python/src/a/polytrack.pxi":281
  *             j = reals(ts)
  *             for i, it in enumerate(ts):
- *                 a_polytrack7_out(self.ctx, it, out)             # <<<<<<<<<<<<<<
+ *                 a_polytrack7_out(&self.ctx, it, out)             # <<<<<<<<<<<<<<
  *                 p[i] = out[0]
  *                 v[i] = out[1]
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 281, __pyx_L1_error)
-      a_polytrack7_out(__pyx_v_self->ctx, __pyx_t_8, __pyx_v_out);
+      a_polytrack7_out((&__pyx_v_self->ctx), __pyx_t_8, __pyx_v_out);
 
-      /* "ffi/python/src/a/polytrack.pxi":282
+      /* "python/src/a/polytrack.pxi":282
  *             for i, it in enumerate(ts):
- *                 a_polytrack7_out(self.ctx, it, out)
+ *                 a_polytrack7_out(&self.ctx, it, out)
  *                 p[i] = out[0]             # <<<<<<<<<<<<<<
  *                 v[i] = out[1]
  *                 a[i] = out[2]
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 282, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_p), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 282, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":283
- *                 a_polytrack7_out(self.ctx, it, out)
+      /* "python/src/a/polytrack.pxi":283
+ *                 a_polytrack7_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  *                 v[i] = out[1]             # <<<<<<<<<<<<<<
  *                 a[i] = out[2]
  *                 j[i] = out[3]
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 283, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_v), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 283, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":284
+      /* "python/src/a/polytrack.pxi":284
  *                 p[i] = out[0]
  *                 v[i] = out[1]
  *                 a[i] = out[2]             # <<<<<<<<<<<<<<
  *                 j[i] = out[3]
  *             return p, v, a, j
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[2])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 284, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_a), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 284, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":285
+      /* "python/src/a/polytrack.pxi":285
  *                 v[i] = out[1]
  *                 a[i] = out[2]
  *                 j[i] = out[3]             # <<<<<<<<<<<<<<
  *             return p, v, a, j
- *         a_polytrack7_out(self.ctx, ts, out)
+ *         a_polytrack7_out(&self.ctx, ts, out)
  */
       __pyx_t_7 = PyFloat_FromDouble((__pyx_v_out[3])); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 285, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_j), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 285, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":280
+      /* "python/src/a/polytrack.pxi":280
  *             a = reals(ts)
  *             j = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 a_polytrack7_out(self.ctx, it, out)
+ *                 a_polytrack7_out(&self.ctx, it, out)
  *                 p[i] = out[0]
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":286
+    /* "python/src/a/polytrack.pxi":286
  *                 a[i] = out[2]
  *                 j[i] = out[3]
  *             return p, v, a, j             # <<<<<<<<<<<<<<
- *         a_polytrack7_out(self.ctx, ts, out)
+ *         a_polytrack7_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2], out[3]
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(((PyObject *)__pyx_v_p));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_p));
@@ -19480,36 +20077,36 @@
     __Pyx_INCREF(((PyObject *)__pyx_v_j));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_j));
     PyTuple_SET_ITEM(__pyx_t_2, 3, ((PyObject *)__pyx_v_j));
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":275
+    /* "python/src/a/polytrack.pxi":275
  *         '''calculate all'''
  *         cdef a_real_t out[4]
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             p = reals(ts)
  *             v = reals(ts)
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":287
+  /* "python/src/a/polytrack.pxi":287
  *                 j[i] = out[3]
  *             return p, v, a, j
- *         a_polytrack7_out(self.ctx, ts, out)             # <<<<<<<<<<<<<<
+ *         a_polytrack7_out(&self.ctx, ts, out)             # <<<<<<<<<<<<<<
  *         return out[0], out[1], out[2], out[3]
  *     def pos(self, ts):
  */
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 287, __pyx_L1_error)
-  a_polytrack7_out(__pyx_v_self->ctx, __pyx_t_8, __pyx_v_out);
+  a_polytrack7_out((&__pyx_v_self->ctx), __pyx_t_8, __pyx_v_out);
 
-  /* "ffi/python/src/a/polytrack.pxi":288
+  /* "python/src/a/polytrack.pxi":288
  *             return p, v, a, j
- *         a_polytrack7_out(self.ctx, ts, out)
+ *         a_polytrack7_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2], out[3]             # <<<<<<<<<<<<<<
  *     def pos(self, ts):
  *         '''calculate position'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2 = PyFloat_FromDouble((__pyx_v_out[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -19533,17 +20130,17 @@
   __pyx_t_4 = 0;
   __pyx_t_7 = 0;
   __pyx_t_9 = 0;
   __pyx_r = __pyx_t_10;
   __pyx_t_10 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":272
+  /* "python/src/a/polytrack.pxi":272
  *     def __cinit__(self, a_real_t t0, a_real_t t1, a_real_t q0, a_real_t q1, a_real_t v0 = 0, a_real_t v1 = 0, a_real_t a0 = 0, a_real_t a1 = 0, a_real_t j0 = 0, a_real_t j1 = 0):
- *         a_polytrack7_init(self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
+ *         a_polytrack7_init(&self.ctx, t0, t1, q0, q1, v0, v1, a0, a1, j0, j1)
  *     def __call__(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate all'''
  *         cdef a_real_t out[4]
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -19562,16 +20159,16 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":289
- *         a_polytrack7_out(self.ctx, ts, out)
+/* "python/src/a/polytrack.pxi":289
+ *         a_polytrack7_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2], out[3]
  *     def pos(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate position'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
@@ -19603,43 +20200,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("pos", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":291
+  /* "python/src/a/polytrack.pxi":291
  *     def pos(self, ts):
  *         '''calculate position'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":292
+    /* "python/src/a/polytrack.pxi":292
  *         '''calculate position'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_pos(self.ctx, it)
+ *                 out[i] = a_polytrack7_pos(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 292, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":293
+    /* "python/src/a/polytrack.pxi":293
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_pos(self.ctx, it)
+ *                 out[i] = a_polytrack7_pos(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -19685,76 +20282,76 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 293, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":294
+      /* "python/src/a/polytrack.pxi":294
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_pos(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack7_pos(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack7_pos(self.ctx, ts)
+ *         return a_polytrack7_pos(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 294, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_pos(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 294, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_pos((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 294, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 294, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":293
+      /* "python/src/a/polytrack.pxi":293
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_pos(self.ctx, it)
+ *                 out[i] = a_polytrack7_pos(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":295
+    /* "python/src/a/polytrack.pxi":295
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_pos(self.ctx, it)
+ *                 out[i] = a_polytrack7_pos(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack7_pos(self.ctx, ts)
+ *         return a_polytrack7_pos(&self.ctx, ts)
  *     def vec(self, ts):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":291
+    /* "python/src/a/polytrack.pxi":291
  *     def pos(self, ts):
  *         '''calculate position'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":296
- *                 out[i] = a_polytrack7_pos(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":296
+ *                 out[i] = a_polytrack7_pos(&self.ctx, it)
  *             return out
- *         return a_polytrack7_pos(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack7_pos(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def vec(self, ts):
  *         '''calculate velocity'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 296, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_pos(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 296, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_pos((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":289
- *         a_polytrack7_out(self.ctx, ts, out)
+  /* "python/src/a/polytrack.pxi":289
+ *         a_polytrack7_out(&self.ctx, ts, out)
  *         return out[0], out[1], out[2], out[3]
  *     def pos(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate position'''
  *         if iterable(ts):
  */
 
   /* function exit code */
@@ -19769,17 +20366,17 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":297
+/* "python/src/a/polytrack.pxi":297
  *             return out
- *         return a_polytrack7_pos(self.ctx, ts)
+ *         return a_polytrack7_pos(&self.ctx, ts)
  *     def vec(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate velocity'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack7_7vec(PyObject *__pyx_v_self, PyObject *__pyx_v_ts); /*proto*/
@@ -19810,43 +20407,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("vec", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":299
+  /* "python/src/a/polytrack.pxi":299
  *     def vec(self, ts):
  *         '''calculate velocity'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":300
+    /* "python/src/a/polytrack.pxi":300
  *         '''calculate velocity'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_vec(self.ctx, it)
+ *                 out[i] = a_polytrack7_vec(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 300, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":301
+    /* "python/src/a/polytrack.pxi":301
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_vec(self.ctx, it)
+ *                 out[i] = a_polytrack7_vec(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -19892,77 +20489,77 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 301, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":302
+      /* "python/src/a/polytrack.pxi":302
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_vec(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack7_vec(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack7_vec(self.ctx, ts)
+ *         return a_polytrack7_vec(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 302, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_vec(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 302, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_vec((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 302, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 302, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":301
+      /* "python/src/a/polytrack.pxi":301
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_vec(self.ctx, it)
+ *                 out[i] = a_polytrack7_vec(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":303
+    /* "python/src/a/polytrack.pxi":303
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_vec(self.ctx, it)
+ *                 out[i] = a_polytrack7_vec(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack7_vec(self.ctx, ts)
+ *         return a_polytrack7_vec(&self.ctx, ts)
  *     def acc(self, ts):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":299
+    /* "python/src/a/polytrack.pxi":299
  *     def vec(self, ts):
  *         '''calculate velocity'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":304
- *                 out[i] = a_polytrack7_vec(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":304
+ *                 out[i] = a_polytrack7_vec(&self.ctx, it)
  *             return out
- *         return a_polytrack7_vec(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack7_vec(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 304, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_vec(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 304, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_vec((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":297
+  /* "python/src/a/polytrack.pxi":297
  *             return out
- *         return a_polytrack7_pos(self.ctx, ts)
+ *         return a_polytrack7_pos(&self.ctx, ts)
  *     def vec(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate velocity'''
  *         if iterable(ts):
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -19976,17 +20573,17 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":305
+/* "python/src/a/polytrack.pxi":305
  *             return out
- *         return a_polytrack7_vec(self.ctx, ts)
+ *         return a_polytrack7_vec(&self.ctx, ts)
  *     def acc(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate acceleration'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack7_9acc(PyObject *__pyx_v_self, PyObject *__pyx_v_ts); /*proto*/
@@ -20017,43 +20614,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("acc", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":307
+  /* "python/src/a/polytrack.pxi":307
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":308
+    /* "python/src/a/polytrack.pxi":308
  *         '''calculate acceleration'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_acc(self.ctx, it)
+ *                 out[i] = a_polytrack7_acc(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 308, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":309
+    /* "python/src/a/polytrack.pxi":309
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_acc(self.ctx, it)
+ *                 out[i] = a_polytrack7_acc(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -20099,77 +20696,77 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 309, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":310
+      /* "python/src/a/polytrack.pxi":310
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_acc(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack7_acc(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack7_acc(self.ctx, ts)
+ *         return a_polytrack7_acc(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 310, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_acc(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 310, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_acc((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 310, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 310, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":309
+      /* "python/src/a/polytrack.pxi":309
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_acc(self.ctx, it)
+ *                 out[i] = a_polytrack7_acc(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":311
+    /* "python/src/a/polytrack.pxi":311
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_acc(self.ctx, it)
+ *                 out[i] = a_polytrack7_acc(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack7_acc(self.ctx, ts)
+ *         return a_polytrack7_acc(&self.ctx, ts)
  *     def jer(self, ts):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":307
+    /* "python/src/a/polytrack.pxi":307
  *     def acc(self, ts):
  *         '''calculate acceleration'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":312
- *                 out[i] = a_polytrack7_acc(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":312
+ *                 out[i] = a_polytrack7_acc(&self.ctx, it)
  *             return out
- *         return a_polytrack7_acc(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack7_acc(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def jer(self, ts):
  *         '''calculate jerk'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 312, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_acc(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 312, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_acc((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":305
+  /* "python/src/a/polytrack.pxi":305
  *             return out
- *         return a_polytrack7_vec(self.ctx, ts)
+ *         return a_polytrack7_vec(&self.ctx, ts)
  *     def acc(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate acceleration'''
  *         if iterable(ts):
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -20183,17 +20780,17 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":313
+/* "python/src/a/polytrack.pxi":313
  *             return out
- *         return a_polytrack7_acc(self.ctx, ts)
+ *         return a_polytrack7_acc(&self.ctx, ts)
  *     def jer(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate jerk'''
  *         if iterable(ts):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack7_11jer(PyObject *__pyx_v_self, PyObject *__pyx_v_ts); /*proto*/
@@ -20224,43 +20821,43 @@
   PyObject *__pyx_t_7 = NULL;
   a_real_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("jer", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":315
+  /* "python/src/a/polytrack.pxi":315
  *     def jer(self, ts):
  *         '''calculate jerk'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   __pyx_t_1 = (__pyx_f_4liba_iterable(__pyx_v_ts) != 0);
   if (__pyx_t_1) {
 
-    /* "ffi/python/src/a/polytrack.pxi":316
+    /* "python/src/a/polytrack.pxi":316
  *         '''calculate jerk'''
  *         if iterable(ts):
  *             out = reals(ts)             # <<<<<<<<<<<<<<
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_jer(self.ctx, it)
+ *                 out[i] = a_polytrack7_jer(&self.ctx, it)
  */
     __pyx_t_3.__pyx_n = 1;
     __pyx_t_3.o = __pyx_v_ts;
     __pyx_t_2 = ((PyObject *)__pyx_f_4liba_reals(&__pyx_t_3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 316, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_out = ((arrayobject *)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":317
+    /* "python/src/a/polytrack.pxi":317
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_jer(self.ctx, it)
+ *                 out[i] = a_polytrack7_jer(&self.ctx, it)
  *             return out
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_ts)) || PyTuple_CheckExact(__pyx_v_ts)) {
       __pyx_t_4 = __pyx_v_ts; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
@@ -20306,77 +20903,77 @@
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
       __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 317, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":318
+      /* "python/src/a/polytrack.pxi":318
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_jer(self.ctx, it)             # <<<<<<<<<<<<<<
+ *                 out[i] = a_polytrack7_jer(&self.ctx, it)             # <<<<<<<<<<<<<<
  *             return out
- *         return a_polytrack7_jer(self.ctx, ts)
+ *         return a_polytrack7_jer(&self.ctx, ts)
  */
       __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_it); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 318, __pyx_L1_error)
-      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_jer(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 318, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(a_polytrack7_jer((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_7)) __PYX_ERR(9, 318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_out), __pyx_v_i, __pyx_t_7) < 0)) __PYX_ERR(9, 318, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "ffi/python/src/a/polytrack.pxi":317
+      /* "python/src/a/polytrack.pxi":317
  *         if iterable(ts):
  *             out = reals(ts)
  *             for i, it in enumerate(ts):             # <<<<<<<<<<<<<<
- *                 out[i] = a_polytrack7_jer(self.ctx, it)
+ *                 out[i] = a_polytrack7_jer(&self.ctx, it)
  *             return out
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "ffi/python/src/a/polytrack.pxi":319
+    /* "python/src/a/polytrack.pxi":319
  *             for i, it in enumerate(ts):
- *                 out[i] = a_polytrack7_jer(self.ctx, it)
+ *                 out[i] = a_polytrack7_jer(&self.ctx, it)
  *             return out             # <<<<<<<<<<<<<<
- *         return a_polytrack7_jer(self.ctx, ts)
+ *         return a_polytrack7_jer(&self.ctx, ts)
  *     def gen(self):
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_out));
     __pyx_r = ((PyObject *)__pyx_v_out);
     goto __pyx_L0;
 
-    /* "ffi/python/src/a/polytrack.pxi":315
+    /* "python/src/a/polytrack.pxi":315
  *     def jer(self, ts):
  *         '''calculate jerk'''
  *         if iterable(ts):             # <<<<<<<<<<<<<<
  *             out = reals(ts)
  *             for i, it in enumerate(ts):
  */
   }
 
-  /* "ffi/python/src/a/polytrack.pxi":320
- *                 out[i] = a_polytrack7_jer(self.ctx, it)
+  /* "python/src/a/polytrack.pxi":320
+ *                 out[i] = a_polytrack7_jer(&self.ctx, it)
  *             return out
- *         return a_polytrack7_jer(self.ctx, ts)             # <<<<<<<<<<<<<<
+ *         return a_polytrack7_jer(&self.ctx, ts)             # <<<<<<<<<<<<<<
  *     def gen(self):
  *         '''generation function'''
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_v_ts); if (unlikely((__pyx_t_8 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 320, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_jer(__pyx_v_self->ctx, __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 320, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(a_polytrack7_jer((&__pyx_v_self->ctx), __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(9, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":313
+  /* "python/src/a/polytrack.pxi":313
  *             return out
- *         return a_polytrack7_acc(self.ctx, ts)
+ *         return a_polytrack7_acc(&self.ctx, ts)
  *     def jer(self, ts):             # <<<<<<<<<<<<<<
  *         '''calculate jerk'''
  *         if iterable(ts):
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -20390,20 +20987,20 @@
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_it);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":321
+/* "python/src/a/polytrack.pxi":321
  *             return out
- *         return a_polytrack7_jer(self.ctx, ts)
+ *         return a_polytrack7_jer(&self.ctx, ts)
  *     def gen(self):             # <<<<<<<<<<<<<<
  *         '''generation function'''
- *         a_polytrack7_gen(self.ctx)
+ *         a_polytrack7_gen(&self.ctx)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_4liba_10polytrack7_13gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static char __pyx_doc_4liba_10polytrack7_12gen[] = "generation function";
 static PyObject *__pyx_pw_4liba_10polytrack7_13gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
@@ -20417,39 +21014,39 @@
 }
 
 static PyObject *__pyx_pf_4liba_10polytrack7_12gen(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("gen", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":323
+  /* "python/src/a/polytrack.pxi":323
  *     def gen(self):
  *         '''generation function'''
- *         a_polytrack7_gen(self.ctx)             # <<<<<<<<<<<<<<
+ *         a_polytrack7_gen(&self.ctx)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  a_polytrack7_gen(__pyx_v_self->ctx);
+  a_polytrack7_gen((&__pyx_v_self->ctx));
 
-  /* "ffi/python/src/a/polytrack.pxi":321
+  /* "python/src/a/polytrack.pxi":321
  *             return out
- *         return a_polytrack7_jer(self.ctx, ts)
+ *         return a_polytrack7_jer(&self.ctx, ts)
  *     def gen(self):             # <<<<<<<<<<<<<<
  *         '''generation function'''
- *         a_polytrack7_gen(self.ctx)
+ *         a_polytrack7_gen(&self.ctx)
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":326
+/* "python/src/a/polytrack.pxi":326
  * 
  *     @property
  *     def k(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.k
  * 
  */
 
@@ -20471,29 +21068,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":327
+  /* "python/src/a/polytrack.pxi":327
  *     @property
  *     def k(self):
  *         return self.ctx.k             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->k, 8); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 327, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.k, 8); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":326
+  /* "python/src/a/polytrack.pxi":326
  * 
  *     @property
  *     def k(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.k
  * 
  */
 
@@ -20504,15 +21101,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":330
+/* "python/src/a/polytrack.pxi":330
  * 
  *     @property
  *     def t(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.t
  *     @t.setter
  */
 
@@ -20534,29 +21131,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":331
+  /* "python/src/a/polytrack.pxi":331
  *     @property
  *     def t(self):
  *         return self.ctx.t             # <<<<<<<<<<<<<<
  *     @t.setter
  *     def t(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->t, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 331, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.t, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 331, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":330
+  /* "python/src/a/polytrack.pxi":330
  * 
  *     @property
  *     def t(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.t
  *     @t.setter
  */
 
@@ -20567,15 +21164,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":333
+/* "python/src/a/polytrack.pxi":333
  *         return self.ctx.t
  *     @t.setter
  *     def t(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]
  */
 
@@ -20598,41 +21195,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":334
+  /* "python/src/a/polytrack.pxi":334
  *     @t.setter
  *     def t(self, val):
  *         self.ctx.t[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 334, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->t[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.t[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":335
+  /* "python/src/a/polytrack.pxi":335
  *     def t(self, val):
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 335, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->t[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.t[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":333
+  /* "python/src/a/polytrack.pxi":333
  *         return self.ctx.t
  *     @t.setter
  *     def t(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val[0]
  *         self.ctx.t[1] = val[1]
  */
 
@@ -20644,15 +21241,15 @@
   __Pyx_AddTraceback("liba.polytrack7.t.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":338
+/* "python/src/a/polytrack.pxi":338
  * 
  *     @property
  *     def q(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.q
  *     @q.setter
  */
 
@@ -20674,29 +21271,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":339
+  /* "python/src/a/polytrack.pxi":339
  *     @property
  *     def q(self):
  *         return self.ctx.q             # <<<<<<<<<<<<<<
  *     @q.setter
  *     def q(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->q, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 339, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.q, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 339, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":338
+  /* "python/src/a/polytrack.pxi":338
  * 
  *     @property
  *     def q(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.q
  *     @q.setter
  */
 
@@ -20707,15 +21304,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":341
+/* "python/src/a/polytrack.pxi":341
  *         return self.ctx.q
  *     @q.setter
  *     def q(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]
  */
 
@@ -20738,41 +21335,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":342
+  /* "python/src/a/polytrack.pxi":342
  *     @q.setter
  *     def q(self, val):
  *         self.ctx.q[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 342, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 342, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->q[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.q[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":343
+  /* "python/src/a/polytrack.pxi":343
  *     def q(self, val):
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 343, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 343, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->q[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.q[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":341
+  /* "python/src/a/polytrack.pxi":341
  *         return self.ctx.q
  *     @q.setter
  *     def q(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val[0]
  *         self.ctx.q[1] = val[1]
  */
 
@@ -20784,15 +21381,15 @@
   __Pyx_AddTraceback("liba.polytrack7.q.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":346
+/* "python/src/a/polytrack.pxi":346
  * 
  *     @property
  *     def v(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.v
  *     @v.setter
  */
 
@@ -20814,29 +21411,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":347
+  /* "python/src/a/polytrack.pxi":347
  *     @property
  *     def v(self):
  *         return self.ctx.v             # <<<<<<<<<<<<<<
  *     @v.setter
  *     def v(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->v, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 347, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.v, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 347, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":346
+  /* "python/src/a/polytrack.pxi":346
  * 
  *     @property
  *     def v(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.v
  *     @v.setter
  */
 
@@ -20847,15 +21444,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":349
+/* "python/src/a/polytrack.pxi":349
  *         return self.ctx.v
  *     @v.setter
  *     def v(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]
  */
 
@@ -20878,41 +21475,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":350
+  /* "python/src/a/polytrack.pxi":350
  *     @v.setter
  *     def v(self, val):
  *         self.ctx.v[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 350, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->v[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.v[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":351
+  /* "python/src/a/polytrack.pxi":351
  *     def v(self, val):
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 351, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->v[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.v[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":349
+  /* "python/src/a/polytrack.pxi":349
  *         return self.ctx.v
  *     @v.setter
  *     def v(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val[0]
  *         self.ctx.v[1] = val[1]
  */
 
@@ -20924,15 +21521,15 @@
   __Pyx_AddTraceback("liba.polytrack7.v.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":354
+/* "python/src/a/polytrack.pxi":354
  * 
  *     @property
  *     def a(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.a
  *     @a.setter
  */
 
@@ -20954,29 +21551,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":355
+  /* "python/src/a/polytrack.pxi":355
  *     @property
  *     def a(self):
  *         return self.ctx.a             # <<<<<<<<<<<<<<
  *     @a.setter
  *     def a(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->a, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 355, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.a, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 355, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":354
+  /* "python/src/a/polytrack.pxi":354
  * 
  *     @property
  *     def a(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.a
  *     @a.setter
  */
 
@@ -20987,15 +21584,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":357
+/* "python/src/a/polytrack.pxi":357
  *         return self.ctx.a
  *     @a.setter
  *     def a(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val[0]
  *         self.ctx.a[1] = val[1]
  */
 
@@ -21018,41 +21615,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":358
+  /* "python/src/a/polytrack.pxi":358
  *     @a.setter
  *     def a(self, val):
  *         self.ctx.a[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.a[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 358, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 358, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->a[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.a[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":359
+  /* "python/src/a/polytrack.pxi":359
  *     def a(self, val):
  *         self.ctx.a[0] = val[0]
  *         self.ctx.a[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 359, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->a[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.a[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":357
+  /* "python/src/a/polytrack.pxi":357
  *         return self.ctx.a
  *     @a.setter
  *     def a(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val[0]
  *         self.ctx.a[1] = val[1]
  */
 
@@ -21064,15 +21661,15 @@
   __Pyx_AddTraceback("liba.polytrack7.a.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":362
+/* "python/src/a/polytrack.pxi":362
  * 
  *     @property
  *     def j(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.j
  *     @j.setter
  */
 
@@ -21094,29 +21691,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":363
+  /* "python/src/a/polytrack.pxi":363
  *     @property
  *     def j(self):
  *         return self.ctx.j             # <<<<<<<<<<<<<<
  *     @j.setter
  *     def j(self, val):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx->j, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 363, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_carray_to_py_a_real_t(__pyx_v_self->ctx.j, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 363, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":362
+  /* "python/src/a/polytrack.pxi":362
  * 
  *     @property
  *     def j(self):             # <<<<<<<<<<<<<<
  *         return self.ctx.j
  *     @j.setter
  */
 
@@ -21127,15 +21724,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":365
+/* "python/src/a/polytrack.pxi":365
  *         return self.ctx.j
  *     @j.setter
  *     def j(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.j[0] = val[0]
  *         self.ctx.j[1] = val[1]
  */
 
@@ -21158,41 +21755,41 @@
   PyObject *__pyx_t_1 = NULL;
   a_real_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":366
+  /* "python/src/a/polytrack.pxi":366
  *     @j.setter
  *     def j(self, val):
  *         self.ctx.j[0] = val[0]             # <<<<<<<<<<<<<<
  *         self.ctx.j[1] = val[1]
  * 
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 366, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->j[0]) = __pyx_t_2;
+  (__pyx_v_self->ctx.j[0]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":367
+  /* "python/src/a/polytrack.pxi":367
  *     def j(self, val):
  *         self.ctx.j[0] = val[0]
  *         self.ctx.j[1] = val[1]             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_val, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_2 == ((a_real_t)-1)) && PyErr_Occurred())) __PYX_ERR(9, 367, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  (__pyx_v_self->ctx->j[1]) = __pyx_t_2;
+  (__pyx_v_self->ctx.j[1]) = __pyx_t_2;
 
-  /* "ffi/python/src/a/polytrack.pxi":365
+  /* "python/src/a/polytrack.pxi":365
  *         return self.ctx.j
  *     @j.setter
  *     def j(self, val):             # <<<<<<<<<<<<<<
  *         self.ctx.j[0] = val[0]
  *         self.ctx.j[1] = val[1]
  */
 
@@ -21204,15 +21801,15 @@
   __Pyx_AddTraceback("liba.polytrack7.j.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":370
+/* "python/src/a/polytrack.pxi":370
  * 
  *     @property
  *     def t0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[0]
  *     @t0.setter
  */
 
@@ -21234,29 +21831,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":371
+  /* "python/src/a/polytrack.pxi":371
  *     @property
  *     def t0(self) -> a_real_t:
  *         return self.ctx.t[0]             # <<<<<<<<<<<<<<
  *     @t0.setter
  *     def t0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->t[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 371, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.t[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 371, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":370
+  /* "python/src/a/polytrack.pxi":370
  * 
  *     @property
  *     def t0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[0]
  *     @t0.setter
  */
 
@@ -21267,15 +21864,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":373
+/* "python/src/a/polytrack.pxi":373
  *         return self.ctx.t[0]
  *     @t0.setter
  *     def t0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val
  * 
  */
 
@@ -21306,38 +21903,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2t0_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":374
+  /* "python/src/a/polytrack.pxi":374
  *     @t0.setter
  *     def t0(self, val: a_real_t):
  *         self.ctx.t[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->t[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.t[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":373
+  /* "python/src/a/polytrack.pxi":373
  *         return self.ctx.t[0]
  *     @t0.setter
  *     def t0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":377
+/* "python/src/a/polytrack.pxi":377
  * 
  *     @property
  *     def q0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[0]
  *     @q0.setter
  */
 
@@ -21359,29 +21956,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":378
+  /* "python/src/a/polytrack.pxi":378
  *     @property
  *     def q0(self) -> a_real_t:
  *         return self.ctx.q[0]             # <<<<<<<<<<<<<<
  *     @q0.setter
  *     def q0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->q[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 378, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.q[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 378, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":377
+  /* "python/src/a/polytrack.pxi":377
  * 
  *     @property
  *     def q0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[0]
  *     @q0.setter
  */
 
@@ -21392,15 +21989,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":380
+/* "python/src/a/polytrack.pxi":380
  *         return self.ctx.q[0]
  *     @q0.setter
  *     def q0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val
  * 
  */
 
@@ -21431,38 +22028,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2q0_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":381
+  /* "python/src/a/polytrack.pxi":381
  *     @q0.setter
  *     def q0(self, val: a_real_t):
  *         self.ctx.q[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->q[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.q[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":380
+  /* "python/src/a/polytrack.pxi":380
  *         return self.ctx.q[0]
  *     @q0.setter
  *     def q0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":384
+/* "python/src/a/polytrack.pxi":384
  * 
  *     @property
  *     def v0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[0]
  *     @v0.setter
  */
 
@@ -21484,29 +22081,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":385
+  /* "python/src/a/polytrack.pxi":385
  *     @property
  *     def v0(self) -> a_real_t:
  *         return self.ctx.v[0]             # <<<<<<<<<<<<<<
  *     @v0.setter
  *     def v0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->v[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 385, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.v[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":384
+  /* "python/src/a/polytrack.pxi":384
  * 
  *     @property
  *     def v0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[0]
  *     @v0.setter
  */
 
@@ -21517,15 +22114,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":387
+/* "python/src/a/polytrack.pxi":387
  *         return self.ctx.v[0]
  *     @v0.setter
  *     def v0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val
  * 
  */
 
@@ -21556,38 +22153,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2v0_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":388
+  /* "python/src/a/polytrack.pxi":388
  *     @v0.setter
  *     def v0(self, val: a_real_t):
  *         self.ctx.v[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->v[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.v[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":387
+  /* "python/src/a/polytrack.pxi":387
  *         return self.ctx.v[0]
  *     @v0.setter
  *     def v0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":391
+/* "python/src/a/polytrack.pxi":391
  * 
  *     @property
  *     def a0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[0]
  *     @a0.setter
  */
 
@@ -21609,29 +22206,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":392
+  /* "python/src/a/polytrack.pxi":392
  *     @property
  *     def a0(self) -> a_real_t:
  *         return self.ctx.a[0]             # <<<<<<<<<<<<<<
  *     @a0.setter
  *     def a0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->a[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 392, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.a[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 392, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":391
+  /* "python/src/a/polytrack.pxi":391
  * 
  *     @property
  *     def a0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[0]
  *     @a0.setter
  */
 
@@ -21642,15 +22239,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":394
+/* "python/src/a/polytrack.pxi":394
  *         return self.ctx.a[0]
  *     @a0.setter
  *     def a0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val
  * 
  */
 
@@ -21681,38 +22278,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2a0_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":395
+  /* "python/src/a/polytrack.pxi":395
  *     @a0.setter
  *     def a0(self, val: a_real_t):
  *         self.ctx.a[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->a[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.a[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":394
+  /* "python/src/a/polytrack.pxi":394
  *         return self.ctx.a[0]
  *     @a0.setter
  *     def a0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":398
+/* "python/src/a/polytrack.pxi":398
  * 
  *     @property
  *     def j0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.j[0]
  *     @j0.setter
  */
 
@@ -21734,29 +22331,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":399
+  /* "python/src/a/polytrack.pxi":399
  *     @property
  *     def j0(self) -> a_real_t:
  *         return self.ctx.j[0]             # <<<<<<<<<<<<<<
  *     @j0.setter
  *     def j0(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->j[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 399, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.j[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 399, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":398
+  /* "python/src/a/polytrack.pxi":398
  * 
  *     @property
  *     def j0(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.j[0]
  *     @j0.setter
  */
 
@@ -21767,15 +22364,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":401
+/* "python/src/a/polytrack.pxi":401
  *         return self.ctx.j[0]
  *     @j0.setter
  *     def j0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.j[0] = val
  * 
  */
 
@@ -21806,38 +22403,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2j0_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":402
+  /* "python/src/a/polytrack.pxi":402
  *     @j0.setter
  *     def j0(self, val: a_real_t):
  *         self.ctx.j[0] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->j[0]) = __pyx_v_val;
+  (__pyx_v_self->ctx.j[0]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":401
+  /* "python/src/a/polytrack.pxi":401
  *         return self.ctx.j[0]
  *     @j0.setter
  *     def j0(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.j[0] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":405
+/* "python/src/a/polytrack.pxi":405
  * 
  *     @property
  *     def t1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[1]
  *     @t1.setter
  */
 
@@ -21859,29 +22456,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":406
+  /* "python/src/a/polytrack.pxi":406
  *     @property
  *     def t1(self) -> a_real_t:
  *         return self.ctx.t[1]             # <<<<<<<<<<<<<<
  *     @t1.setter
  *     def t1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->t[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 406, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.t[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 406, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":405
+  /* "python/src/a/polytrack.pxi":405
  * 
  *     @property
  *     def t1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.t[1]
  *     @t1.setter
  */
 
@@ -21892,15 +22489,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":408
+/* "python/src/a/polytrack.pxi":408
  *         return self.ctx.t[1]
  *     @t1.setter
  *     def t1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val
  * 
  */
 
@@ -21931,38 +22528,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2t1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":409
+  /* "python/src/a/polytrack.pxi":409
  *     @t1.setter
  *     def t1(self, val: a_real_t):
  *         self.ctx.t[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->t[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.t[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":408
+  /* "python/src/a/polytrack.pxi":408
  *         return self.ctx.t[1]
  *     @t1.setter
  *     def t1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.t[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":412
+/* "python/src/a/polytrack.pxi":412
  * 
  *     @property
  *     def q1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[1]
  *     @q1.setter
  */
 
@@ -21984,29 +22581,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":413
+  /* "python/src/a/polytrack.pxi":413
  *     @property
  *     def q1(self) -> a_real_t:
  *         return self.ctx.q[1]             # <<<<<<<<<<<<<<
  *     @q1.setter
  *     def q1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->q[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 413, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.q[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 413, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":412
+  /* "python/src/a/polytrack.pxi":412
  * 
  *     @property
  *     def q1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.q[1]
  *     @q1.setter
  */
 
@@ -22017,15 +22614,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":415
+/* "python/src/a/polytrack.pxi":415
  *         return self.ctx.q[1]
  *     @q1.setter
  *     def q1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val
  * 
  */
 
@@ -22056,38 +22653,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2q1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":416
+  /* "python/src/a/polytrack.pxi":416
  *     @q1.setter
  *     def q1(self, val: a_real_t):
  *         self.ctx.q[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->q[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.q[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":415
+  /* "python/src/a/polytrack.pxi":415
  *         return self.ctx.q[1]
  *     @q1.setter
  *     def q1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.q[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":419
+/* "python/src/a/polytrack.pxi":419
  * 
  *     @property
  *     def v1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[1]
  *     @v1.setter
  */
 
@@ -22109,29 +22706,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":420
+  /* "python/src/a/polytrack.pxi":420
  *     @property
  *     def v1(self) -> a_real_t:
  *         return self.ctx.v[1]             # <<<<<<<<<<<<<<
  *     @v1.setter
  *     def v1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->v[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 420, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.v[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":419
+  /* "python/src/a/polytrack.pxi":419
  * 
  *     @property
  *     def v1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.v[1]
  *     @v1.setter
  */
 
@@ -22142,15 +22739,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":422
+/* "python/src/a/polytrack.pxi":422
  *         return self.ctx.v[1]
  *     @v1.setter
  *     def v1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val
  * 
  */
 
@@ -22181,38 +22778,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2v1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":423
+  /* "python/src/a/polytrack.pxi":423
  *     @v1.setter
  *     def v1(self, val: a_real_t):
  *         self.ctx.v[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->v[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.v[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":422
+  /* "python/src/a/polytrack.pxi":422
  *         return self.ctx.v[1]
  *     @v1.setter
  *     def v1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.v[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":426
+/* "python/src/a/polytrack.pxi":426
  * 
  *     @property
  *     def a1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[1]
  *     @a1.setter
  */
 
@@ -22234,29 +22831,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":427
+  /* "python/src/a/polytrack.pxi":427
  *     @property
  *     def a1(self) -> a_real_t:
  *         return self.ctx.a[1]             # <<<<<<<<<<<<<<
  *     @a1.setter
  *     def a1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->a[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 427, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.a[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 427, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":426
+  /* "python/src/a/polytrack.pxi":426
  * 
  *     @property
  *     def a1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.a[1]
  *     @a1.setter
  */
 
@@ -22267,15 +22864,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":429
+/* "python/src/a/polytrack.pxi":429
  *         return self.ctx.a[1]
  *     @a1.setter
  *     def a1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[1] = val
  * 
  */
 
@@ -22306,38 +22903,38 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2a1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":430
+  /* "python/src/a/polytrack.pxi":430
  *     @a1.setter
  *     def a1(self, val: a_real_t):
  *         self.ctx.a[1] = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  (__pyx_v_self->ctx->a[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.a[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":429
+  /* "python/src/a/polytrack.pxi":429
  *         return self.ctx.a[1]
  *     @a1.setter
  *     def a1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.a[1] = val
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":433
+/* "python/src/a/polytrack.pxi":433
  * 
  *     @property
  *     def j1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.j[1]
  *     @j1.setter
  */
 
@@ -22359,29 +22956,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":434
+  /* "python/src/a/polytrack.pxi":434
  *     @property
  *     def j1(self) -> a_real_t:
  *         return self.ctx.j[1]             # <<<<<<<<<<<<<<
  *     @j1.setter
  *     def j1(self, val: a_real_t):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx->j[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 434, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->ctx.j[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(9, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "ffi/python/src/a/polytrack.pxi":433
+  /* "python/src/a/polytrack.pxi":433
  * 
  *     @property
  *     def j1(self) -> a_real_t:             # <<<<<<<<<<<<<<
  *         return self.ctx.j[1]
  *     @j1.setter
  */
 
@@ -22392,15 +22989,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "ffi/python/src/a/polytrack.pxi":436
+/* "python/src/a/polytrack.pxi":436
  *         return self.ctx.j[1]
  *     @j1.setter
  *     def j1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.j[1] = val
  */
 
 /* Python wrapper */
@@ -22430,22 +23027,22 @@
 }
 
 static int __pyx_pf_4liba_10polytrack7_2j1_2__set__(struct __pyx_obj_4liba_polytrack7 *__pyx_v_self, a_real_t __pyx_v_val) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__", 0);
 
-  /* "ffi/python/src/a/polytrack.pxi":437
+  /* "python/src/a/polytrack.pxi":437
  *     @j1.setter
  *     def j1(self, val: a_real_t):
  *         self.ctx.j[1] = val             # <<<<<<<<<<<<<<
  */
-  (__pyx_v_self->ctx->j[1]) = __pyx_v_val;
+  (__pyx_v_self->ctx.j[1]) = __pyx_v_val;
 
-  /* "ffi/python/src/a/polytrack.pxi":436
+  /* "python/src/a/polytrack.pxi":436
  *         return self.ctx.j[1]
  *     @j1.setter
  *     def j1(self, val: a_real_t):             # <<<<<<<<<<<<<<
  *         self.ctx.j[1] = val
  */
 
   /* function exit code */
@@ -22570,17 +23167,17 @@
 /* "(tree fragment)":1
  * def __pyx_unpickle_mf(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4liba_15__pyx_unpickle_mf(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4liba_15__pyx_unpickle_mf = {"__pyx_unpickle_mf", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_15__pyx_unpickle_mf, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4liba_15__pyx_unpickle_mf(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4liba_17__pyx_unpickle_mf(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4liba_17__pyx_unpickle_mf = {"__pyx_unpickle_mf", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_17__pyx_unpickle_mf, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4liba_17__pyx_unpickle_mf(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v___pyx_type = 0;
   long __pyx_v___pyx_checksum;
   PyObject *__pyx_v___pyx_state = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -22638,163 +23235,167 @@
   __pyx_L5_argtuple_error:;
   __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_mf", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(2, 1, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("liba.__pyx_unpickle_mf", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4liba_14__pyx_unpickle_mf(__pyx_self, __pyx_v___pyx_type, __pyx_v___pyx_checksum, __pyx_v___pyx_state);
+  __pyx_r = __pyx_pf_4liba_16__pyx_unpickle_mf(__pyx_self, __pyx_v___pyx_type, __pyx_v___pyx_checksum, __pyx_v___pyx_state);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4liba_14__pyx_unpickle_mf(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state) {
+static PyObject *__pyx_pf_4liba_16__pyx_unpickle_mf(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_v___pyx_PickleError = 0;
   PyObject *__pyx_v___pyx_result = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  int __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_t_2;
+  int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
+  PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__pyx_unpickle_mf", 0);
 
   /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
- *     if __pyx_checksum != 0xd41d8cd:             # <<<<<<<<<<<<<<
+ *     if __pyx_checksum not in (0xd41d8cd, 0xe3b0c44, 0xda39a3e):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xd41d8cd = ())" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())" % __pyx_checksum)
  */
-  __pyx_t_1 = ((__pyx_v___pyx_checksum != 0xd41d8cd) != 0);
-  if (__pyx_t_1) {
+  __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__13, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_3 = (__pyx_t_2 != 0);
+  if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
- *     if __pyx_checksum != 0xd41d8cd:
+ *     if __pyx_checksum not in (0xd41d8cd, 0xe3b0c44, 0xda39a3e):
  *         from pickle import PickleError as __pyx_PickleError             # <<<<<<<<<<<<<<
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xd41d8cd = ())" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())" % __pyx_checksum)
  *     __pyx_result = mf.__new__(__pyx_type)
  */
-    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 5, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 5, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_s_PickleError);
     __Pyx_GIVEREF(__pyx_n_s_PickleError);
-    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_PickleError);
-    __pyx_t_3 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 5, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_3, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 5, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_t_2);
-    __pyx_v___pyx_PickleError = __pyx_t_2;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_PickleError);
+    __pyx_t_4 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(2, 5, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 5, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_t_1);
+    __pyx_v___pyx_PickleError = __pyx_t_1;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
     /* "(tree fragment)":6
- *     if __pyx_checksum != 0xd41d8cd:
+ *     if __pyx_checksum not in (0xd41d8cd, 0xe3b0c44, 0xda39a3e):
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xd41d8cd = ())" % __pyx_checksum)             # <<<<<<<<<<<<<<
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())" % __pyx_checksum)             # <<<<<<<<<<<<<<
  *     __pyx_result = mf.__new__(__pyx_type)
  *     if __pyx_state is not None:
  */
-    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 6, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_s_vs_0xd4, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(2, 6, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 6, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(2, 6, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_INCREF(__pyx_v___pyx_PickleError);
-    __pyx_t_2 = __pyx_v___pyx_PickleError; __pyx_t_5 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_5)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_5);
+    __pyx_t_1 = __pyx_v___pyx_PickleError; __pyx_t_6 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_6)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5);
+    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(2, 6, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 6, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 6, __pyx_L1_error)
 
     /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
- *     if __pyx_checksum != 0xd41d8cd:             # <<<<<<<<<<<<<<
+ *     if __pyx_checksum not in (0xd41d8cd, 0xe3b0c44, 0xda39a3e):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xd41d8cd = ())" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())" % __pyx_checksum)
  */
   }
 
   /* "(tree fragment)":7
  *         from pickle import PickleError as __pyx_PickleError
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xd41d8cd = ())" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())" % __pyx_checksum)
  *     __pyx_result = mf.__new__(__pyx_type)             # <<<<<<<<<<<<<<
  *     if __pyx_state is not None:
  *         __pyx_unpickle_mf__set_state(<mf> __pyx_result, __pyx_state)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_4liba_mf), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 7, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = NULL;
-  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_4);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_4liba_mf), __pyx_n_s_new); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 7, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+    if (likely(__pyx_t_5)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
-  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v___pyx_type) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v___pyx_type);
-  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 7, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v___pyx_result = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v___pyx_type) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v___pyx_type);
+  __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(2, 7, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v___pyx_result = __pyx_t_4;
+  __pyx_t_4 = 0;
 
   /* "(tree fragment)":8
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xd41d8cd = ())" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())" % __pyx_checksum)
  *     __pyx_result = mf.__new__(__pyx_type)
  *     if __pyx_state is not None:             # <<<<<<<<<<<<<<
  *         __pyx_unpickle_mf__set_state(<mf> __pyx_result, __pyx_state)
  *     return __pyx_result
  */
-  __pyx_t_1 = (__pyx_v___pyx_state != Py_None);
-  __pyx_t_6 = (__pyx_t_1 != 0);
-  if (__pyx_t_6) {
+  __pyx_t_3 = (__pyx_v___pyx_state != Py_None);
+  __pyx_t_2 = (__pyx_t_3 != 0);
+  if (__pyx_t_2) {
 
     /* "(tree fragment)":9
  *     __pyx_result = mf.__new__(__pyx_type)
  *     if __pyx_state is not None:
  *         __pyx_unpickle_mf__set_state(<mf> __pyx_result, __pyx_state)             # <<<<<<<<<<<<<<
  *     return __pyx_result
  * cdef __pyx_unpickle_mf__set_state(mf __pyx_result, tuple __pyx_state):
  */
     if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(2, 9, __pyx_L1_error)
-    __pyx_t_3 = __pyx_f_4liba___pyx_unpickle_mf__set_state(((struct __pyx_obj_4liba_mf *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 9, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_4 = __pyx_f_4liba___pyx_unpickle_mf__set_state(((struct __pyx_obj_4liba_mf *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_4)) __PYX_ERR(2, 9, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
     /* "(tree fragment)":8
- *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xd41d8cd = ())" % __pyx_checksum)
+ *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xd41d8cd, 0xe3b0c44, 0xda39a3e) = ())" % __pyx_checksum)
  *     __pyx_result = mf.__new__(__pyx_type)
  *     if __pyx_state is not None:             # <<<<<<<<<<<<<<
  *         __pyx_unpickle_mf__set_state(<mf> __pyx_result, __pyx_state)
  *     return __pyx_result
  */
   }
 
@@ -22814,18 +23415,18 @@
  * def __pyx_unpickle_mf(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("liba.__pyx_unpickle_mf", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v___pyx_PickleError);
   __Pyx_XDECREF(__pyx_v___pyx_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
@@ -24378,15 +24979,16 @@
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
   } else {
     o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
   }
   if (unlikely(!o)) return 0;
   p = ((struct __pyx_obj_4liba_fpid *)o);
-  p->mmp = ((arrayobject *)Py_None); Py_INCREF(Py_None);
+  p->me = ((arrayobject *)Py_None); Py_INCREF(Py_None);
+  p->mec = ((arrayobject *)Py_None); Py_INCREF(Py_None);
   p->mkp = ((arrayobject *)Py_None); Py_INCREF(Py_None);
   p->mki = ((arrayobject *)Py_None); Py_INCREF(Py_None);
   p->mkd = ((arrayobject *)Py_None); Py_INCREF(Py_None);
   if (unlikely(__pyx_pw_4liba_4fpid_1__cinit__(o, a, k) < 0)) goto bad;
   return o;
   bad:
   Py_DECREF(o); o = 0;
@@ -24405,26 +25007,30 @@
     PyObject *etype, *eval, *etb;
     PyErr_Fetch(&etype, &eval, &etb);
     __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
     __pyx_pw_4liba_4fpid_5__dealloc__(o);
     __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
     PyErr_Restore(etype, eval, etb);
   }
-  Py_CLEAR(p->mmp);
+  Py_CLEAR(p->me);
+  Py_CLEAR(p->mec);
   Py_CLEAR(p->mkp);
   Py_CLEAR(p->mki);
   Py_CLEAR(p->mkd);
   (*Py_TYPE(o)->tp_free)(o);
 }
 
 static int __pyx_tp_traverse_4liba_fpid(PyObject *o, visitproc v, void *a) {
   int e;
   struct __pyx_obj_4liba_fpid *p = (struct __pyx_obj_4liba_fpid *)o;
-  if (p->mmp) {
-    e = (*v)(((PyObject *)p->mmp), a); if (e) return e;
+  if (p->me) {
+    e = (*v)(((PyObject *)p->me), a); if (e) return e;
+  }
+  if (p->mec) {
+    e = (*v)(((PyObject *)p->mec), a); if (e) return e;
   }
   if (p->mkp) {
     e = (*v)(((PyObject *)p->mkp), a); if (e) return e;
   }
   if (p->mki) {
     e = (*v)(((PyObject *)p->mki), a); if (e) return e;
   }
@@ -24433,16 +25039,19 @@
   }
   return 0;
 }
 
 static int __pyx_tp_clear_4liba_fpid(PyObject *o) {
   PyObject* tmp;
   struct __pyx_obj_4liba_fpid *p = (struct __pyx_obj_4liba_fpid *)o;
-  tmp = ((PyObject*)p->mmp);
-  p->mmp = ((arrayobject *)Py_None); Py_INCREF(Py_None);
+  tmp = ((PyObject*)p->me);
+  p->me = ((arrayobject *)Py_None); Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->mec);
+  p->mec = ((arrayobject *)Py_None); Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   tmp = ((PyObject*)p->mkp);
   p->mkp = ((arrayobject *)Py_None); Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   tmp = ((PyObject*)p->mki);
   p->mki = ((arrayobject *)Py_None); Py_INCREF(Py_None);
   Py_XDECREF(tmp);
@@ -24598,21 +25207,19 @@
   return __pyx_pw_4liba_4fpid_1e_1__get__(o);
 }
 
 static PyMethodDef __pyx_methods_4liba_fpid[] = {
   {"zero", (PyCFunction)__pyx_pw_4liba_4fpid_7zero, METH_NOARGS, __pyx_doc_4liba_4fpid_6zero},
   {"base", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_4fpid_9base, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4liba_4fpid_8base},
   {"kpid", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_4fpid_11kpid, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4liba_4fpid_10kpid},
-  {"olim", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_4fpid_13olim, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4liba_4fpid_12olim},
-  {"ilim", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4liba_4fpid_15ilim, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4liba_4fpid_14ilim},
-  {"pos", (PyCFunction)__pyx_pw_4liba_4fpid_17pos, METH_O, __pyx_doc_4liba_4fpid_16pos},
-  {"inc", (PyCFunction)__pyx_pw_4liba_4fpid_19inc, METH_NOARGS, __pyx_doc_4liba_4fpid_18inc},
-  {"off", (PyCFunction)__pyx_pw_4liba_4fpid_21off, METH_NOARGS, __pyx_doc_4liba_4fpid_20off},
-  {"__reduce_cython__", (PyCFunction)__pyx_pw_4liba_4fpid_23__reduce_cython__, METH_NOARGS, 0},
-  {"__setstate_cython__", (PyCFunction)__pyx_pw_4liba_4fpid_25__setstate_cython__, METH_O, 0},
+  {"pos", (PyCFunction)__pyx_pw_4liba_4fpid_13pos, METH_O, __pyx_doc_4liba_4fpid_12pos},
+  {"inc", (PyCFunction)__pyx_pw_4liba_4fpid_15inc, METH_NOARGS, __pyx_doc_4liba_4fpid_14inc},
+  {"off", (PyCFunction)__pyx_pw_4liba_4fpid_17off, METH_NOARGS, __pyx_doc_4liba_4fpid_16off},
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_4liba_4fpid_19__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_4liba_4fpid_21__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
 static struct PyGetSetDef __pyx_getsets_4liba_fpid[] = {
   {(char *)"outmin", __pyx_getprop_4liba_4fpid_outmin, __pyx_setprop_4liba_4fpid_outmin, (char *)0, 0},
   {(char *)"outmax", __pyx_getprop_4liba_4fpid_outmax, __pyx_setprop_4liba_4fpid_outmax, (char *)0, 0},
   {(char *)"summax", __pyx_getprop_4liba_4fpid_summax, __pyx_setprop_4liba_4fpid_summax, (char *)0, 0},
@@ -25604,58 +26211,65 @@
   }
   return o;
 }
 
 static void __pyx_tp_dealloc_4liba___pyx_scope_struct____cinit__(PyObject *o) {
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *p = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *)o;
   PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->__pyx_v_me);
+  Py_CLEAR(p->__pyx_v_mec);
   Py_CLEAR(p->__pyx_v_mkd);
   Py_CLEAR(p->__pyx_v_mki);
   Py_CLEAR(p->__pyx_v_mkp);
-  Py_CLEAR(p->__pyx_v_mmp);
   if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_4liba___pyx_scope_struct____cinit__ < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct____cinit__)))) {
     __pyx_freelist_4liba___pyx_scope_struct____cinit__[__pyx_freecount_4liba___pyx_scope_struct____cinit__++] = ((struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
 static int __pyx_tp_traverse_4liba___pyx_scope_struct____cinit__(PyObject *o, visitproc v, void *a) {
   int e;
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *p = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *)o;
+  if (p->__pyx_v_me) {
+    e = (*v)(p->__pyx_v_me, a); if (e) return e;
+  }
+  if (p->__pyx_v_mec) {
+    e = (*v)(p->__pyx_v_mec, a); if (e) return e;
+  }
   if (p->__pyx_v_mkd) {
     e = (*v)(p->__pyx_v_mkd, a); if (e) return e;
   }
   if (p->__pyx_v_mki) {
     e = (*v)(p->__pyx_v_mki, a); if (e) return e;
   }
   if (p->__pyx_v_mkp) {
     e = (*v)(p->__pyx_v_mkp, a); if (e) return e;
   }
-  if (p->__pyx_v_mmp) {
-    e = (*v)(p->__pyx_v_mmp, a); if (e) return e;
-  }
   return 0;
 }
 
 static int __pyx_tp_clear_4liba___pyx_scope_struct____cinit__(PyObject *o) {
   PyObject* tmp;
   struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *p = (struct __pyx_obj_4liba___pyx_scope_struct____cinit__ *)o;
+  tmp = ((PyObject*)p->__pyx_v_me);
+  p->__pyx_v_me = Py_None; Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->__pyx_v_mec);
+  p->__pyx_v_mec = Py_None; Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
   tmp = ((PyObject*)p->__pyx_v_mkd);
   p->__pyx_v_mkd = Py_None; Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   tmp = ((PyObject*)p->__pyx_v_mki);
   p->__pyx_v_mki = Py_None; Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   tmp = ((PyObject*)p->__pyx_v_mkp);
   p->__pyx_v_mkp = Py_None; Py_INCREF(Py_None);
   Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_mmp);
-  p->__pyx_v_mmp = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
   return 0;
 }
 
 static PyTypeObject __pyx_type_4liba___pyx_scope_struct____cinit__ = {
   PyVarObject_HEAD_INIT(0, 0)
   "liba.__pyx_scope_struct____cinit__", /*tp_name*/
   sizeof(struct __pyx_obj_4liba___pyx_scope_struct____cinit__), /*tp_basicsize*/
@@ -26223,87 +26837,73 @@
   0, /*tp_print*/
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
   0, /*tp_pypy_flags*/
   #endif
 };
 
-static struct __pyx_obj_4liba___pyx_scope_struct_5_base *__pyx_freelist_4liba___pyx_scope_struct_5_base[8];
-static int __pyx_freecount_4liba___pyx_scope_struct_5_base = 0;
+static struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *__pyx_freelist_4liba___pyx_scope_struct_5_genexpr[8];
+static int __pyx_freecount_4liba___pyx_scope_struct_5_genexpr = 0;
 
-static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_5_base(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_5_genexpr(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_4liba___pyx_scope_struct_5_base > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_base)))) {
-    o = (PyObject*)__pyx_freelist_4liba___pyx_scope_struct_5_base[--__pyx_freecount_4liba___pyx_scope_struct_5_base];
-    memset(o, 0, sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_base));
+  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_4liba___pyx_scope_struct_5_genexpr > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr)))) {
+    o = (PyObject*)__pyx_freelist_4liba___pyx_scope_struct_5_genexpr[--__pyx_freecount_4liba___pyx_scope_struct_5_genexpr];
+    memset(o, 0, sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else {
     o = (*t->tp_alloc)(t, 0);
     if (unlikely(!o)) return 0;
   }
   return o;
 }
 
-static void __pyx_tp_dealloc_4liba___pyx_scope_struct_5_base(PyObject *o) {
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *p = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *)o;
+static void __pyx_tp_dealloc_4liba___pyx_scope_struct_5_genexpr(PyObject *o) {
+  struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *)o;
   PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_v_mkd);
-  Py_CLEAR(p->__pyx_v_mki);
-  Py_CLEAR(p->__pyx_v_mkp);
-  Py_CLEAR(p->__pyx_v_mmp);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_4liba___pyx_scope_struct_5_base < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_base)))) {
-    __pyx_freelist_4liba___pyx_scope_struct_5_base[__pyx_freecount_4liba___pyx_scope_struct_5_base++] = ((struct __pyx_obj_4liba___pyx_scope_struct_5_base *)o);
+  Py_CLEAR(p->__pyx_outer_scope);
+  Py_CLEAR(p->__pyx_v_i);
+  Py_CLEAR(p->__pyx_v_j);
+  Py_CLEAR(p->__pyx_t_0);
+  Py_CLEAR(p->__pyx_t_3);
+  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_4liba___pyx_scope_struct_5_genexpr < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr)))) {
+    __pyx_freelist_4liba___pyx_scope_struct_5_genexpr[__pyx_freecount_4liba___pyx_scope_struct_5_genexpr++] = ((struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
-static int __pyx_tp_traverse_4liba___pyx_scope_struct_5_base(PyObject *o, visitproc v, void *a) {
+static int __pyx_tp_traverse_4liba___pyx_scope_struct_5_genexpr(PyObject *o, visitproc v, void *a) {
   int e;
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *p = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *)o;
-  if (p->__pyx_v_mkd) {
-    e = (*v)(p->__pyx_v_mkd, a); if (e) return e;
+  struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr *)o;
+  if (p->__pyx_outer_scope) {
+    e = (*v)(((PyObject *)p->__pyx_outer_scope), a); if (e) return e;
   }
-  if (p->__pyx_v_mki) {
-    e = (*v)(p->__pyx_v_mki, a); if (e) return e;
+  if (p->__pyx_v_i) {
+    e = (*v)(p->__pyx_v_i, a); if (e) return e;
   }
-  if (p->__pyx_v_mkp) {
-    e = (*v)(p->__pyx_v_mkp, a); if (e) return e;
+  if (p->__pyx_v_j) {
+    e = (*v)(p->__pyx_v_j, a); if (e) return e;
   }
-  if (p->__pyx_v_mmp) {
-    e = (*v)(p->__pyx_v_mmp, a); if (e) return e;
+  if (p->__pyx_t_0) {
+    e = (*v)(p->__pyx_t_0, a); if (e) return e;
+  }
+  if (p->__pyx_t_3) {
+    e = (*v)(p->__pyx_t_3, a); if (e) return e;
   }
   return 0;
 }
 
-static int __pyx_tp_clear_4liba___pyx_scope_struct_5_base(PyObject *o) {
-  PyObject* tmp;
-  struct __pyx_obj_4liba___pyx_scope_struct_5_base *p = (struct __pyx_obj_4liba___pyx_scope_struct_5_base *)o;
-  tmp = ((PyObject*)p->__pyx_v_mkd);
-  p->__pyx_v_mkd = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_mki);
-  p->__pyx_v_mki = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_mkp);
-  p->__pyx_v_mkp = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_mmp);
-  p->__pyx_v_mmp = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  return 0;
-}
-
-static PyTypeObject __pyx_type_4liba___pyx_scope_struct_5_base = {
+static PyTypeObject __pyx_type_4liba___pyx_scope_struct_5_genexpr = {
   PyVarObject_HEAD_INIT(0, 0)
-  "liba.__pyx_scope_struct_5_base", /*tp_name*/
-  sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_base), /*tp_basicsize*/
+  "liba.__pyx_scope_struct_5_genexpr", /*tp_name*/
+  sizeof(struct __pyx_obj_4liba___pyx_scope_struct_5_genexpr), /*tp_basicsize*/
   0, /*tp_itemsize*/
-  __pyx_tp_dealloc_4liba___pyx_scope_struct_5_base, /*tp_dealloc*/
+  __pyx_tp_dealloc_4liba___pyx_scope_struct_5_genexpr, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
   0, /*tp_vectorcall_offset*/
   #endif
   0, /*tp_getattr*/
@@ -26322,31 +26922,31 @@
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
   0, /*tp_doc*/
-  __pyx_tp_traverse_4liba___pyx_scope_struct_5_base, /*tp_traverse*/
-  __pyx_tp_clear_4liba___pyx_scope_struct_5_base, /*tp_clear*/
+  __pyx_tp_traverse_4liba___pyx_scope_struct_5_genexpr, /*tp_traverse*/
+  0, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   0, /*tp_methods*/
   0, /*tp_members*/
   0, /*tp_getset*/
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
   0, /*tp_descr_set*/
   0, /*tp_dictoffset*/
   0, /*tp_init*/
   0, /*tp_alloc*/
-  __pyx_tp_new_4liba___pyx_scope_struct_5_base, /*tp_new*/
+  __pyx_tp_new_4liba___pyx_scope_struct_5_genexpr, /*tp_new*/
   0, /*tp_free*/
   0, /*tp_is_gc*/
   0, /*tp_bases*/
   0, /*tp_mro*/
   0, /*tp_cache*/
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
@@ -26362,73 +26962,94 @@
   0, /*tp_print*/
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
   0, /*tp_pypy_flags*/
   #endif
 };
 
-static struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *__pyx_freelist_4liba___pyx_scope_struct_6_genexpr[8];
-static int __pyx_freecount_4liba___pyx_scope_struct_6_genexpr = 0;
+static struct __pyx_obj_4liba___pyx_scope_struct_6_base *__pyx_freelist_4liba___pyx_scope_struct_6_base[8];
+static int __pyx_freecount_4liba___pyx_scope_struct_6_base = 0;
 
-static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_6_genexpr(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_6_base(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_4liba___pyx_scope_struct_6_genexpr > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr)))) {
-    o = (PyObject*)__pyx_freelist_4liba___pyx_scope_struct_6_genexpr[--__pyx_freecount_4liba___pyx_scope_struct_6_genexpr];
-    memset(o, 0, sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr));
+  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_4liba___pyx_scope_struct_6_base > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_base)))) {
+    o = (PyObject*)__pyx_freelist_4liba___pyx_scope_struct_6_base[--__pyx_freecount_4liba___pyx_scope_struct_6_base];
+    memset(o, 0, sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_base));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else {
     o = (*t->tp_alloc)(t, 0);
     if (unlikely(!o)) return 0;
   }
   return o;
 }
 
-static void __pyx_tp_dealloc_4liba___pyx_scope_struct_6_genexpr(PyObject *o) {
-  struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *)o;
+static void __pyx_tp_dealloc_4liba___pyx_scope_struct_6_base(PyObject *o) {
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *p = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *)o;
   PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_outer_scope);
-  Py_CLEAR(p->__pyx_v_i);
-  Py_CLEAR(p->__pyx_v_j);
-  Py_CLEAR(p->__pyx_t_0);
-  Py_CLEAR(p->__pyx_t_3);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_4liba___pyx_scope_struct_6_genexpr < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr)))) {
-    __pyx_freelist_4liba___pyx_scope_struct_6_genexpr[__pyx_freecount_4liba___pyx_scope_struct_6_genexpr++] = ((struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *)o);
+  Py_CLEAR(p->__pyx_v_me);
+  Py_CLEAR(p->__pyx_v_mec);
+  Py_CLEAR(p->__pyx_v_mkd);
+  Py_CLEAR(p->__pyx_v_mki);
+  Py_CLEAR(p->__pyx_v_mkp);
+  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_4liba___pyx_scope_struct_6_base < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_base)))) {
+    __pyx_freelist_4liba___pyx_scope_struct_6_base[__pyx_freecount_4liba___pyx_scope_struct_6_base++] = ((struct __pyx_obj_4liba___pyx_scope_struct_6_base *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
-static int __pyx_tp_traverse_4liba___pyx_scope_struct_6_genexpr(PyObject *o, visitproc v, void *a) {
+static int __pyx_tp_traverse_4liba___pyx_scope_struct_6_base(PyObject *o, visitproc v, void *a) {
   int e;
-  struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr *)o;
-  if (p->__pyx_outer_scope) {
-    e = (*v)(((PyObject *)p->__pyx_outer_scope), a); if (e) return e;
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *p = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *)o;
+  if (p->__pyx_v_me) {
+    e = (*v)(p->__pyx_v_me, a); if (e) return e;
   }
-  if (p->__pyx_v_i) {
-    e = (*v)(p->__pyx_v_i, a); if (e) return e;
+  if (p->__pyx_v_mec) {
+    e = (*v)(p->__pyx_v_mec, a); if (e) return e;
   }
-  if (p->__pyx_v_j) {
-    e = (*v)(p->__pyx_v_j, a); if (e) return e;
+  if (p->__pyx_v_mkd) {
+    e = (*v)(p->__pyx_v_mkd, a); if (e) return e;
   }
-  if (p->__pyx_t_0) {
-    e = (*v)(p->__pyx_t_0, a); if (e) return e;
+  if (p->__pyx_v_mki) {
+    e = (*v)(p->__pyx_v_mki, a); if (e) return e;
   }
-  if (p->__pyx_t_3) {
-    e = (*v)(p->__pyx_t_3, a); if (e) return e;
+  if (p->__pyx_v_mkp) {
+    e = (*v)(p->__pyx_v_mkp, a); if (e) return e;
   }
   return 0;
 }
 
-static PyTypeObject __pyx_type_4liba___pyx_scope_struct_6_genexpr = {
+static int __pyx_tp_clear_4liba___pyx_scope_struct_6_base(PyObject *o) {
+  PyObject* tmp;
+  struct __pyx_obj_4liba___pyx_scope_struct_6_base *p = (struct __pyx_obj_4liba___pyx_scope_struct_6_base *)o;
+  tmp = ((PyObject*)p->__pyx_v_me);
+  p->__pyx_v_me = Py_None; Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->__pyx_v_mec);
+  p->__pyx_v_mec = Py_None; Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->__pyx_v_mkd);
+  p->__pyx_v_mkd = Py_None; Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->__pyx_v_mki);
+  p->__pyx_v_mki = Py_None; Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  tmp = ((PyObject*)p->__pyx_v_mkp);
+  p->__pyx_v_mkp = Py_None; Py_INCREF(Py_None);
+  Py_XDECREF(tmp);
+  return 0;
+}
+
+static PyTypeObject __pyx_type_4liba___pyx_scope_struct_6_base = {
   PyVarObject_HEAD_INIT(0, 0)
-  "liba.__pyx_scope_struct_6_genexpr", /*tp_name*/
-  sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_genexpr), /*tp_basicsize*/
+  "liba.__pyx_scope_struct_6_base", /*tp_name*/
+  sizeof(struct __pyx_obj_4liba___pyx_scope_struct_6_base), /*tp_basicsize*/
   0, /*tp_itemsize*/
-  __pyx_tp_dealloc_4liba___pyx_scope_struct_6_genexpr, /*tp_dealloc*/
+  __pyx_tp_dealloc_4liba___pyx_scope_struct_6_base, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
   0, /*tp_vectorcall_offset*/
   #endif
   0, /*tp_getattr*/
@@ -26447,31 +27068,31 @@
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
   0, /*tp_doc*/
-  __pyx_tp_traverse_4liba___pyx_scope_struct_6_genexpr, /*tp_traverse*/
-  0, /*tp_clear*/
+  __pyx_tp_traverse_4liba___pyx_scope_struct_6_base, /*tp_traverse*/
+  __pyx_tp_clear_4liba___pyx_scope_struct_6_base, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   0, /*tp_methods*/
   0, /*tp_members*/
   0, /*tp_getset*/
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
   0, /*tp_descr_set*/
   0, /*tp_dictoffset*/
   0, /*tp_init*/
   0, /*tp_alloc*/
-  __pyx_tp_new_4liba___pyx_scope_struct_6_genexpr, /*tp_new*/
+  __pyx_tp_new_4liba___pyx_scope_struct_6_base, /*tp_new*/
   0, /*tp_free*/
   0, /*tp_is_gc*/
   0, /*tp_bases*/
   0, /*tp_mro*/
   0, /*tp_cache*/
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
@@ -26862,14 +27483,264 @@
   0, /*tp_print*/
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
   0, /*tp_pypy_flags*/
   #endif
 };
 
+static struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *__pyx_freelist_4liba___pyx_scope_struct_10_genexpr[8];
+static int __pyx_freecount_4liba___pyx_scope_struct_10_genexpr = 0;
+
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_10_genexpr(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+  PyObject *o;
+  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_4liba___pyx_scope_struct_10_genexpr > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr)))) {
+    o = (PyObject*)__pyx_freelist_4liba___pyx_scope_struct_10_genexpr[--__pyx_freecount_4liba___pyx_scope_struct_10_genexpr];
+    memset(o, 0, sizeof(struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr));
+    (void) PyObject_INIT(o, t);
+    PyObject_GC_Track(o);
+  } else {
+    o = (*t->tp_alloc)(t, 0);
+    if (unlikely(!o)) return 0;
+  }
+  return o;
+}
+
+static void __pyx_tp_dealloc_4liba___pyx_scope_struct_10_genexpr(PyObject *o) {
+  struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *)o;
+  PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->__pyx_outer_scope);
+  Py_CLEAR(p->__pyx_v_i);
+  Py_CLEAR(p->__pyx_v_j);
+  Py_CLEAR(p->__pyx_t_0);
+  Py_CLEAR(p->__pyx_t_3);
+  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_4liba___pyx_scope_struct_10_genexpr < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr)))) {
+    __pyx_freelist_4liba___pyx_scope_struct_10_genexpr[__pyx_freecount_4liba___pyx_scope_struct_10_genexpr++] = ((struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *)o);
+  } else {
+    (*Py_TYPE(o)->tp_free)(o);
+  }
+}
+
+static int __pyx_tp_traverse_4liba___pyx_scope_struct_10_genexpr(PyObject *o, visitproc v, void *a) {
+  int e;
+  struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr *)o;
+  if (p->__pyx_outer_scope) {
+    e = (*v)(((PyObject *)p->__pyx_outer_scope), a); if (e) return e;
+  }
+  if (p->__pyx_v_i) {
+    e = (*v)(p->__pyx_v_i, a); if (e) return e;
+  }
+  if (p->__pyx_v_j) {
+    e = (*v)(p->__pyx_v_j, a); if (e) return e;
+  }
+  if (p->__pyx_t_0) {
+    e = (*v)(p->__pyx_t_0, a); if (e) return e;
+  }
+  if (p->__pyx_t_3) {
+    e = (*v)(p->__pyx_t_3, a); if (e) return e;
+  }
+  return 0;
+}
+
+static PyTypeObject __pyx_type_4liba___pyx_scope_struct_10_genexpr = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "liba.__pyx_scope_struct_10_genexpr", /*tp_name*/
+  sizeof(struct __pyx_obj_4liba___pyx_scope_struct_10_genexpr), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_4liba___pyx_scope_struct_10_genexpr, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  0, /*tp_as_sequence*/
+  0, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
+  0, /*tp_doc*/
+  __pyx_tp_traverse_4liba___pyx_scope_struct_10_genexpr, /*tp_traverse*/
+  0, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  0, /*tp_methods*/
+  0, /*tp_members*/
+  0, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  0, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_4liba___pyx_scope_struct_10_genexpr, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
+
+static struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *__pyx_freelist_4liba___pyx_scope_struct_11_genexpr[8];
+static int __pyx_freecount_4liba___pyx_scope_struct_11_genexpr = 0;
+
+static PyObject *__pyx_tp_new_4liba___pyx_scope_struct_11_genexpr(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+  PyObject *o;
+  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_4liba___pyx_scope_struct_11_genexpr > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr)))) {
+    o = (PyObject*)__pyx_freelist_4liba___pyx_scope_struct_11_genexpr[--__pyx_freecount_4liba___pyx_scope_struct_11_genexpr];
+    memset(o, 0, sizeof(struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr));
+    (void) PyObject_INIT(o, t);
+    PyObject_GC_Track(o);
+  } else {
+    o = (*t->tp_alloc)(t, 0);
+    if (unlikely(!o)) return 0;
+  }
+  return o;
+}
+
+static void __pyx_tp_dealloc_4liba___pyx_scope_struct_11_genexpr(PyObject *o) {
+  struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *)o;
+  PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->__pyx_outer_scope);
+  Py_CLEAR(p->__pyx_v_i);
+  Py_CLEAR(p->__pyx_v_j);
+  Py_CLEAR(p->__pyx_t_0);
+  Py_CLEAR(p->__pyx_t_3);
+  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_4liba___pyx_scope_struct_11_genexpr < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr)))) {
+    __pyx_freelist_4liba___pyx_scope_struct_11_genexpr[__pyx_freecount_4liba___pyx_scope_struct_11_genexpr++] = ((struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *)o);
+  } else {
+    (*Py_TYPE(o)->tp_free)(o);
+  }
+}
+
+static int __pyx_tp_traverse_4liba___pyx_scope_struct_11_genexpr(PyObject *o, visitproc v, void *a) {
+  int e;
+  struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *p = (struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr *)o;
+  if (p->__pyx_outer_scope) {
+    e = (*v)(((PyObject *)p->__pyx_outer_scope), a); if (e) return e;
+  }
+  if (p->__pyx_v_i) {
+    e = (*v)(p->__pyx_v_i, a); if (e) return e;
+  }
+  if (p->__pyx_v_j) {
+    e = (*v)(p->__pyx_v_j, a); if (e) return e;
+  }
+  if (p->__pyx_t_0) {
+    e = (*v)(p->__pyx_t_0, a); if (e) return e;
+  }
+  if (p->__pyx_t_3) {
+    e = (*v)(p->__pyx_t_3, a); if (e) return e;
+  }
+  return 0;
+}
+
+static PyTypeObject __pyx_type_4liba___pyx_scope_struct_11_genexpr = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "liba.__pyx_scope_struct_11_genexpr", /*tp_name*/
+  sizeof(struct __pyx_obj_4liba___pyx_scope_struct_11_genexpr), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_4liba___pyx_scope_struct_11_genexpr, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  0, /*tp_as_sequence*/
+  0, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
+  0, /*tp_doc*/
+  __pyx_tp_traverse_4liba___pyx_scope_struct_11_genexpr, /*tp_traverse*/
+  0, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  0, /*tp_methods*/
+  0, /*tp_members*/
+  0, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  0, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_4liba___pyx_scope_struct_11_genexpr, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
+
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
@@ -26911,15 +27782,15 @@
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s_GAUSS, __pyx_k_GAUSS, sizeof(__pyx_k_GAUSS), 0, 0, 1, 1},
   {&__pyx_n_s_GBELL, __pyx_k_GBELL, sizeof(__pyx_k_GBELL), 0, 0, 1, 1},
   {&__pyx_n_s_INC, __pyx_k_INC, sizeof(__pyx_k_INC), 0, 0, 1, 1},
-  {&__pyx_kp_s_Incompatible_checksums_s_vs_0xd4, __pyx_k_Incompatible_checksums_s_vs_0xd4, sizeof(__pyx_k_Incompatible_checksums_s_vs_0xd4), 0, 0, 1, 0},
+  {&__pyx_kp_s_Incompatible_checksums_0x_x_vs_0, __pyx_k_Incompatible_checksums_0x_x_vs_0, sizeof(__pyx_k_Incompatible_checksums_0x_x_vs_0), 0, 0, 1, 0},
   {&__pyx_n_s_MemoryError, __pyx_k_MemoryError, sizeof(__pyx_k_MemoryError), 0, 0, 1, 1},
   {&__pyx_n_s_NUL, __pyx_k_NUL, sizeof(__pyx_k_NUL), 0, 0, 1, 1},
   {&__pyx_n_s_OFF, __pyx_k_OFF, sizeof(__pyx_k_OFF), 0, 0, 1, 1},
   {&__pyx_n_s_POS, __pyx_k_POS, sizeof(__pyx_k_POS), 0, 0, 1, 1},
   {&__pyx_n_s_PickleError, __pyx_k_PickleError, sizeof(__pyx_k_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_SIG, __pyx_k_SIG, sizeof(__pyx_k_SIG), 0, 0, 1, 1},
   {&__pyx_n_s_TRAP, __pyx_k_TRAP, sizeof(__pyx_k_TRAP), 0, 0, 1, 1},
@@ -26941,58 +27812,57 @@
   {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
   {&__pyx_n_u_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 1, 0, 1},
   {&__pyx_n_s_den, __pyx_k_den, sizeof(__pyx_k_den), 0, 0, 1, 1},
   {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
   {&__pyx_n_s_dt, __pyx_k_dt, sizeof(__pyx_k_dt), 0, 0, 1, 1},
   {&__pyx_n_s_e, __pyx_k_e, sizeof(__pyx_k_e), 0, 0, 1, 1},
   {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
+  {&__pyx_n_s_f32_rsqrt, __pyx_k_f32_rsqrt, sizeof(__pyx_k_f32_rsqrt), 0, 0, 1, 1},
+  {&__pyx_n_s_f64_rsqrt, __pyx_k_f64_rsqrt, sizeof(__pyx_k_f64_rsqrt), 0, 0, 1, 1},
   {&__pyx_n_s_fdb, __pyx_k_fdb, sizeof(__pyx_k_fdb), 0, 0, 1, 1},
-  {&__pyx_kp_s_ffi_python_src_a_math_pxi, __pyx_k_ffi_python_src_a_math_pxi, sizeof(__pyx_k_ffi_python_src_a_math_pxi), 0, 0, 1, 0},
-  {&__pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_k_ffi_python_src_a_mf_pxi, sizeof(__pyx_k_ffi_python_src_a_mf_pxi), 0, 0, 1, 0},
-  {&__pyx_kp_s_ffi_python_src_a_poly_pxi, __pyx_k_ffi_python_src_a_poly_pxi, sizeof(__pyx_k_ffi_python_src_a_poly_pxi), 0, 0, 1, 0},
-  {&__pyx_kp_s_ffi_python_src_a_version_pxi, __pyx_k_ffi_python_src_a_version_pxi, sizeof(__pyx_k_ffi_python_src_a_version_pxi), 0, 0, 1, 0},
   {&__pyx_n_s_fpid, __pyx_k_fpid, sizeof(__pyx_k_fpid), 0, 0, 1, 1},
   {&__pyx_n_s_gauss, __pyx_k_gauss, sizeof(__pyx_k_gauss), 0, 0, 1, 1},
   {&__pyx_n_s_gbell, __pyx_k_gbell, sizeof(__pyx_k_gbell), 0, 0, 1, 1},
   {&__pyx_n_s_genexpr, __pyx_k_genexpr, sizeof(__pyx_k_genexpr), 0, 0, 1, 1},
   {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
-  {&__pyx_n_s_imax, __pyx_k_imax, sizeof(__pyx_k_imax), 0, 0, 1, 1},
-  {&__pyx_n_s_imin, __pyx_k_imin, sizeof(__pyx_k_imin), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_it, __pyx_k_it, sizeof(__pyx_k_it), 0, 0, 1, 1},
   {&__pyx_n_s_j0, __pyx_k_j0, sizeof(__pyx_k_j0), 0, 0, 1, 1},
   {&__pyx_n_s_j1, __pyx_k_j1, sizeof(__pyx_k_j1), 0, 0, 1, 1},
   {&__pyx_n_s_kd, __pyx_k_kd, sizeof(__pyx_k_kd), 0, 0, 1, 1},
   {&__pyx_n_s_ki, __pyx_k_ki, sizeof(__pyx_k_ki), 0, 0, 1, 1},
   {&__pyx_n_s_kp, __pyx_k_kp, sizeof(__pyx_k_kp), 0, 0, 1, 1},
   {&__pyx_n_s_liba, __pyx_k_liba, sizeof(__pyx_k_liba), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_max, __pyx_k_max, sizeof(__pyx_k_max), 0, 0, 1, 1},
+  {&__pyx_n_s_me, __pyx_k_me, sizeof(__pyx_k_me), 0, 0, 1, 1},
+  {&__pyx_n_s_mec, __pyx_k_mec, sizeof(__pyx_k_mec), 0, 0, 1, 1},
   {&__pyx_n_s_mf, __pyx_k_mf, sizeof(__pyx_k_mf), 0, 0, 1, 1},
   {&__pyx_n_s_min, __pyx_k_min, sizeof(__pyx_k_min), 0, 0, 1, 1},
   {&__pyx_n_s_mkd, __pyx_k_mkd, sizeof(__pyx_k_mkd), 0, 0, 1, 1},
   {&__pyx_n_s_mki, __pyx_k_mki, sizeof(__pyx_k_mki), 0, 0, 1, 1},
   {&__pyx_n_s_mkp, __pyx_k_mkp, sizeof(__pyx_k_mkp), 0, 0, 1, 1},
-  {&__pyx_n_s_mmp, __pyx_k_mmp, sizeof(__pyx_k_mmp), 0, 0, 1, 1},
   {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
   {&__pyx_kp_s_no_default___reduce___due_to_non, __pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 0, 1, 0},
   {&__pyx_n_s_num, __pyx_k_num, sizeof(__pyx_k_num), 0, 0, 1, 1},
-  {&__pyx_n_s_omax, __pyx_k_omax, sizeof(__pyx_k_omax), 0, 0, 1, 1},
-  {&__pyx_n_s_omin, __pyx_k_omin, sizeof(__pyx_k_omin), 0, 0, 1, 1},
   {&__pyx_n_s_p, __pyx_k_p, sizeof(__pyx_k_p), 0, 0, 1, 1},
   {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
   {&__pyx_n_s_pid, __pyx_k_pid, sizeof(__pyx_k_pid), 0, 0, 1, 1},
   {&__pyx_n_s_poly_eval, __pyx_k_poly_eval, sizeof(__pyx_k_poly_eval), 0, 0, 1, 1},
   {&__pyx_n_s_poly_evar, __pyx_k_poly_evar, sizeof(__pyx_k_poly_evar), 0, 0, 1, 1},
   {&__pyx_n_s_polytrack3, __pyx_k_polytrack3, sizeof(__pyx_k_polytrack3), 0, 0, 1, 1},
   {&__pyx_n_s_polytrack5, __pyx_k_polytrack5, sizeof(__pyx_k_polytrack5), 0, 0, 1, 1},
   {&__pyx_n_s_polytrack7, __pyx_k_polytrack7, sizeof(__pyx_k_polytrack7), 0, 0, 1, 1},
+  {&__pyx_kp_s_python_src_a_math_pxi, __pyx_k_python_src_a_math_pxi, sizeof(__pyx_k_python_src_a_math_pxi), 0, 0, 1, 0},
+  {&__pyx_kp_s_python_src_a_mf_pxi, __pyx_k_python_src_a_mf_pxi, sizeof(__pyx_k_python_src_a_mf_pxi), 0, 0, 1, 0},
+  {&__pyx_kp_s_python_src_a_poly_pxi, __pyx_k_python_src_a_poly_pxi, sizeof(__pyx_k_python_src_a_poly_pxi), 0, 0, 1, 0},
+  {&__pyx_kp_s_python_src_a_version_pxi, __pyx_k_python_src_a_version_pxi, sizeof(__pyx_k_python_src_a_version_pxi), 0, 0, 1, 0},
   {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_unpickle_mf, __pyx_k_pyx_unpickle_mf, sizeof(__pyx_k_pyx_unpickle_mf), 0, 0, 1, 1},
   {&__pyx_n_s_q0, __pyx_k_q0, sizeof(__pyx_k_q0), 0, 0, 1, 1},
@@ -27003,15 +27873,14 @@
   {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
   {&__pyx_n_s_send, __pyx_k_send, sizeof(__pyx_k_send), 0, 0, 1, 1},
   {&__pyx_n_s_set, __pyx_k_set, sizeof(__pyx_k_set), 0, 0, 1, 1},
   {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
   {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
   {&__pyx_n_s_sig, __pyx_k_sig, sizeof(__pyx_k_sig), 0, 0, 1, 1},
   {&__pyx_n_s_sigma, __pyx_k_sigma, sizeof(__pyx_k_sigma), 0, 0, 1, 1},
-  {&__pyx_n_s_sqrt_inv, __pyx_k_sqrt_inv, sizeof(__pyx_k_sqrt_inv), 0, 0, 1, 1},
   {&__pyx_n_s_staticmethod, __pyx_k_staticmethod, sizeof(__pyx_k_staticmethod), 0, 0, 1, 1},
   {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
   {&__pyx_n_s_sum, __pyx_k_sum, sizeof(__pyx_k_sum), 0, 0, 1, 1},
   {&__pyx_n_s_t0, __pyx_k_t0, sizeof(__pyx_k_t0), 0, 0, 1, 1},
   {&__pyx_n_s_t1, __pyx_k_t1, sizeof(__pyx_k_t1), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_n_s_tf, __pyx_k_tf, sizeof(__pyx_k_tf), 0, 0, 1, 1},
@@ -27156,192 +28025,209 @@
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__12);
   __Pyx_GIVEREF(__pyx_tuple__12);
+  __pyx_tuple__13 = PyTuple_Pack(3, __pyx_int_222419149, __pyx_int_238750788, __pyx_int_228825662); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__13);
+  __Pyx_GIVEREF(__pyx_tuple__13);
 
-  /* "ffi/python/src/a/version.pxi":3
+  /* "python/src/a/version.pxi":3
  * from a.version cimport *
  * 
  * def version():             # <<<<<<<<<<<<<<
  *     '''algorithm library version'''
  *     if PY_MAJOR_VERSION >= 3:
  */
-  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_version_pxi, __pyx_n_s_version, 3, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(4, 3, __pyx_L1_error)
+  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_version_pxi, __pyx_n_s_version, 3, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(4, 3, __pyx_L1_error)
 
-  /* "ffi/python/src/a/version.pxi":9
+  /* "python/src/a/version.pxi":9
  *     return a_version()
  * 
  * def version_major() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version major'''
  *     return a_version_major()
  */
-  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_version_pxi, __pyx_n_s_version_major, 9, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(4, 9, __pyx_L1_error)
+  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_version_pxi, __pyx_n_s_version_major, 9, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(4, 9, __pyx_L1_error)
 
-  /* "ffi/python/src/a/version.pxi":13
+  /* "python/src/a/version.pxi":13
  *     return a_version_major()
  * 
  * def version_minor() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version minor'''
  *     return a_version_minor()
  */
-  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_version_pxi, __pyx_n_s_version_minor, 13, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(4, 13, __pyx_L1_error)
+  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_version_pxi, __pyx_n_s_version_minor, 13, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(4, 13, __pyx_L1_error)
 
-  /* "ffi/python/src/a/version.pxi":17
+  /* "python/src/a/version.pxi":17
  *     return a_version_minor()
  * 
  * def version_patch() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version patch'''
  *     return a_version_patch()
  */
-  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_version_pxi, __pyx_n_s_version_patch, 17, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(4, 17, __pyx_L1_error)
+  __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_version_pxi, __pyx_n_s_version_patch, 17, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(4, 17, __pyx_L1_error)
 
-  /* "ffi/python/src/a/math.pxi":5
+  /* "python/src/a/math.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
- * def sqrt_inv(x):             # <<<<<<<<<<<<<<
+ * def f32_rsqrt(x):             # <<<<<<<<<<<<<<
  *     '''fast inverse square-root'''
  *     if iterable(x):
  */
-  __pyx_tuple__17 = PyTuple_Pack(4, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(1, 5, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__17);
-  __Pyx_GIVEREF(__pyx_tuple__17);
-  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__17, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_math_pxi, __pyx_n_s_sqrt_inv, 5, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(1, 5, __pyx_L1_error)
+  __pyx_tuple__18 = PyTuple_Pack(4, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(1, 5, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_codeobj__19 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__18, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_math_pxi, __pyx_n_s_f32_rsqrt, 5, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__19)) __PYX_ERR(1, 5, __pyx_L1_error)
 
-  /* "ffi/python/src/a/mf.pxi":15
+  /* "python/src/a/math.pxi":16
+ * @cython.wraparound(False)
+ * @cython.boundscheck(False)
+ * def f64_rsqrt(x):             # <<<<<<<<<<<<<<
+ *     '''fast inverse square-root'''
+ *     if iterable(x):
+ */
+  __pyx_tuple__20 = PyTuple_Pack(4, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 16, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
+  __pyx_codeobj__21 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__20, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_math_pxi, __pyx_n_s_f64_rsqrt, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__21)) __PYX_ERR(1, 16, __pyx_L1_error)
+
+  /* "python/src/a/mf.pxi":15
  *     Z     = A_MF_Z
  *     @staticmethod
  *     def __call__(e: a_mf_e, x, a):             # <<<<<<<<<<<<<<
  *         cdef array d = reals(a)
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  */
-  __pyx_tuple__19 = PyTuple_Pack(8, __pyx_n_s_e, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_d, __pyx_n_s_v, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 15, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__19);
-  __Pyx_GIVEREF(__pyx_tuple__19);
-  __pyx_codeobj__20 = (PyObject*)__Pyx_PyCode_New(3, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__19, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_n_s_call, 15, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 15, __pyx_L1_error)
+  __pyx_tuple__22 = PyTuple_Pack(8, __pyx_n_s_e, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_d, __pyx_n_s_v, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 15, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(3, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_mf_pxi, __pyx_n_s_call, 15, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 15, __pyx_L1_error)
 
-  /* "ffi/python/src/a/mf.pxi":25
+  /* "python/src/a/mf.pxi":25
  *         return a_mf(e, x, v)
  *     @staticmethod
  *     def gauss(x, sigma: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Gaussian membership function'''
  *         if iterable(x):
  */
-  __pyx_tuple__21 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_sigma, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 25, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
-  __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_n_s_gauss, 25, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 25, __pyx_L1_error)
+  __pyx_tuple__24 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_sigma, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 25, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_mf_pxi, __pyx_n_s_gauss, 25, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 25, __pyx_L1_error)
 
-  /* "ffi/python/src/a/mf.pxi":34
+  /* "python/src/a/mf.pxi":34
  *         return a_mf_gauss(x, sigma, c)
  *     @staticmethod
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Generalized bell-shaped membership function'''
  *         if iterable(x):
  */
-  __pyx_tuple__23 = PyTuple_Pack(7, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 34, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
-  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_n_s_gbell, 34, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 34, __pyx_L1_error)
+  __pyx_tuple__26 = PyTuple_Pack(7, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 34, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_mf_pxi, __pyx_n_s_gbell, 34, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 34, __pyx_L1_error)
 
-  /* "ffi/python/src/a/mf.pxi":43
+  /* "python/src/a/mf.pxi":43
  *         return a_mf_gbell(x, a, b, c)
  *     @staticmethod
  *     def sig(x, a: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Sigmoidal membership function'''
  *         if iterable(x):
  */
-  __pyx_tuple__25 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 43, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__25);
-  __Pyx_GIVEREF(__pyx_tuple__25);
-  __pyx_codeobj__26 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_n_s_sig, 43, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_tuple__28 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_codeobj__29 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_mf_pxi, __pyx_n_s_sig, 43, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 43, __pyx_L1_error)
 
-  /* "ffi/python/src/a/mf.pxi":52
+  /* "python/src/a/mf.pxi":52
  *         return a_mf_sig(x, a, c)
  *     @staticmethod
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Trapezoidal membership function'''
  *         if iterable(x):
  */
-  __pyx_tuple__27 = PyTuple_Pack(8, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_d, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 52, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
-  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(5, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_n_s_trap, 52, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 52, __pyx_L1_error)
+  __pyx_tuple__30 = PyTuple_Pack(8, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_d, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 52, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(5, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_mf_pxi, __pyx_n_s_trap, 52, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 52, __pyx_L1_error)
 
-  /* "ffi/python/src/a/mf.pxi":61
+  /* "python/src/a/mf.pxi":61
  *         return a_mf_trap(x, a, b, c, d)
  *     @staticmethod
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Triangular membership function'''
  *         if iterable(x):
  */
-  __pyx_tuple__29 = PyTuple_Pack(7, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 61, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
-  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_n_s_tri, 61, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __pyx_tuple__32 = PyTuple_Pack(7, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__32);
+  __Pyx_GIVEREF(__pyx_tuple__32);
+  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_mf_pxi, __pyx_n_s_tri, 61, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 61, __pyx_L1_error)
 
-  /* "ffi/python/src/a/mf.pxi":70
+  /* "python/src/a/mf.pxi":70
  *         return a_mf_tri(x, a, b, c)
  *     @staticmethod
  *     def z(x, a: a_real_t, b: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Z-shaped membership function'''
  *         if iterable(x):
  */
-  __pyx_tuple__31 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 70, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
-  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_mf_pxi, __pyx_n_s_z, 70, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 70, __pyx_L1_error)
+  __pyx_tuple__34 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_y, __pyx_n_s_i, __pyx_n_s_it); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 70, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__34);
+  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_mf_pxi, __pyx_n_s_z, 70, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 70, __pyx_L1_error)
 
-  /* "ffi/python/src/a/poly.pxi":5
+  /* "python/src/a/poly.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_eval(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
-  __pyx_tuple__33 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_d, __pyx_n_s_n, __pyx_n_s_p, __pyx_n_s_y); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(8, 5, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_poly_pxi, __pyx_n_s_poly_eval, 5, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(8, 5, __pyx_L1_error)
+  __pyx_tuple__36 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_d, __pyx_n_s_n, __pyx_n_s_p, __pyx_n_s_y); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(8, 5, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
+  __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_poly_pxi, __pyx_n_s_poly_eval, 5, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(8, 5, __pyx_L1_error)
 
-  /* "ffi/python/src/a/poly.pxi":16
+  /* "python/src/a/poly.pxi":16
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_evar(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
-  __pyx_tuple__35 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_d, __pyx_n_s_n, __pyx_n_s_p, __pyx_n_s_y); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(8, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ffi_python_src_a_poly_pxi, __pyx_n_s_poly_evar, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(8, 16, __pyx_L1_error)
+  __pyx_tuple__38 = PyTuple_Pack(6, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_d, __pyx_n_s_n, __pyx_n_s_p, __pyx_n_s_y); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(8, 16, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
+  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_python_src_a_poly_pxi, __pyx_n_s_poly_evar, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(8, 16, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_mf(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__37 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
-  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_mf, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __pyx_tuple__40 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__40);
+  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_codeobj__41 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__40, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_mf, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(2, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
   if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(3, 1, __pyx_L1_error);
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(3, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(3, 1, __pyx_L1_error)
   __pyx_int_222419149 = PyInt_FromLong(222419149L); if (unlikely(!__pyx_int_222419149)) __PYX_ERR(3, 1, __pyx_L1_error)
+  __pyx_int_228825662 = PyInt_FromLong(228825662L); if (unlikely(!__pyx_int_228825662)) __PYX_ERR(3, 1, __pyx_L1_error)
+  __pyx_int_238750788 = PyInt_FromLong(238750788L); if (unlikely(!__pyx_int_238750788)) __PYX_ERR(3, 1, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(void); /*proto*/
 static CYTHON_SMALL_CODE int __Pyx_modinit_variable_export_code(void); /*proto*/
@@ -27395,15 +28281,15 @@
   if (PyType_Ready(&__pyx_type_4liba_tf) < 0) __PYX_ERR(5, 5, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba_tf.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba_tf.tp_dictoffset && __pyx_type_4liba_tf.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba_tf.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_UPDATE_DESCRIPTOR_DOC
   {
     PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_4liba_tf, "__call__"); if (unlikely(!wrapper)) __PYX_ERR(5, 5, __pyx_L1_error)
     if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
       __pyx_wrapperbase_4liba_2tf_2__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
       __pyx_wrapperbase_4liba_2tf_2__call__.doc = __pyx_doc_4liba_2tf_2__call__;
       ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_4liba_2tf_2__call__;
     }
@@ -27415,15 +28301,15 @@
   if (PyType_Ready(&__pyx_type_4liba_pid) < 0) __PYX_ERR(6, 5, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba_pid.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba_pid.tp_dictoffset && __pyx_type_4liba_pid.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba_pid.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_UPDATE_DESCRIPTOR_DOC
   {
     PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_4liba_pid, "__call__"); if (unlikely(!wrapper)) __PYX_ERR(6, 5, __pyx_L1_error)
     if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
       __pyx_wrapperbase_4liba_3pid_2__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
       __pyx_wrapperbase_4liba_3pid_2__call__.doc = __pyx_doc_4liba_3pid_2__call__;
       ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_4liba_3pid_2__call__;
     }
@@ -27435,15 +28321,15 @@
   if (PyType_Ready(&__pyx_type_4liba_fpid) < 0) __PYX_ERR(7, 6, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba_fpid.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba_fpid.tp_dictoffset && __pyx_type_4liba_fpid.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba_fpid.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_UPDATE_DESCRIPTOR_DOC
   {
     PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_4liba_fpid, "__call__"); if (unlikely(!wrapper)) __PYX_ERR(7, 6, __pyx_L1_error)
     if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
       __pyx_wrapperbase_4liba_4fpid_2__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
       __pyx_wrapperbase_4liba_4fpid_2__call__.doc = __pyx_doc_4liba_4fpid_2__call__;
       ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_4liba_4fpid_2__call__;
     }
@@ -27455,15 +28341,15 @@
   if (PyType_Ready(&__pyx_type_4liba_polytrack3) < 0) __PYX_ERR(9, 5, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba_polytrack3.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba_polytrack3.tp_dictoffset && __pyx_type_4liba_polytrack3.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba_polytrack3.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_UPDATE_DESCRIPTOR_DOC
   {
     PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_4liba_polytrack3, "__call__"); if (unlikely(!wrapper)) __PYX_ERR(9, 5, __pyx_L1_error)
     if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
       __pyx_wrapperbase_4liba_10polytrack3_2__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
       __pyx_wrapperbase_4liba_10polytrack3_2__call__.doc = __pyx_doc_4liba_10polytrack3_2__call__;
       ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_4liba_10polytrack3_2__call__;
     }
@@ -27475,15 +28361,15 @@
   if (PyType_Ready(&__pyx_type_4liba_polytrack5) < 0) __PYX_ERR(9, 125, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba_polytrack5.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba_polytrack5.tp_dictoffset && __pyx_type_4liba_polytrack5.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba_polytrack5.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_UPDATE_DESCRIPTOR_DOC
   {
     PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_4liba_polytrack5, "__call__"); if (unlikely(!wrapper)) __PYX_ERR(9, 125, __pyx_L1_error)
     if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
       __pyx_wrapperbase_4liba_10polytrack5_2__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
       __pyx_wrapperbase_4liba_10polytrack5_2__call__.doc = __pyx_doc_4liba_10polytrack5_2__call__;
       ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_4liba_10polytrack5_2__call__;
     }
@@ -27495,107 +28381,123 @@
   if (PyType_Ready(&__pyx_type_4liba_polytrack7) < 0) __PYX_ERR(9, 267, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba_polytrack7.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba_polytrack7.tp_dictoffset && __pyx_type_4liba_polytrack7.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba_polytrack7.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_UPDATE_DESCRIPTOR_DOC
   {
     PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_4liba_polytrack7, "__call__"); if (unlikely(!wrapper)) __PYX_ERR(9, 267, __pyx_L1_error)
     if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
       __pyx_wrapperbase_4liba_10polytrack7_2__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
       __pyx_wrapperbase_4liba_10polytrack7_2__call__.doc = __pyx_doc_4liba_10polytrack7_2__call__;
       ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_4liba_10polytrack7_2__call__;
     }
   }
   #endif
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s_polytrack7, (PyObject *)&__pyx_type_4liba_polytrack7) < 0) __PYX_ERR(9, 267, __pyx_L1_error)
   if (__Pyx_setup_reduce((PyObject*)&__pyx_type_4liba_polytrack7) < 0) __PYX_ERR(9, 267, __pyx_L1_error)
   __pyx_ptype_4liba_polytrack7 = &__pyx_type_4liba_polytrack7;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct____cinit__) < 0) __PYX_ERR(7, 14, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct____cinit__) < 0) __PYX_ERR(7, 15, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct____cinit__.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct____cinit__.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct____cinit__.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct____cinit__.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct____cinit__ = &__pyx_type_4liba___pyx_scope_struct____cinit__;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_1_genexpr) < 0) __PYX_ERR(7, 15, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_1_genexpr) < 0) __PYX_ERR(7, 16, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct_1_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_1_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_1_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct_1_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct_1_genexpr = &__pyx_type_4liba___pyx_scope_struct_1_genexpr;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_2_genexpr) < 0) __PYX_ERR(7, 16, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_2_genexpr) < 0) __PYX_ERR(7, 17, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct_2_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_2_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_2_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct_2_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct_2_genexpr = &__pyx_type_4liba___pyx_scope_struct_2_genexpr;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_3_genexpr) < 0) __PYX_ERR(7, 17, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_3_genexpr) < 0) __PYX_ERR(7, 18, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct_3_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_3_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_3_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct_3_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct_3_genexpr = &__pyx_type_4liba___pyx_scope_struct_3_genexpr;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_4_genexpr) < 0) __PYX_ERR(7, 18, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_4_genexpr) < 0) __PYX_ERR(7, 19, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct_4_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_4_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_4_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct_4_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct_4_genexpr = &__pyx_type_4liba___pyx_scope_struct_4_genexpr;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_5_base) < 0) __PYX_ERR(7, 40, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_5_genexpr) < 0) __PYX_ERR(7, 20, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_4liba___pyx_scope_struct_5_base.tp_print = 0;
+  __pyx_type_4liba___pyx_scope_struct_5_genexpr.tp_print = 0;
   #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_5_base.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_5_base.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_4liba___pyx_scope_struct_5_base.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_5_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_5_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_4liba___pyx_scope_struct_5_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  __pyx_ptype_4liba___pyx_scope_struct_5_base = &__pyx_type_4liba___pyx_scope_struct_5_base;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_6_genexpr) < 0) __PYX_ERR(7, 42, __pyx_L1_error)
+  __pyx_ptype_4liba___pyx_scope_struct_5_genexpr = &__pyx_type_4liba___pyx_scope_struct_5_genexpr;
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_6_base) < 0) __PYX_ERR(7, 43, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_4liba___pyx_scope_struct_6_genexpr.tp_print = 0;
+  __pyx_type_4liba___pyx_scope_struct_6_base.tp_print = 0;
   #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_6_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_6_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_4liba___pyx_scope_struct_6_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_6_base.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_6_base.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_4liba___pyx_scope_struct_6_base.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  __pyx_ptype_4liba___pyx_scope_struct_6_genexpr = &__pyx_type_4liba___pyx_scope_struct_6_genexpr;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_7_genexpr) < 0) __PYX_ERR(7, 43, __pyx_L1_error)
+  __pyx_ptype_4liba___pyx_scope_struct_6_base = &__pyx_type_4liba___pyx_scope_struct_6_base;
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_7_genexpr) < 0) __PYX_ERR(7, 45, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct_7_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_7_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_7_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct_7_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct_7_genexpr = &__pyx_type_4liba___pyx_scope_struct_7_genexpr;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_8_genexpr) < 0) __PYX_ERR(7, 44, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_8_genexpr) < 0) __PYX_ERR(7, 46, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct_8_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_8_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_8_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct_8_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct_8_genexpr = &__pyx_type_4liba___pyx_scope_struct_8_genexpr;
-  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_9_genexpr) < 0) __PYX_ERR(7, 45, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_9_genexpr) < 0) __PYX_ERR(7, 47, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_4liba___pyx_scope_struct_9_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_9_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_9_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_4liba___pyx_scope_struct_9_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_4liba___pyx_scope_struct_9_genexpr = &__pyx_type_4liba___pyx_scope_struct_9_genexpr;
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_10_genexpr) < 0) __PYX_ERR(7, 48, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_4liba___pyx_scope_struct_10_genexpr.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_10_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_10_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_4liba___pyx_scope_struct_10_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
+  }
+  __pyx_ptype_4liba___pyx_scope_struct_10_genexpr = &__pyx_type_4liba___pyx_scope_struct_10_genexpr;
+  if (PyType_Ready(&__pyx_type_4liba___pyx_scope_struct_11_genexpr) < 0) __PYX_ERR(7, 49, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_4liba___pyx_scope_struct_11_genexpr.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_4liba___pyx_scope_struct_11_genexpr.tp_dictoffset && __pyx_type_4liba___pyx_scope_struct_11_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_4liba___pyx_scope_struct_11_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
+  }
+  __pyx_ptype_4liba___pyx_scope_struct_11_genexpr = &__pyx_type_4liba___pyx_scope_struct_11_genexpr;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -27854,179 +28756,191 @@
   (void)__Pyx_modinit_variable_import_code();
   (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(3, 1, __pyx_L1_error)
   #endif
 
-  /* "ffi/python/src/a/version.pxi":3
+  /* "python/src/a/version.pxi":3
  * from a.version cimport *
  * 
  * def version():             # <<<<<<<<<<<<<<
  *     '''algorithm library version'''
  *     if PY_MAJOR_VERSION >= 3:
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_1version, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_version, __pyx_t_1) < 0) __PYX_ERR(4, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/version.pxi":9
+  /* "python/src/a/version.pxi":9
  *     return a_version()
  * 
  * def version_major() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version major'''
  *     return a_version_major()
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_3version_major, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_version_major, __pyx_t_1) < 0) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/version.pxi":13
+  /* "python/src/a/version.pxi":13
  *     return a_version_major()
  * 
  * def version_minor() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version minor'''
  *     return a_version_minor()
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_5version_minor, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 13, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_version_minor, __pyx_t_1) < 0) __PYX_ERR(4, 13, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/version.pxi":17
+  /* "python/src/a/version.pxi":17
  *     return a_version_minor()
  * 
  * def version_patch() -> a_uint_t:             # <<<<<<<<<<<<<<
  *     '''algorithm library version patch'''
  *     return a_version_patch()
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_7version_patch, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 17, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_version_patch, __pyx_t_1) < 0) __PYX_ERR(4, 17, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/math.pxi":5
+  /* "python/src/a/math.pxi":5
+ * @cython.wraparound(False)
+ * @cython.boundscheck(False)
+ * def f32_rsqrt(x):             # <<<<<<<<<<<<<<
+ *     '''fast inverse square-root'''
+ *     if iterable(x):
+ */
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_9f32_rsqrt, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_f32_rsqrt, __pyx_t_1) < 0) __PYX_ERR(1, 5, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "python/src/a/math.pxi":16
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
- * def sqrt_inv(x):             # <<<<<<<<<<<<<<
+ * def f64_rsqrt(x):             # <<<<<<<<<<<<<<
  *     '''fast inverse square-root'''
  *     if iterable(x):
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_9sqrt_inv, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_11f64_rsqrt, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqrt_inv, __pyx_t_1) < 0) __PYX_ERR(1, 5, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_f64_rsqrt, __pyx_t_1) < 0) __PYX_ERR(1, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "ffi/python/src/a/mf.pxi":7
+  /* "python/src/a/mf.pxi":7
  * cdef class mf:
  *     '''membership function'''
  *     NUL   = A_MF_NUL             # <<<<<<<<<<<<<<
  *     GAUSS = A_MF_GAUSS
  *     GBELL = A_MF_GBELL
  */
   __pyx_t_1 = __Pyx_PyInt_From_a_mf_e(A_MF_NUL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_NUL, __pyx_t_1) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":8
+  /* "python/src/a/mf.pxi":8
  *     '''membership function'''
  *     NUL   = A_MF_NUL
  *     GAUSS = A_MF_GAUSS             # <<<<<<<<<<<<<<
  *     GBELL = A_MF_GBELL
  *     SIG   = A_MF_SIG
  */
   __pyx_t_1 = __Pyx_PyInt_From_a_mf_e(A_MF_GAUSS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_GAUSS, __pyx_t_1) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":9
+  /* "python/src/a/mf.pxi":9
  *     NUL   = A_MF_NUL
  *     GAUSS = A_MF_GAUSS
  *     GBELL = A_MF_GBELL             # <<<<<<<<<<<<<<
  *     SIG   = A_MF_SIG
  *     TRAP  = A_MF_TRAP
  */
   __pyx_t_1 = __Pyx_PyInt_From_a_mf_e(A_MF_GBELL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_GBELL, __pyx_t_1) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":10
+  /* "python/src/a/mf.pxi":10
  *     GAUSS = A_MF_GAUSS
  *     GBELL = A_MF_GBELL
  *     SIG   = A_MF_SIG             # <<<<<<<<<<<<<<
  *     TRAP  = A_MF_TRAP
  *     TRI   = A_MF_TRI
  */
   __pyx_t_1 = __Pyx_PyInt_From_a_mf_e(A_MF_SIG); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_SIG, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":11
+  /* "python/src/a/mf.pxi":11
  *     GBELL = A_MF_GBELL
  *     SIG   = A_MF_SIG
  *     TRAP  = A_MF_TRAP             # <<<<<<<<<<<<<<
  *     TRI   = A_MF_TRI
  *     Z     = A_MF_Z
  */
   __pyx_t_1 = __Pyx_PyInt_From_a_mf_e(A_MF_TRAP); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_TRAP, __pyx_t_1) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":12
+  /* "python/src/a/mf.pxi":12
  *     SIG   = A_MF_SIG
  *     TRAP  = A_MF_TRAP
  *     TRI   = A_MF_TRI             # <<<<<<<<<<<<<<
  *     Z     = A_MF_Z
  *     @staticmethod
  */
   __pyx_t_1 = __Pyx_PyInt_From_a_mf_e(A_MF_TRI); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_TRI, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":13
+  /* "python/src/a/mf.pxi":13
  *     TRAP  = A_MF_TRAP
  *     TRI   = A_MF_TRI
  *     Z     = A_MF_Z             # <<<<<<<<<<<<<<
  *     @staticmethod
  *     def __call__(e: a_mf_e, x, a):
  */
   __pyx_t_1 = __Pyx_PyInt_From_a_mf_e(A_MF_Z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_Z, __pyx_t_1) < 0) __PYX_ERR(0, 13, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":15
+  /* "python/src/a/mf.pxi":15
  *     Z     = A_MF_Z
  *     @staticmethod
  *     def __call__(e: a_mf_e, x, a):             # <<<<<<<<<<<<<<
  *         cdef array d = reals(a)
  *         cdef a_real_t *v = <a_real_t *>d.data.as_voidptr
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_2mf_1__call__, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_call, __pyx_t_1) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":14
+  /* "python/src/a/mf.pxi":14
  *     TRI   = A_MF_TRI
  *     Z     = A_MF_Z
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def __call__(e: a_mf_e, x, a):
  *         cdef array d = reals(a)
  */
   __Pyx_GetNameInClass(__pyx_t_1, (PyObject *)__pyx_ptype_4liba_mf, __pyx_n_s_call); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
@@ -28034,28 +28948,28 @@
   __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_call, __pyx_t_2) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":25
+  /* "python/src/a/mf.pxi":25
  *         return a_mf(e, x, v)
  *     @staticmethod
  *     def gauss(x, sigma: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Gaussian membership function'''
  *         if iterable(x):
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_2mf_3gauss, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_gauss, __pyx_t_2) < 0) __PYX_ERR(0, 25, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":24
+  /* "python/src/a/mf.pxi":24
  *             return y
  *         return a_mf(e, x, v)
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def gauss(x, sigma: a_real_t, c: a_real_t):
  *         '''Gaussian membership function'''
  */
   __Pyx_GetNameInClass(__pyx_t_2, (PyObject *)__pyx_ptype_4liba_mf, __pyx_n_s_gauss); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)
@@ -28063,28 +28977,28 @@
   __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 24, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_gauss, __pyx_t_1) < 0) __PYX_ERR(0, 25, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":34
+  /* "python/src/a/mf.pxi":34
  *         return a_mf_gauss(x, sigma, c)
  *     @staticmethod
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Generalized bell-shaped membership function'''
  *         if iterable(x):
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_2mf_5gbell, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_gbell, __pyx_t_1) < 0) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":33
+  /* "python/src/a/mf.pxi":33
  *             return y
  *         return a_mf_gauss(x, sigma, c)
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def gbell(x, a: a_real_t, b: a_real_t, c: a_real_t):
  *         '''Generalized bell-shaped membership function'''
  */
   __Pyx_GetNameInClass(__pyx_t_1, (PyObject *)__pyx_ptype_4liba_mf, __pyx_n_s_gbell); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 34, __pyx_L1_error)
@@ -28092,28 +29006,28 @@
   __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_gbell, __pyx_t_2) < 0) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":43
+  /* "python/src/a/mf.pxi":43
  *         return a_mf_gbell(x, a, b, c)
  *     @staticmethod
  *     def sig(x, a: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Sigmoidal membership function'''
  *         if iterable(x):
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_2mf_7sig, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_sig, __pyx_t_2) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":42
+  /* "python/src/a/mf.pxi":42
  *             return y
  *         return a_mf_gbell(x, a, b, c)
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def sig(x, a: a_real_t, c: a_real_t):
  *         '''Sigmoidal membership function'''
  */
   __Pyx_GetNameInClass(__pyx_t_2, (PyObject *)__pyx_ptype_4liba_mf, __pyx_n_s_sig); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
@@ -28121,28 +29035,28 @@
   __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_sig, __pyx_t_1) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":52
+  /* "python/src/a/mf.pxi":52
  *         return a_mf_sig(x, a, c)
  *     @staticmethod
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Trapezoidal membership function'''
  *         if iterable(x):
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_2mf_9trap, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_trap, __pyx_t_1) < 0) __PYX_ERR(0, 52, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":51
+  /* "python/src/a/mf.pxi":51
  *             return y
  *         return a_mf_sig(x, a, c)
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def trap(x, a: a_real_t, b: a_real_t, c: a_real_t, d: a_real_t):
  *         '''Trapezoidal membership function'''
  */
   __Pyx_GetNameInClass(__pyx_t_1, (PyObject *)__pyx_ptype_4liba_mf, __pyx_n_s_trap); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)
@@ -28150,28 +29064,28 @@
   __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_trap, __pyx_t_2) < 0) __PYX_ERR(0, 52, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":61
+  /* "python/src/a/mf.pxi":61
  *         return a_mf_trap(x, a, b, c, d)
  *     @staticmethod
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Triangular membership function'''
  *         if iterable(x):
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_2mf_11tri, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_tri, __pyx_t_2) < 0) __PYX_ERR(0, 61, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":60
+  /* "python/src/a/mf.pxi":60
  *             return y
  *         return a_mf_trap(x, a, b, c, d)
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def tri(x, a: a_real_t, b: a_real_t, c: a_real_t):
  *         '''Triangular membership function'''
  */
   __Pyx_GetNameInClass(__pyx_t_2, (PyObject *)__pyx_ptype_4liba_mf, __pyx_n_s_tri); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)
@@ -28179,28 +29093,28 @@
   __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_tri, __pyx_t_1) < 0) __PYX_ERR(0, 61, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":70
+  /* "python/src/a/mf.pxi":70
  *         return a_mf_tri(x, a, b, c)
  *     @staticmethod
  *     def z(x, a: a_real_t, b: a_real_t):             # <<<<<<<<<<<<<<
  *         '''Z-shaped membership function'''
  *         if iterable(x):
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_4liba_2mf_13z, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_z, __pyx_t_1) < 0) __PYX_ERR(0, 70, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/mf.pxi":69
+  /* "python/src/a/mf.pxi":69
  *             return y
  *         return a_mf_tri(x, a, b, c)
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def z(x, a: a_real_t, b: a_real_t):
  *         '''Z-shaped membership function'''
  */
   __Pyx_GetNameInClass(__pyx_t_1, (PyObject *)__pyx_ptype_4liba_mf, __pyx_n_s_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)
@@ -28208,88 +29122,88 @@
   __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 69, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_mf->tp_dict, __pyx_n_s_z, __pyx_t_2) < 0) __PYX_ERR(0, 70, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_mf);
 
-  /* "ffi/python/src/a/pid.pxi":7
+  /* "python/src/a/pid.pxi":7
  * cdef class pid:
  *     '''proportional integral derivative controller'''
  *     OFF = A_PID_OFF             # <<<<<<<<<<<<<<
  *     POS = A_PID_POS
  *     INC = A_PID_INC
  */
   __pyx_t_2 = __Pyx_PyInt_From_a_pid_e(A_PID_OFF); if (unlikely(!__pyx_t_2)) __PYX_ERR(6, 7, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_pid->tp_dict, __pyx_n_s_OFF, __pyx_t_2) < 0) __PYX_ERR(6, 7, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_pid);
 
-  /* "ffi/python/src/a/pid.pxi":8
+  /* "python/src/a/pid.pxi":8
  *     '''proportional integral derivative controller'''
  *     OFF = A_PID_OFF
  *     POS = A_PID_POS             # <<<<<<<<<<<<<<
  *     INC = A_PID_INC
- *     cdef a_pid_s ctx[1]
+ *     cdef a_pid_s ctx
  */
   __pyx_t_2 = __Pyx_PyInt_From_a_pid_e(A_PID_POS); if (unlikely(!__pyx_t_2)) __PYX_ERR(6, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_pid->tp_dict, __pyx_n_s_POS, __pyx_t_2) < 0) __PYX_ERR(6, 8, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_pid);
 
-  /* "ffi/python/src/a/pid.pxi":9
+  /* "python/src/a/pid.pxi":9
  *     OFF = A_PID_OFF
  *     POS = A_PID_POS
  *     INC = A_PID_INC             # <<<<<<<<<<<<<<
- *     cdef a_pid_s ctx[1]
+ *     cdef a_pid_s ctx
  *     def __cinit__(self, a_real_t dt, a_real_t min, a_real_t max, a_real_t sum = 0):
  */
   __pyx_t_2 = __Pyx_PyInt_From_a_pid_e(A_PID_INC); if (unlikely(!__pyx_t_2)) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem((PyObject *)__pyx_ptype_4liba_pid->tp_dict, __pyx_n_s_INC, __pyx_t_2) < 0) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_ptype_4liba_pid);
 
-  /* "ffi/python/src/a/poly.pxi":5
+  /* "python/src/a/poly.pxi":5
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_eval(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_11poly_eval, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(8, 5, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_13poly_eval, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(8, 5, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_poly_eval, __pyx_t_2) < 0) __PYX_ERR(8, 5, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "ffi/python/src/a/poly.pxi":16
+  /* "python/src/a/poly.pxi":16
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * def poly_evar(x, *a):             # <<<<<<<<<<<<<<
  *     d, n = reals(a), len(a)
  *     cdef a_real_t *p = <a_real_t *>d.data.as_voidptr
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_13poly_evar, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(8, 16, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_15poly_evar, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(8, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_poly_evar, __pyx_t_2) < 0) __PYX_ERR(8, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_mf(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_15__pyx_unpickle_mf, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4liba_17__pyx_unpickle_mf, NULL, __pyx_n_s_liba); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_mf, __pyx_t_2) < 0) __PYX_ERR(2, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "ffi/python/src/lib.pyx":1
+  /* "python/src/a.pyx":1
  * include "a/__init__.pxi"             # <<<<<<<<<<<<<<
  * 
  * from cpython cimport *
  */
   __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(3, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(3, 1, __pyx_L1_error)
@@ -29512,25 +30426,43 @@
   }
   Py_XDECREF(name_attr);
   return ret;
 }
 static int __Pyx_setup_reduce(PyObject* type_obj) {
     int ret = 0;
     PyObject *object_reduce = NULL;
+    PyObject *object_getstate = NULL;
     PyObject *object_reduce_ex = NULL;
     PyObject *reduce = NULL;
     PyObject *reduce_ex = NULL;
     PyObject *reduce_cython = NULL;
     PyObject *setstate = NULL;
     PyObject *setstate_cython = NULL;
+    PyObject *getstate = NULL;
+#if CYTHON_USE_PYTYPE_LOOKUP
+    getstate = _PyType_Lookup((PyTypeObject*)type_obj, __pyx_n_s_getstate);
+#else
+    getstate = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_n_s_getstate);
+    if (!getstate && PyErr_Occurred()) {
+        goto __PYX_BAD;
+    }
+#endif
+    if (getstate) {
 #if CYTHON_USE_PYTYPE_LOOKUP
-    if (_PyType_Lookup((PyTypeObject*)type_obj, __pyx_n_s_getstate)) goto __PYX_GOOD;
+        object_getstate = _PyType_Lookup(&PyBaseObject_Type, __pyx_n_s_getstate);
 #else
-    if (PyObject_HasAttr(type_obj, __pyx_n_s_getstate)) goto __PYX_GOOD;
+        object_getstate = __Pyx_PyObject_GetAttrStrNoError((PyObject*)&PyBaseObject_Type, __pyx_n_s_getstate);
+        if (!object_getstate && PyErr_Occurred()) {
+            goto __PYX_BAD;
+        }
 #endif
+        if (object_getstate != getstate) {
+            goto __PYX_GOOD;
+        }
+    }
 #if CYTHON_USE_PYTYPE_LOOKUP
     object_reduce_ex = _PyType_Lookup(&PyBaseObject_Type, __pyx_n_s_reduce_ex); if (!object_reduce_ex) goto __PYX_BAD;
 #else
     object_reduce_ex = __Pyx_PyObject_GetAttrStr((PyObject*)&PyBaseObject_Type, __pyx_n_s_reduce_ex); if (!object_reduce_ex) goto __PYX_BAD;
 #endif
     reduce_ex = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_n_s_reduce_ex); if (unlikely(!reduce_ex)) goto __PYX_BAD;
     if (reduce_ex == object_reduce_ex) {
@@ -29567,14 +30499,16 @@
     if (!PyErr_Occurred())
         PyErr_Format(PyExc_RuntimeError, "Unable to initialize pickling for %s", ((PyTypeObject*)type_obj)->tp_name);
     ret = -1;
 __PYX_GOOD:
 #if !CYTHON_USE_PYTYPE_LOOKUP
     Py_XDECREF(object_reduce);
     Py_XDECREF(object_reduce_ex);
+    Py_XDECREF(object_getstate);
+    Py_XDECREF(getstate);
 #endif
     Py_XDECREF(reduce);
     Py_XDECREF(reduce_ex);
     Py_XDECREF(reduce_cython);
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
@@ -29783,14 +30717,20 @@
     Py_INCREF(code_object);
 }
 
 /* AddTraceback */
 #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
 static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
             const char *funcname, int c_line,
             int py_line, const char *filename) {
     PyCodeObject *py_code = NULL;
     PyObject *py_funcname = NULL;
     #if PY_MAJOR_VERSION < 3
     PyObject *py_srcfile = NULL;
@@ -29846,22 +30786,32 @@
     return NULL;
 }
 static void __Pyx_AddTraceback(const char *funcname, int c_line,
                                int py_line, const char *filename) {
     PyCodeObject *py_code = 0;
     PyFrameObject *py_frame = 0;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
+    PyObject *ptype, *pvalue, *ptraceback;
     if (c_line) {
         c_line = __Pyx_CLineForTraceback(tstate, c_line);
     }
     py_code = __pyx_find_code_object(c_line ? -c_line : py_line);
     if (!py_code) {
+        __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
         py_code = __Pyx_CreateCodeObjectForTraceback(
             funcname, c_line, py_line, filename);
-        if (!py_code) goto bad;
+        if (!py_code) {
+            /* If the code object creation fails, then we should clear the
+               fetched exception references and propagate the new exception */
+            Py_XDECREF(ptype);
+            Py_XDECREF(pvalue);
+            Py_XDECREF(ptraceback);
+            goto bad;
+        }
+        __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
         __pyx_insert_code_object(c_line ? -c_line : py_line, py_code);
     }
     py_frame = PyFrame_New(
         tstate,            /*PyThreadState *tstate,*/
         py_code,           /*PyCodeObject *code,*/
         __pyx_d,    /*PyObject *globals,*/
         0                  /*PyObject *locals*/
@@ -31371,14 +32321,20 @@
     if (unlikely(!method)) return NULL;
     return __Pyx__PyObject_CallMethod1(method, arg);
 }
 
 /* CoroutineBase */
 #include <structmember.h>
 #include <frameobject.h>
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
 #define __Pyx_Coroutine_Undelegate(gen) Py_CLEAR((gen)->yieldfrom)
 static int __Pyx_PyGen__FetchStopIterationValue(CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject **pvalue) {
     PyObject *et, *ev, *tb;
     PyObject *value = NULL;
     __Pyx_ErrFetch(&et, &ev, &tb);
     if (!et) {
         Py_XDECREF(tb);
@@ -32358,19 +33314,41 @@
         return -1;
     }
     return 0;
 }
 
 /* CheckBinaryVersion */
 static int __Pyx_check_binary_version(void) {
-    char ctversion[4], rtversion[4];
-    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
-    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
-    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
+    char ctversion[5];
+    int same=1, i, found_dot;
+    const char* rt_from_call = Py_GetVersion();
+    PyOS_snprintf(ctversion, 5, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
+    found_dot = 0;
+    for (i = 0; i < 4; i++) {
+        if (!ctversion[i]) {
+            same = (rt_from_call[i] < '0' || rt_from_call[i] > '9');
+            break;
+        }
+        if (rt_from_call[i] != ctversion[i]) {
+            same = 0;
+            break;
+        }
+    }
+    if (!same) {
+        char rtversion[5] = {'\0'};
         char message[200];
+        for (i=0; i<4; ++i) {
+            if (rt_from_call[i] == '.') {
+                if (found_dot) break;
+                found_dot = 1;
+            } else if (rt_from_call[i] < '0' || rt_from_call[i] > '9') {
+                break;
+            }
+            rtversion[i] = rt_from_call[i];
+        }
         PyOS_snprintf(message, sizeof(message),
                       "compiletime version %s of module '%.100s' "
                       "does not match runtime version %s",
                       ctversion, __Pyx_MODULE_NAME, rtversion);
         return PyErr_WarnEx(NULL, message, 1);
     }
     return 0;
```

### Comparing `liba-0.1.1rc4/include/a/a.h` & `liba-0.1.1rc5/include/a/a.h`

 * *Files 24% similar despite different names*

```diff
@@ -1,24 +1,281 @@
 /*!
  @file a.h
  @brief algorithm library
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_A_H
-#define A_A_H
+#ifndef LIBA_A_H
+#define LIBA_A_H
+
+#if defined(A_HAVE_H)
+#include A_HAVE_H
+#endif /* A_HAVE_H */
+
+/*! @cond */
+
+#if !defined __has_attribute
+#define __has_attribute(x) 0
+#endif /* __has_attribute */
+#if !defined __has_builtin
+#define __has_builtin(x) 0
+#endif /* __has_builtin */
+#if !defined __has_feature
+#define __has_feature(x) 0
+#endif /* __has_feature */
+#if !defined __has_include
+#define __has_include(x) 0
+#endif /* __has_include */
+#if !defined __has_warning
+#define __has_warning(x) 0
+#endif /* __has_warning */
+#if !defined A_HAVE_INLINE
+#define A_HAVE_INLINE 1
+#elif A_HAVE_INLINE + 0 < 1
+#undef A_HAVE_INLINE
+#endif /* A_HAVE_INLINE */
+#if defined(__GNUC__) || \
+    defined(__clang__)
+#pragma GCC system_header
+#endif /* __GNUC__ */
+
+#if defined(__STDC_LIB_EXT1__)
+#if !defined __STDC_WANT_LIB_EXT1__
+#define __STDC_WANT_LIB_EXT1__ 1
+#endif /* __STDC_WANT_LIB_EXT1__ */
+#endif /* __STDC_LIB_EXT1__ */
+
+#if defined(__MINGW32__)
+#undef __USE_MINGW_ANSI_STDIO
+#define __USE_MINGW_ANSI_STDIO 1
+#endif /* __MINGW32__ */
+
+/* https://en.wikipedia.org/wiki/Microsoft_Visual_C++ */
+#if defined(_MSC_VER)
+#define A_PREREQ_MSVC(maj, min) (_MSC_VER >= (maj * 100 + min))
+#else /* !_MSC_VER */
+#define A_PREREQ_MSVC(maj, min) 0
+#endif /* _MSC_VER */
+
+/* https://gcc.gnu.org/onlinedocs/cpp/Common-Predefined-Macros.html */
+#if defined(__GNUC__) && defined(__GNUC_MINOR__)
+#define A_PREREQ_GNUC(maj, min) ((__GNUC__ << 16) + __GNUC_MINOR__ >= ((maj) << 16) + (min))
+#else /* !__GNUC__ */
+#define A_PREREQ_GNUC(maj, min) 0
+#endif /* __GNUC__ */
+
+/* https://clang.llvm.org/docs/LanguageExtensions.html */
+#if defined(__clang_major__) && defined(__clang_minor__)
+#define A_PREREQ_LLVM(maj, min) ((__clang_major__ << 16) + __clang_minor__ >= ((maj) << 16) + (min))
+#else /* !__clang__ */
+#define A_PREREQ_LLVM(maj, min) 0
+#endif /* __clang__ */
+
+#if __has_warning("-Wdisabled-macro-expansion")
+#pragma clang diagnostic ignored "-Wdisabled-macro-expansion"
+#endif /* -Wdisabled-macro-expansion */
+
+#if !defined A_FUNC
+#if defined(_MSC_VER)
+#define A_FUNC __FUNCTION__
+#elif defined(__GNUC__)
+#define A_FUNC (__extension__ __PRETTY_FUNCTION__)
+#elif defined(__cplusplus) && (__cplusplus > 201100L) || \
+    defined(__STDC_VERSION__) && (__STDC_VERSION__ > 199900L)
+#define A_FUNC __func__
+#else /* !__func__ */
+#define A_FUNC __FUNCTION__
+#endif /* __func__ */
+#endif /* A_FUNC */
+
+/* https://en.cppreference.com/w/cpp/preprocessor/replace */
+#if !defined __cplusplus
+/* https://en.cppreference.com/w/c/preprocessor/replace */
+#if !defined __STDC_VERSION__ && A_PREREQ_MSVC(18, 0)
+#define __STDC_VERSION__ 199901L /* C99 */
+#elif !defined __STDC_VERSION__
+#define __STDC_VERSION__ 199001L /* C90 */
+#endif /* __STDC_VERSION__ */
+#endif /* __cplusplus */
+
+#if defined(__cplusplus) && (__cplusplus > 201100L) || \
+    defined(__STDC_VERSION__) && (__STDC_VERSION__ > 199900L)
+
+#if !defined A_HAVE_VARIADIC_MACROS
+#define A_HAVE_VARIADIC_MACROS 1
+#endif /* A_HAVE_VARIADIC_MACROS */
+
+#if !defined A_HAVE_LONG_LONG_TYPE
+#define A_HAVE_LONG_LONG_TYPE 1
+#endif /* A_HAVE_LONG_LONG_TYPE */
+
+#endif /* C > 199900 or C++ > 201100 */
+#if defined(A_HAVE_VARIADIC_MACROS) && (A_HAVE_VARIADIC_MACROS + 0 < 1)
+#undef A_HAVE_VARIADIC_MACROS
+#endif /* A_HAVE_VARIADIC_MACROS */
+#if defined(A_HAVE_LONG_LONG_TYPE) && (A_HAVE_LONG_LONG_TYPE + 0 < 1)
+#undef A_HAVE_LONG_LONG_TYPE
+#endif /* A_HAVE_LONG_LONG_TYPE */
+
+#if defined(__cplusplus) && (__cplusplus > 201100L) || \
+    defined(__STDC_VERSION__) && (__STDC_VERSION__ > 201100L)
+
+#if !defined A_HAVE_STATIC_ASSERT
+#define A_HAVE_STATIC_ASSERT 1
+#endif /* A_HAVE_STATIC_ASSERT */
+
+#endif /* C > 201100 or C++ > 201100 */
+#if defined(A_HAVE_STATIC_ASSERT) && (A_HAVE_STATIC_ASSERT + 0 < 1)
+#undef A_HAVE_STATIC_ASSERT
+#endif /* A_HAVE_STATIC_ASSERT */
+
+#if defined(__cplusplus) && (__cplusplus > 201100L)
+
+#if !defined A_HAVE_NULLPTR
+#define A_HAVE_NULLPTR 1
+#endif /* A_HAVE_NULLPTR */
+
+#endif /*  C++ > 201100 */
+#if defined(A_HAVE_NULLPTR) && (A_HAVE_NULLPTR + 0 < 1)
+#undef A_HAVE_NULLPTR
+#endif /* A_HAVE_NULLPTR */
+
+#if A_PREREQ_GNUC(2, 96) || __has_builtin(__builtin_expect)
+#define a_unlikely(x) __builtin_expect(!!(x), 0)
+#define a_likely(x) __builtin_expect(!!(x), 1)
+#else /* !__GNUC__ */
+#define a_unlikely(x) (x)
+#define a_likely(x) (x)
+#endif /* __GNUC__ */
+
+#if defined(_WIN32) || defined(__CYGWIN__)
+#define A_DECLSPEC(x) __declspec(x)
+#else /* !__declspec */
+#define A_DECLSPEC(x)
+#endif /* __declspec */
+
+#if defined(__GNUC__) || defined(__clang__)
+#define A_ATTRIBUTE(x) __attribute__(x)
+#else /* !__attribute__ */
+#define A_ATTRIBUTE(x)
+#endif /* __attribute__ */
+
+/* attribute format */
+#if A_PREREQ_GNUC(2, 4) || __has_attribute(format)
+#define A_FORMAT(_, a, b) __attribute__((format(_, a, b)))
+#else /* !format */
+#define A_FORMAT(_, a, b)
+#endif /* format */
+
+/* attribute fallthrough */
+#if A_PREREQ_GNUC(7, 1) || __has_attribute(fallthrough)
+#define A_FALLTHROUGH __attribute__((fallthrough))
+#else /* !fallthrough */
+#define A_FALLTHROUGH ((void)(0))
+#endif /* fallthrough */
+
+/* attribute deprecated */
+#if A_PREREQ_GNUC(3, 2) || __has_attribute(deprecated)
+#define A_DEPRECATED __attribute__((deprecated))
+#elif defined(_WIN32) || defined(__CYGWIN__)
+#define A_DEPRECATED __declspec(deprecated)
+#else /* !deprecated */
+#define A_DEPRECATED
+#endif /* deprecated */
+
+/* attribute always inline */
+#if A_PREREQ_GNUC(3, 2) || __has_attribute(always_inline)
+#define A_INLINE __inline __attribute__((always_inline))
+#elif defined(_MSC_VER)
+#define A_INLINE __inline __forceinline
+#else /* !_MSC_VER */
+#define A_INLINE __inline
+#endif /* _MSC_VER */
+#if !defined A_INTERN
+#define A_INTERN static A_INLINE
+#endif /* A_INTERN */
+
+/* attribute visibility */
+#if defined(_WIN32) || defined(__CYGWIN__)
+#define A_EXPORT __declspec(dllexport)
+#define A_IMPORT __declspec(dllimport)
+#define A_HIDDEN
+#elif A_PREREQ_GNUC(4, 0) || __has_attribute(visibility)
+#define A_EXPORT __attribute__((visibility("default")))
+#define A_IMPORT __attribute__((visibility("default")))
+#define A_HIDDEN __attribute__((visibility("hidden")))
+#else /* !visibility */
+#define A_EXPORT
+#define A_IMPORT
+#define A_HIDDEN
+#endif /* visibility */
+#if defined(A_EXPORTS)
+#define A_PUBLIC A_EXPORT
+#elif defined(A_IMPORTS)
+#define A_PUBLIC A_IMPORT
+#else /* !A_PUBLIC */
+#define A_PUBLIC
+#endif /* A_PUBLIC */
+
+#if !defined __cplusplus
+#define A_EXTERN_C
+#define A_EXTERN_C_ENTER
+#define A_EXTERN_C_LEAVE
+#else /* !__cplusplus */
+#define A_EXTERN_C extern "C"
+#define A_EXTERN_C_ENTER extern "C" {
+#define A_EXTERN_C_LEAVE }
+#endif /* __cplusplus */
+#if !defined A_EXTERN
+#define A_EXTERN extern A_PUBLIC
+#endif /* A_EXTERN */
+
+#if defined(__cplusplus)
+#define A_REGISTER
+#else /* !__cplusplus */
+#define A_REGISTER __register
+#endif /* __cplusplus */
+#define A_VOLATILE __volatile
+#define A_RESTRICT __restrict
+
+/*! @endcond */
+
+#if defined(__ORDER_LITTLE_ENDIAN__)
+#define A_ORDER_LITTLE __ORDER_LITTLE_ENDIAN__
+#else /* !__ORDER_LITTLE_ENDIAN__ */
+#define A_ORDER_LITTLE 1234
+#endif /* __ORDER_LITTLE_ENDIAN__ */
+#if defined(__ORDER_BIG_ENDIAN__)
+#define A_ORDER_BIG __ORDER_BIG_ENDIAN__
+#else /* !__ORDER_BIG_ENDIAN__ */
+#define A_ORDER_BIG 4321
+#endif /* __ORDER_BIG_ENDIAN__ */
+#if !defined A_BYTE_ORDER
+#if defined(__BYTE_ORDER__)
+#define A_BYTE_ORDER __BYTE_ORDER__
+#endif /* __BYTE_ORDER__ */
+#endif /* A_BYTE_ORDER */
+
+/* size of void pointer */
+#if !defined A_SIZE_VPTR
+#if defined(__SIZEOF_POINTER__)
+#define A_SIZE_VPTR __SIZEOF_POINTER__
+#elif defined(_WIN64)
+#define A_SIZE_VPTR 8
+#elif defined(_WIN32)
+#define A_SIZE_VPTR 4
+#endif /* __SIZEOF_POINTER__ */
+#endif /* A_SIZE_VPTR */
 
-#include "config.h"
 #include <stddef.h>
 #include <stdint.h>
 #include <limits.h>
 #include <float.h>
 
 /*!
- @addtogroup A algorithm library based on C
+ @addtogroup A algorithm library
  @{
 */
 
 #if defined(__cplusplus)
 #define a_cast_r(T, x) reinterpret_cast<T>(x)
 #define a_cast_d(T, x) dynamic_cast<T>(x)
 #define a_cast_s(T, x) static_cast<T>(x)
@@ -26,564 +283,551 @@
 #else /* !__cplusplus */
 #define a_cast_r(T, x) ((T)(x))
 #define a_cast_d(T, x) ((T)(x))
 #define a_cast_s(T, x) ((T)(x))
 #define a_cast_c(T, x) ((T)(x))
 #endif /* __cplusplus */
 
-#if !defined A_VOID_T
-#define A_VOID_T void
-#endif /* A_VOID_T */
 #if defined(__cplusplus) && defined(A_HAVE_NULLPTR)
 #define A_NULL nullptr
 #else /* !__cplusplus */
 #define A_NULL NULL
 #endif /* __cplusplus */
+
+#if !defined A_VOID_T
+#define A_VOID_T void
+#endif /* A_VOID_T */
 /*! static cast to \ref a_void_t */
 #define a_void_c(x) a_cast_s(A_VOID_T, x)
 #define a_void_p(x) a_cast_s(A_VOID_T *, x)
-#define a_void_P(x) a_cast_s(const A_VOID_T *, x)
+#define A_VOID_P(x) a_cast_s(A_VOID_T const *, x)
 /*! as the declaration of the incomplete type */
 #define a_void_t A_VOID_T
 
-#if !defined __cplusplus
-#define A_FALSE 0
-#define A_TRUE !A_FALSE
-#else /* !__cplusplus */
-#define A_FALSE false
+#if defined(__cplusplus)
 #define A_TRUE true
-#endif /* __cplusplus */
+#define A_FALSE false
+#if !defined A_BOOL_T
+#define A_BOOL_T bool
+#endif /* A_BOOL_T */
+#else /* !__cplusplus */
+#define A_TRUE 1
+#define A_FALSE 0
 #if !defined A_BOOL_T
-#define A_BOOL_T int
+#define A_BOOL_T _Bool
 #endif /* A_BOOL_T */
+#endif /* __cplusplus */
 /*! static cast to \ref a_bool_t */
 #define a_bool_c(x) (!!(x))
 /*! type, capable of holding one of the two values: 1 and 0 */
 #define a_bool_t A_BOOL_T
 
-#define a_byte_P(x) a_cast_s(const a_byte_t *, x)
-#define a_char_P(x) a_cast_s(const a_char_t *, x)
-#define a_byte_p(x) a_cast_s(a_byte_t *, x)
-#define a_char_p(x) a_cast_s(a_char_t *, x)
-#define a_byte_c(x) a_cast_s(a_byte_t, x)
-#define a_char_c(x) a_cast_s(a_char_t, x)
-#define a_byte_t unsigned char
 #define a_char_t char
+#define A_CHAR_MIN CHAR_MIN
+#define A_CHAR_MAX CHAR_MAX
+#define a_byte_t unsigned char
+#define A_BYTE_MAX UCHAR_MAX
+#define a_char_c(x) a_cast_s(a_char_t, x)
+#define a_byte_c(x) a_cast_s(a_byte_t, x)
+#define a_char_p(x) a_cast_s(a_char_t *, x)
+#define a_byte_p(x) a_cast_s(a_byte_t *, x)
+#define A_CHAR_P(x) a_cast_s(a_char_t const *, x)
+#define A_BYTE_P(x) a_cast_s(a_byte_t const *, x)
 /* the most optimal integer type for the platform */
-#define a_uint_P(x) a_cast_s(const a_uint_t *, x)
-#define a_int_P(x) a_cast_s(const a_int_t *, x)
-#define a_uint_p(x) a_cast_s(a_uint_t *, x)
-#define a_int_p(x) a_cast_s(a_int_t *, x)
-#define a_uint_c(x) a_cast_s(a_uint_t, x)
-#define a_int_c(x) a_cast_s(a_int_t, x)
-#define a_uint_t unsigned int
 #define a_int_t int
+#define A_INT_MIN INT_MIN
+#define A_INT_MAX INT_MAX
+#define a_uint_t unsigned int
+#define A_UINT_MAX UINT_MAX
+#define a_int_c(x) a_cast_s(a_int_t, x)
+#define a_uint_c(x) a_cast_s(a_uint_t, x)
+#define a_int_p(x) a_cast_s(a_int_t *, x)
+#define a_uint_p(x) a_cast_s(a_uint_t *, x)
+#define A_INT_P(x) a_cast_s(a_int_t const *, x)
+#define A_UINT_P(x) a_cast_s(a_uint_t const *, x)
 
-#if !defined A_I_T
-#define A_I_T signed int
-#endif /* A_I_T */
-#if !defined A_U_T
-#define A_U_T unsigned int
-#endif /* A_U_T */
-#if !defined A_I_MIN
+#define A_I_T int
 #define A_I_MIN INT_MIN
-#endif /* A_I_MIN */
-#if !defined A_I_MAX
 #define A_I_MAX INT_MAX
-#endif /* A_I_MAX */
-#if !defined A_U_MAX
+#define A_U_T unsigned A_I_T
 #define A_U_MAX UINT_MAX
-#endif /* A_U_MAX */
 /*! static cast to \ref a_i_t */
 #define a_i_c(x) a_cast_s(A_I_T, x)
 #define a_i_p(x) a_cast_s(A_I_T *, x)
-#define a_i_P(x) a_cast_s(const A_I_T *, x)
+#define A_I_P(x) a_cast_s(A_I_T const *, x)
 /*! static cast to \ref a_u_t */
 #define a_u_c(x) a_cast_s(A_U_T, x)
 #define a_u_p(x) a_cast_s(A_U_T *, x)
-#define a_u_P(x) a_cast_s(const A_U_T *, x)
+#define A_U_P(x) a_cast_s(A_U_T const *, x)
 /*! signed integer type is guaranteed to be at least 16 bits */
 #define a_i_t A_I_T
 /*! unsigned integer type is guaranteed to be at least 16 bits */
 #define a_u_t A_U_T
 
-#if !defined A_IS_T
-#define A_IS_T signed short
-#endif /* A_IS_T */
-#if !defined A_US_T
-#define A_US_T unsigned short
-#endif /* A_US_T */
-#if !defined A_IS_MIN
+#define A_IS_T short
 #define A_IS_MIN SHRT_MIN
-#endif /* A_IS_MIN */
-#if !defined A_IS_MAX
 #define A_IS_MAX SHRT_MAX
-#endif /* A_IS_MAX */
-#if !defined A_US_MAX
+#define A_US_T unsigned A_IS_T
 #define A_US_MAX USHRT_MAX
-#endif /* A_US_MAX */
 /*! static cast to \ref a_is_t */
 #define a_is_c(x) a_cast_s(A_IS_T, x)
 #define a_is_p(x) a_cast_s(A_IS_T *, x)
-#define a_is_P(x) a_cast_s(const A_IS_T *, x)
+#define A_IS_P(x) a_cast_s(A_IS_T const *, x)
 /*! static cast to \ref a_us_t */
 #define a_us_c(x) a_cast_s(A_US_T, x)
 #define a_us_p(x) a_cast_s(A_US_T *, x)
-#define a_us_P(x) a_cast_s(const A_US_T *, x)
+#define A_US_P(x) a_cast_s(A_US_T const *, x)
 /*! signed integer type is guaranteed to be at least 16 bits */
 #define a_is_t A_IS_T
 /*! unsigned integer type is guaranteed to be at least 16 bits */
 #define a_us_t A_US_T
 
-#if !defined A_IL_T
-#define A_IL_T signed long
-#endif /* A_IL_T */
-#if !defined A_UL_T
-#define A_UL_T unsigned long
-#endif /* A_UL_T */
-#if !defined A_IL_MIN
+#define A_IL_T long
 #define A_IL_MIN LONG_MIN
-#endif /* A_IL_MIN */
-#if !defined A_IL_MAX
 #define A_IL_MAX LONG_MAX
-#endif /* A_IL_MAX */
-#if !defined A_UL_MAX
+#define A_UL_T unsigned A_IL_T
 #define A_UL_MAX ULONG_MAX
-#endif /* A_UL_MAX */
 /*! static cast to \ref a_il_t */
 #define a_il_c(x) a_cast_s(A_IL_T, x)
 #define a_il_p(x) a_cast_s(A_IL_T *, x)
-#define a_il_P(x) a_cast_s(const A_IL_T *, x)
+#define A_IL_P(x) a_cast_s(A_IL_T const *, x)
 /*! static cast to \ref a_ul_t */
 #define a_ul_c(x) a_cast_s(A_UL_T, x)
 #define a_ul_p(x) a_cast_s(A_UL_T *, x)
-#define a_ul_P(x) a_cast_s(const A_UL_T *, x)
+#define A_UL_P(x) a_cast_s(A_UL_T const *, x)
 /*! signed integer type is guaranteed to be at least 32 bits */
 #define a_il_t A_IL_T
 /*! unsigned integer type is guaranteed to be at least 32 bits */
 #define a_ul_t A_UL_T
 
 #if defined(A_HAVE_LONG_LONG_TYPE)
 
-#if !defined A_ILL_T
-#define A_ILL_T signed long long
-#endif /* A_ILL_T */
-#if !defined A_ULL_T
-#define A_ULL_T unsigned long long
-#endif /* A_ULL_T */
-#if !defined A_ILL_MIN
+#define A_ILL_T long long
 #define A_ILL_MIN LLONG_MIN
-#endif /* A_ILL_MIN */
-#if !defined A_ILL_MAX
 #define A_ILL_MAX LLONG_MAX
-#endif /* A_ILL_MAX */
-#if !defined A_ULL_MAX
+#define A_ULL_T unsigned A_ILL_T
 #define A_ULL_MAX ULLONG_MAX
-#endif /* A_ULL_MAX */
 /*! static cast to \ref a_ill_t */
 #define a_ill_c(x) a_cast_s(A_ILL_T, x)
 #define a_ill_p(x) a_cast_s(A_ILL_T *, x)
-#define a_ill_P(x) a_cast_s(const A_ILL_T *, x)
+#define A_ILL_P(x) a_cast_s(A_ILL_T const *, x)
 /*! static cast to \ref a_ull_t */
 #define a_ull_c(x) a_cast_s(A_ULL_T, x)
 #define a_ull_p(x) a_cast_s(A_ULL_T *, x)
-#define a_ull_P(x) a_cast_s(const A_ULL_T *, x)
+#define A_ULL_P(x) a_cast_s(A_ULL_T const *, x)
 /*! signed integer type is guaranteed to be at least 64 bits */
 #define a_ill_t A_ILL_T
 /*! unsigned integer type is guaranteed to be at least 64 bits */
 #define a_ull_t A_ULL_T
 
 #endif /* A_HAVE_LONG_LONG_TYPE */
 
-#if !defined A_SINGLE_T
 #define A_SINGLE_T float
-#endif /* A_SINGLE_T */
 #define A_SINGLE_C(X) X##F
 #define A_SINGLE_F(F) F##f
 #define A_SINGLE_F1(F, a) F##f(a)
 #define A_SINGLE_F2(F, a, b) F##f(a, b)
 #define A_SINGLE_F3(F, a, b, c) F##f(a, b, c)
 #if defined(A_HAVE_VARIADIC_MACROS)
 #define A_SINGLE_FN(F, ...) F##f(__VA_ARGS__)
 #endif /* A_HAVE_VARIADIC_MACROS */
-#define A_SINGLE_MIN FLT_MIN
+#define A_SINGLE_DIG FLT_DIG
+#define A_SINGLE_EPSILON FLT_EPSILON
+#define A_SINGLE_MANT_DIG FLT_MANT_DIG
 #define A_SINGLE_MAX FLT_MAX
+#define A_SINGLE_MAX_10_EXP FLT_MAX_10_EXP
+#define A_SINGLE_MAX_EXP FLT_MAX_EXP
+#define A_SINGLE_MIN FLT_MIN
+#define A_SINGLE_MIN_10_EXP FLT_MIN_10_EXP
+#define A_SINGLE_MIN_EXP FLT_MIN_EXP
 #define A_SINGLE_INF a_single_c(A_DOUBLE_INF)
 #define A_SINGLE_NAN (A_SINGLE_C(0.0) * A_SINGLE_INF)
 /*! format constants for the fprintf family of functions */
 #define A_SINGLE_PRI(F, C) "%" F C
 /*! format constants for the fscanf family of functions */
 #define A_SINGLE_SCN(F, C) "%" F C
 /*! static cast to \ref a_single_t */
 #define a_single_c(x) a_cast_s(A_SINGLE_T, x)
 #define a_single_p(x) a_cast_s(A_SINGLE_T *, x)
-#define a_single_P(x) a_cast_s(const A_SINGLE_T *, x)
+#define A_SINGLE_P(x) a_cast_s(A_SINGLE_T const *, x)
 /*! single precision floating point type. Matches IEEE-754 binary32 format if supported. */
 #define a_single_t A_SINGLE_T
 
-#if !defined A_DOUBLE_T
 #define A_DOUBLE_T double
-#endif /* A_DOUBLE_T */
 #define A_DOUBLE_C(X) X
 #define A_DOUBLE_F(F) F
 #define A_DOUBLE_F1(F, a) F(a)
 #define A_DOUBLE_F2(F, a, b) F(a, b)
 #define A_DOUBLE_F3(F, a, b, c) F(a, b, c)
 #if defined(A_HAVE_VARIADIC_MACROS)
 #define A_DOUBLE_FN(F, ...) F(__VA_ARGS__)
 #endif /* A_HAVE_VARIADIC_MACROS */
-#define A_DOUBLE_MIN DBL_MIN
+#define A_DOUBLE_DIG DBL_DIG
+#define A_DOUBLE_EPSILON DBL_EPSILON
+#define A_DOUBLE_MANT_DIG DBL_MANT_DIG
 #define A_DOUBLE_MAX DBL_MAX
+#define A_DOUBLE_MAX_10_EXP DBL_MAX_10_EXP
+#define A_DOUBLE_MAX_EXP DBL_MAX_EXP
+#define A_DOUBLE_MIN DBL_MIN
+#define A_DOUBLE_MIN_10_EXP DBL_MIN_10_EXP
+#define A_DOUBLE_MIN_EXP DBL_MIN_EXP
 #define A_DOUBLE_INF (DBL_MAX * DBL_MAX)
 #define A_DOUBLE_NAN (A_DOUBLE_C(0.0) * A_DOUBLE_INF)
 /*! format constants for the fprintf family of functions */
 #define A_DOUBLE_PRI(F, C) "%" F "l" C
 /*! format constants for the fscanf family of functions */
 #define A_DOUBLE_SCN(F, C) "%" F "l" C
 /*! static cast to \ref a_double_t */
 #define a_double_c(x) a_cast_s(A_DOUBLE_T, x)
 #define a_double_p(x) a_cast_s(A_DOUBLE_T *, x)
-#define a_double_P(x) a_cast_s(const A_DOUBLE_T *, x)
+#define A_DOUBLE_P(x) a_cast_s(A_DOUBLE_T const *, x)
 /*! double precision floating point type. Matches IEEE-754 binary32 format if supported. */
 #define a_double_t A_DOUBLE_T
 
-#if !defined A_EXTEND_T
 #define A_EXTEND_T long double
-#endif /* A_EXTEND_T */
 #define A_EXTEND_C(X) X##L
 #define A_EXTEND_F(F) F##l
 #define A_EXTEND_F1(F, a) F##l(a)
 #define A_EXTEND_F2(F, a, b) F##l(a, b)
 #define A_EXTEND_F3(F, a, b, c) F##l(a, b, c)
 #if defined(A_HAVE_VARIADIC_MACROS)
 #define A_EXTEND_FN(F, ...) F##l(__VA_ARGS__)
 #endif /* A_HAVE_VARIADIC_MACROS */
-#define A_EXTEND_MIN LDBL_MIN
+#define A_EXTEND_DIG LDBL_DIG
+#define A_EXTEND_EPSILON LDBL_EPSILON
+#define A_EXTEND_MANT_DIG LDBL_MANT_DIG
 #define A_EXTEND_MAX LDBL_MAX
+#define A_EXTEND_MAX_10_EXP LDBL_MAX_10_EXP
+#define A_EXTEND_MAX_EXP LDBL_MAX_EXP
+#define A_EXTEND_MIN LDBL_MIN
+#define A_EXTEND_MIN_10_EXP LDBL_MIN_10_EXP
+#define A_EXTEND_MIN_EXP LDBL_MIN_EXP
 #define A_EXTEND_INF (LDBL_MAX * LDBL_MAX)
 #define A_EXTEND_NAN (A_EXTEND_C(0.0) * A_EXTEND_INF)
 /*! format constants for the fprintf family of functions */
 #define A_EXTEND_PRI(F, C) "%" F "L" C
 /*! format constants for the fscanf family of functions */
 #define A_EXTEND_SCN(F, C) "%" F "L" C
 /*! static cast to \ref a_extend_t */
 #define a_extend_c(x) a_cast_s(A_EXTEND_T, x)
 #define a_extend_p(x) a_cast_s(A_EXTEND_T *, x)
-#define a_extend_P(x) a_cast_s(const A_EXTEND_T *, x)
+#define A_EXTEND_P(x) a_cast_s(A_EXTEND_T const *, x)
 /*! extend precision floating point type. Matches IEEE-754 extend format if supported. */
 #define a_extend_t A_EXTEND_T
 
 #if !defined A_I8_T
 #define A_I8_T int8_t
 #endif /* A_I8_T */
 #if !defined A_U8_T
 #define A_U8_T uint8_t
 #endif /* A_U8_T */
-#if !defined A_I8_MIN
+#if !defined A_I8_C && defined(INT8_C)
+#define A_I8_C(X) INT8_C(X)
+#endif /* A_I8_C */
+#if !defined A_U8_C && defined(UINT8_C)
+#define A_U8_C(X) UINT8_C(X)
+#endif /* A_U8_C */
+#if !defined A_I8_MIN && defined(INT8_MIN)
 #define A_I8_MIN INT8_MIN
 #endif /* A_I8_MIN */
-#if !defined A_I8_MAX
+#if !defined A_I8_MAX && defined(INT8_MAX)
 #define A_I8_MAX INT8_MAX
 #endif /* A_I8_MAX */
-#if !defined A_U8_MAX
+#if !defined A_U8_MAX && defined(UINT8_MAX)
 #define A_U8_MAX UINT8_MAX
 #endif /* A_U8_MAX */
-#if !defined A_I8_C
-#define A_I8_C(X) INT8_C(X)
-#endif /* A_I8_C */
-#if !defined A_U8_C
-#define A_U8_C(X) UINT8_C(X)
-#endif /* A_U8_C */
 /*! static cast to \ref a_i8_t */
 #define a_i8_c(x) a_cast_s(A_I8_T, x)
 #define a_i8_p(x) a_cast_s(A_I8_T *, x)
-#define a_i8_P(x) a_cast_s(const A_I8_T *, x)
+#define A_I8_P(x) a_cast_s(A_I8_T const *, x)
 /*! static cast to \ref a_u8_t */
 #define a_u8_c(x) a_cast_s(A_U8_T, x)
 #define a_u8_p(x) a_cast_s(A_U8_T *, x)
-#define a_u8_P(x) a_cast_s(const A_U8_T *, x)
+#define A_U8_P(x) a_cast_s(A_U8_T const *, x)
 /*! signed integer type with width of exactly 8 bits */
 #define a_i8_t A_I8_T
 /*! unsigned integer type with width of exactly 8 bits */
 #define a_u8_t A_U8_T
 
 #if !defined A_I16_T
 #define A_I16_T int16_t
 #endif /* A_I16_T */
 #if !defined A_U16_T
 #define A_U16_T uint16_t
 #endif /* A_U16_T */
-#if !defined A_I16_MIN
+#if !defined A_I16_C && defined(INT16_C)
+#define A_I16_C(X) INT16_C(X)
+#endif /* A_I16_C */
+#if !defined A_U16_C && defined(UINT16_C)
+#define A_U16_C(X) UINT16_C(X)
+#endif /* A_U16_C */
+#if !defined A_I16_MIN && defined(INT16_MIN)
 #define A_I16_MIN INT16_MIN
 #endif /* A_I16_MIN */
-#if !defined A_I16_MAX
+#if !defined A_I16_MAX && defined(INT16_MAX)
 #define A_I16_MAX INT16_MAX
 #endif /* A_I16_MAX */
-#if !defined A_U16_MAX
+#if !defined A_U16_MAX && defined(UINT16_MAX)
 #define A_U16_MAX UINT16_MAX
 #endif /* A_U16_MAX */
-#if !defined A_I16_C
-#define A_I16_C(X) INT16_C(X)
-#endif /* A_I16_C */
-#if !defined A_U16_C
-#define A_U16_C(X) UINT16_C(X)
-#endif /* A_U16_C */
 /*! static cast to \ref a_i16_t */
 #define a_i16_c(x) a_cast_s(A_I16_T, x)
 #define a_i16_p(x) a_cast_s(A_I16_T *, x)
-#define a_i16_P(x) a_cast_s(const A_I16_T *, x)
+#define A_I16_P(x) a_cast_s(A_I16_T const *, x)
 /*! static cast to \ref a_u16_t */
 #define a_u16_c(x) a_cast_s(A_U16_T, x)
 #define a_u16_p(x) a_cast_s(A_U16_T *, x)
-#define a_u16_P(x) a_cast_s(const A_U16_T *, x)
+#define A_U16_P(x) a_cast_s(A_U16_T const *, x)
 /*! signed integer type with width of exactly 16 bits */
 #define a_i16_t A_I16_T
 /*! unsigned integer type with width of exactly 16 bits */
 #define a_u16_t A_U16_T
 
 #if !defined A_I32_T
 #define A_I32_T int32_t
 #endif /* A_I32_T */
 #if !defined A_U32_T
 #define A_U32_T uint32_t
 #endif /* A_U32_T */
-#if !defined A_I32_MIN
+#if !defined A_I32_C && defined(INT32_C)
+#define A_I32_C(X) INT32_C(X)
+#endif /* A_I32_C */
+#if !defined A_U32_C && defined(UINT32_C)
+#define A_U32_C(X) UINT32_C(X)
+#endif /* A_U32_C */
+#if !defined A_I32_MIN && defined(INT32_MIN)
 #define A_I32_MIN INT32_MIN
 #endif /* A_I32_MIN */
-#if !defined A_I32_MAX
+#if !defined A_I32_MAX && defined(INT32_MAX)
 #define A_I32_MAX INT32_MAX
 #endif /* A_I32_MAX */
-#if !defined A_U32_MAX
+#if !defined A_U32_MAX && defined(UINT32_MAX)
 #define A_U32_MAX UINT32_MAX
 #endif /* A_U32_MAX */
-#if !defined A_I32_C
-#define A_I32_C(X) INT32_C(X)
-#endif /* A_I32_C */
-#if !defined A_U32_C
-#define A_U32_C(X) UINT32_C(X)
-#endif /* A_U32_C */
 /*! static cast to \ref a_i32_t */
 #define a_i32_c(x) a_cast_s(A_I32_T, x)
 #define a_i32_p(x) a_cast_s(A_I32_T *, x)
-#define a_i32_P(x) a_cast_s(const A_I32_T *, x)
+#define A_I32_P(x) a_cast_s(A_I32_T const *, x)
 /*! static cast to \ref a_u32_t */
 #define a_u32_c(x) a_cast_s(A_U32_T, x)
 #define a_u32_p(x) a_cast_s(A_U32_T *, x)
-#define a_u32_P(x) a_cast_s(const A_U32_T *, x)
+#define A_U32_P(x) a_cast_s(A_U32_T const *, x)
 /*! signed integer type with width of exactly 32 bits */
 #define a_i32_t A_I32_T
 /*! unsigned integer type with width of exactly 32 bits */
 #define a_u32_t A_U32_T
 
 #if !defined A_I64_T
 #define A_I64_T int64_t
 #endif /* A_I64_T */
 #if !defined A_U64_T
 #define A_U64_T uint64_t
 #endif /* A_U64_T */
-#if !defined A_I64_MIN
+#if !defined A_I64_C && defined(INT64_C)
+#define A_I64_C(X) INT64_C(X)
+#endif /* A_I64_C */
+#if !defined A_U64_C && defined(UINT64_C)
+#define A_U64_C(X) UINT64_C(X)
+#endif /* A_U64_C */
+#if !defined A_I64_MIN && defined(INT64_MIN)
 #define A_I64_MIN INT64_MIN
 #endif /* A_I64_MIN */
-#if !defined A_I64_MAX
+#if !defined A_I64_MAX && defined(INT64_MAX)
 #define A_I64_MAX INT64_MAX
 #endif /* A_I64_MAX */
-#if !defined A_U64_MAX
+#if !defined A_U64_MAX && defined(UINT64_MAX)
 #define A_U64_MAX UINT64_MAX
 #endif /* A_U64_MAX */
-#if !defined A_I64_C
-#define A_I64_C(X) INT64_C(X)
-#endif /* A_I64_C */
-#if !defined A_U64_C
-#define A_U64_C(X) UINT64_C(X)
-#endif /* A_U64_C */
 /*! static cast to \ref a_i64_t */
 #define a_i64_c(x) a_cast_s(A_I64_T, x)
 #define a_i64_p(x) a_cast_s(A_I64_T *, x)
-#define a_i64_P(x) a_cast_s(const A_I64_T *, x)
+#define A_I64_P(x) a_cast_s(A_I64_T const *, x)
 /*! static cast to \ref a_u64_t */
 #define a_u64_c(x) a_cast_s(A_U64_T, x)
 #define a_u64_p(x) a_cast_s(A_U64_T *, x)
-#define a_u64_P(x) a_cast_s(const A_U64_T *, x)
+#define A_U64_P(x) a_cast_s(A_U64_T const *, x)
 /*! signed integer type with width of exactly 64 bits */
 #define a_i64_t A_I64_T
 /*! unsigned integer type with width of exactly 64 bits */
 #define a_u64_t A_U64_T
 
 #if !defined A_IMAX_T
 #define A_IMAX_T intmax_t
 #endif /* A_IMAX_T */
 #if !defined A_UMAX_T
 #define A_UMAX_T uintmax_t
 #endif /* A_UMAX_T */
-#if !defined A_IMAX_MIN
+#if !defined A_IMAX_C && defined(INTMAX_C)
+#define A_IMAX_C(X) INTMAX_C(X)
+#endif /* A_IMAX_C */
+#if !defined A_UMAX_C && defined(UINTMAX_C)
+#define A_UMAX_C(X) UINTMAX_C(X)
+#endif /* A_UMAX_C */
+#if !defined A_IMAX_MIN && defined(INTMAX_MIN)
 #define A_IMAX_MIN INTMAX_MIN
 #endif /* A_IMAX_MIN */
-#if !defined A_IMAX_MAX
+#if !defined A_IMAX_MAX && defined(INTMAX_MAX)
 #define A_IMAX_MAX INTMAX_MAX
 #endif /* A_IMAX_MAX */
-#if !defined A_UMAX_MAX
+#if !defined A_UMAX_MAX && defined(UINTMAX_MAX)
 #define A_UMAX_MAX UINTMAX_MAX
 #endif /* A_UMAX_MAX */
-#if !defined A_IMAX_C
-#define A_IMAX_C(X) INTMAX_C(X)
-#endif /* A_IMAX_C */
-#if !defined A_UMAX_C
-#define A_UMAX_C(X) UINTMAX_C(X)
-#endif /* A_UMAX_C */
 /*! static cast to \ref a_imax_t */
 #define a_imax_c(x) a_cast_s(A_IMAX_T, x)
 #define a_imax_p(x) a_cast_s(A_IMAX_T *, x)
-#define a_imax_P(x) a_cast_s(const A_IMAX_T *, x)
+#define A_IMAX_P(x) a_cast_s(A_IMAX_T const *, x)
 /*! static cast to \ref a_umax_t */
 #define a_umax_c(x) a_cast_s(A_UMAX_T, x)
 #define a_umax_p(x) a_cast_s(A_UMAX_T *, x)
-#define a_umax_P(x) a_cast_s(const A_UMAX_T *, x)
+#define A_UMAX_P(x) a_cast_s(A_UMAX_T const *, x)
 /*! maximum-width signed integer type */
 #define a_imax_t A_IMAX_T
 /*! maximum-width unsigned integer type */
 #define a_umax_t A_UMAX_T
 
 #if !defined A_IPTR_T
 #define A_IPTR_T intptr_t
 #endif /* A_IPTR_T */
 #if !defined A_UPTR_T
 #define A_UPTR_T uintptr_t
 #endif /* A_UPTR_T */
-#if !defined A_IPTR_MIN
+#if !defined A_IPTR_MIN && defined(INTPTR_MIN)
 #define A_IPTR_MIN INTPTR_MIN
 #endif /* A_IPTR_MIN */
-#if !defined A_IPTR_MAX
+#if !defined A_IPTR_MAX && defined(INTPTR_MAX)
 #define A_IPTR_MAX INTPTR_MAX
 #endif /* A_IPTR_MAX */
-#if !defined A_UPTR_MAX
+#if !defined A_UPTR_MAX && defined(UINTPTR_MAX)
 #define A_UPTR_MAX UINTPTR_MAX
 #endif /* A_UPTR_MAX */
-#if !defined A_IPTR_C
-#define A_IPTR_C(X) INTPTR_C(X)
-#endif /* A_IPTR_C */
-#if !defined A_UPTR_C
-#define A_UPTR_C(X) UINTPTR_C(X)
-#endif /* A_UPTR_C */
 /*! static cast to \ref a_iptr_t */
 #define a_iptr_c(x) a_cast_s(A_IPTR_T, x)
 #define a_iptr_p(x) a_cast_s(A_IPTR_T *, x)
-#define a_iptr_P(x) a_cast_s(const A_IPTR_T *, x)
+#define A_IPTR_P(x) a_cast_s(A_IPTR_T const *, x)
 /*! static cast to \ref a_uptr_t */
 #define a_uptr_c(x) a_cast_s(A_UPTR_T, x)
 #define a_uptr_p(x) a_cast_s(A_UPTR_T *, x)
-#define a_uptr_P(x) a_cast_s(const A_UPTR_T *, x)
+#define A_UPTR_P(x) a_cast_s(A_UPTR_T const *, x)
 /*! signed integer type capable of holding a pointer to void */
 #define a_iptr_t A_IPTR_T
 /*! unsigned integer type capable of holding a pointer to void */
 #define a_uptr_t A_UPTR_T
 
 #if !defined A_DIFF_T
 #define A_DIFF_T ptrdiff_t
 #endif /* A_DIFF_T */
-#if !defined A_DIFF_MIN
+#if !defined A_DIFF_MIN && defined(PTRDIFF_MIN)
 #define A_DIFF_MIN PTRDIFF_MIN
 #endif /* A_DIFF_MIN */
-#if !defined A_DIFF_MAX
+#if !defined A_DIFF_MAX && defined(PTRDIFF_MAX)
 #define A_DIFF_MAX PTRDIFF_MAX
 #endif /* A_DIFF_MAX */
 /*! static cast to \ref a_diff_t */
 #define a_diff_c(x) a_cast_s(A_DIFF_T, x)
 #define a_diff_p(x) a_cast_s(A_DIFF_T *, x)
-#define a_diff_P(x) a_cast_s(const A_DIFF_T *, x)
+#define A_DIFF_P(x) a_cast_s(A_DIFF_T const *, x)
 /*! signed integer type returned when subtracting two pointers */
 #define a_diff_t A_DIFF_T
 
 #if !defined A_SIZE_T
 #define A_SIZE_T size_t
 #endif /* A_SIZE_T */
-#if !defined A_SIZE_MAX
+#if !defined A_SIZE_MAX && defined(SIZE_MAX)
 #define A_SIZE_MAX SIZE_MAX
 #endif /* A_SIZE_MAX */
 /*! static cast to \ref a_size_t */
 #define a_size_c(x) a_cast_s(A_SIZE_T, x)
 #define a_size_p(x) a_cast_s(A_SIZE_T *, x)
-#define a_size_P(x) a_cast_s(const A_SIZE_T *, x)
+#define A_SIZE_P(x) a_cast_s(A_SIZE_T const *, x)
 /*! unsigned integer type returned by the sizeof operator */
 #define a_size_t A_SIZE_T
 
-#if !defined A_F16_T
-#define A_F16_T A_U16_T
-#endif /* A_F16_T */
 #define A_F16_NNAN A_U16_C(0xFE00)
 #define A_F16_PNAN A_U16_C(0x7E00)
 #define A_F16_NINF A_U16_C(0xFC00)
 #define A_F16_PINF A_U16_C(0x7C00)
 
-#if !defined A_F32_T
 #define A_F32_T float
-#endif /* A_F32_T */
 #define A_F32_C(X) X##F
 #define A_F32_F(F) F##f
 #define A_F32_F1(F, a) F##f(a)
 #define A_F32_F2(F, a, b) F##f(a, b)
 #define A_F32_F3(F, a, b, c) F##f(a, b, c)
 #if defined(A_HAVE_VARIADIC_MACROS)
 #define A_F32_FN(F, ...) F##f(__VA_ARGS__)
 #endif /* A_HAVE_VARIADIC_MACROS */
-#define A_F32_MIN FLT_MIN
+#define A_F32_DIG FLT_DIG
+#define A_F32_EPSILON FLT_EPSILON
+#define A_F32_MANT_DIG FLT_MANT_DIG
 #define A_F32_MAX FLT_MAX
+#define A_F32_MAX_10_EXP FLT_MAX_10_EXP
+#define A_F32_MAX_EXP FLT_MAX_EXP
+#define A_F32_MIN FLT_MIN
+#define A_F32_MIN_10_EXP FLT_MIN_10_EXP
+#define A_F32_MIN_EXP FLT_MIN_EXP
 #define A_F32_INF a_f32_c(A_F64_INF)
 #define A_F32_NAN (A_F32_C(0.0) * A_F32_INF)
 #define A_F32_NNAN A_U32_C(0xFFC00000)
 #define A_F32_PNAN A_U32_C(0x7FC00000)
 #define A_F32_NINF A_U32_C(0xFF800000)
 #define A_F32_PINF A_U32_C(0x7F800000)
 /*! format constants for the fprintf family of functions */
 #define A_F32_PRI(F, C) "%" F C
 /*! format constants for the fscanf family of functions */
 #define A_F32_SCN(F, C) "%" F C
 /*! static cast to \ref a_f32_t */
 #define a_f32_c(x) a_cast_s(A_F32_T, x)
 #define a_f32_p(x) a_cast_s(A_F32_T *, x)
-#define a_f32_P(x) a_cast_s(const A_F32_T *, x)
+#define A_F32_P(x) a_cast_s(A_F32_T const *, x)
 /*! single precision floating point type. Matches IEEE-754 binary32 format if supported. */
 #define a_f32_t A_F32_T
 
-#if !defined A_F64_T
 #define A_F64_T double
-#endif /* A_F64_T */
 #define A_F64_C(X) X
 #define A_F64_F(F) F
 #define A_F64_F1(F, a) F(a)
 #define A_F64_F2(F, a, b) F(a, b)
 #define A_F64_F3(F, a, b, c) F(a, b, c)
 #if defined(A_HAVE_VARIADIC_MACROS)
 #define A_F64_FN(F, ...) F(__VA_ARGS__)
 #endif /* A_HAVE_VARIADIC_MACROS */
-#define A_F64_MIN DBL_MIN
+#define A_F64_DIG DBL_DIG
+#define A_F64_EPSILON DBL_EPSILON
+#define A_F64_MANT_DIG DBL_MANT_DIG
 #define A_F64_MAX DBL_MAX
+#define A_F64_MAX_10_EXP DBL_MAX_10_EXP
+#define A_F64_MAX_EXP DBL_MAX_EXP
+#define A_F64_MIN DBL_MIN
+#define A_F64_MIN_10_EXP DBL_MIN_10_EXP
+#define A_F64_MIN_EXP DBL_MIN_EXP
 #define A_F64_INF (DBL_MAX * DBL_MAX)
 #define A_F64_NAN (A_F64_C(0.0) * A_F64_INF)
 #define A_F64_NNAN A_U64_C(0xFFF8000000000000)
 #define A_F64_PNAN A_U64_C(0x7FF8000000000000)
 #define A_F64_NINF A_U64_C(0xFFF0000000000000)
 #define A_F64_PINF A_U64_C(0x7FF0000000000000)
 /*! format constants for the fprintf family of functions */
 #define A_F64_PRI(F, C) "%" F "l" C
 /*! format constants for the fscanf family of functions */
 #define A_F64_SCN(F, C) "%" F "l" C
 /*! static cast to \ref a_f64_t */
 #define a_f64_c(x) a_cast_s(A_F64_T, x)
 #define a_f64_p(x) a_cast_s(A_F64_T *, x)
-#define a_f64_P(x) a_cast_s(const A_F64_T *, x)
+#define A_F64_P(x) a_cast_s(A_F64_T const *, x)
 /*! double precision floating point type. Matches IEEE-754 binary64 format if supported. */
 #define a_f64_t A_F64_T
 
 typedef char *a_str_t;
 #define a_str_c(x) a_cast_s(a_str_t, x)
-typedef const char *a_cstr_t;
+typedef char const *a_cstr_t;
 #define a_cstr_c(x) a_cast_s(a_cstr_t, x)
+
 typedef void *a_vptr_t;
 #define a_vptr_c(x) a_cast_s(a_vptr_t, x)
-typedef const void *a_cptr_t;
+typedef void const *a_cptr_t;
 #define a_cptr_c(x) a_cast_s(a_cptr_t, x)
 
 typedef union a_cast_u
 {
     a_i_t i;
     a_u_t u;
     a_is_t is;
@@ -613,14 +857,73 @@
     a_cptr_t cptr;
     a_vptr_t vptr;
     a_cstr_t cstr;
     a_str_t str;
     a_char_t c;
 } a_cast_u;
 
+#if defined(__cplusplus)
+namespace a
+{
+
+typedef a_void_t void_t;
+typedef a_bool_t bool_t;
+
+typedef a_i8_t i8_t;
+typedef a_u8_t u8_t;
+
+typedef a_i16_t i16_t;
+typedef a_u16_t u16_t;
+
+typedef a_i32_t i32_t;
+typedef a_u32_t u32_t;
+
+typedef a_i64_t i64_t;
+typedef a_u64_t u64_t;
+
+typedef a_imax_t imax_t;
+typedef a_umax_t umax_t;
+
+typedef a_iptr_t iptr_t;
+typedef a_uptr_t uptr_t;
+
+typedef a_diff_t diff_t;
+typedef a_size_t size_t;
+
+typedef a_i_t i_t;
+typedef a_u_t u_t;
+
+typedef a_is_t is_t;
+typedef a_us_t us_t;
+
+typedef a_il_t il_t;
+typedef a_ul_t ul_t;
+
+#if defined(A_HAVE_LONG_LONG_TYPE)
+typedef a_ill_t ill_t;
+typedef a_ull_t ull_t;
+#endif /* A_HAVE_LONG_LONG_TYPE */
+
+typedef a_int_t int_t;
+typedef a_uint_t uint_t;
+
+typedef a_byte_t byte_t;
+typedef a_char_t char_t;
+
+typedef a_str_t str_t;
+typedef a_cstr_t cstr_t;
+typedef a_vptr_t vptr_t;
+typedef a_cptr_t cptr_t;
+
+typedef a_f32_t f32_t;
+typedef a_f64_t f64_t;
+
+} /* namespace a */
+#endif /* __cplusplus */
+
 /*!
  @addtogroup A_REAL real number
  @{
 */
 
 /*! real number bytes */
 #if !defined A_REAL_TYPE
@@ -629,26 +932,28 @@
 #else /* !A_SIZE_REAL */
 #define A_REAL_TYPE A_SIZE_REAL
 #endif /* A_SIZE_REAL */
 #endif /* A_REAL_TYPE */
 #define A_REAL_SINGLE 0x04
 #define A_REAL_DOUBLE 0x08
 #define A_REAL_EXTEND 0x10
-#if A_REAL_TYPE == A_REAL_SINGLE
+#if defined(A_REAL_T)
+#elif A_REAL_TYPE == A_REAL_SINGLE
 
 /*! real number stored using `float` */
-#if !defined A_REAL_T
 #define A_REAL_T float
-#endif /* A_REAL_T */
-#if !defined A_REAL_MIN
-#define A_REAL_MIN FLT_MIN
-#endif /* A_REAL_MIN */
-#if !defined A_REAL_MAX
+#define A_REAL_DIG FLT_DIG
+#define A_REAL_EPSILON FLT_EPSILON
+#define A_REAL_MANT_DIG FLT_MANT_DIG
 #define A_REAL_MAX FLT_MAX
-#endif /* A_REAL_MAX */
+#define A_REAL_MAX_10_EXP FLT_MAX_10_EXP
+#define A_REAL_MAX_EXP FLT_MAX_EXP
+#define A_REAL_MIN FLT_MIN
+#define A_REAL_MIN_10_EXP FLT_MIN_10_EXP
+#define A_REAL_MIN_EXP FLT_MIN_EXP
 
 /*!
  expands to a floating-point constant expression having the value specified by its argument and the type \ref a_real_t
 */
 #define A_REAL_C(X) X##F
 /*!
  expands to a floating-point function expression having the value specified by its argument and the type \ref a_real_t
@@ -665,23 +970,24 @@
 #define A_REAL_PRI(F, C) "%" F C
 /*! format constants for the fscanf family of functions */
 #define A_REAL_SCN(F, C) "%" F C
 
 #elif A_REAL_TYPE == A_REAL_DOUBLE
 
 /*! real number stored using `double` */
-#if !defined A_REAL_T
 #define A_REAL_T double
-#endif /* A_REAL_T */
-#if !defined A_REAL_MIN
-#define A_REAL_MIN DBL_MIN
-#endif /* A_REAL_MIN */
-#if !defined A_REAL_MAX
+#define A_REAL_DIG DBL_DIG
+#define A_REAL_EPSILON DBL_EPSILON
+#define A_REAL_MANT_DIG DBL_MANT_DIG
 #define A_REAL_MAX DBL_MAX
-#endif /* A_REAL_MAX */
+#define A_REAL_MAX_10_EXP DBL_MAX_10_EXP
+#define A_REAL_MAX_EXP DBL_MAX_EXP
+#define A_REAL_MIN DBL_MIN
+#define A_REAL_MIN_10_EXP DBL_MIN_10_EXP
+#define A_REAL_MIN_EXP DBL_MIN_EXP
 
 /*!
  expands to a floating-point constant expression having the value specified by its argument and the type \ref a_real_t
 */
 #define A_REAL_C(X) X
 /*!
  expands to a floating-point function expression having the value specified by its argument and the type \ref a_real_t
@@ -698,23 +1004,24 @@
 #define A_REAL_PRI(F, C) "%" F C
 /*! format constants for the fscanf family of functions */
 #define A_REAL_SCN(F, C) "%" F "l" C
 
 #elif A_REAL_TYPE == A_REAL_EXTEND
 
 /*! real number stored using `long double` */
-#if !defined A_REAL_T
 #define A_REAL_T long double
-#endif /* A_REAL_T */
-#if !defined A_REAL_MIN
-#define A_REAL_MIN LDBL_MIN
-#endif /* A_REAL_MIN */
-#if !defined A_REAL_MAX
+#define A_REAL_DIG LDBL_DIG
+#define A_REAL_EPSILON LDBL_EPSILON
+#define A_REAL_MANT_DIG LDBL_MANT_DIG
 #define A_REAL_MAX LDBL_MAX
-#endif /* A_REAL_MAX */
+#define A_REAL_MAX_10_EXP LDBL_MAX_10_EXP
+#define A_REAL_MAX_EXP LDBL_MAX_EXP
+#define A_REAL_MIN LDBL_MIN
+#define A_REAL_MIN_10_EXP LDBL_MIN_10_EXP
+#define A_REAL_MIN_EXP LDBL_MIN_EXP
 
 /*!
  expands to a floating-point constant expression having the value specified by its argument and the type \ref a_real_t
 */
 #define A_REAL_C(X) X##L
 /*!
  expands to a floating-point function expression having the value specified by its argument and the type \ref a_real_t
@@ -738,38 +1045,48 @@
 
 #define A_REAL_INF a_cast_s(A_REAL_T, A_F64_INF)
 #define A_REAL_NAN (A_REAL_C(0.0) * A_REAL_INF)
 
 /*! static cast to \ref a_real_t */
 #define a_real_c(x) a_cast_s(A_REAL_T, x)
 #define a_real_p(x) a_cast_s(A_REAL_T *, x)
-#define a_real_P(x) a_cast_s(const A_REAL_T *, x)
+#define A_REAL_P(x) a_cast_s(A_REAL_T const *, x)
 /*! compiler built-in real number type */
 #define a_real_t A_REAL_T
 
 typedef union a_real_u
 {
     a_real_t v; //!< a real value
     a_real_t *p; //!< real vector
 } a_real_u;
 
+#if defined(__cplusplus)
+namespace a
+{
+
+typedef a_real_t real_t;
+typedef a_real_u real_u;
+
+} /* namespace a */
+#endif /* __cplusplus */
+
 /*! @} A_REAL */
 
 /*!
  @brief size of memory that alignment is specified by alignment
  @param base specifies the alignment that is a power of two
  @param size number of bytes to allocate
 */
 #define a_align(base, size) ((a_cast_s(a_size_t, size) + (base)-1) & ~((base)-1))
 
 /*!
- @brief size of an array
- @param a must be an array variable
+ @brief count of an array buffer
+ @param array must be an array variable
 */
-#define a_arrayof(a) (sizeof(a) / sizeof(*(a)))
+#define a_count_of(array) (sizeof(array) / sizeof(*(array)))
 
 /*!
  @brief offset of a structure member
  @param type structure type
  @param member member variable
 */
 #if defined(offsetof)
@@ -857,149 +1174,162 @@
     A_FAILURE /*!< return failure */,
     A_INVALID /*!< return invalid */
 };
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
+#if defined(LIBA_A_C)
+#undef A_INTERN
+#define A_INTERN A_INLINE
+#endif /* LIBA_A_C */
 
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_f32_t a_f32_from(a_u32_t x);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_f32_t a_f32_from(a_u32_t x);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_f32_t a_f32_from(a_u32_t x)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_f32_t a_f32_from(a_u32_t const x)
 {
     union
     {
         a_u32_t u;
         a_f32_t x;
     } u;
     u.u = x;
     return u.x;
 }
 #endif /* A_HAVE_INLINE */
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_u32_t a_f32_into(a_f32_t x);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_u32_t a_f32_into(a_f32_t x);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_u32_t a_f32_into(a_f32_t x)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_u32_t a_f32_into(a_f32_t const x)
 {
     union
     {
         a_f32_t x;
         a_u32_t u;
     } u;
     u.x = x;
     return u.u;
 }
 #endif /* A_HAVE_INLINE */
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_f64_t a_f64_from(a_u64_t x);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_f64_t a_f64_from(a_u64_t x);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_f64_t a_f64_from(a_u64_t x)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_f64_t a_f64_from(a_u64_t const x)
 {
     union
     {
         a_u64_t u;
         a_f64_t x;
     } u;
     u.u = x;
     return u.x;
 }
 #endif /* A_HAVE_INLINE */
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_u64_t a_f64_into(a_f64_t x);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_u64_t a_f64_into(a_f64_t x);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_u64_t a_f64_into(a_f64_t x)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_u64_t a_f64_into(a_f64_t const x)
 {
     union
     {
         a_f64_t x;
         a_u64_t u;
     } u;
     u.x = x;
     return u.u;
 }
 #endif /* A_HAVE_INLINE */
 
+A_EXTERN a_vptr_t a_copy(a_vptr_t A_RESTRICT dst, a_cptr_t A_RESTRICT src, a_size_t siz);
+A_EXTERN a_vptr_t a_move(a_vptr_t dst, a_cptr_t src, a_size_t siz);
+A_EXTERN a_vptr_t a_fill(a_vptr_t ptr, a_size_t siz, a_int_t val);
+A_EXTERN a_vptr_t a_zero(a_vptr_t ptr, a_size_t siz);
+
 /*!
  @brief swap two different memory blocks of the same size
  @param[in] siz the size of memory block being swapped
  @param[in,out] lhs points to memory block on the left
  @param[in,out] rhs points to memory block on the right
 */
-A_PUBLIC a_void_t a_swap(a_size_t siz, a_vptr_t lhs, a_vptr_t rhs);
+A_EXTERN a_void_t a_swap(a_vptr_t lhs, a_vptr_t rhs, a_size_t siz);
 
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_void_t a_swap1(a_vptr_t lhs, a_vptr_t rhs);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_void_t a_swap1(a_vptr_t lhs, a_vptr_t rhs);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_void_t a_swap1(a_vptr_t lhs, a_vptr_t rhs)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_void_t a_swap1(a_vptr_t const lhs, a_vptr_t const rhs)
 {
-    *a_u8_p(lhs) ^= *a_u8_p(rhs);
-    *a_u8_p(rhs) ^= *a_u8_p(lhs);
-    *a_u8_p(lhs) ^= *a_u8_p(rhs);
+    *a_u8_p(lhs) ^= *A_U8_P(rhs);
+    *a_u8_p(rhs) ^= *A_U8_P(lhs);
+    *a_u8_p(lhs) ^= *A_U8_P(rhs);
 }
 #endif /* A_HAVE_INLINE */
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_void_t a_swap2(a_vptr_t lhs, a_vptr_t rhs);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_void_t a_swap2(a_vptr_t lhs, a_vptr_t rhs);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_void_t a_swap2(a_vptr_t lhs, a_vptr_t rhs)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_void_t a_swap2(a_vptr_t const lhs, a_vptr_t const rhs)
 {
-    *a_u16_p(lhs) ^= *a_u16_p(rhs);
-    *a_u16_p(rhs) ^= *a_u16_p(lhs);
-    *a_u16_p(lhs) ^= *a_u16_p(rhs);
+    *a_u16_p(lhs) ^= *A_U16_P(rhs);
+    *a_u16_p(rhs) ^= *A_U16_P(lhs);
+    *a_u16_p(lhs) ^= *A_U16_P(rhs);
 }
 #endif /* A_HAVE_INLINE */
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_void_t a_swap4(a_vptr_t lhs, a_vptr_t rhs);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_void_t a_swap4(a_vptr_t lhs, a_vptr_t rhs);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_void_t a_swap4(a_vptr_t lhs, a_vptr_t rhs)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_void_t a_swap4(a_vptr_t const lhs, a_vptr_t const rhs)
 {
-    *a_u32_p(lhs) ^= *a_u32_p(rhs);
-    *a_u32_p(rhs) ^= *a_u32_p(lhs);
-    *a_u32_p(lhs) ^= *a_u32_p(rhs);
+    *a_u32_p(lhs) ^= *A_U32_P(rhs);
+    *a_u32_p(rhs) ^= *A_U32_P(lhs);
+    *a_u32_p(lhs) ^= *A_U32_P(rhs);
 }
 #endif /* A_HAVE_INLINE */
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_void_t a_swap8(a_vptr_t lhs, a_vptr_t rhs);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_void_t a_swap8(a_vptr_t lhs, a_vptr_t rhs);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_void_t a_swap8(a_vptr_t lhs, a_vptr_t rhs)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_void_t a_swap8(a_vptr_t const lhs, a_vptr_t const rhs)
 {
-    *a_u64_p(lhs) ^= *a_u64_p(rhs);
-    *a_u64_p(rhs) ^= *a_u64_p(lhs);
-    *a_u64_p(lhs) ^= *a_u64_p(rhs);
+    *a_u64_p(lhs) ^= *A_U64_P(rhs);
+    *a_u64_p(rhs) ^= *A_U64_P(lhs);
+    *a_u64_p(lhs) ^= *A_U64_P(rhs);
 }
 #endif /* A_HAVE_INLINE */
-#if !defined A_HAVE_INLINE || defined(A_A_I)
-A_PUBLIC a_void_t a_swapz(a_vptr_t lhs, a_vptr_t rhs);
+#if !defined A_HAVE_INLINE || defined(LIBA_A_C)
+A_EXTERN a_void_t a_swapz(a_vptr_t lhs, a_vptr_t rhs);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_A_I)
-A_INTERN a_void_t a_swapz(a_vptr_t lhs, a_vptr_t rhs)
+#if defined(A_HAVE_INLINE) || defined(LIBA_A_C)
+A_INTERN a_void_t a_swapz(a_vptr_t const lhs, a_vptr_t const rhs)
 {
-    *a_size_p(lhs) ^= *a_size_p(rhs);
-    *a_size_p(rhs) ^= *a_size_p(lhs);
-    *a_size_p(lhs) ^= *a_size_p(rhs);
+    *a_size_p(lhs) ^= *A_SIZE_P(rhs);
+    *a_size_p(rhs) ^= *A_SIZE_P(lhs);
+    *a_size_p(lhs) ^= *A_SIZE_P(rhs);
 }
 #endif /* A_HAVE_INLINE */
 
 /*!
  @brief Brian Kernighan and Dennis Ritchie
  @param[in] str string to be processed
  @param[in] val initial value
  @return hash value
 */
-A_PUBLIC a_umax_t a_hash_bkdr(a_cptr_t str, a_umax_t val);
-A_PUBLIC a_umax_t a_hash_bkdrn(a_cptr_t ptr, a_size_t siz, a_umax_t val);
+A_EXTERN a_umax_t a_hash_bkdr(a_cptr_t str, a_umax_t val);
+A_EXTERN a_umax_t a_hash_bkdrn(a_cptr_t ptr, a_size_t siz, a_umax_t val);
 
+#if defined(LIBA_A_C)
+#undef A_INTERN
+#define A_INTERN static A_INLINE
+#endif /* LIBA_A_C */
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A */
 
-#endif /* A_A_H */
+#endif /* a.h */
```

### Comparing `liba-0.1.1rc4/include/a/arr.h` & `liba-0.1.1rc5/include/a/host/vec.h`

 * *Files 21% similar despite different names*

```diff
@@ -1,359 +1,427 @@
 /*!
- @file arr.h
- @brief basic array library
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
+ @file vec.h
+ @brief basic vector library
 */
 
-#ifndef A_ARR_H
-#define A_ARR_H
+#ifndef LIBA_HOST_VEC_H
+#define LIBA_HOST_VEC_H
 
 #include "a.h"
 
 /*!
  @ingroup A
- @addtogroup A_ARR basic array library
+ @addtogroup A_VEC basic vector library
  @{
 */
 
 /*!
- @brief instance structure for basic array
+ @brief instance structure for basic vector
 */
-typedef struct a_arr_s
+typedef struct a_vec_s
 {
-    a_vptr_t _ptr; /*!< address of memory */
+    a_vptr_t _ptr; /*!< address of vector */
     a_size_t _num; /*!< number of element */
     a_size_t _mem; /*!< memory of element */
     a_size_t _siz; /*!< size of a element */
-} a_arr_s;
+} a_vec_s;
 
 /*!
- @brief access address of array for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief access address of vector for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_vptr_t a_arr_ptr(const a_arr_s *ctx) { return ctx->_ptr; }
+A_INTERN a_vptr_t a_vec_ptr(a_vec_s const *const ctx) { return ctx->_ptr; }
 
 /*!
- @brief access number of element for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief access number of element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_size_t a_arr_num(const a_arr_s *ctx) { return ctx->_num; }
+A_INTERN a_size_t a_vec_num(a_vec_s const *const ctx) { return ctx->_num; }
 
 /*!
- @brief access memory of element for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief access memory of element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_size_t a_arr_mem(const a_arr_s *ctx) { return ctx->_mem; }
+A_INTERN a_size_t a_vec_mem(a_vec_s const *const ctx) { return ctx->_mem; }
 
 /*!
- @brief access size of a element for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief access size of a element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_size_t a_arr_get(const a_arr_s *ctx) { return ctx->_siz; }
+A_INTERN a_size_t a_vec_get(a_vec_s const *const ctx) { return ctx->_siz; }
 
 /*!
- @brief access specified element for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief access specified element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] idx index of element less than memory
  @note should check for out of bounds
- @return element pointer
+ @return specified element pointer
 */
-A_INTERN a_vptr_t a_arr_at_(const a_arr_s *ctx, a_size_t idx)
+A_INTERN a_vptr_t a_vec_at_(a_vec_s const *const ctx, a_size_t const idx)
 {
     return a_byte_p(ctx->_ptr) + ctx->_siz * idx;
 }
 
 /*!
- @brief access specified element for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief access specified element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] idx index of element less than memory
- @return element pointer
+ @return specified element pointer
   @retval 0 out of bounds
 */
-A_INTERN a_vptr_t a_arr_at(const a_arr_s *ctx, a_size_t idx)
+A_INTERN a_vptr_t a_vec_at(a_vec_s const *const ctx, a_size_t const idx)
 {
-    return a_likely(idx < ctx->_mem) ? a_arr_at_(ctx, idx) : A_NULL;
+    return a_likely(idx < ctx->_mem) ? a_vec_at_(ctx, idx) : A_NULL;
 }
 
 /*!
- @brief access top element for a pointer to array structure
- @param[in] ctx points to an instance of array structure
- @note should check if array is empty
- @return element pointer
+ @brief access specified element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @param[in] idx index of element -memory < idx < memory
+ @return specified element pointer
+  @retval 0 out of bounds
+*/
+A_INTERN a_vptr_t a_vec_idx(a_vec_s const *const ctx, a_diff_t const idx)
+{
+    a_size_t const num = idx < 0 ? a_size_c(idx) + ctx->_num : a_size_c(idx);
+    return a_likely(num < ctx->_mem) ? a_vec_at_(ctx, num) : A_NULL;
+}
+
+/*!
+ @brief access top element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @note should check if vector is empty
+ @return specified element pointer
 */
-A_INTERN a_vptr_t a_arr_top_(const a_arr_s *ctx)
+A_INTERN a_vptr_t a_vec_top_(a_vec_s const *const ctx)
 {
     return a_byte_p(ctx->_ptr) + ctx->_siz * (ctx->_num - 1);
 }
 
 /*!
- @brief access top element for a pointer to array structure
- @param[in] ctx points to an instance of array structure
- @return element pointer
-  @retval 0 empty array
+ @brief access top element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @return specified element pointer
+  @retval 0 empty vector
 */
-A_INTERN a_vptr_t a_arr_top(const a_arr_s *ctx)
+A_INTERN a_vptr_t a_vec_top(a_vec_s const *const ctx)
 {
-    return a_likely(ctx->_num) ? a_arr_top_(ctx) : A_NULL;
+    return a_likely(ctx->_num) ? a_vec_top_(ctx) : A_NULL;
 }
 
 /*!
- @brief access end pointer for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief access end pointer for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @return vector end pointer
 */
-A_INTERN a_vptr_t a_arr_end(const a_arr_s *ctx)
+A_INTERN a_vptr_t a_vec_end_(a_vec_s const *const ctx)
 {
     return a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num;
 }
 
+/*!
+ @brief access end pointer for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @return vector end pointer
+  @retval 0 empty vector
+*/
+A_INTERN a_vptr_t a_vec_end(a_vec_s const *const ctx)
+{
+    return a_likely(ctx->_ptr) ? a_vec_end_(ctx) : ctx->_ptr;
+}
+
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
 /*!
- @brief constructor for array structure
- @param[in] ctx points to an instance of array structure
- @param[in] ptr address of memory
- @param[in] siz size of a element
- @param[in] num number of element
+ @brief allocate a pointer to vector structure from memory
+ @param[in] size size of element
+*/
+A_EXTERN a_vec_s *a_vec_new(a_size_t size);
+
+/*!
+ @brief deallocate a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @param[in] dtor element destructor
+*/
+A_EXTERN a_void_t a_vec_die(a_vec_s *ctx, a_void_t (*dtor)(a_vptr_t));
+
+/*!
+ @brief constructor for vector structure
+ @param[in] ctx points to an instance of vector structure
+ @param[in] size size of element
 */
-A_PUBLIC a_void_t a_arr_ctor(a_arr_s *ctx, a_vptr_t ptr, a_size_t siz, a_size_t num);
+A_EXTERN a_void_t a_vec_ctor(a_vec_s *ctx, a_size_t size);
 
 /*!
- @brief destructor for array structure
- @param[in] ctx points to an instance of array structure
+ @brief destructor for vector structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] dtor element destructor
 */
-A_PUBLIC a_void_t a_arr_dtor(a_arr_s *ctx, a_void_t (*dtor)(a_vptr_t));
+A_EXTERN a_void_t a_vec_dtor(a_vec_s *ctx, a_void_t (*dtor)(a_vptr_t));
+
+/*!
+ @brief initialize a pointer to vector structure by copying
+ @param[in] ctx points to an instance of vector structure
+ @param[in] obj input source pointing to an instance
+ @param[in] dup a function that copies elements
+  @arg 0 use function a_copy to copy elements
+ @return the execution state of the function
+  @retval 0 success
+  @retval 1 failure
+*/
+A_EXTERN a_int_t a_vec_copy(a_vec_s *ctx, a_vec_s const *obj, a_int_t (*dup)(a_vptr_t, a_cptr_t));
 
 /*!
- @brief initialize a pointer to array structure by moving
- @param[in] ctx points to an instance of array structure
+ @brief initialize a pointer to vector structure by moving
+ @param[in] ctx points to an instance of vector structure
  @param[in] obj input source pointing to an instance
 */
-A_PUBLIC a_arr_s *a_arr_move(a_arr_s *ctx, a_arr_s *obj);
+A_EXTERN a_vec_s *a_vec_move(a_vec_s *ctx, a_vec_s *obj);
+
+/*!
+ @brief modify size of a element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @param[in] size the size of the new element
+ @param[in] dtor previous element destructor
+*/
+A_EXTERN a_void_t a_vec_set(a_vec_s *ctx, a_size_t size, a_void_t (*dtor)(a_vptr_t));
+
+/*!
+ @brief modify element number for a pointer to string structure
+ @param[in] ctx points to an instance of string structure
+ @param[in] num number of all elements in the vector
+ @param[in] dtor previous element destructor
+ @return the execution state of the function
+  @retval 0 success
+  @retval 1 failure
+*/
+A_EXTERN a_int_t a_vec_make(a_vec_s *ctx, a_size_t num, a_void_t (*dtor)(a_vptr_t));
 
 /*!
- @brief drop all the elements for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief drop all the elements for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] dtor current element destructor
 */
-A_PUBLIC a_void_t a_arr_drop(a_arr_s *ctx, a_void_t (*dtor)(a_vptr_t));
+A_EXTERN a_void_t a_vec_drop(a_vec_s *ctx, a_void_t (*dtor)(a_vptr_t));
 
 /*!
- @brief swap elements lhs and rhs for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief swap elements lhs and rhs for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] lhs element index on the left
  @param[in] rhs element index on the right
 */
-A_PUBLIC a_void_t a_arr_swap(const a_arr_s *ctx, a_size_t lhs, a_size_t rhs);
+A_EXTERN a_void_t a_vec_swap(a_vec_s const *ctx, a_size_t lhs, a_size_t rhs);
 
 /*!
- @brief sort all elements for a pointer to array structure
- @param[in] ctx points to an instance of array structure
+ @brief sort all elements for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_arr_sort(const a_arr_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_vec_sort(a_vec_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
- @brief insert sort foremost element for a pointer to array structure
+ @brief insert sort foremost element for a pointer to vector structure
  @code{.c}
- T *obj = a_arr_push_fore(T, ctx);
+ T *obj = a_vec_push_fore(T, ctx);
  if (obj)
  {
      CTOR(obj);
      INIT(obj);
-     a_arr_sort_fore(ctx, cmp);
+     a_vec_sort_fore(ctx, cmp);
  }
  @endcode
- @param[in] ctx points to an instance of array structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_arr_sort_fore(const a_arr_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_vec_sort_fore(a_vec_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
- @brief insert sort backmost element for a pointer to array structure
+ @brief insert sort backmost element for a pointer to vector structure
  @code{.c}
- T *obj = a_arr_push_back(T, ctx);
+ T *obj = a_vec_push_back(T, ctx);
  if (obj)
  {
      CTOR(obj);
      INIT(obj);
-     a_arr_sort_back(ctx, cmp);
+     a_vec_sort_back(ctx, cmp);
  }
  @endcode
- @param[in] ctx points to an instance of array structure
+ @param[in] ctx points to an instance of vector structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_arr_sort_back(const a_arr_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_vec_sort_back(a_vec_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
- @brief search the given element in this array
- @param[in] ctx points to an instance of array structure
+ @brief search the given element in this vector
+ @param[in] ctx points to an instance of vector structure
  @param[in] obj object that serves as key for the search
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
  @return matching element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_arr_search(const a_arr_s *ctx, a_cptr_t obj, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_vptr_t a_vec_search(a_vec_s const *ctx, a_cptr_t obj, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
- @brief insert an element into the array
- @param[in] ctx points to an instance of array structure
- @param[in] idx index of element in this array
-  @arg 0 @ref a_arr_push_fore
-  @arg n @ref a_arr_push_back
+ @brief insert an element into the vector
+ @param[in] ctx points to an instance of vector structure
+ @param[in] idx index of element in this vector
+  @arg 0 a_vec_push_fore
+  @arg n a_vec_push_back
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_arr_insert(a_arr_s *ctx, a_size_t idx);
+A_EXTERN a_vptr_t a_vec_insert(a_vec_s *ctx, a_size_t idx);
 
 /*!
- @brief remove an element from the array
- @param[in] ctx points to an instance of array structure
- @param[in] idx index of element in this array
-  @arg 0 @ref a_arr_pull_fore
-  @arg n @ref a_arr_pull_back
+ @brief remove an element from the vector
+ @param[in] ctx points to an instance of vector structure
+ @param[in] idx index of element in this vector
+  @arg 0 a_vec_pull_fore
+  @arg n a_vec_pull_back
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_arr_remove(a_arr_s *ctx, a_size_t idx);
+A_EXTERN a_vptr_t a_vec_remove(a_vec_s *ctx, a_size_t idx);
 
 /*!
- @brief push an element into the array forward
- @param[in] ctx points to an instance of array structure
+ @brief push an element into the vector forward
+ @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_arr_push_fore(a_arr_s *ctx);
+A_EXTERN a_vptr_t a_vec_push_fore(a_vec_s *ctx);
 
 /*!
- @brief push an element into the array backward
- @param[in] ctx points to an instance of array structure
+ @brief push an element into the vector backward
+ @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_arr_push_back(a_arr_s *ctx);
+A_EXTERN a_vptr_t a_vec_push_back(a_vec_s *ctx);
 
 /*!
- @brief pull an element from the array forward
- @param[in] ctx points to an instance of array structure
+ @brief pull an element from the vector forward
+ @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_arr_pull_fore(a_arr_s *ctx);
+A_EXTERN a_vptr_t a_vec_pull_fore(a_vec_s *ctx);
 
 /*!
- @brief pull an element from the array backward
- @param[in] ctx points to an instance of array structure
+ @brief pull an element from the vector backward
+ @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_arr_pull_back(a_arr_s *ctx);
+A_EXTERN a_vptr_t a_vec_pull_back(a_vec_s *ctx);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*!
- @brief push an element into the array
- @param[in] ctx points to an instance of array structure
+ @brief push an element into the vector
+ @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_INTERN a_vptr_t a_arr_push(a_arr_s *ctx) { return a_arr_push_back(ctx); }
+A_INTERN a_vptr_t a_vec_push(a_vec_s *ctx) { return a_vec_push_back(ctx); }
 
 /*!
- @brief pull an element from the array
- @param[in] ctx points to an instance of array structure
+ @brief pull an element from the vector
+ @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_INTERN a_vptr_t a_arr_pull(a_arr_s *ctx) { return a_arr_pull_back(ctx); }
+A_INTERN a_vptr_t a_vec_pull(a_vec_s *ctx) { return a_vec_pull_back(ctx); }
 
 /*!
- @brief iterate over a array
+ @brief iterate over a vector
  @code{.c}
- a_arr_forenum(i, ctx)
+ a_vec_forenum(i, ctx)
  {
-     T *it = (T *)a_arr_at(ctx, i);
-     assert(a_arr_get(ctx) == sizeof(*it));
+     T *it = (T *)a_vec_at(ctx, i);
+     assert(a_vec_get(ctx) == sizeof(*it));
  }
  @endcode
- @param i index of elements in the array
- @param ctx points to an instance of array structure
+ @param i index of elements in the vector
+ @param ctx points to an instance of vector structure
 */
-#define a_arr_forenum(i, ctx) a_forenum(a_size_t, i, (ctx)->_num)
+#define a_vec_forenum(i, ctx) a_forenum(a_size_t, i, (ctx)->_num)
 
 /*!
- @brief iterate over a array in reverse
+ @brief iterate over a vector in reverse
  @code{.c}
- a_arr_forenum_reverse(i, ctx)
+ a_vec_forenum_reverse(i, ctx)
  {
-     T *it = (T *)a_arr_at(ctx, i);
-     assert(a_arr_get(ctx) == sizeof(*it));
+     T *it = (T *)a_vec_at(ctx, i);
+     assert(a_vec_get(ctx) == sizeof(*it));
  }
  @endcode
- @param i index of elements in the array
- @param ctx points to an instance of array structure
+ @param i index of elements in the vector
+ @param ctx points to an instance of vector structure
 */
-#define a_arr_forenum_reverse(i, ctx) a_forenum_reverse(a_size_t, i, (ctx)->_num)
+#define a_vec_forenum_reverse(i, ctx) a_forenum_reverse(a_size_t, i, (ctx)->_num)
 
 /*!
- @brief iterate over a array
+ @brief iterate over a vector
  @code{.c}
- a_arr_foreach(T, it, ctx)
+ a_vec_foreach(T, it, ctx)
  {
-     assert(a_arr_get(ctx) == sizeof(*it));
+     assert(a_vec_get(ctx) == sizeof(*it));
  }
  @endcode
- @param T type of elements in the array
- @param it the &a_arr_s to use as a loop counter
- @param ctx points to an instance of array structure
+ @param T type of elements in the vector
+ @param it the &a_vec_s to use as a loop counter
+ @param ctx points to an instance of vector structure
 */
-#define a_arr_foreach(T, it, ctx) a_foreach(T, it, (ctx)->_ptr, (ctx)->_num)
+#define a_vec_foreach(T, it, ctx) a_foreach(T, it, (ctx)->_ptr, (ctx)->_num)
 
 /*!
- @brief iterate over a array in reverse
+ @brief iterate over a vector in reverse
  @code{.c}
- a_arr_foreach_reverse(T, it, ctx)
+ a_vec_foreach_reverse(T, it, ctx)
  {
-     assert(a_arr_get(ctx) == sizeof(*it));
+     assert(a_vec_get(ctx) == sizeof(*it));
  }
  @endcode
- @param T type of elements in the array
- @param it the &a_arr_s to use as a loop counter
- @param ctx points to an instance of array structure
-*/
-#define a_arr_foreach_reverse(T, it, ctx) a_foreach_reverse(T, it, (ctx)->_ptr, (ctx)->_num)
-
-#define a_arr_ptr(T, ctx) a_cast_s(T *, a_arr_ptr(ctx))
-#define a_arr_end(T, ctx) a_cast_s(T *, a_arr_end(ctx))
-#define a_arr_top(T, ctx) a_cast_s(T *, a_arr_top(ctx))
-#define a_arr_top_(T, ctx) a_cast_s(T *, a_arr_top_(ctx))
-#define a_arr_at(T, ctx, idx) a_cast_s(T *, a_arr_at(ctx, idx))
-#define a_arr_at_(T, ctx, idx) a_cast_s(T *, a_arr_at_(ctx, idx))
-#define a_arr_search(T, ctx, obj, cmp) a_cast_s(T *, a_arr_search(ctx, obj, cmp))
-#define a_arr_insert(T, ctx, idx) a_cast_s(T *, a_arr_insert(ctx, idx))
-#define a_arr_remove(T, ctx, idx) a_cast_s(T *, a_arr_remove(ctx, idx))
-#define a_arr_push_fore(T, ctx) a_cast_s(T *, a_arr_push_fore(ctx))
-#define a_arr_push_back(T, ctx) a_cast_s(T *, a_arr_push_back(ctx))
-#define a_arr_pull_fore(T, ctx) a_cast_s(T *, a_arr_pull_fore(ctx))
-#define a_arr_pull_back(T, ctx) a_cast_s(T *, a_arr_pull_back(ctx))
-#define a_arr_push(T, ctx) a_cast_s(T *, a_arr_push(ctx))
-#define a_arr_pull(T, ctx) a_cast_s(T *, a_arr_pull(ctx))
+ @param T type of elements in the vector
+ @param it the &a_vec_s to use as a loop counter
+ @param ctx points to an instance of vector structure
+*/
+#define a_vec_foreach_reverse(T, it, ctx) a_foreach_reverse(T, it, (ctx)->_ptr, (ctx)->_num)
+
+#define a_vec_ptr(T, ctx) a_cast_s(T *, a_vec_ptr(ctx))
+#define a_vec_end(T, ctx) a_cast_s(T *, a_vec_end(ctx))
+#define a_vec_top(T, ctx) a_cast_s(T *, a_vec_top(ctx))
+#define a_vec_end_(T, ctx) a_cast_s(T *, a_vec_end_(ctx))
+#define a_vec_top_(T, ctx) a_cast_s(T *, a_vec_top_(ctx))
+#define a_vec_at(T, ctx, idx) a_cast_s(T *, a_vec_at(ctx, idx))
+#define a_vec_at_(T, ctx, idx) a_cast_s(T *, a_vec_at_(ctx, idx))
+#define a_vec_idx(T, ctx, idx) a_cast_s(T *, a_vec_idx(ctx, idx))
+#define a_vec_search(T, ctx, obj, cmp) a_cast_s(T *, a_vec_search(ctx, obj, cmp))
+#define a_vec_insert(T, ctx, idx) a_cast_s(T *, a_vec_insert(ctx, idx))
+#define a_vec_remove(T, ctx, idx) a_cast_s(T *, a_vec_remove(ctx, idx))
+#define a_vec_push_fore(T, ctx) a_cast_s(T *, a_vec_push_fore(ctx))
+#define a_vec_push_back(T, ctx) a_cast_s(T *, a_vec_push_back(ctx))
+#define a_vec_pull_fore(T, ctx) a_cast_s(T *, a_vec_pull_fore(ctx))
+#define a_vec_pull_back(T, ctx) a_cast_s(T *, a_vec_pull_back(ctx))
+#define a_vec_push(T, ctx) a_cast_s(T *, a_vec_push(ctx))
+#define a_vec_pull(T, ctx) a_cast_s(T *, a_vec_pull(ctx))
 
-/*! @} A_ARR */
+/*! @} A_VEC */
 
-#endif /* A_ARR_H */
+#endif /* host/vec.h */
```

### Comparing `liba-0.1.1rc4/include/a/complex.h` & `liba-0.1.1rc5/include/a/complex.h`

 * *Files 18% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file complex.h
  @brief complex number
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_COMPLEX_H
-#define A_COMPLEX_H
+#ifndef LIBA_COMPLEX_H
+#define LIBA_COMPLEX_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_COMPLEX complex number
  @{
@@ -59,362 +58,370 @@
     a_real_t real; //!< real part of complex number
     a_real_t imag; //!< imaginary part of complex number
 } a_complex_s;
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
+#if defined(LIBA_COMPLEX_C)
+#undef A_INTERN
+#define A_INTERN A_INLINE
+#endif /* LIBA_COMPLEX_C */
 
 /*!
  @brief constructs a complex number from polar form
  @param r a distance from a reference point
  @param theta an angle from a reference direction
  @return = \f$ (r\cos\theta,r\sin\theta{i}) \f$
 */
-A_PUBLIC a_complex_s a_complex_polar(a_real_t r, a_real_t theta);
+A_EXTERN a_complex_s a_complex_polar(a_real_t r, a_real_t theta);
 
 /* Properties of complex numbers */
 
 /*!
  @brief computes the natural logarithm of magnitude of a complex number
  @param z a complex number
  @return = \f$ \log\left|x\right| \f$
 */
-A_PUBLIC a_real_t a_complex_logabs(a_complex_s z);
+A_EXTERN a_real_t a_complex_logabs(a_complex_s z);
 
 /*!
  @brief computes the squared magnitude of a complex number
  @param z a complex number
  @return = \f$ a^2+b^2 \f$
 */
-A_PUBLIC a_real_t a_complex_abs2(a_complex_s z);
+A_EXTERN a_real_t a_complex_abs2(a_complex_s z);
 
 /*!
  @brief computes the magnitude of a complex number
  @param z a complex number
  @return = \f$ \sqrt{a^2+b^2} \f$
 */
-A_PUBLIC a_real_t a_complex_abs(a_complex_s z);
+A_EXTERN a_real_t a_complex_abs(a_complex_s z);
 
 /*!
  @brief computes the phase angle of a complex number
  @param z a complex number
  @return = \f$ \arctan\frac{b}{a} \f$
 */
-A_PUBLIC a_real_t a_complex_arg(a_complex_s z);
+A_EXTERN a_real_t a_complex_arg(a_complex_s z);
 
 /* Complex arithmetic operators */
 
 /*!
  @brief computes the complex conjugate
  @param z a complex number
  @return = \f$ (a,-b{i}) \f$
 */
-#if !defined A_HAVE_INLINE || defined(A_COMPLEX_I)
-A_PUBLIC a_complex_s a_complex_conj(a_complex_s z);
+#if !defined A_HAVE_INLINE || defined(LIBA_COMPLEX_C)
+A_EXTERN a_complex_s a_complex_conj(a_complex_s z);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_COMPLEX_I)
+#if defined(A_HAVE_INLINE) || defined(LIBA_COMPLEX_C)
 A_INTERN a_complex_s a_complex_conj(a_complex_s z)
 {
     z.imag = -z.imag;
     return z;
 }
 #endif /* A_HAVE_INLINE */
 
 /*!
  @brief computes the complex negative
  @param z a complex number
  @return \f$ (-a,-b{i}) \f$
 */
-#if !defined A_HAVE_INLINE || defined(A_COMPLEX_I)
-A_PUBLIC a_complex_s a_complex_neg(a_complex_s z);
+#if !defined A_HAVE_INLINE || defined(LIBA_COMPLEX_C)
+A_EXTERN a_complex_s a_complex_neg(a_complex_s z);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_COMPLEX_I)
+#if defined(A_HAVE_INLINE) || defined(LIBA_COMPLEX_C)
 A_INTERN a_complex_s a_complex_neg(a_complex_s z)
 {
     z.real = -z.real;
     z.imag = -z.imag;
     return z;
 }
 #endif /* A_HAVE_INLINE */
 
 /*!
  @brief addition of complex numbers \f[ (a+b i)+(c+d i)=(a+c)+(b+d)i \f]
  @param x complex number on the left
  @param y complex number on the right
  @return = \f$ x + y \f$
 */
-A_PUBLIC a_complex_s a_complex_add(a_complex_s x, a_complex_s y);
-A_PUBLIC a_complex_s a_complex_add_real(a_complex_s x, a_real_t y);
-A_PUBLIC a_complex_s a_complex_add_imag(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_add(a_complex_s x, a_complex_s y);
+A_EXTERN a_complex_s a_complex_add_real(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_add_imag(a_complex_s x, a_real_t y);
 
 /*!
  @brief subtraction of complex numbers \f[ (a+b i)-(c+d i)=(a-c)+(b-d)i \f]
  @param x complex number on the left
  @param y complex number on the right
  @return = \f$ x - y \f$
 */
-A_PUBLIC a_complex_s a_complex_sub(a_complex_s x, a_complex_s y);
-A_PUBLIC a_complex_s a_complex_sub_real(a_complex_s x, a_real_t y);
-A_PUBLIC a_complex_s a_complex_sub_imag(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_sub(a_complex_s x, a_complex_s y);
+A_EXTERN a_complex_s a_complex_sub_real(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_sub_imag(a_complex_s x, a_real_t y);
 
 /*!
  @brief multiplication of complex numbers \f[ (a+b i)(c+d i)=a c+b c i+a d i+b d i^{2}=(a c-b d)+(b c+a d) i \f]
  @param x complex number on the left
  @param y complex number on the right
  @return = \f$ x \times y \f$
 */
-A_PUBLIC a_complex_s a_complex_mul(a_complex_s x, a_complex_s y);
-A_PUBLIC a_complex_s a_complex_mul_real(a_complex_s x, a_real_t y);
-A_PUBLIC a_complex_s a_complex_mul_imag(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_mul(a_complex_s x, a_complex_s y);
+A_EXTERN a_complex_s a_complex_mul_real(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_mul_imag(a_complex_s x, a_real_t y);
 
 /*!
  @brief division of complex numbers \f[ \frac{(a+b i)}{(c+d i)}=\frac{(a+b i)(c-d i)}{(c+d i)(c-d i)}=\frac{a c+b c i-a d i-b d i^{2}}{c^{2}-(d i)^{2}}=\frac{(a c+b d)+(b c-a d) i}{c^{2}+d^{2}}=\left(\frac{a c+b d}{c^{2}+d^{2}}\right)+\left(\frac{b c-a d}{c^{2}+d^{2}}\right) i \f]
  @param x complex number on the left
  @param y complex number on the right
  @return = \f$ x \div y \f$
 */
-A_PUBLIC a_complex_s a_complex_div(a_complex_s x, a_complex_s y);
-A_PUBLIC a_complex_s a_complex_div_real(a_complex_s x, a_real_t y);
-A_PUBLIC a_complex_s a_complex_div_imag(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_div(a_complex_s x, a_complex_s y);
+A_EXTERN a_complex_s a_complex_div_real(a_complex_s x, a_real_t y);
+A_EXTERN a_complex_s a_complex_div_imag(a_complex_s x, a_real_t y);
 
 /*!
  @brief inverse of a complex number \f[ \frac{a-bi}{a^2+b^2}=\left(\frac{a}{a^2+b^2}\right)-\left(\frac{b}{a^2+b^2}\right)i \f]
  @param z a complex number
  @return inverse or reciprocal \f$ \frac{1}{z} \f$
 */
-A_PUBLIC a_complex_s a_complex_inv(a_complex_s z);
+A_EXTERN a_complex_s a_complex_inv(a_complex_s z);
 
 /* Elementary Complex Functions */
 
 /*!
  @brief square root of a complex number
  @param z a complex number
  @return = \f$ \sqrt{z} \f$
 */
-A_PUBLIC a_complex_s a_complex_sqrt(a_complex_s z);
+A_EXTERN a_complex_s a_complex_sqrt(a_complex_s z);
 
 /*!
  @brief complex square root of a real number
  @param x a real number
  @return = \f$ \sqrt{x} \f$
 */
-A_PUBLIC a_complex_s a_complex_sqrt_real(a_real_t x);
+A_EXTERN a_complex_s a_complex_sqrt_real(a_real_t x);
 
 /*!
  @brief complex number z raised to complex power a
  @param z a complex number
  @param a a complex number
  @return = \f$ z^a \f$
 */
-A_PUBLIC a_complex_s a_complex_pow(a_complex_s z, a_complex_s a);
+A_EXTERN a_complex_s a_complex_pow(a_complex_s z, a_complex_s a);
 
 /*!
  @brief complex number z raised to real power a
  @param z a complex number
  @param a a real number
  @return = \f$ z^a \f$
 */
-A_PUBLIC a_complex_s a_complex_pow_real(a_complex_s z, a_real_t a);
+A_EXTERN a_complex_s a_complex_pow_real(a_complex_s z, a_real_t a);
 
 /*!
  @brief computes the complex base-e exponential
  @param z a complex number
  @return = \f$ e^z \f$
 */
-A_PUBLIC a_complex_s a_complex_exp(a_complex_s z);
+A_EXTERN a_complex_s a_complex_exp(a_complex_s z);
 
 /*!
  @brief computes the complex natural logarithm
  @param z a complex number
  @return = \f$ \ln{z} \f$
 */
-A_PUBLIC a_complex_s a_complex_log(a_complex_s z);
+A_EXTERN a_complex_s a_complex_log(a_complex_s z);
 /*!
  @brief computes the complex base-2 logarithm
  @param z a complex number
  @return = \f$ \log_{2}{z} \f$
 */
-A_PUBLIC a_complex_s a_complex_log2(a_complex_s z);
+A_EXTERN a_complex_s a_complex_log2(a_complex_s z);
 /*!
  @brief computes the complex base-10 logarithm
  @param z a complex number
  @return = \f$ \lg{z} \f$
 */
-A_PUBLIC a_complex_s a_complex_log10(a_complex_s z);
+A_EXTERN a_complex_s a_complex_log10(a_complex_s z);
 /*!
  @brief computes the complex base-b logarithm
  @param z a complex number
  @param b a complex number
  @return = \f$ \log_{b}{z} \f$
 */
-A_PUBLIC a_complex_s a_complex_logb(a_complex_s z, a_complex_s b);
+A_EXTERN a_complex_s a_complex_logb(a_complex_s z, a_complex_s b);
 
 /* Complex Trigonometric Functions */
 
 /*!
  @brief computes the complex sine \f[ \sin(z)=\frac{\exp(z{i})-\exp(-z{i})}{2{i}} \f]
  @param z a complex number
  @return = \f$ \sin(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_sin(a_complex_s z);
+A_EXTERN a_complex_s a_complex_sin(a_complex_s z);
 /*!
  @brief computes the complex cosine \f[ \cos(z)=\frac{\exp(z{i})+\exp(-z{i})}{2} \f]
  @param z a complex number
  @return = \f$ \cos(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_cos(a_complex_s z);
+A_EXTERN a_complex_s a_complex_cos(a_complex_s z);
 /*!
  @brief computes the complex tangent \f[ \tan(z)=\frac{\sin(z)}{\cos(z)} \f]
  @param z a complex number
  @return = \f$ \tan(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_tan(a_complex_s z);
+A_EXTERN a_complex_s a_complex_tan(a_complex_s z);
 /*!
  @brief computes the complex secant \f[ \sec(z)=\frac{1}{\cos(z)} \f]
  @param z a complex number
  @return = \f$ \sec(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_sec(a_complex_s z);
+A_EXTERN a_complex_s a_complex_sec(a_complex_s z);
 /*!
  @brief computes the complex cosecant \f[ \csc(z)=\frac{1}{\sin(z)} \f]
  @param z a complex number
  @return = \f$ \csc(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_csc(a_complex_s z);
+A_EXTERN a_complex_s a_complex_csc(a_complex_s z);
 /*!
  @brief computes the complex cotangent \f[ \cot(z)=\frac{1}{\tan(z)} \f]
  @param z a complex number
  @return = \f$ \cot(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_cot(a_complex_s z);
+A_EXTERN a_complex_s a_complex_cot(a_complex_s z);
 
 /* Inverse Complex Trigonometric Functions */
 
 /*!
  @brief computes the complex arc sine
  @param z a complex number
  @return = \f$ \arcsin(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_asin(a_complex_s z);
-A_PUBLIC a_complex_s a_complex_asin_real(a_real_t x);
+A_EXTERN a_complex_s a_complex_asin(a_complex_s z);
+A_EXTERN a_complex_s a_complex_asin_real(a_real_t x);
 /*!
  @brief computes the complex arc cosine
  @param z a complex number
  @return = \f$ \arccos(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_acos(a_complex_s z);
-A_PUBLIC a_complex_s a_complex_acos_real(a_real_t x);
+A_EXTERN a_complex_s a_complex_acos(a_complex_s z);
+A_EXTERN a_complex_s a_complex_acos_real(a_real_t x);
 /*!
  @brief computes the complex arc tangent
  @param z a complex number
  @return = \f$ \arctan(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_atan(a_complex_s z);
+A_EXTERN a_complex_s a_complex_atan(a_complex_s z);
 /*!
  @brief computes the complex arc secant \f[ \mathrm{arcsec}(z)=\mathrm{arccos}(\frac{1}{z}) \f]
  @param z a complex number
  @return = \f$ \mathrm{arcsec}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_asec(a_complex_s z);
-A_PUBLIC a_complex_s a_complex_asec_real(a_real_t x);
+A_EXTERN a_complex_s a_complex_asec(a_complex_s z);
+A_EXTERN a_complex_s a_complex_asec_real(a_real_t x);
 /*!
  @brief computes the complex arc cosecant \f[ \mathrm{arccsc}(z)=\mathrm{arcsin}(\frac{1}{z}) \f]
  @param z a complex number
  @return = \f$ \mathrm{arccsc}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_acsc(a_complex_s z);
-A_PUBLIC a_complex_s a_complex_acsc_real(a_real_t x);
+A_EXTERN a_complex_s a_complex_acsc(a_complex_s z);
+A_EXTERN a_complex_s a_complex_acsc_real(a_real_t x);
 /*!
  @brief computes the complex arc cotangent \f[ \mathrm{arccot}(z)=\mathrm{arctan}(\frac{1}{z}) \f]
  @param z a complex number
  @return = \f$ \mathrm{arccot}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_acot(a_complex_s z);
+A_EXTERN a_complex_s a_complex_acot(a_complex_s z);
 
 /* Complex Hyperbolic Functions */
 
 /*!
  @brief computes the complex hyperbolic sine \f[ \sinh(z)=\frac{\exp(z)-\exp(-z)}{2} \f]
  @param z a complex number
  @return = \f$ \sinh(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_sinh(a_complex_s z);
+A_EXTERN a_complex_s a_complex_sinh(a_complex_s z);
 /*!
  @brief computes the complex hyperbolic cosine \f[ \cosh(z)=\frac{\exp(z)+\exp(-z)}{2} \f]
  @param z a complex number
  @return = \f$ \cosh(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_cosh(a_complex_s z);
+A_EXTERN a_complex_s a_complex_cosh(a_complex_s z);
 /*!
  @brief computes the complex hyperbolic tangent \f[ \tanh(z)=\frac{\sinh(z)}{\cosh(z)} \f]
  @param z a complex number
  @return = \f$ \tanh(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_tanh(a_complex_s z);
+A_EXTERN a_complex_s a_complex_tanh(a_complex_s z);
 /*!
  @brief computes the complex hyperbolic secant \f[ \mathrm{sech}(z)=\frac{1}{\cosh(z)} \f]
  @param z a complex number
  @return = \f$ \mathrm{sech}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_sech(a_complex_s z);
+A_EXTERN a_complex_s a_complex_sech(a_complex_s z);
 /*!
  @brief computes the complex hyperbolic cosecant \f[ \mathrm{csch}(z)=\frac{1}{\sinh(z)} \f]
  @param z a complex number
  @return = \f$ \mathrm{csch}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_csch(a_complex_s z);
+A_EXTERN a_complex_s a_complex_csch(a_complex_s z);
 /*!
  @brief computes the complex hyperbolic cotangent \f[ \mathrm{coth}(z)=\frac{1}{\tanh(z)} \f]
  @param z a complex number
  @return = \f$ \mathrm{coth}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_coth(a_complex_s z);
+A_EXTERN a_complex_s a_complex_coth(a_complex_s z);
 
 /* Inverse Complex Hyperbolic Functions */
 
 /*!
  @brief computes the complex arc hyperbolic sine
  @param z a complex number
  @return = \f$ \mathrm{arcsinh}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_asinh(a_complex_s z);
+A_EXTERN a_complex_s a_complex_asinh(a_complex_s z);
 /*!
  @brief computes the complex arc hyperbolic cosine \f[ \mathrm{arccosh}(z)=\log(z-\sqrt{z^2-1}) \f]
  @param z a complex number
  @return = \f$ \mathrm{arccosh}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_acosh(a_complex_s z);
-A_PUBLIC a_complex_s a_complex_acosh_real(a_real_t x);
+A_EXTERN a_complex_s a_complex_acosh(a_complex_s z);
+A_EXTERN a_complex_s a_complex_acosh_real(a_real_t x);
 /*!
  @brief computes the complex arc hyperbolic tangent
  @param z a complex number
  @return = \f$ \mathrm{arctanh}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_atanh(a_complex_s z);
-A_PUBLIC a_complex_s a_complex_atanh_real(a_real_t x);
+A_EXTERN a_complex_s a_complex_atanh(a_complex_s z);
+A_EXTERN a_complex_s a_complex_atanh_real(a_real_t x);
 /*!
  @brief computes the complex arc hyperbolic secant \f[ \mathrm{arcsech}(z)=\mathrm{arccosh}(\frac{1}{z}) \f]
  @param z a complex number
  @return = \f$ \mathrm{arcsech}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_asech(a_complex_s z);
+A_EXTERN a_complex_s a_complex_asech(a_complex_s z);
 /*!
  @brief computes the complex arc hyperbolic cosecant \f[ \mathrm{arccsch}(z)=\mathrm{arcsinh}(\frac{1}{z}) \f]
  @param z a complex number
  @return = \f$ \mathrm{arccsch}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_acsch(a_complex_s z);
+A_EXTERN a_complex_s a_complex_acsch(a_complex_s z);
 /*!
  @brief computes the complex arc hyperbolic cotangent \f[ \mathrm{arccoth}(z)=\mathrm{arctanh}(\frac{1}{z}) \f]
  @param z a complex number
  @return = \f$ \mathrm{arccoth}(z) \f$
 */
-A_PUBLIC a_complex_s a_complex_acoth(a_complex_s z);
+A_EXTERN a_complex_s a_complex_acoth(a_complex_s z);
 
+#if defined(LIBA_COMPLEX_C)
+#undef A_INTERN
+#define A_INTERN static A_INLINE
+#endif /* LIBA_COMPLEX_C */
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_COMPLEX */
 
-#endif /* A_COMPLEX_H */
+#endif /* complex.h */
```

### Comparing `liba-0.1.1rc4/include/a/crc.h` & `liba-0.1.1rc5/include/a/crc.h`

 * *Files 25% similar despite different names*

```diff
@@ -1,16 +1,15 @@
 /*!
  @file crc.h
  @brief Cyclic Redundancy Check
  @details https://en.wikipedia.org/wiki/Cyclic_redundancy_check
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_CRC_H
-#define A_CRC_H
+#ifndef LIBA_CRC_H
+#define LIBA_CRC_H
 
 #include "a.h"
 
 #define A_CRC_SIZ 0x100
 
 #define A_CRC8_POLY A_U8_C(0x31)
 #define A_CRC8_INIT A_U8_C(0x00)
@@ -24,31 +23,31 @@
 #define A_CRC64_POLY A_U64_C(0x42F0E1EBA9EA3693)
 #define A_CRC64_INIT A_U64_C(0xFFFFFFFFFFFFFFFF)
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
-A_PUBLIC a_void_t a_crc8l_init(a_u8_t ctx[A_CRC_SIZ], a_u8_t poly);
-A_PUBLIC a_void_t a_crc8h_init(a_u8_t ctx[A_CRC_SIZ], a_u8_t poly);
-A_PUBLIC a_u8_t a_crc8(const a_u8_t ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u8_t val);
-
-A_PUBLIC a_void_t a_crc16l_init(a_u16_t ctx[A_CRC_SIZ], a_u16_t poly);
-A_PUBLIC a_void_t a_crc16h_init(a_u16_t ctx[A_CRC_SIZ], a_u16_t poly);
-A_PUBLIC a_u16_t a_crc16l(const a_u16_t ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u16_t val);
-A_PUBLIC a_u16_t a_crc16h(const a_u16_t ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u16_t val);
-
-A_PUBLIC a_void_t a_crc32l_init(a_u32_t ctx[A_CRC_SIZ], a_u32_t poly);
-A_PUBLIC a_void_t a_crc32h_init(a_u32_t ctx[A_CRC_SIZ], a_u32_t poly);
-A_PUBLIC a_u32_t a_crc32l(const a_u32_t ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u32_t val);
-A_PUBLIC a_u32_t a_crc32h(const a_u32_t ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u32_t val);
-
-A_PUBLIC a_void_t a_crc64l_init(a_u64_t ctx[A_CRC_SIZ], a_u64_t poly);
-A_PUBLIC a_void_t a_crc64h_init(a_u64_t ctx[A_CRC_SIZ], a_u64_t poly);
-A_PUBLIC a_u64_t a_crc64l(const a_u64_t ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u64_t val);
-A_PUBLIC a_u64_t a_crc64h(const a_u64_t ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u64_t val);
+A_EXTERN a_void_t a_crc8l_init(a_u8_t ctx[A_CRC_SIZ], a_u8_t poly);
+A_EXTERN a_void_t a_crc8h_init(a_u8_t ctx[A_CRC_SIZ], a_u8_t poly);
+A_EXTERN a_u8_t a_crc8(a_u8_t const ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u8_t val);
+
+A_EXTERN a_void_t a_crc16l_init(a_u16_t ctx[A_CRC_SIZ], a_u16_t poly);
+A_EXTERN a_void_t a_crc16h_init(a_u16_t ctx[A_CRC_SIZ], a_u16_t poly);
+A_EXTERN a_u16_t a_crc16l(a_u16_t const ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u16_t val);
+A_EXTERN a_u16_t a_crc16h(a_u16_t const ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u16_t val);
+
+A_EXTERN a_void_t a_crc32l_init(a_u32_t ctx[A_CRC_SIZ], a_u32_t poly);
+A_EXTERN a_void_t a_crc32h_init(a_u32_t ctx[A_CRC_SIZ], a_u32_t poly);
+A_EXTERN a_u32_t a_crc32l(a_u32_t const ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u32_t val);
+A_EXTERN a_u32_t a_crc32h(a_u32_t const ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u32_t val);
+
+A_EXTERN a_void_t a_crc64l_init(a_u64_t ctx[A_CRC_SIZ], a_u64_t poly);
+A_EXTERN a_void_t a_crc64h_init(a_u64_t ctx[A_CRC_SIZ], a_u64_t poly);
+A_EXTERN a_u64_t a_crc64l(a_u64_t const ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u64_t val);
+A_EXTERN a_u64_t a_crc64h(a_u64_t const ctx[A_CRC_SIZ], a_cptr_t pdata, a_size_t nbyte, a_u64_t val);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
-#endif /* A_CRC_H */
+#endif /* crc.h */
```

### Comparing `liba-0.1.1rc4/include/a/fpid.h` & `liba-0.1.1rc5/include/a/fpid.h`

 * *Files 10% similar despite different names*

```diff
@@ -1,296 +1,278 @@
 /*!
  @file fpid.h
  @brief fuzzy proportional integral derivative controller
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_FPID_H
-#define A_FPID_H
+#ifndef LIBA_FPID_H
+#define LIBA_FPID_H
 
 #include "mf.h"
 #include "pid.h"
 #include "fuzzy.h"
 
 /*!
  @ingroup A
  @addtogroup A_FPID fuzzy proportional integral derivative controller
  @{
 */
 
-#define A_FPID_FUZZY_BITS 4
+#define A_FPID_FUZZY_BITS 4 // 00111100
 #define A_FPID_FUZZY_BITL A_PID_MODE_BITS
 #define A_FPID_FUZZY_BITH (A_FPID_FUZZY_BITS + A_FPID_FUZZY_BITL)
 #define A_FPID_FUZZY_MASK (~((1U << A_FPID_FUZZY_BITL) - 1U) & ((1U << A_FPID_FUZZY_BITH) - 1U))
 
 /*!
  @brief instance enumeration for fuzzy PID controller operator
 */
 typedef enum a_fpid_e
 {
     A_FPID_EQU,
-    A_FPID_AND = (1 << (A_FPID_FUZZY_BITL + 2)),
+    A_FPID_AND = (1 << (A_FPID_FUZZY_BITL + 2)), // 00010000 + 0100 * 0
     A_FPID_AND_DEFAULT = A_FPID_AND + (A_FUZZY_DEFAULT << A_FPID_FUZZY_BITL),
     A_FPID_AND_ALGEBRA = A_FPID_AND + (A_FUZZY_ALGEBRA << A_FPID_FUZZY_BITL),
     A_FPID_AND_BOUNDED = A_FPID_AND + (A_FUZZY_BOUNDED << A_FPID_FUZZY_BITL),
-    A_FPID_OR = (1 << (A_FPID_FUZZY_BITL + 3)),
+    A_FPID_OR = (1 << (A_FPID_FUZZY_BITL + 3)), // 00100000 + 0100 * 0
     A_FPID_OR_DEFAULT = A_FPID_OR + (A_FUZZY_DEFAULT << A_FPID_FUZZY_BITL),
     A_FPID_OR_ALGEBRA = A_FPID_OR + (A_FUZZY_ALGEBRA << A_FPID_FUZZY_BITL),
     A_FPID_OR_BOUNDED = A_FPID_OR + (A_FUZZY_BOUNDED << A_FPID_FUZZY_BITL)
 } a_fpid_e;
 
 /*!
  @brief instance structure for fuzzy PID controller
 */
 typedef struct a_fpid_s
 {
-    a_pid_s pid[1]; //!< instance structure for PID controller
+    a_pid_s pid; //!< instance structure for PID controller
 
-    const a_real_t *mmp; //!< points to membership function parameter table, an array terminated by @ref A_MF_NUL
-    const a_real_t *mkp; //!< points to Kp's rule base table, the rule base must be square
-    const a_real_t *mki; //!< points to Ki's rule base table, the rule base must be square
-    const a_real_t *mkd; //!< points to Kd's rule base table, the rule base must be square
-
-    a_uint_t *idx; //!< the memory cache for membership index
-    /*!< the length must be greater than or equal to twice the maximum number triggered by the rule */
-    a_real_t *mms; //!< the memory cache for membership value
-    /*!< the length must be greater than or equal to twice the maximum number triggered by the rule */
-    a_real_t *mat; //!< the memory cache for matrix of the membership outer product of e and ec
-    a_real_t (*op)(a_real_t, a_real_t); //!< fuzzy relational operator
+    a_real_t const *me; //!< points to membership function parameter table, terminated by @ref A_MF_NUL
+    a_real_t const *mec; //!< points to membership function parameter table, terminated by @ref A_MF_NUL
+    a_real_t const *mkp; //!< points to Kp's rule base table, the rule base must be square matrix
+    a_real_t const *mki; //!< points to Ki's rule base table, the rule base must be square matrix
+    a_real_t const *mkd; //!< points to Kd's rule base table, the rule base must be square matrix
 
-    a_real_t sigma; //!< the coefficient of the input, ((num-1)>>1<<1)/(Imax-Imin)
-    a_real_t alpha; //!< the coefficient of the output, (Omax-Omin)/((num-1)>>1<<1)
+    a_uint_t *idx; //!< the memory cache for membership index, >= 2N
+    a_real_t *val; //!< the memory cache for membership value and membership outer product of e and ec, >= (2+N)N
+    a_real_t (*op)(a_real_t, a_real_t); //!< fuzzy relational operator
 
     a_real_t kp; //!< base proportional constant
     a_real_t ki; //!< base integral constant
     a_real_t kd; //!< base derivative constant
 } a_fpid_s;
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
+#if defined(LIBA_FPID_C)
+#undef A_INTERN
+#define A_INTERN A_INLINE
+#endif /* LIBA_FPID_C */
 
-#if !defined A_HAVE_INLINE || defined(A_FPID_I)
-A_PUBLIC a_size_t A_FPID_BUF1(a_uint_t max);
+#if !defined A_HAVE_INLINE || defined(LIBA_FPID_C)
+A_EXTERN a_size_t A_FPID_BUF1(a_uint_t max);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_FPID_I)
-A_INTERN a_size_t A_FPID_BUF1(a_uint_t max)
+#if defined(A_HAVE_INLINE) || defined(LIBA_FPID_C)
+A_INTERN a_size_t A_FPID_BUF1(a_uint_t const max)
 {
-    return (sizeof(a_uint_t) << 1) * max + sizeof(a_real_t) * (max + 2) * max;
+    return sizeof(a_uint_t) * 2 * max + sizeof(a_real_t) * (2 + max) * max;
 }
 #endif /* A_HAVE_INLINE */
-#define A_FPID_BUF1(N) ((sizeof(a_uint_t) << 1) * (N) + sizeof(a_real_t) * ((N) + 2) * (N))
+#define A_FPID_BUF1(N) (sizeof(a_uint_t) * 2 * (N) + sizeof(a_real_t) * (2 + (N)) * (N))
 
-#if !defined A_HAVE_INLINE || defined(A_FPID_I)
-A_PUBLIC a_vptr_t a_fpid_bufptr(const a_fpid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_FPID_C)
+A_EXTERN a_vptr_t a_fpid_bufptr(a_fpid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_FPID_I)
-A_INTERN a_vptr_t a_fpid_bufptr(const a_fpid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_FPID_C)
+A_INTERN a_vptr_t a_fpid_bufptr(a_fpid_s const *const ctx)
 {
     return ctx->idx;
 }
 #endif /* A_HAVE_INLINE */
 #define a_fpid_bufptr(ctx) (ctx)->idx
 
-#if !defined A_HAVE_INLINE || defined(A_FPID_I)
-A_PUBLIC a_uint_t a_fpid_bufnum(const a_fpid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_FPID_C)
+A_EXTERN a_uint_t a_fpid_bufnum(a_fpid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_FPID_I)
-A_INTERN a_uint_t a_fpid_bufnum(const a_fpid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_FPID_C)
+A_INTERN a_uint_t a_fpid_bufnum(a_fpid_s const *const ctx)
 {
-    return ctx->pid->num >> A_PID_NUM_BITS;
+    return ctx->pid.num >> A_PID_NUM_BITS;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_FPID_I)
-A_PUBLIC a_void_t a_fpid_set_bufnum(a_fpid_s *ctx, a_uint_t num);
+#if !defined A_HAVE_INLINE || defined(LIBA_FPID_C)
+A_EXTERN a_void_t a_fpid_set_bufmax(a_fpid_s *ctx, a_uint_t max);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_FPID_I)
-A_INTERN a_void_t a_fpid_set_bufnum(a_fpid_s *ctx, a_uint_t num)
+#if defined(A_HAVE_INLINE) || defined(LIBA_FPID_C)
+A_INTERN a_void_t a_fpid_set_bufmax(a_fpid_s *const ctx, a_uint_t const max)
 {
-    ctx->pid->num &= A_PID_NUM_MASK;
-    ctx->pid->num |= num << A_PID_NUM_BITS;
+    ctx->pid.num &= A_PID_NUM_MASK;
+    ctx->pid.num |= max << A_PID_NUM_BITS;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_FPID_I)
-A_PUBLIC a_uint_t a_fpid_col(const a_fpid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_FPID_C)
+A_EXTERN a_uint_t a_fpid_col(a_fpid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_FPID_I)
-A_INTERN a_uint_t a_fpid_col(const a_fpid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_FPID_C)
+A_INTERN a_uint_t a_fpid_col(a_fpid_s const *const ctx)
 {
-    return ctx->pid->reg >> A_PID_REG_BITS;
+    return ctx->pid.reg >> A_PID_REG_BITS;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_FPID_I)
-A_PUBLIC a_void_t a_fpid_set_col(a_fpid_s *ctx, a_uint_t reg);
+#if !defined A_HAVE_INLINE || defined(LIBA_FPID_C)
+A_EXTERN a_void_t a_fpid_set_col(a_fpid_s *ctx, a_uint_t reg);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_FPID_I)
-A_INTERN a_void_t a_fpid_set_col(a_fpid_s *ctx, a_uint_t reg)
+#if defined(A_HAVE_INLINE) || defined(LIBA_FPID_C)
+A_INTERN a_void_t a_fpid_set_col(a_fpid_s *const ctx, a_uint_t const reg)
 {
-    ctx->pid->reg &= A_PID_REG_MASK;
-    ctx->pid->reg |= reg << A_PID_REG_BITS;
+    ctx->pid.reg &= A_PID_REG_MASK;
+    ctx->pid.reg |= reg << A_PID_REG_BITS;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_FPID_I)
-A_PUBLIC a_uint_t a_fpid_op(const a_fpid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_FPID_C)
+A_EXTERN a_uint_t a_fpid_op(a_fpid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_FPID_I)
-A_INTERN a_uint_t a_fpid_op(const a_fpid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_FPID_C)
+A_INTERN a_uint_t a_fpid_op(a_fpid_s const *const ctx)
 {
-    return ctx->pid->reg & A_FPID_FUZZY_MASK;
+    return ctx->pid.reg & A_FPID_FUZZY_MASK;
 }
 #endif /* A_HAVE_INLINE */
 
-A_PUBLIC a_void_t a_fpid_set_op(a_fpid_s *ctx, a_uint_t op);
+A_EXTERN a_void_t a_fpid_set_op(a_fpid_s *ctx, a_uint_t op);
 
 /*!
  @brief turn off fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
 */
-A_PUBLIC a_fpid_s *a_fpid_off(a_fpid_s *ctx);
+A_EXTERN a_fpid_s *a_fpid_off(a_fpid_s *ctx);
 
 /*!
  @brief incremental fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
 */
-A_PUBLIC a_fpid_s *a_fpid_inc(a_fpid_s *ctx);
+A_EXTERN a_fpid_s *a_fpid_inc(a_fpid_s *ctx);
 
 /*!
  @brief positional fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
  @param[in] max maximum intergral output
 */
-A_PUBLIC a_fpid_s *a_fpid_pos(a_fpid_s *ctx, a_real_t max);
+A_EXTERN a_fpid_s *a_fpid_pos(a_fpid_s *ctx, a_real_t max);
 
 /*!
- @brief set input extreme value for fuzzy PID controller
- @param[in,out] ctx points to an instance of fuzzy PID controller
- @param[in] min mininum input
- @param[in] max maxinum input
-*/
-A_PUBLIC a_fpid_s *a_fpid_ilim(a_fpid_s *ctx, a_real_t min, a_real_t max);
-
-/*!
- @brief set output extreme value for fuzzy PID controller
+ @brief set proportional integral derivative constant for fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
- @param[in] min mininum output
- @param[in] max maxinum output
+ @param[in] kp proportional constant
+ @param[in] ki integral constant
+ @param[in] kd derivative constant
 */
-A_PUBLIC a_fpid_s *a_fpid_olim(a_fpid_s *ctx, a_real_t min, a_real_t max);
+A_EXTERN a_fpid_s *a_fpid_kpid(a_fpid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd);
 
 /*!
  @brief set one cache buffer for fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
  @param[in] ptr points to a buffer at least A_FPID_BUF1(max)
  @param[in] max the maximum number triggered by the rule
 */
-A_PUBLIC a_fpid_s *a_fpid_buf1(a_fpid_s *ctx, a_vptr_t ptr, a_size_t max);
-
-/*!
- @brief set proportional integral derivative constant for fuzzy PID controller
- @param[in,out] ctx points to an instance of fuzzy PID controller
- @param[in] kp proportional constant
- @param[in] ki integral constant
- @param[in] kd derivative constant
-*/
-A_PUBLIC a_fpid_s *a_fpid_kpid(a_fpid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd);
+A_EXTERN a_fpid_s *a_fpid_buf1(a_fpid_s *ctx, a_vptr_t ptr, a_size_t max);
 
 /*!
  @brief set buffer for fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
- @param[in] idx the memory cache for membership index
-  the length must be greater than or equal to twice the maximum number triggered by the rule
- @param[in] mms the memory cache for membership
-  the length must be greater than or equal to twice the maximum number triggered by the rule
- @param[in] mat the memory cache for matrix of the membership outer product of e and ec
-*/
-A_PUBLIC a_fpid_s *a_fpid_buff(a_fpid_s *ctx, a_uint_t *idx, a_real_t *mms, a_real_t *mat);
-#define A_FPID_MAT1(N) (sizeof(a_real_t) * (N) * (N))
-#define A_FPID_MMS1(N) (sizeof(a_real_t) * 2 * (N))
+ @param[in] idx the memory cache for membership index, >= 2N
+ @param[in] val the memory cache for membership value and membership outer product of e and ec, >= (2+N)N
+*/
+A_EXTERN a_fpid_s *a_fpid_buff(a_fpid_s *ctx, a_uint_t *idx, a_real_t *val);
+#define A_FPID_VAL1(N) (sizeof(a_real_t) * (2 + (N)) * (N))
 #define A_FPID_IDX1(N) (sizeof(a_uint_t) * 2 * (N))
-#define A_FPID_MAT(N) ((N) * (N))
-#define A_FPID_MMS(N) (2 * (N))
+#define A_FPID_VAL(N) ((2 + (N)) * (N))
 #define A_FPID_IDX(N) (2 * (N))
 
 /*!
- @brief set buffer for fuzzy PID controller
+ @brief set buffer for multichannel fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
  @param[in] num number of controllers output
  @param[in] out points to controllers output
  @param[in] fdb points to cache feedback buffer
  @param[in] sum points to (integral) output buffer
  @param[in] ec points to error change buffer
  @param[in] e points to error input buffer
 */
-A_PUBLIC a_fpid_s *a_fpid_setp(a_fpid_s *ctx, a_uint_t num, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e);
+A_EXTERN a_fpid_s *a_fpid_chan(a_fpid_s *ctx, a_uint_t num, a_real_t *out, a_real_t *fdb,
+                               a_real_t *sum, a_real_t *ec, a_real_t *e);
 
 /*!
  @brief set rule base for fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
- @param[in] num number of columns in the rule base
- @param[in] mmp points to membership function parameter table, an array terminated by @ref A_MF_NUL
+ @param[in] col number of columns in the rule base
+ @param[in] me points to membership function parameter table, terminated by @ref A_MF_NUL
+ @param[in] mec points to membership function parameter table, terminated by @ref A_MF_NUL
  @param[in] mkp points to Kp's rule base table, the rule base must be square
  @param[in] mki points to Ki's rule base table, the rule base must be square
  @param[in] mkd points to Kd's rule base table, the rule base must be square
 */
-A_PUBLIC a_fpid_s *a_fpid_base(a_fpid_s *ctx, a_uint_t num, const a_real_t *mmp, const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd);
+A_EXTERN a_fpid_s *a_fpid_base(a_fpid_s *ctx, a_uint_t col, a_real_t const *me, a_real_t const *const mec,
+                               a_real_t const *mkp, a_real_t const *mki, a_real_t const *mkd);
 
 /*!
  @brief initialize function for fuzzy PID controller, default setting is off
  @param[in,out] ctx points to an instance of fuzzy PID controller
  @param[in] dt sampling time unit(s)
- @param[in] num number of columns in the rule base
- @param[in] mmp points to membership function parameter table, an array terminated by @ref A_MF_NUL
+ @param[in] col number of columns in the rule base
+ @param[in] me points to membership function parameter table, terminated by @ref A_MF_NUL
+ @param[in] mec points to membership function parameter table, terminated by @ref A_MF_NUL
  @param[in] mkp points to Kp's rule base table, the rule base must be square
  @param[in] mki points to Ki's rule base table, the rule base must be square
  @param[in] mkd points to Kd's rule base table, the rule base must be square
- @param[in] imin mininum input
- @param[in] imax maxinum input
- @param[in] omin mininum output
- @param[in] omax maxinum output
-*/
-A_PUBLIC a_fpid_s *a_fpid_init(a_fpid_s *ctx, a_real_t dt, a_uint_t num, const a_real_t *mmp,
-                               const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd,
-                               a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax);
+ @param[in] min mininum output
+ @param[in] max maxinum output
+*/
+A_EXTERN a_fpid_s *a_fpid_init(a_fpid_s *ctx, a_real_t dt, a_uint_t col, a_real_t const *me, a_real_t const *mec,
+                               a_real_t const *mkp, a_real_t const *mki, a_real_t const *mkd, a_real_t min, a_real_t max);
 
 /*!
  @brief calculate function for fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
  @param[in] set setpoint
  @param[in] fdb feedback
- @return output
+ @return output value
   @retval set when fuzzy PID controller is off
 */
-A_PUBLIC a_real_t a_fpid_outv(a_fpid_s *ctx, a_real_t set, a_real_t fdb);
+A_EXTERN a_real_t a_fpid_outv(a_fpid_s *ctx, a_real_t set, a_real_t fdb);
 
 /*!
- @brief calculate function for fuzzy PID controller
+ @brief calculate function for multichannel fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
  @param[in] set points to setpoint
  @param[in] fdb points to feedback
  @return points to output
   @retval set when fuzzy PID controller is off
 */
-A_PUBLIC a_real_t *a_fpid_outp(a_fpid_s *ctx, a_real_t *set, a_real_t *fdb);
+A_EXTERN a_real_t *a_fpid_outp(a_fpid_s *ctx, a_real_t *set, a_real_t *fdb);
 
 /*!
  @brief terminate function for fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
 */
-A_PUBLIC a_fpid_s *a_fpid_exit(a_fpid_s *ctx);
+A_EXTERN a_fpid_s *a_fpid_exit(a_fpid_s *ctx);
 
 /*!
  @brief zero function for fuzzy PID controller
  @param[in,out] ctx points to an instance of fuzzy PID controller
 */
-A_PUBLIC a_fpid_s *a_fpid_zero(a_fpid_s *ctx);
+A_EXTERN a_fpid_s *a_fpid_zero(a_fpid_s *ctx);
 
+#if defined(LIBA_FPID_C)
+#undef A_INTERN
+#define A_INTERN static A_INLINE
+#endif /* LIBA_FPID_C */
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_FPID */
 
-#endif /* A_FPID_H */
+#endif /* fpid.h */
```

### Comparing `liba-0.1.1rc4/include/a/fuzzy.h` & `liba-0.1.1rc5/include/a/fuzzy.h`

 * *Files 6% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file fuzzy.h
  @brief fuzzy operator
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_FUZZY_H
-#define A_FUZZY_H
+#ifndef LIBA_FUZZY_H
+#define LIBA_FUZZY_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_FUZZY fuzzy operator
  @{
@@ -35,37 +34,37 @@
   @arg 0 fuzzy union
   @arg 1 algebraic sum
   @arg 2 bounded sum
  @param[in] l left-hand operand
  @param[in] r right-hand operand
  @return result of operation
 */
-A_PUBLIC a_real_t a_fuzzy_or(a_uint_t e, a_real_t l, a_real_t r);
+A_EXTERN a_real_t a_fuzzy_or(a_uint_t e, a_real_t l, a_real_t r);
 
 /*!
  @brief Intersection operator
  @param[in] e enumeration of operator
   @arg 0 fuzzy intersection
   @arg 1 algebraic product
   @arg 2 bounded product
  @param[in] l left-hand operand
  @param[in] r right-hand operand
  @return result of operation
 */
-A_PUBLIC a_real_t a_fuzzy_and(a_uint_t e, a_real_t l, a_real_t r);
+A_EXTERN a_real_t a_fuzzy_and(a_uint_t e, a_real_t l, a_real_t r);
 
 /*!
  @brief Equilibrium operator
  @param[in] gamma gamma operator
  @param[in] l left-hand operand
  @param[in] r right-hand operand
  @return result of operation
 */
-A_PUBLIC a_real_t a_fuzzy_equ(a_real_t gamma, a_real_t l, a_real_t r);
+A_EXTERN a_real_t a_fuzzy_equ(a_real_t gamma, a_real_t l, a_real_t r);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_FUZZY */
 
-#endif /* A_FUZZY_H */
+#endif /* fuzzy.h */
```

### Comparing `liba-0.1.1rc4/include/a/host/que.h` & `liba-0.1.1rc5/include/a/host/que.h`

 * *Files 11% similar despite different names*

```diff
@@ -1,190 +1,189 @@
 /*!
  @file que.h
  @brief basic queue library
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_HOST_QUE_H
-#define A_HOST_QUE_H
+#ifndef LIBA_HOST_QUE_H
+#define LIBA_HOST_QUE_H
 
-#include "a/list.h"
-#include <stdlib.h>
+#include "a.h"
+#include "../list.h"
 
 /*!
  @ingroup A
  @addtogroup A_QUE basic queue library
  @{
 */
 
 /*!
  @brief instance structure for basic queue node
 */
 typedef struct a_que_node_s
 {
-    a_list_s _node[1]; /*!< element node */
+    a_list_s _node; /*!< element node */
     a_vptr_t _data; /*!< element data */
 } a_que_node_s;
 
 /*!
  @brief cast a list pointer from another type pointer
  @param[in] obj points to basic queue node
  @return a pointer to basic queue node
 */
-A_INTERN a_que_node_s *a_que_from(a_vptr_t obj) { return a_cast_s(a_que_node_s *, obj); }
+A_INTERN a_que_node_s *a_que_from(a_vptr_t const obj) { return a_cast_s(a_que_node_s *, obj); }
 
 /*!
  @brief instance structure for basic queue
 */
 typedef struct a_que_s
 {
     a_que_node_s **_ptr; /*!< mempool block */
-    a_list_s _head[1]; /*!< element head */
+    a_list_s _head; /*!< element head */
     a_size_t _size; /*!< element sizeof */
     a_size_t _num; /*!< element number */
     a_size_t _cur; /*!< mempool cursor */
     a_size_t _mem; /*!< mempool memory */
 } a_que_s;
 
 /*!
  @brief access size of a element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
 */
-A_INTERN a_size_t a_que_get(const a_que_s *ctx) { return ctx->_size; }
+A_INTERN a_size_t a_que_get(a_que_s const *const ctx) { return ctx->_size; }
 
 /*!
  @brief access number of element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
 */
-A_INTERN a_size_t a_que_num(const a_que_s *ctx) { return ctx->_num; }
+A_INTERN a_size_t a_que_num(a_que_s const *const ctx) { return ctx->_num; }
 
 /*!
  @brief access foremost element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @note should check if queue is empty
  @return element pointer
 */
-A_INTERN a_vptr_t a_que_fore_(const a_que_s *ctx)
+A_INTERN a_vptr_t a_que_fore_(a_que_s const *const ctx)
 {
-    return a_que_from(ctx->_head->next)->_data;
+    return a_que_from(ctx->_head.next)->_data;
 }
 
 /*!
  @brief access backmost element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @note should check if queue is empty
  @return element pointer
 */
-A_INTERN a_vptr_t a_que_back_(const a_que_s *ctx)
+A_INTERN a_vptr_t a_que_back_(a_que_s const *const ctx)
 {
-    return a_que_from(ctx->_head->prev)->_data;
+    return a_que_from(ctx->_head.prev)->_data;
 }
 
 /*!
  @brief access foremost element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @return element pointer
   @retval 0 empty queue
 */
-A_INTERN a_vptr_t a_que_fore(const a_que_s *ctx)
+A_INTERN a_vptr_t a_que_fore(a_que_s const *const ctx)
 {
-    return a_likely(a_list_used(ctx->_head)) ? a_que_fore_(ctx) : A_NULL;
+    return a_likely(a_list_used(&ctx->_head)) ? a_que_fore_(ctx) : A_NULL;
 }
 
 /*!
  @brief access backmost element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @return element pointer
   @retval 0 empty queue
 */
-A_INTERN a_vptr_t a_que_back(const a_que_s *ctx)
+A_INTERN a_vptr_t a_que_back(a_que_s const *const ctx)
 {
-    return a_likely(a_list_used(ctx->_head)) ? a_que_back_(ctx) : A_NULL;
+    return a_likely(a_list_used(&ctx->_head)) ? a_que_back_(ctx) : A_NULL;
 }
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
 /*!
  @brief allocate a pointer to queue structure from memory
  @param[in] size size of element
 */
-A_PUBLIC a_que_s *a_que_new(a_size_t size);
+A_EXTERN a_que_s *a_que_new(a_size_t size);
 
 /*!
  @brief deallocate a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] dtor element destructor
 */
-A_PUBLIC a_void_t a_que_die(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t));
+A_EXTERN a_void_t a_que_die(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t));
 
 /*!
  @brief constructor for queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] size size of element
 */
-A_PUBLIC a_void_t a_que_ctor(a_que_s *ctx, a_size_t size);
+A_EXTERN a_void_t a_que_ctor(a_que_s *ctx, a_size_t size);
 
 /*!
  @brief destructor for queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] dtor element destructor
 */
-A_PUBLIC a_void_t a_que_dtor(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t));
+A_EXTERN a_void_t a_que_dtor(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t));
 
 /*!
  @brief initialize a pointer to queue structure by moving
  @param[in] ctx points to an instance of queue structure
  @param[in] obj input source pointing to an instance
 */
-A_PUBLIC a_que_s *a_que_move(a_que_s *ctx, a_que_s *obj);
+A_EXTERN a_que_s *a_que_move(a_que_s *ctx, a_que_s *obj);
 
 /*!
  @brief access specified element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] idx index of element, 0 ~ n-1, -n ~ -1
  @return element pointer
   @retval 0 out of bounds
 */
-A_PUBLIC a_vptr_t a_que_at(const a_que_s *ctx, a_imax_t idx);
+A_EXTERN a_vptr_t a_que_at(a_que_s const *ctx, a_imax_t idx);
 
 /*!
  @brief modify size of a element for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] size the size of the new element
  @param[in] dtor previous element destructor
 */
-A_PUBLIC a_void_t a_que_set(a_que_s *ctx, a_size_t size, a_void_t (*dtor)(a_vptr_t));
+A_EXTERN a_void_t a_que_set(a_que_s *ctx, a_size_t size, a_void_t (*dtor)(a_vptr_t));
 
 /*!
  @brief drop all the elements for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] dtor current element destructor
 */
-A_PUBLIC a_void_t a_que_drop(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t));
+A_EXTERN a_void_t a_que_drop(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t));
 
 /*!
  @brief swap elements lhs and rhs for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] lhs element pointer on the left
  @param[in] rhs element pointer on the right
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_que_swap_(const a_que_s *ctx, a_vptr_t lhs, a_vptr_t rhs);
+A_EXTERN a_int_t a_que_swap_(a_que_s const *ctx, a_vptr_t lhs, a_vptr_t rhs);
 
 /*!
  @brief swap elements lhs and rhs for a pointer to queue structure
  @param[in] ctx points to an instance of queue structure
  @param[in] lhs element index on the left
  @param[in] rhs element index on the right
 */
-A_PUBLIC a_void_t a_que_swap(const a_que_s *ctx, a_size_t lhs, a_size_t rhs);
+A_EXTERN a_void_t a_que_swap(a_que_s const *ctx, a_size_t lhs, a_size_t rhs);
 
 /*!
  @brief insert sort foremost element for a pointer to queue structure
  @code{.c}
  T *obj = a_que_push_fore(T, ctx);
  if (obj)
  {
@@ -195,15 +194,15 @@
  @endcode
  @param[in] ctx points to an instance of queue structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_que_sort_fore(const a_que_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_que_sort_fore(a_que_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
  @brief insert sort backmost element for a pointer to queue structure
  @code{.c}
  T *obj = a_que_push_back(T, ctx);
  if (obj)
  {
@@ -214,69 +213,69 @@
  @endcode
  @param[in] ctx points to an instance of queue structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_que_sort_back(const a_que_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_que_sort_back(a_que_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
  @brief push an element into the queue forward
  @param[in] ctx points to an instance of queue structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_que_push_fore(a_que_s *ctx);
+A_EXTERN a_vptr_t a_que_push_fore(a_que_s *ctx);
 
 /*!
  @brief push an element into the queue backward
  @param[in] ctx points to an instance of queue structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_que_push_back(a_que_s *ctx);
+A_EXTERN a_vptr_t a_que_push_back(a_que_s *ctx);
 
 /*!
  @brief pull an element from the queue forward
  @param[in] ctx points to an instance of queue structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_que_pull_fore(a_que_s *ctx);
+A_EXTERN a_vptr_t a_que_pull_fore(a_que_s *ctx);
 
 /*!
  @brief pull an element from the queue backward
  @param[in] ctx points to an instance of queue structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_que_pull_back(a_que_s *ctx);
+A_EXTERN a_vptr_t a_que_pull_back(a_que_s *ctx);
 
 /*!
  @brief insert an element into the queue
  @param[in] ctx points to an instance of queue structure
  @param[in] idx index of element in this queue
-  @arg 0 @ref a_que_push_fore
-  @arg n @ref a_que_push_back
+  @arg 0 a_que_push_fore
+  @arg n a_que_push_back
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_que_insert(a_que_s *ctx, a_size_t idx);
+A_EXTERN a_vptr_t a_que_insert(a_que_s *ctx, a_size_t idx);
 
 /*!
  @brief remove an element from the queue
  @param[in] ctx points to an instance of queue structure
  @param[in] idx index of element in this queue
-  @arg 0 @ref a_que_pull_fore
-  @arg n @ref a_que_pull_back
+  @arg 0 a_que_pull_fore
+  @arg n a_que_pull_back
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_que_remove(a_que_s *ctx, a_size_t idx);
+A_EXTERN a_vptr_t a_que_remove(a_que_s *ctx, a_size_t idx);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*!
  @brief iterate over a queue
@@ -287,17 +286,17 @@
  }
  @endcode
  @param T type of elements in the queue
  @param it the &a_que_s to use as a loop counter
  @param ctx points to an instance of queue structure
 */
 #define a_que_foreach(T, it, ctx)                                     \
-    for (T *it = a_cast_r(T *, (ctx)->_head->next),                   \
+    for (T *it = a_cast_r(T *, (ctx)->_head.next),                    \
            *it##_ = a_cast_r(T *, a_list_from(it)->next);             \
-         a_list_from(it) != (ctx)->_head                              \
+         a_list_from(it) != &(ctx)->_head                             \
              ? ((void)(it = a_cast_s(T *, a_que_from(it)->_data)), 1) \
              : (0);                                                   \
          it = it##_, it##_ = a_cast_r(T *, a_list_from(it)->next))
 
 /*!
  @brief iterate over a queue in reverse
  @code{.c}
@@ -307,17 +306,17 @@
  }
  @endcode
  @param T type of elements in the queue
  @param it the &a_que_s to use as a loop counter
  @param ctx points to an instance of queue structure
 */
 #define a_que_foreach_reverse(T, it, ctx)                             \
-    for (T *it = a_cast_r(T *, (ctx)->_head->prev),                   \
+    for (T *it = a_cast_r(T *, (ctx)->_head.prev),                    \
            *it##_ = a_cast_r(T *, a_list_from(it)->prev);             \
-         a_list_from(it) != (ctx)->_head                              \
+         a_list_from(it) != &(ctx)->_head                             \
              ? ((void)(it = a_cast_s(T *, a_que_from(it)->_data)), 1) \
              : (0);                                                   \
          it = it##_, it##_ = a_cast_r(T *, a_list_from(it)->prev))
 
 #define a_que_fore(T, ctx) a_cast_s(T *, a_que_fore(ctx))
 #define a_que_back(T, ctx) a_cast_s(T *, a_que_back(ctx))
 #define a_que_fore_(T, ctx) a_cast_s(T *, a_que_fore_(ctx))
@@ -328,8 +327,8 @@
 #define a_que_pull_fore(T, ctx) a_cast_s(T *, a_que_pull_fore(ctx))
 #define a_que_pull_back(T, ctx) a_cast_s(T *, a_que_pull_back(ctx))
 #define a_que_insert(T, ctx, idx) a_cast_s(T *, a_que_insert(ctx, idx))
 #define a_que_remove(T, ctx, idx) a_cast_s(T *, a_que_remove(ctx, idx))
 
 /*! @} A_QUE */
 
-#endif /* A_HOST_QUE_H */
+#endif /* host/que.h */
```

### Comparing `liba-0.1.1rc4/include/a/host/str.h` & `liba-0.1.1rc5/include/a/host/str.h`

 * *Files 26% similar despite different names*

```diff
@@ -1,225 +1,289 @@
 /*!
  @file str.h
  @brief basic string library
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_HOST_STR_H
-#define A_HOST_STR_H
+#ifndef LIBA_HOST_STR_H
+#define LIBA_HOST_STR_H
 
-#include "a/a.h"
+#include "a.h"
 #include <string.h>
 #include <stdarg.h>
-#include <stdlib.h>
 
 /*!
  @ingroup A
  @addtogroup A_STR basic string library
  @{
 */
 
-#ifndef A_STR_NIL
 // clang-format off
-#define A_STR_NIL {A_NULL, 0, 0}
+#define A_STR_NUL {A_NULL, 0, 0}
 // clang-format on
-#endif /* A_STR_NIL */
 
 /*!
  @brief instance structure for basic string
 */
 typedef struct a_str_s
 {
-    a_str_t _str; /*!< string */
+    a_str_t _ptr; /*!< string */
     a_size_t _num; /*!< length */
     a_size_t _mem; /*!< memory */
 } a_str_s;
 
 /*!
  @brief string for a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @return string
 */
-A_INTERN a_str_t a_str_val(const a_str_s *ctx) { return ctx->_str; }
+A_INTERN a_str_t a_str_ptr(a_str_s const *const ctx) { return ctx->_ptr; }
 
 /*!
  @brief length for a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @return size of length
 */
-A_INTERN a_size_t a_str_len(const a_str_s *ctx) { return ctx->_num; }
+A_INTERN a_size_t a_str_len(a_str_s const *const ctx) { return ctx->_num; }
 
 /*!
  @brief memory for a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @return size of memory
 */
-A_INTERN a_size_t a_str_mem(const a_str_s *ctx) { return ctx->_mem; }
+A_INTERN a_size_t a_str_mem(a_str_s const *const ctx) { return ctx->_mem; }
+
+/*!
+ @brief access specified character for a pointer to string structure
+ @param[in] ctx points to an instance of string structure
+ @param[in] idx index of character less than memory
+ @note should check if string is empty
+ @return specified character
+*/
+A_INTERN a_char_t a_str_at_(a_str_s const *const ctx, a_size_t const idx) { return ctx->_ptr[idx]; }
+
+/*!
+ @brief access specified character for a pointer to string structure
+ @param[in] ctx points to an instance of string structure
+ @param[in] idx index of character less than length
+ @return specified character
+  @retval 0 out of bounds
+*/
+A_INTERN a_char_t a_str_at(a_str_s const *const ctx, a_size_t const idx)
+{
+    return a_likely(idx < ctx->_num) ? ctx->_ptr[idx] : 0;
+}
+
+/*!
+ @brief access specified character for a pointer to string structure
+ @param[in] ctx points to an instance of string structure
+ @param[in] idx index of character -length < idx < length
+ @return specified character
+  @retval 0 out of bounds
+*/
+A_INTERN a_char_t a_str_idx(a_str_s const *const ctx, a_diff_t const idx)
+{
+    a_size_t const num = idx < 0 ? a_size_c(idx) + ctx->_num : a_size_c(idx);
+    return a_likely(num < ctx->_num) ? ctx->_ptr[num] : 0;
+}
+
+/*!
+ @brief set length for a pointer to string structure
+ @param[in] ctx points to an instance of string structure
+ @param[in] len new length for a pointer to string structure
+ @note length must less than memory
+*/
+A_INLINE a_void_t a_str_set_len_(a_str_s *const ctx, a_size_t const len) { ctx->_num = len; }
+
+/*!
+ @brief set length for a pointer to string structure
+ @param[in] ctx points to an instance of string structure
+ @param[in] len new length for a pointer to string structure
+ @return the execution state of the function
+  @retval 0 success
+  @retval 1 failure
+*/
+A_INLINE a_int_t a_str_set_len(a_str_s *const ctx, a_size_t const len)
+{
+    return a_likely(len < ctx->_mem) ? ((void)(ctx->_num = len), A_SUCCESS) : A_FAILURE;
+}
+
+/*!
+ @brief drop all characters for a pointer to string structure
+ @param[in] ctx points to an instance of string structure
+*/
+A_INTERN a_void_t a_str_drop(a_str_s *const ctx) { ctx->_num = 0; }
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
 /*!
  @brief allocate a pointer to string structure from memory
 */
-A_PUBLIC a_str_s *a_str_new(void);
+A_EXTERN a_str_s *a_str_new(void);
 
 /*!
  @brief deallocate a pointer to string structure
  @param[in] ctx points to an instance of string structure
 */
-A_PUBLIC a_void_t a_str_die(a_str_s *ctx);
+A_EXTERN a_void_t a_str_die(a_str_s *ctx);
 
 /*!
  @brief constructor for string structure
  @param[in] ctx points to an instance of string structure
 */
-A_PUBLIC a_void_t a_str_ctor(a_str_s *ctx);
+A_EXTERN a_void_t a_str_ctor(a_str_s *ctx);
 
 /*!
  @brief destructor for string structure
  @param[in] ctx points to an instance of string structure
 */
-A_PUBLIC a_void_t a_str_dtor(a_str_s *ctx);
+A_EXTERN a_void_t a_str_dtor(a_str_s *ctx);
 
 /*!
  @brief initialize a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] pdata points to data to initialize
  @param[in] nbyte length of data to initialize
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_str_init(a_str_s *ctx, a_cptr_t pdata, a_size_t nbyte);
+A_EXTERN a_int_t a_str_init(a_str_s *ctx, a_cptr_t pdata, a_size_t nbyte);
 
 /*!
  @brief initialize a pointer to string structure by copying
  @param[in] ctx points to an instance of string structure
  @param[in] obj input source pointing to an instance
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_str_copy(a_str_s *ctx, const a_str_s *obj);
+A_EXTERN a_int_t a_str_copy(a_str_s *ctx, a_str_s const *obj);
 
 /*!
  @brief initialize a pointer to string structure by moving
  @param[in] ctx points to an instance of string structure
  @param[in] obj input source pointing to an instance
 */
-A_PUBLIC a_str_s *a_str_move(a_str_s *ctx, a_str_s *obj);
+A_EXTERN a_str_s *a_str_move(a_str_s *ctx, a_str_s *obj);
 
 /*!
  @brief terminate a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @note should use free to release this memory
  @return string of string structure
 */
-A_PUBLIC a_str_t a_str_exit(a_str_s *ctx);
+A_EXTERN a_str_t a_str_exit(a_str_s *ctx);
 
 /*!
- @brief compare the string lhs to the string rhs
+ @brief compare the string lhs with the string rhs
  @param[in] lhs string structure to be compared
  @param[in] rhs string structure to be compared
  @return relationship between the strings
-  @retval <0 lhs < rhs
-  @retval >0 lhs > rhs
-  @retval 0 lhs == rhs
+  @retval <0 string lhs < string rhs
+  @retval >0 string lhs > string rhs
+  @retval 0 string lhs == string rhs
 */
-A_PUBLIC a_int_t a_str_cmp(const a_str_s *lhs, const a_str_s *rhs);
+A_EXTERN a_int_t a_str_cmp(a_str_s const *lhs, a_str_s const *rhs);
 
 /*!
  @brief allocate memory for a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] mem new memory capacity of string
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_str_alloc(a_str_s *ctx, a_size_t mem);
-A_PUBLIC a_int_t a_str_alloc_(a_str_s *ctx, a_size_t mem);
+A_EXTERN a_int_t a_str_alloc(a_str_s *ctx, a_size_t mem);
+A_EXTERN a_int_t a_str_alloc_(a_str_s *ctx, a_size_t mem);
 
 /*!
  @brief get character for a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @return deleted character
   @retval EOF failure
 */
-A_PUBLIC a_int_t a_str_getc(a_str_s *ctx);
-A_PUBLIC a_int_t a_str_getc_(a_str_s *ctx);
+A_EXTERN a_int_t a_str_getc(a_str_s *ctx);
+A_EXTERN a_int_t a_str_getc_(a_str_s *ctx);
 
 /*!
  @brief put character to a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] c character to be printed
  @return printed character
   @retval EOF failure
 */
-A_PUBLIC a_int_t a_str_putc(a_str_s *ctx, a_int_t c);
-A_PUBLIC a_int_t a_str_putc_(a_str_s *ctx, a_int_t c);
+A_EXTERN a_int_t a_str_putc(a_str_s *ctx, a_int_t c);
+A_EXTERN a_int_t a_str_putc_(a_str_s *ctx, a_int_t c);
 
 /*!
  @brief put memory block to a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] pdata points to memory block to put
  @param[in] nbyte length of memory block to put
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_str_putn(a_str_s *ctx, a_cptr_t pdata, a_size_t nbyte);
-A_PUBLIC a_int_t a_str_putn_(a_str_s *ctx, a_cptr_t pdata, a_size_t nbyte);
+A_EXTERN a_int_t a_str_putn(a_str_s *ctx, a_cptr_t pdata, a_size_t nbyte);
+A_EXTERN a_int_t a_str_putn_(a_str_s *ctx, a_cptr_t pdata, a_size_t nbyte);
 
 /*!
  @brief put string to a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] str string terminated with a null character
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_str_puts(a_str_s *ctx, a_cptr_t str);
+A_EXTERN a_int_t a_str_puts(a_str_s *ctx, a_cptr_t str);
 
 /*!
  @brief concat the string structure obj to the string structure ctx
  @param[in] ctx points to an instance of string structure
  @param[in] obj input source pointing to an instance
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_str_cat(a_str_s *ctx, const a_str_s *obj);
+A_EXTERN a_int_t a_str_cat(a_str_s *ctx, a_str_s const *obj);
 
 /*!
  @brief print string to a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] fmt format of string to be printed
  @param[in] va instance of variable argument
  @return number of printed characters
   @retval EOF failure
 */
-A_PUBLIC a_int_t a_str_vprintf(a_str_s *ctx, a_cstr_t fmt, va_list va) A_FORMAT(printf, 2, 0);
+A_EXTERN a_int_t a_str_vprintf(a_str_s *ctx, a_cstr_t fmt, va_list va) A_FORMAT(printf, 2, 0);
 
 /*!
  @brief print string to a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] fmt format of string to be printed
  @return number of printed characters
   @retval EOF failure
 */
-A_PUBLIC a_int_t a_str_printf(a_str_s *ctx, a_cstr_t fmt, ...) A_FORMAT(printf, 2, 3);
+A_EXTERN a_int_t a_str_printf(a_str_s *ctx, a_cstr_t fmt, ...) A_FORMAT(printf, 2, 3);
+
+/*!
+ @brief length for a pointer to string structure using UTF-8
+ @param[in] ctx points to an instance of string structure
+ @return number of code points
+*/
+A_EXTERN a_size_t a_str_utflen(a_str_s const *ctx);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /* inline function for generic */
 A_INTERN a_vptr_t a_str_new_(void) { return a_str_new(); }
 A_INTERN a_void_t a_str_die_(a_vptr_t ctx) { a_str_die(a_cast_s(a_str_s *, ctx)); }
 A_INTERN a_void_t a_str_ctor_(a_vptr_t ctx) { a_str_ctor(a_cast_s(a_str_s *, ctx)); }
 A_INTERN a_void_t a_str_dtor_(a_vptr_t ctx) { a_str_dtor(a_cast_s(a_str_s *, ctx)); }
 
 /*! @} A_STR */
 
-#endif /* A_HOST_STR_H */
+#endif /* host/str.h */
```

### Comparing `liba-0.1.1rc4/include/a/host/vector.h` & `liba-0.1.1rc5/include/a/host/vector.h`

 * *Files 5% similar despite different names*

```diff
@@ -1,18 +1,16 @@
 /*!
  @file vector.h
  @brief basic vector library
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_HOST_VECTOR_H
-#define A_HOST_VECTOR_H
+#ifndef LIBA_HOST_VECTOR_H
+#define LIBA_HOST_VECTOR_H
 
-#include "a/a.h"
-#include <stdlib.h>
+#include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_VECTOR basic vector library
  @{
 */
 
@@ -31,186 +29,199 @@
     a_size_t _mem; /*!< count memory */
 } a_vector_s;
 
 /*!
  @brief access vector head pointer for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_vptr_t a_vector_ptr(const a_vector_s *ctx) { return ctx->_head; }
+A_INTERN a_vptr_t a_vector_ptr(a_vector_s const *const ctx) { return ctx->_head; }
 
 /*!
  @brief access vector tail pointer for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_vptr_t a_vector_end(const a_vector_s *ctx) { return ctx->_tail; }
+A_INTERN a_vptr_t a_vector_end(a_vector_s const *const ctx) { return ctx->_tail; }
 
 /*!
  @brief access size of a element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_size_t a_vector_get(const a_vector_s *ctx) { return ctx->_size; }
+A_INTERN a_size_t a_vector_get(a_vector_s const *const ctx) { return ctx->_size; }
 
 /*!
  @brief access number of element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_size_t a_vector_num(const a_vector_s *ctx) { return ctx->_num; }
+A_INTERN a_size_t a_vector_num(a_vector_s const *const ctx) { return ctx->_num; }
 
 /*!
  @brief access capacity of element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_INTERN a_size_t a_vector_mem(const a_vector_s *ctx) { return ctx->_mem; }
+A_INTERN a_size_t a_vector_mem(a_vector_s const *const ctx) { return ctx->_mem; }
 
 /*!
  @brief access specified element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
  @param[in] idx index of element less than capacity
  @note should check for out of bounds
- @return element pointer
+ @return specified element pointer
 */
-A_INTERN a_vptr_t a_vector_at_(const a_vector_s *ctx, a_size_t idx)
+A_INTERN a_vptr_t a_vector_at_(a_vector_s const *const ctx, a_size_t idx)
 {
     return a_byte_p(ctx->_head) + ctx->_size * idx;
 }
 
 /*!
  @brief access specified element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
  @param[in] idx index of element less than capacity
- @return element pointer
+ @return specified element pointer
   @retval 0 out of bounds
 */
-A_INTERN a_vptr_t a_vector_at(const a_vector_s *ctx, a_size_t idx)
+A_INTERN a_vptr_t a_vector_at(a_vector_s const *const ctx, a_size_t idx)
 {
     return a_likely(idx < ctx->_mem) ? a_vector_at_(ctx, idx) : A_NULL;
 }
 
 /*!
+ @brief access specified element for a pointer to vector structure
+ @param[in] ctx points to an instance of vector structure
+ @param[in] idx index of element -capacity < idx < capacity
+ @return specified element pointer
+  @retval 0 out of bounds
+*/
+A_INTERN a_vptr_t a_vector_idx(a_vector_s const *const ctx, a_diff_t const idx)
+{
+    a_size_t const num = idx < 0 ? a_size_c(idx) + ctx->_num : a_size_c(idx);
+    return a_likely(num < ctx->_mem) ? a_vector_at_(ctx, num) : A_NULL;
+}
+
+/*!
  @brief access top element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
  @note should check if vector is empty
- @return element pointer
+ @return specified element pointer
 */
-A_INTERN a_vptr_t a_vector_top_(const a_vector_s *ctx)
+A_INTERN a_vptr_t a_vector_top_(a_vector_s const *const ctx)
 {
     return a_byte_p(ctx->_tail) - ctx->_size;
 }
 
 /*!
  @brief access top element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
- @return element pointer
+ @return specified element pointer
   @retval 0 empty vector
 */
-A_INTERN a_vptr_t a_vector_top(const a_vector_s *ctx)
+A_INTERN a_vptr_t a_vector_top(a_vector_s const *const ctx)
 {
     return a_likely(ctx->_num) ? a_vector_top_(ctx) : A_NULL;
 }
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
 /*!
  @brief allocate a pointer to vector structure from memory
  @param[in] size the size of the element
  @param[in] ctor element constructor
  @param[in] dtor element destructor
 */
-A_PUBLIC a_vector_s *a_vector_new(a_size_t size,
+A_EXTERN a_vector_s *a_vector_new(a_size_t size,
                                   a_void_t (*ctor)(a_vptr_t),
                                   a_void_t (*dtor)(a_vptr_t));
 
 /*!
  @brief deallocate a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_PUBLIC a_void_t a_vector_die(a_vector_s *ctx);
+A_EXTERN a_void_t a_vector_die(a_vector_s *ctx);
 
 /*!
  @brief constructor for vector structure
  @param[in] ctx points to an instance of vector structure
  @param[in] size the size of the element
  @param[in] ctor element constructor
  @param[in] dtor element destructor
 */
-A_PUBLIC a_void_t a_vector_ctor(a_vector_s *ctx, a_size_t size,
+A_EXTERN a_void_t a_vector_ctor(a_vector_s *ctx, a_size_t size,
                                 a_void_t (*ctor)(a_vptr_t),
                                 a_void_t (*dtor)(a_vptr_t));
 
 /*!
  @brief destructor for vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_PUBLIC a_void_t a_vector_dtor(a_vector_s *ctx);
+A_EXTERN a_void_t a_vector_dtor(a_vector_s *ctx);
 
 /*!
  @brief initialize a pointer to vector structure by copying
  @param[in] ctx points to an instance of vector structure
  @param[in] obj input source pointing to an instance
  @param[in] dup a function that copies elements
-  @arg 0 use function memcpy to copy elements
+  @arg 0 use function a_copy to copy elements
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_vector_copy(a_vector_s *ctx, const a_vector_s *obj, a_int_t (*dup)(a_vptr_t, a_cptr_t));
+A_EXTERN a_int_t a_vector_copy(a_vector_s *ctx, a_vector_s const *obj, a_int_t (*dup)(a_vptr_t, a_cptr_t));
 
 /*!
  @brief initialize a pointer to vector structure by moving
  @param[in] ctx points to an instance of vector structure
  @param[in] obj input source pointing to an instance
 */
-A_PUBLIC a_vector_s *a_vector_move(a_vector_s *ctx, a_vector_s *obj);
+A_EXTERN a_vector_s *a_vector_move(a_vector_s *ctx, a_vector_s *obj);
 
 /*!
  @brief modify size of a element for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
  @param[in] size the size of the new element
  @param[in] ctor current element constructor
  @param[in] dtor current element destructor
 */
-A_PUBLIC a_void_t a_vector_set(a_vector_s *ctx, a_size_t size,
+A_EXTERN a_void_t a_vector_set(a_vector_s *ctx, a_size_t size,
                                a_void_t (*ctor)(a_vptr_t),
                                a_void_t (*dtor)(a_vptr_t));
 
 /*!
  @brief modify element number for a pointer to string structure
  @param[in] ctx points to an instance of string structure
  @param[in] num number of all elements in the vector
  @return the execution state of the function
   @retval 0 success
   @retval 1 failure
 */
-A_PUBLIC a_int_t a_vector_make(a_vector_s *ctx, a_size_t num);
+A_EXTERN a_int_t a_vector_make(a_vector_s *ctx, a_size_t num);
 
 /*!
  @brief drop all the elements for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
 */
-A_PUBLIC a_void_t a_vector_drop(a_vector_s *ctx);
+A_EXTERN a_void_t a_vector_drop(a_vector_s *ctx);
 
 /*!
  @brief swap elements lhs and rhs for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
  @param[in] lhs element index on the left
  @param[in] rhs element index on the right
 */
-A_PUBLIC a_void_t a_vector_swap(const a_vector_s *ctx, a_size_t lhs, a_size_t rhs);
+A_EXTERN a_void_t a_vector_swap(a_vector_s const *ctx, a_size_t lhs, a_size_t rhs);
 
 /*!
  @brief sort all elements for a pointer to vector structure
  @param[in] ctx points to an instance of vector structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_vector_sort(const a_vector_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_vector_sort(a_vector_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
  @brief insert sort foremost element for a pointer to vector structure
  @code{.c}
  T *obj = a_vector_push_fore(T, ctx);
  if (obj)
  {
@@ -221,15 +232,15 @@
  @endcode
  @param[in] ctx points to an instance of vector structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_vector_sort_fore(const a_vector_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_vector_sort_fore(a_vector_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
  @brief insert sort backmost element for a pointer to vector structure
  @code{.c}
  T *obj = a_vector_push_back(T, ctx);
  if (obj)
  {
@@ -240,82 +251,82 @@
  @endcode
  @param[in] ctx points to an instance of vector structure
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
 */
-A_PUBLIC a_void_t a_vector_sort_back(const a_vector_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_void_t a_vector_sort_back(a_vector_s const *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
  @brief search the given element in this vector
  @param[in] ctx points to an instance of vector structure
  @param[in] obj object that serves as key for the search
  @param[in] cmp a function that compares two elements
   @arg cmp(lhs,rhs)==0 *lhs is equivalent to *rhs
   @arg cmp(lhs,rhs)<0 *lhs goes before *rhs
   @arg cmp(lhs,rhs)>0 *lhs goes after *rhs
  @return matching element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_vector_search(const a_vector_s *ctx, a_cptr_t obj, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
+A_EXTERN a_vptr_t a_vector_search(a_vector_s const *ctx, a_cptr_t obj, a_int_t (*cmp)(a_cptr_t, a_cptr_t));
 
 /*!
  @brief insert an element into the vector
  @param[in] ctx points to an instance of vector structure
  @param[in] idx index of element in this vector
-  @arg 0 @ref a_vector_push_fore
-  @arg n @ref a_vector_push_back
+  @arg 0 a_vector_push_fore
+  @arg n a_vector_push_back
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_vector_insert(a_vector_s *ctx, a_size_t idx);
+A_EXTERN a_vptr_t a_vector_insert(a_vector_s *ctx, a_size_t idx);
 
 /*!
  @brief remove an element from the vector
  @param[in] ctx points to an instance of vector structure
  @param[in] idx index of element in this vector
-  @arg 0 @ref a_vector_pull_fore
-  @arg n @ref a_vector_pull_back
+  @arg 0 a_vector_pull_fore
+  @arg n a_vector_pull_back
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_vector_remove(a_vector_s *ctx, a_size_t idx);
+A_EXTERN a_vptr_t a_vector_remove(a_vector_s *ctx, a_size_t idx);
 
 /*!
  @brief push an element into the vector forward
  @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_vector_push_fore(a_vector_s *ctx);
+A_EXTERN a_vptr_t a_vector_push_fore(a_vector_s *ctx);
 
 /*!
  @brief push an element into the vector backward
  @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_vector_push_back(a_vector_s *ctx);
+A_EXTERN a_vptr_t a_vector_push_back(a_vector_s *ctx);
 
 /*!
  @brief pull an element from the vector forward
  @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_vector_pull_fore(a_vector_s *ctx);
+A_EXTERN a_vptr_t a_vector_pull_fore(a_vector_s *ctx);
 
 /*!
  @brief pull an element from the vector backward
  @param[in] ctx points to an instance of vector structure
  @return element pointer
   @retval 0 failure
 */
-A_PUBLIC a_vptr_t a_vector_pull_back(a_vector_s *ctx);
+A_EXTERN a_vptr_t a_vector_pull_back(a_vector_s *ctx);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*!
  @brief push an element into the vector
@@ -391,20 +402,21 @@
 
 #define a_vector_ptr(T, ctx) a_cast_s(T *, a_vector_ptr(ctx))
 #define a_vector_end(T, ctx) a_cast_s(T *, a_vector_end(ctx))
 #define a_vector_top(T, ctx) a_cast_s(T *, a_vector_top(ctx))
 #define a_vector_top_(T, ctx) a_cast_s(T *, a_vector_top_(ctx))
 #define a_vector_at(T, ctx, idx) a_cast_s(T *, a_vector_at(ctx, idx))
 #define a_vector_at_(T, ctx, idx) a_cast_s(T *, a_vector_at_(ctx, idx))
+#define a_vector_idx(T, ctx, idx) a_cast_s(T *, a_vector_idx(ctx, idx))
 #define a_vector_search(T, ctx, obj, cmp) a_cast_s(T *, a_vector_search(ctx, obj, cmp))
 #define a_vector_insert(T, ctx, idx) a_cast_s(T *, a_vector_insert(ctx, idx))
 #define a_vector_remove(T, ctx, idx) a_cast_s(T *, a_vector_remove(ctx, idx))
 #define a_vector_push_fore(T, ctx) a_cast_s(T *, a_vector_push_fore(ctx))
 #define a_vector_push_back(T, ctx) a_cast_s(T *, a_vector_push_back(ctx))
 #define a_vector_pull_fore(T, ctx) a_cast_s(T *, a_vector_pull_fore(ctx))
 #define a_vector_pull_back(T, ctx) a_cast_s(T *, a_vector_pull_back(ctx))
 #define a_vector_push(T, ctx) a_cast_s(T *, a_vector_push(ctx))
 #define a_vector_pull(T, ctx) a_cast_s(T *, a_vector_pull(ctx))
 
 /*! @} A_VECTOR */
 
-#endif /* A_HOST_VECTOR_H */
+#endif /* host/vector.h */
```

### Comparing `liba-0.1.1rc4/include/a/list.h` & `liba-0.1.1rc5/include/a/list.h`

 * *Files 12% similar despite different names*

```diff
@@ -1,24 +1,27 @@
 /*!
  @file list.h
- @brief circular doubly linked list implementation.
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
+ @brief circular doubly linked list implementation
 */
 
-#ifndef A_LIST_H
-#define A_LIST_H
+#ifndef LIBA_LIST_H
+#define LIBA_LIST_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_LIST circular doubly linked list
  @{
 */
 
+// clang-format off
+#define A_LIST_INIT(node) {&(node), &(node)}
+// clang-format on
+
 /*!
  @brief instance structure for circular doubly linked list
 */
 typedef struct a_list_s
 {
     struct a_list_s *next, *prev;
 } a_list_s;
@@ -57,55 +60,55 @@
 */
 #define a_list_forsafe_(it, at, ctx, next) \
     for (a_list_s *it = (ctx)->next, *at = it->next; it != (ctx); it = at, at = it->next)
 #define a_list_forsafe_next(it, at, ctx) a_list_forsafe_(it, at, ctx, next)
 #define a_list_forsafe_prev(it, at, ctx) a_list_forsafe_(it, at, ctx, prev)
 
 /*!
+ @brief test whether a list is null
+ @param[in] ctx points to circular doubly linked list
+ @return int bool
+  @retval 0 non-null
+  @retval 1 null
+*/
+A_INTERN a_bool_t a_list_null(a_list_s const *const ctx) { return ctx->next == ctx || ctx->next->prev != ctx; }
+
+/*!
+ @brief test whether a list is used
+ @param[in] ctx points to circular doubly linked list
+ @return int bool
+  @retval 0 unused
+  @retval 1 used
+*/
+A_INTERN a_bool_t a_list_used(a_list_s const *const ctx) { return ctx->next != ctx && ctx->next->prev == ctx; }
+
+/*!
  @brief cast a list pointer from another type pointer
  @param[in] obj points to circular doubly linked list
  @return a pointer to circular doubly linked list
 */
-A_INTERN a_list_s *a_list_from(a_vptr_t obj) { return a_cast_s(a_list_s *, obj); }
+A_INTERN a_list_s *a_list_from(a_vptr_t const obj) { return a_cast_s(a_list_s *, obj); }
 
 /*!
  @brief constructor for circular doubly linked list
  @param[in,out] ctx points to circular doubly linked list
 */
-A_INTERN a_void_t a_list_ctor(a_list_s *ctx) { ctx->prev = ctx->next = ctx; }
+A_INTERN a_void_t a_list_ctor(a_list_s *const ctx) { ctx->prev = ctx->next = ctx; }
 
 /*!
  @brief initialize for circular doubly linked list
  @param[in,out] ctx points to circular doubly linked list
 */
-A_INTERN a_void_t a_list_init(a_list_s *ctx) { ctx->prev = ctx->next = ctx; }
+A_INTERN a_void_t a_list_init(a_list_s *const ctx) { ctx->prev = ctx->next = ctx; }
 
 /*!
  @brief destructor for circular doubly linked list
  @param[in,out] ctx points to circular doubly linked list
 */
-A_INTERN a_void_t a_list_dtor(a_list_s *ctx) { ctx->prev = ctx->next = ctx; }
-
-/*!
- @brief test whether a list is null
- @param[in] ctx points to circular doubly linked list
- @return int bool
-  @retval 0 non-null
-  @retval 1 null
-*/
-A_INTERN a_bool_t a_list_null(const a_list_s *ctx) { return ctx->next == ctx; }
-
-/*!
- @brief test whether a list is used
- @param[in] ctx points to circular doubly linked list
- @return int bool
-  @retval 0 unused
-  @retval 1 used
-*/
-A_INTERN a_bool_t a_list_used(const a_list_s *ctx) { return ctx->next != ctx; }
+A_INTERN a_void_t a_list_dtor(a_list_s *const ctx) { ctx->prev = ctx->next = ctx; }
 
 /*!
  @brief link head node and tail node
  @dot
  digraph a_list_link {
      node[shape="record"]
      nodehead[label="{<prev>prev|<addr>head|<next>next}"]
@@ -114,15 +117,15 @@
      nodetail:prev -> nodehead:addr [color=green]
      nodehead -> "..." -> nodetail
  }
  @enddot
  @param[in,out] head the head node of a list
  @param[in,out] tail the tail node of a list
 */
-A_INTERN a_void_t a_list_link(a_list_s *head, a_list_s *tail)
+A_INTERN a_void_t a_list_link(a_list_s *const head, a_list_s *const tail)
 {
     head->next = tail;
     tail->prev = head;
 }
 
 /*!
  @brief loop head node to tail node
@@ -135,15 +138,15 @@
      nodetail:next -> nodehead:addr [color=green]
      nodehead -> "..." -> nodetail
  }
  @enddot
  @param[in,out] head the head node of a list
  @param[in,out] tail the tail node of a list
 */
-A_INTERN a_void_t a_list_loop(a_list_s *head, a_list_s *tail)
+A_INTERN a_void_t a_list_loop(a_list_s *const head, a_list_s *const tail)
 {
     head->prev = tail;
     tail->next = head;
 }
 
 /*!
  @brief connect list1 and list2
@@ -165,15 +168,15 @@
  }
  @enddot
  @param[in,out] head1 the head node of the list1
  @param[in,out] tail1 the tail node of the list1
  @param[in,out] head2 the head node of the list2
  @param[in,out] tail2 the tail node of the list2
 */
-A_INTERN a_void_t a_list_add_(a_list_s *head1, a_list_s *tail1, a_list_s *head2, a_list_s *tail2)
+A_INTERN a_void_t a_list_add_(a_list_s *const head1, a_list_s *const tail1, a_list_s *const head2, a_list_s *const tail2)
 {
     a_list_link(tail1, head2);
     a_list_link(tail2, head1);
 }
 
 /*!
  @brief insert a node to a list
@@ -190,15 +193,15 @@
      1 -> 2
  }
  @enddot
  @param[in,out] head the head node of a list
  @param[in,out] tail the tail node of a list
  @param[in] node a list node
 */
-A_INTERN a_void_t a_list_add_node(a_list_s *head, a_list_s *tail, a_list_s *node)
+A_INTERN a_void_t a_list_add_node(a_list_s *const head, a_list_s *const tail, a_list_s *const node)
 {
     a_list_add_(head, tail, node, node);
 }
 
 /*!
  @brief append a node to a list forward
  @dot
@@ -213,15 +216,15 @@
      }
      1 -> 2
  }
  @enddot
  @param[in,out] ctx points to circular doubly linked list
  @param[in] node a list node
 */
-A_INTERN a_void_t a_list_add_next(a_list_s *ctx, a_list_s *node)
+A_INTERN a_void_t a_list_add_next(a_list_s *const ctx, a_list_s *const node)
 {
     a_list_add_(ctx->next, ctx, node, node);
 }
 
 /*!
  @brief append a node to a list backward
  @dot
@@ -236,15 +239,15 @@
      }
      1 -> 2
  }
  @enddot
  @param[in,out] ctx points to circular doubly linked list
  @param[in] node a list node
 */
-A_INTERN a_void_t a_list_add_prev(a_list_s *ctx, a_list_s *node)
+A_INTERN a_void_t a_list_add_prev(a_list_s *const ctx, a_list_s *const node)
 {
     a_list_add_(ctx, ctx->prev, node, node);
 }
 
 /*!
  @brief delete a section of a list
  @dot
@@ -258,15 +261,15 @@
      head:next -> tail:addr [color=green]
      tail:prev -> head:addr [color=green]
  }
  @enddot
  @param[in,out] head the head node of a list
  @param[in,out] tail the tail node of a list
 */
-A_INTERN a_void_t a_list_del_(a_list_s *head, a_list_s *tail)
+A_INTERN a_void_t a_list_del_(a_list_s *const head, a_list_s *const tail)
 {
     a_list_link(head->prev, tail->next);
 }
 
 /*!
  @brief delete a node from a list
  @dot
@@ -280,15 +283,15 @@
          2[label="<head>head|<tail>tail"]
      }
      1 -> 2
  }
  @enddot
  @param[in] node a list node
 */
-A_INTERN a_void_t a_list_del_node(a_list_s *node) { a_list_del_(node, node); }
+A_INTERN a_void_t a_list_del_node(a_list_s *const node) { a_list_del_(node, node); }
 
 /*!
  @brief remove a node from a list forward
  @dot
  digraph a_list_del_next {
      node[shape="record"]
      subgraph cluster0 {
@@ -299,15 +302,15 @@
          2[label="<prev>prev|<node>node|<next>next"]
      }
      1 -> 2
  }
  @enddot
  @param[in] node a list node
 */
-A_INTERN a_void_t a_list_del_next(a_list_s *node) { a_list_del_(node->next, node->next); }
+A_INTERN a_void_t a_list_del_next(a_list_s *const node) { a_list_del_(node->next, node->next); }
 
 /*!
  @brief remove a node from a list backward
  @dot
  digraph a_list_del_prev {
      node[shape="record"]
      subgraph cluster0 {
@@ -318,15 +321,15 @@
          0[label="<0>0"]
      }
      1 -> 2
  }
  @enddot
  @param[in] node a list node
 */
-A_INTERN a_void_t a_list_del_prev(a_list_s *node) { a_list_del_(node->prev, node->prev); }
+A_INTERN a_void_t a_list_del_prev(a_list_s *const node) { a_list_del_(node->prev, node->prev); }
 
 /*!
  @brief moving a list to another list forward
  @dot
  digraph a_list_mov_next {
      node[shape="record"]
      subgraph cluster0 {
@@ -338,15 +341,15 @@
      }
      1 -> 2
  }
  @enddot
  @param[in,out] ctx points to circular doubly linked list
  @param[in] obj source list
 */
-A_INTERN a_void_t a_list_mov_next(a_list_s *ctx, a_list_s *obj)
+A_INTERN a_void_t a_list_mov_next(a_list_s *const ctx, a_list_s *const obj)
 {
     a_list_add_(ctx->next, ctx, obj->next, obj->prev);
 }
 
 /*!
  @brief moving a list to another list backward
  @dot
@@ -361,15 +364,15 @@
      }
      1 -> 2
  }
  @enddot
  @param[in,out] ctx points to circular doubly linked list
  @param[in] obj source list
 */
-A_INTERN a_void_t a_list_mov_prev(a_list_s *ctx, a_list_s *obj)
+A_INTERN a_void_t a_list_mov_prev(a_list_s *const ctx, a_list_s *const obj)
 {
     a_list_add_(ctx, ctx->prev, obj->next, obj->prev);
 }
 
 /*!
  @brief rotate a node in the list backward
  @dot
@@ -386,17 +389,17 @@
      2:prev -> 2:2 [color=blue]
      2:next -> 2:3 [color=blue]
      1 -> 2
  }
  @enddot
  @param[in,out] ctx points to circular doubly linked list
 */
-A_INTERN a_void_t a_list_rot_next(a_list_s *ctx)
+A_INTERN a_void_t a_list_rot_next(a_list_s *const ctx)
 {
-    a_list_s *node = ctx->prev;
+    a_list_s *const node = ctx->prev;
     a_list_del_(node, node);
     a_list_add_(ctx->next, ctx, node, node);
 }
 
 /*!
  @brief rotate a node in the list forward
  @dot
@@ -413,17 +416,17 @@
      2:prev -> 2:0 [color=blue]
      2:next -> 2:1 [color=blue]
      1 -> 2
  }
  @enddot
  @param[in,out] ctx points to circular doubly linked list
 */
-A_INTERN a_void_t a_list_rot_prev(a_list_s *ctx)
+A_INTERN a_void_t a_list_rot_prev(a_list_s *const ctx)
 {
-    a_list_s *node = ctx->next;
+    a_list_s *const node = ctx->next;
     a_list_del_(node, node);
     a_list_add_(ctx, ctx->prev, node, node);
 }
 
 /*!
  @brief shift a section of one list to a section of another list
  @dot
@@ -440,25 +443,25 @@
  }
  @enddot
  @param[in,out] head1 the head node of the list1
  @param[in,out] tail1 the tail node of the list1
  @param[in,out] head2 the head node of the list2
  @param[in,out] tail2 the tail node of the list2
 */
-A_INTERN a_void_t a_list_shift_(a_list_s *head1, a_list_s *tail1, a_list_s *head2, a_list_s *tail2)
+A_INTERN a_void_t a_list_shift_(a_list_s *const head1, a_list_s *const tail1, a_list_s *const head2, a_list_s *const tail2)
 {
     a_list_add_(tail1->next, head1->prev, head2, tail2);
 }
 
 /*!
  @brief shift the node rhs to the node lhs
  @param[in,out] lhs the old node
  @param[in,out] rhs the new node
 */
-A_INTERN a_void_t a_list_shift_node(a_list_s *lhs, a_list_s *rhs)
+A_INTERN a_void_t a_list_shift_node(a_list_s *const lhs, a_list_s *const rhs)
 {
     a_list_shift_(lhs, lhs, rhs, rhs);
 }
 
 /*!
  @brief swap a section of one list and a section of another list
  @dot
@@ -477,31 +480,31 @@
  }
  @enddot
  @param[in,out] head1 the head node of the list1
  @param[in,out] tail1 the tail node of the list1
  @param[in,out] head2 the head node of the list2
  @param[in,out] tail2 the tail node of the list2
 */
-A_INTERN a_void_t a_list_swap_(a_list_s *head1, a_list_s *tail1, a_list_s *head2, a_list_s *tail2)
+A_INTERN a_void_t a_list_swap_(a_list_s *const head1, a_list_s *const tail1, a_list_s *const head2, a_list_s *const tail2)
 {
-    a_list_s *head = tail2->next, *tail = head2->prev;
+    a_list_s *const head = tail2->next, *const tail = head2->prev;
     a_list_add_(tail1->next, head1->prev, head2, tail2);
     a_list_add_(head, tail, head1, tail1);
 }
 
 /*!
  @brief swap the node lhs and the node rhs
  @param[in,out] lhs a node on the left
  @param[in,out] rhs a node on the right
 */
-A_INTERN a_void_t a_list_swap_node(a_list_s *lhs, a_list_s *rhs)
+A_INTERN a_void_t a_list_swap_node(a_list_s *const lhs, a_list_s *const rhs)
 {
     a_list_swap_(lhs, lhs, rhs, rhs);
 }
 
 /* inline function for generic */
-A_INTERN a_void_t a_list_ctor_(a_vptr_t ctx) { a_list_ctor(a_cast_s(a_list_s *, ctx)); }
-A_INTERN a_void_t a_list_dtor_(a_vptr_t ctx) { a_list_dtor(a_cast_s(a_list_s *, ctx)); }
+A_INTERN a_void_t a_list_ctor_(a_vptr_t const ctx) { a_list_ctor(a_cast_s(a_list_s *, ctx)); }
+A_INTERN a_void_t a_list_dtor_(a_vptr_t const ctx) { a_list_dtor(a_cast_s(a_list_s *, ctx)); }
 
 /*! @} A_LIST */
 
-#endif /* A_LIST_H */
+#endif /* list.h */
```

### Comparing `liba-0.1.1rc4/include/a/math.h` & `liba-0.1.1rc5/include/a/math.h`

 * *Files 1% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file math.h
  @brief mathematical algorithm library
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_MATH_H
-#define A_MATH_H
+#ifndef LIBA_MATH_H
+#define LIBA_MATH_H
 
 #include "a.h"
 #include <math.h>
 
 /*!
  @ingroup A
  @addtogroup A_MATH mathematical algorithm library
@@ -58,27 +57,28 @@
 */
 #define A_SGN(x) ((0 < (x)) - ((x) < 0))
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
-A_PUBLIC a_f32_t a_f32_hypot(a_f32_t x, a_f32_t y);
-A_PUBLIC a_f64_t a_f64_hypot(a_f64_t x, a_f64_t y);
+A_EXTERN a_f32_t a_f32_hypot(a_f32_t x, a_f32_t y);
+A_EXTERN a_f64_t a_f64_hypot(a_f64_t x, a_f64_t y);
 
 /*!
  @brief fast inverse square-root, \f$ \frac{1}{\sqrt{x}} \f$
  @details http://en.wikipedia.org/wiki/Fast_inverse_square_root
  @param[in] x independent variable
  @return calculated result
 */
-A_PUBLIC a_f32_t a_sqrt_inv(a_f32_t x);
+A_EXTERN a_f32_t a_f32_rsqrt(a_f32_t x);
+A_EXTERN a_f64_t a_f64_rsqrt(a_f64_t x);
 
-A_PUBLIC a_u32_t a_u32_sqrt(a_u32_t x, a_u32_t *p);
-A_PUBLIC a_u64_t a_u64_sqrt(a_u64_t x, a_u64_t *p);
+A_EXTERN a_u32_t a_u32_sqrt(a_u32_t x, a_u32_t *o);
+A_EXTERN a_u64_t a_u64_sqrt(a_u64_t x, a_u64_t *o);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 #define a_f32_fpclassify A_F32_F(fpclassify)
 #define a_f32_copysign A_F32_F(copysign)
@@ -186,8 +186,8 @@
 #define a_f64_tanh A_F64_F(tanh)
 #define a_f64_asinh A_F64_F(asinh)
 #define a_f64_acosh A_F64_F(acosh)
 #define a_f64_atanh A_F64_F(atanh)
 
 /*! @} A_MATH */
 
-#endif /* A_MATH_H */
+#endif /* math.h */
```

### Comparing `liba-0.1.1rc4/include/a/mf.h` & `liba-0.1.1rc5/include/a/mf.h`

 * *Files 13% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file mf.h
  @brief membership function
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_MF_H
-#define A_MF_H
+#ifndef LIBA_MF_H
+#define LIBA_MF_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_MF membership function
  @{
@@ -38,38 +37,38 @@
  \f[
   f(x,\sigma,c)=e^{-\frac{(x-c)^2}{2\sigma^2}}
  \f]
  @param[in] x any element
  @param[in] sigma sigma
  @param[in] c c
 */
-A_PUBLIC a_real_t a_mf_gauss(a_real_t x, a_real_t sigma, a_real_t c);
+A_EXTERN a_real_t a_mf_gauss(a_real_t x, a_real_t sigma, a_real_t c);
 
 /*!
  @brief generalized bell-shaped membership function
  \f[
   f(x,a,b,c)=\frac{1}{1+\left|\frac{x-c}{a}\right|^{2b}}
  \f]
  @param[in] x any element
  @param[in] a a
  @param[in] b b
  @param[in] c c
 */
-A_PUBLIC a_real_t a_mf_gbell(a_real_t x, a_real_t a, a_real_t b, a_real_t c);
+A_EXTERN a_real_t a_mf_gbell(a_real_t x, a_real_t a, a_real_t b, a_real_t c);
 
 /*!
  @brief sigmoidal membership function
  \f[
   f(x,a,c)=\frac{1}{1+e^{-a(x-c)}}
  \f]
  @param[in] x any element
  @param[in] a a
  @param[in] c c
 */
-A_PUBLIC a_real_t a_mf_sig(a_real_t x, a_real_t a, a_real_t c);
+A_EXTERN a_real_t a_mf_sig(a_real_t x, a_real_t a, a_real_t c);
 
 /*!
  @brief trapezoidal membership function
  \f[
   f(x,a,b,c,d)=\begin{cases}
   0 & x \le a \\
   \frac{x-a}{b-a} & a \le x \le b \\
@@ -80,15 +79,15 @@
  \f]
  @param[in] x any element
  @param[in] a a
  @param[in] b b
  @param[in] c c
  @param[in] d d
 */
-A_PUBLIC a_real_t a_mf_trap(a_real_t x, a_real_t a, a_real_t b, a_real_t c, a_real_t d);
+A_EXTERN a_real_t a_mf_trap(a_real_t x, a_real_t a, a_real_t b, a_real_t c, a_real_t d);
 
 /*!
  @brief triangular membership function
  \f[
   f(x,a,b,c,d)=\begin{cases}
   0 & x \le a \\
   \frac{x-a}{b-a} & a \le x \le b \\
@@ -97,15 +96,15 @@
   \end{cases}
  \f]
  @param[in] x any element
  @param[in] a a
  @param[in] b b
  @param[in] c c
 */
-A_PUBLIC a_real_t a_mf_tri(a_real_t x, a_real_t a, a_real_t b, a_real_t c);
+A_EXTERN a_real_t a_mf_tri(a_real_t x, a_real_t a, a_real_t b, a_real_t c);
 
 /*!
  @brief z-shaped membership function
  \f[
   f(x,a,b,c,d)=\begin{cases}
   1 & x \le a \\
   1-2(\frac{x-a}{b-a})^2 & a \le x \le \frac{a+b}{2} \\
@@ -113,33 +112,35 @@
   0 & x \ge c \\
   \end{cases}
  \f]
  @param[in] x any element
  @param[in] a a
  @param[in] b b
 */
-A_PUBLIC a_real_t a_mf_z(a_real_t x, a_real_t a, a_real_t b);
+A_EXTERN a_real_t a_mf_z(a_real_t x, a_real_t a, a_real_t b);
 
 /*!
  @brief membership function
  @param[in] e type for membership function
-  @arg \ref A_MF_GAUSS a_mf_gauss(x, sigma, c)
-  @arg \ref A_MF_GBELL a_mf_gbell(x, a, b, c)
-  @arg \ref A_MF_SIG   a_mf_sig(x, a, c)
-  @arg \ref A_MF_TRAP  a_mf_trap(x, a, b, c, d)
-  @arg \ref A_MF_TRI   a_mf_tri(x, a, b, c)
-  @arg \ref A_MF_Z     a_mf_z(x, a, b)
+ |                   |                          |
+ | :---------------- | ------------------------ |
+ | \ref A_MF_GAUSS   | a_mf_gauss(x, sigma, c)  |
+ | \ref A_MF_GBELL   | a_mf_gbell(x, a, b, c)   |
+ | \ref A_MF_SIG     | a_mf_sig(x, a, c)        |
+ | \ref A_MF_TRAP    | a_mf_trap(x, a, b, c, d) |
+ | \ref A_MF_TRI     | a_mf_tri(x, a, b, c)     |
+ | \ref A_MF_Z       | a_mf_z(x, a, b)          |
  @param[in] x any element
  @param[in] a paramarrays
-  @arg a[2] \ref a_mf_gauss \ref a_mf_sig \ref a_mf_z
-  @arg a[3] \ref a_mf_gbell \ref a_mf_tri
-  @arg a[4] \ref a_mf_trap
+  @arg \b a[2] \ref a_mf_gauss \ref a_mf_sig \ref a_mf_z
+  @arg \b a[3] \ref a_mf_gbell \ref a_mf_tri
+  @arg \b a[4] \ref a_mf_trap
 */
-A_PUBLIC a_real_t a_mf(a_uint_t e, a_real_t x, a_real_t *a);
+A_EXTERN a_real_t a_mf(a_uint_t e, a_real_t x, a_real_t const *a);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_MF */
 
-#endif /* A_MF_H */
+#endif /* mf.h */
```

### Comparing `liba-0.1.1rc4/include/a/notefreqs.h` & `liba-0.1.1rc5/include/a/notefreqs.h`

 * *Files 0% similar despite different names*

```diff
@@ -19,19 +19,18 @@
  \f[
  W_n = \cfrac {c} {f_n}
  \f]
  where \f$W\f$ is the wavelength and \f$c\f$ is the speed of sound.
  The speed of sound depends on temperature,
  but is approximately 345 m/s at "room temperature."
  http://pages.mtu.edu/~suits/notefreqs.html
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_NOTEFREQS_H
-#define A_NOTEFREQS_H
+#ifndef LIBA_NOTEFREQS_H
+#define LIBA_NOTEFREQS_H
 
 /*!
  @ingroup A
  @addtogroup A_NOTEFREQ note frequency table
  @{
 */
 
@@ -1481,8 +1480,8 @@
 #define A_NOTEFREQ_Bb8 A_NOTEFREQ_CAST(A_NOTEFREQ_FREQ / A_NOTEFREQ_FREQ_Bb8) /*!< Bb8 */
 #define A_NOTEFREQ_B8  A_NOTEFREQ_CAST(A_NOTEFREQ_FREQ / A_NOTEFREQ_FREQ_B8)  /*!< B8  */
 
 // clang-format on
 
 /*! @} A_NOTEFREQ */
 
-#endif /* A_NOTEFREQS_H */
+#endif /* notefreqs.h */
```

### Comparing `liba-0.1.1rc4/include/a/oop.h` & `liba-0.1.1rc5/include/a/oop.h`

 * *Files 8% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file oop.h
  @brief Object Oriented Programming Macros
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_OOP_H
-#define A_OOP_H
+#ifndef LIBA_OOP_H
+#define LIBA_OOP_H
 
 #include "a.h"
 
 #include <stdlib.h>
 
 /*!
  @ingroup A
@@ -100,8 +99,8 @@
 #define A_OOP_CREATE A_OOP_NEW
 #define A_OOP_DELETE A_OOP_DIE
 #define A_OOP_CREATE_VA A_OOP_NEW_VA
 #define A_OOP_DELETE_VA A_OOP_DIE_VA
 
 /*! @} A_OOP */
 
-#endif /* A_OOP_H */
+#endif /* oop.h */
```

### Comparing `liba-0.1.1rc4/include/a/operator.h` & `liba-0.1.1rc5/include/a/operator.h`

 * *Files 4% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file operator.h
  @brief algorithm library operators
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_OPERATOR_H
-#define A_OPERATOR_H
+#ifndef LIBA_OPERATOR_H
+#define LIBA_OPERATOR_H
 
 /*!
  @ingroup A
  @addtogroup A_OPERATOR algorithm library operators
  @{
 */
 
@@ -61,8 +60,8 @@
 #define a_xor_eq(a, b) ((a) ^= (b)) //!< in-place assignment by bitwise XOR (exclusive or)
 #define a_or_eq(a, b)  ((a) |= (b)) //!< in-place assignment by bitwise OR (inclusive or)
 
 // clang-format on
 
 /*! @} A_OPERATOR */
 
-#endif /* A_OPERATOR_H */
+#endif /* operator.h */
```

### Comparing `liba-0.1.1rc4/include/a/pid.h` & `liba-0.1.1rc5/include/a/pid.h`

 * *Files 13% similar despite different names*

```diff
@@ -20,33 +20,32 @@
  \f}
  - incremental PID controller
  \f{aligned}{
   \Delta u(k) &= K_p [e(k)-e(k-1)] + K_i e(k) + K_d [e(k)+e(k-2)-2e(k-1)] \\
               &= (K_p+K_i+K_d) e(k) + (-K_p-2K_i) e(k-1) + K_d e(k-2)
  \f}
  https://en.wikipedia.org/wiki/PID_controller
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_PID_H
-#define A_PID_H
+#ifndef LIBA_PID_H
+#define LIBA_PID_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_PID proportional integral derivative controller
  @{
 */
 
-#define A_PID_NUM_BITS 8
+#define A_PID_NUM_BITS 8 // 00000000 11111111
 #define A_PID_NUM_MASK ((1U << A_PID_NUM_BITS) - 1U)
-#define A_PID_REG_BITS 8
+#define A_PID_REG_BITS 8 // 00000000 11111111
 #define A_PID_REG_MASK ((1U << A_PID_REG_BITS) - 1U)
-#define A_PID_MODE_BITS 2
+#define A_PID_MODE_BITS 2 // 00000000 00000011
 #define A_PID_MODE_MASK ((1U << A_PID_MODE_BITS) - 1U)
 
 /*!
  @brief instance enumeration for PID controller mode
 */
 typedef enum a_pid_e
 {
@@ -75,231 +74,239 @@
     a_uint_t num; //!< number register
     a_uint_t reg; //!< status register
 } a_pid_s;
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
+#if defined(LIBA_PID_C)
+#undef A_INTERN
+#define A_INTERN A_INLINE
+#endif /* LIBA_PID_C */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_real_t a_pid_dt(const a_pid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_real_t a_pid_dt(a_pid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_real_t a_pid_dt(const a_pid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_real_t a_pid_dt(a_pid_s const *const ctx)
 {
     return ctx->dt;
 }
 #endif /* A_HAVE_INLINE */
 
-A_PUBLIC a_void_t a_pid_set_dt(a_pid_s *ctx, a_real_t dt);
+A_EXTERN a_void_t a_pid_set_dt(a_pid_s *ctx, a_real_t dt);
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_real_t a_pid_kp(const a_pid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_real_t a_pid_kp(a_pid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_real_t a_pid_kp(const a_pid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_real_t a_pid_kp(a_pid_s const *const ctx)
 {
     return ctx->kp;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_void_t a_pid_set_kp(a_pid_s *ctx, a_real_t kp);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_void_t a_pid_set_kp(a_pid_s *ctx, a_real_t kp);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_void_t a_pid_set_kp(a_pid_s *ctx, a_real_t kp)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_void_t a_pid_set_kp(a_pid_s *const ctx, a_real_t const kp)
 {
     ctx->kp = kp;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_real_t a_pid_ki(const a_pid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_real_t a_pid_ki(a_pid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_real_t a_pid_ki(const a_pid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_real_t a_pid_ki(a_pid_s const *const ctx)
 {
     return ctx->ki / ctx->dt;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_void_t a_pid_set_ki(a_pid_s *ctx, a_real_t ki);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_void_t a_pid_set_ki(a_pid_s *ctx, a_real_t ki);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_void_t a_pid_set_ki(a_pid_s *ctx, a_real_t ki)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_void_t a_pid_set_ki(a_pid_s *const ctx, a_real_t const ki)
 {
     ctx->ki = ki * ctx->dt;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_real_t a_pid_kd(const a_pid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_real_t a_pid_kd(a_pid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_real_t a_pid_kd(const a_pid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_real_t a_pid_kd(a_pid_s const *const ctx)
 {
     return ctx->kd * ctx->dt;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_void_t a_pid_set_kd(a_pid_s *ctx, a_real_t kd);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_void_t a_pid_set_kd(a_pid_s *ctx, a_real_t kd);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_void_t a_pid_set_kd(a_pid_s *ctx, a_real_t kd)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_void_t a_pid_set_kd(a_pid_s *const ctx, a_real_t const kd)
 {
     ctx->kd = kd / ctx->dt;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_uint_t a_pid_num(const a_pid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_uint_t a_pid_num(a_pid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_uint_t a_pid_num(const a_pid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_uint_t a_pid_num(a_pid_s const *const ctx)
 {
     return ctx->num & A_PID_NUM_MASK;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_void_t a_pid_set_num(a_pid_s *ctx, a_uint_t num);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_void_t a_pid_set_num(a_pid_s *ctx, a_uint_t num);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_void_t a_pid_set_num(a_pid_s *ctx, a_uint_t num)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_void_t a_pid_set_num(a_pid_s *const ctx, a_uint_t const num)
 {
     ctx->num &= ~A_PID_NUM_MASK;
     ctx->num |= num & A_PID_NUM_MASK;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_uint_t a_pid_reg(const a_pid_s *ctx);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_uint_t a_pid_reg(a_pid_s const *ctx);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_uint_t a_pid_reg(const a_pid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_uint_t a_pid_reg(a_pid_s const *const ctx)
 {
     return ctx->reg & A_PID_REG_MASK;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_void_t a_pid_set_reg(a_pid_s *ctx, a_uint_t reg);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_void_t a_pid_set_reg(a_pid_s *ctx, a_uint_t reg);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_void_t a_pid_set_reg(a_pid_s *ctx, a_uint_t reg)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_void_t a_pid_set_reg(a_pid_s *const ctx, a_uint_t const reg)
 {
     ctx->reg &= ~A_PID_REG_MASK;
     ctx->reg |= reg & A_PID_REG_MASK;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_uint_t a_pid_mode(const a_pid_s *mode);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_uint_t a_pid_mode(a_pid_s const *mode);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_uint_t a_pid_mode(const a_pid_s *ctx)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_uint_t a_pid_mode(a_pid_s const *const ctx)
 {
     return ctx->reg & A_PID_MODE_MASK;
 }
 #endif /* A_HAVE_INLINE */
 
-#if !defined A_HAVE_INLINE || defined(A_PID_I)
-A_PUBLIC a_void_t a_pid_set_mode(a_pid_s *ctx, a_uint_t mode);
+#if !defined A_HAVE_INLINE || defined(LIBA_PID_C)
+A_EXTERN a_void_t a_pid_set_mode(a_pid_s *ctx, a_uint_t mode);
 #endif /* A_HAVE_INLINE */
-#if defined(A_HAVE_INLINE) || defined(A_PID_I)
-A_INTERN a_void_t a_pid_set_mode(a_pid_s *ctx, a_uint_t mode)
+#if defined(A_HAVE_INLINE) || defined(LIBA_PID_C)
+A_INTERN a_void_t a_pid_set_mode(a_pid_s *const ctx, a_uint_t const mode)
 {
     ctx->reg &= ~A_PID_MODE_MASK;
     ctx->reg |= mode & A_PID_MODE_MASK;
 }
 #endif /* A_HAVE_INLINE */
 
 /*!
  @brief turn off PID controller
  @param[in,out] ctx points to an instance of PID controller
 */
-A_PUBLIC a_pid_s *a_pid_off(a_pid_s *ctx);
+A_EXTERN a_pid_s *a_pid_off(a_pid_s *ctx);
 
 /*!
  @brief incremental PID controller
  @param[in,out] ctx points to an instance of PID controller
 */
-A_PUBLIC a_pid_s *a_pid_inc(a_pid_s *ctx);
+A_EXTERN a_pid_s *a_pid_inc(a_pid_s *ctx);
 
 /*!
  @brief positional PID controller
  @param[in,out] ctx points to an instance of PID controller
  @param[in] max maximum intergral output
 */
-A_PUBLIC a_pid_s *a_pid_pos(a_pid_s *ctx, a_real_t max);
+A_EXTERN a_pid_s *a_pid_pos(a_pid_s *ctx, a_real_t max);
 
 /*!
  @brief set proportional integral derivative constant for PID controller
  @param[in,out] ctx points to an instance of PID controller
  @param[in] kp proportional constant
  @param[in] ki integral constant
  @param[in] kd derivative constant
 */
-A_PUBLIC a_pid_s *a_pid_kpid(a_pid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd);
+A_EXTERN a_pid_s *a_pid_kpid(a_pid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd);
 
 /*!
- @brief set buffer for PID controller
+ @brief set buffer for multichannel PID controller
  @param[in,out] ctx points to an instance of PID controller
  @param[in] num number of controllers output
  @param[in] out points to controllers output
  @param[in] fdb points to cache feedback buffer
  @param[in] sum points to (integral) output buffer
  @param[in] ec points to error change buffer
  @param[in] e points to error input buffer
 */
-A_PUBLIC a_pid_s *a_pid_setp(a_pid_s *ctx, a_uint_t num, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e);
+A_EXTERN a_pid_s *a_pid_chan(a_pid_s *ctx, a_uint_t num, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e);
 
 /*!
  @brief initialize function for PID controller, default is turn off
  @param[in,out] ctx points to an instance of PID controller
  @param[in] dt sampling time unit(s)
  @param[in] min minimum output
  @param[in] max maximum output
 */
-A_PUBLIC a_pid_s *a_pid_init(a_pid_s *ctx, a_real_t dt, a_real_t min, a_real_t max);
+A_EXTERN a_pid_s *a_pid_init(a_pid_s *ctx, a_real_t dt, a_real_t min, a_real_t max);
 
 /*!
  @brief calculate function for PID controller
  @param[in,out] ctx points to an instance of PID controller
  @param[in] set setpoint
  @param[in] fdb feedback
- @return output
+ @return output value
   @retval set when PID controller is off
 */
-A_PUBLIC a_real_t a_pid_outv(a_pid_s *ctx, a_real_t set, a_real_t fdb);
+A_EXTERN a_real_t a_pid_outv(a_pid_s *ctx, a_real_t set, a_real_t fdb);
 
 /*!
- @brief calculate function for PID controller
+ @brief calculate function for multichannel PID controller
  @param[in,out] ctx points to an instance of PID controller
  @param[in] set points to setpoint
  @param[in] fdb points to feedback
  @return points to output
   @retval set when PID controller is off
 */
-A_PUBLIC a_real_t *a_pid_outp(a_pid_s *ctx, a_real_t *set, a_real_t *fdb);
+A_EXTERN a_real_t *a_pid_outp(a_pid_s *ctx, a_real_t *set, a_real_t *fdb);
 
 /*!
  @brief terminate function for PID controller
  @param[in,out] ctx points to an instance of PID controller
 */
-A_PUBLIC a_pid_s *a_pid_exit(a_pid_s *ctx);
+A_EXTERN a_pid_s *a_pid_exit(a_pid_s *ctx);
 
 /*!
  @brief zero function for PID controller
  @param[in,out] ctx points to an instance of PID controller
 */
-A_PUBLIC a_pid_s *a_pid_zero(a_pid_s *ctx);
+A_EXTERN a_pid_s *a_pid_zero(a_pid_s *ctx);
 
+#if defined(LIBA_PID_C)
+#undef A_INTERN
+#define A_INTERN static A_INLINE
+#endif /* LIBA_PID_C */
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_PID */
 
-#endif /* A_PID_H */
+#endif /* pid.h */
```

### Comparing `liba-0.1.1rc4/include/a/poly.h` & `liba-0.1.1rc5/include/a/poly.h`

 * *Files 15% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file poly.h
  @brief polynomial
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_POLY_H
-#define A_POLY_H
+#ifndef LIBA_POLY_H
+#define LIBA_POLY_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_POLY polynomial
  @{
@@ -18,42 +17,42 @@
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
 /*!
  @brief convert between \f$ \sum_{i=0}^{n}a_{i}x^{i} \f$ and \f$ \sum_{i=0}^{n}a_{i}x^{n-i} \f$
 */
-A_PUBLIC a_real_t *a_poly_inv(a_real_t *a, a_size_t n);
+A_EXTERN a_real_t *a_poly_inv(a_real_t *a, a_size_t n);
 
 /*!
  @brief horner function for polynomial \f$ \sum_{i=0}^{n}a_{i}x^{i} \f$
  \f[
   \left\{\begin{array}{l}
   S_n = a_n\\
   S_i = xS_{i+1} + a_i,\quad(i=n-1,n-2,\cdots,1,0)\\
   P(x) = S_0
   \end{array}\right.
  \f]
 */
-A_PUBLIC a_real_t a_poly_eval(const a_real_t *a, a_size_t n, a_real_t x);
-A_PUBLIC a_real_t *a_poly_evaln(const a_real_t *a, a_size_t n, const a_real_t *ptr, a_size_t num, a_real_t *out);
+A_EXTERN a_real_t a_poly_eval(a_real_t const *a, a_size_t n, a_real_t x);
+A_EXTERN a_real_t *a_poly_evaln(a_real_t const *a, a_size_t n, a_real_t const *ptr, a_size_t num, a_real_t *out);
 
 /*!
  @brief horner function for polynomial \f$ \sum_{i=0}^{n}a_{i}x^{n-i} \f$
  @f[
   \left\{\begin{array}{l}
   S_0 = a_0\\
   S_i = xS_{i-1} + a_i,\quad(i=1,2,\cdots,n-1,n)\\
   P(x) = S_n
   \end{array}\right.
  @f]
 */
-A_PUBLIC a_real_t a_poly_evar(const a_real_t *a, a_size_t n, a_real_t x);
-A_PUBLIC a_real_t *a_poly_evarn(const a_real_t *a, a_size_t n, const a_real_t *ptr, a_size_t num, a_real_t *out);
+A_EXTERN a_real_t a_poly_evar(a_real_t const *a, a_size_t n, a_real_t x);
+A_EXTERN a_real_t *a_poly_evarn(a_real_t const *a, a_size_t n, a_real_t const *ptr, a_size_t num, a_real_t *out);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_POLY */
 
-#endif /* A_POLY_H */
+#endif /* poly.h */
```

### Comparing `liba-0.1.1rc4/include/a/polytrack.h` & `liba-0.1.1rc5/include/a/polytrack.h`

 * *Files 6% similar despite different names*

```diff
@@ -1,16 +1,15 @@
 /*!
  @file polytrack.h
  @brief polynomial trajectory
- @details Trajectory Planning for Automatic Machines and Robots.
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
+ @details Trajectory Planning for Automatic Machines and Robots
 */
 
-#ifndef A_POLYTRACK_H
-#define A_POLYTRACK_H
+#ifndef LIBA_POLYTRACK_H
+#define LIBA_POLYTRACK_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_POLYTRACK polynomial trajectory
  @{
@@ -67,41 +66,41 @@
  @param[in] q position
   @arg 0 source
   @arg 1 target
  @param[in] v velocity
   @arg 0 source
   @arg 1 target
 */
-A_PUBLIC a_void_t a_polytrack3_init1(a_polytrack3_s *ctx, const a_real_t t[2], const a_real_t q[2], const a_real_t v[2]);
+A_EXTERN a_void_t a_polytrack3_init1(a_polytrack3_s *ctx, a_real_t const t[2], a_real_t const q[2], a_real_t const v[2]);
 
 /*!
  @brief initialize function for cubic polynomial trajectory
  @param[in,out] ctx points to an instance of cubic polynomial trajectory
  @param[in] source source for trajectory
   @arg 0 time for source
   @arg 1 position for source
   @arg 2 velocity for source
  @param[in] target target for trajectory
   @arg 0 time for target
   @arg 1 position for target
   @arg 2 velocity for target
 */
-A_PUBLIC a_void_t a_polytrack3_init2(a_polytrack3_s *ctx, const a_real_t source[3], const a_real_t target[3]);
+A_EXTERN a_void_t a_polytrack3_init2(a_polytrack3_s *ctx, a_real_t const source[3], a_real_t const target[3]);
 
 /*!
  @brief initialize function for cubic polynomial trajectory
  @param[in,out] ctx points to an instance of cubic polynomial trajectory
  @param[in] t0 time for source
  @param[in] t1 time for target
  @param[in] q0 position for source
  @param[in] q1 position for target
  @param[in] v0 velocity for source
  @param[in] v1 velocity for target
 */
-A_PUBLIC a_void_t a_polytrack3_init(a_polytrack3_s *ctx,
+A_EXTERN a_void_t a_polytrack3_init(a_polytrack3_s *ctx,
                                     a_real_t t0, a_real_t t1,
                                     a_real_t q0, a_real_t q1,
                                     a_real_t v0, a_real_t v1);
 
 /*!
  @brief generation function for cubic polynomial trajectory
  @f{aligned}{
@@ -112,72 +111,72 @@
   k_{1}=v_{0}\\
   k_{2}=\cfrac{\left(-2\,v_{0}-v_{1}\right)\,t+3\,q}{t^2}\\
   k_{3}=\cfrac{\left(v_{0}+v_{1}\right)\,t-2\,q}{t^3}
   \end{array}\right.
  @f}
  @param[in,out] ctx points to an instance of cubic polynomial trajectory
 */
-A_PUBLIC a_void_t a_polytrack3_gen(a_polytrack3_s *ctx);
+A_EXTERN a_void_t a_polytrack3_gen(a_polytrack3_s *ctx);
 
 /*!
- @brief process function for cubic polynomial trajectory
+ @brief calculate function for cubic polynomial trajectory
  @f{aligned}{
   \begin{array}{l}
   q(t)=k_{0}+k_{1}\left(t-t_{0}\right)+k_{2}\left(t-t_{0}\right)^{2}+k_{3}\left(t-t_{0}\right)^{3} \\
   \dot{q}(t)=k_{1}+2 k_{2}\left(t-t_{0}\right)+3 k_{3}\left(t-t_{0}\right)^{2} \\
   \ddot{q}(t)=2 k_{2}+6 k_{3}\left(t-t_{0}\right)
   \end{array}
  @f}
  @param[in] ctx points to an instance of cubic polynomial trajectory
  @param[in] ts current time unit(s)
  @param[out] out buffer for result
   @arg 0 position output
   @arg 1 velocity output
   @arg 2 acceleration output
 */
-A_PUBLIC a_void_t a_polytrack3_out(const a_polytrack3_s *ctx, a_real_t ts, a_real_t out[3]);
+A_EXTERN a_void_t a_polytrack3_out(a_polytrack3_s const *ctx, a_real_t ts, a_real_t out[3]);
 
 /*!
- @brief process function for cubic polynomial trajectory position
+ @brief calculate function for cubic polynomial trajectory position
  @f{aligned}{
   \begin{array}{l}
   q(t)=k_{0}+k_{1}\left(t-t_{0}\right)+k_{2}\left(t-t_{0}\right)^{2}+k_{3}\left(t-t_{0}\right)^{3} \\
   \end{array}
  @f}
  @param[in] ctx points to an instance of cubic polynomial trajectory
  @param[in] ts current time unit(s)
  @return position output
 */
-A_PUBLIC a_real_t a_polytrack3_pos(const a_polytrack3_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack3_pos(a_polytrack3_s const *ctx, a_real_t ts);
 
 /*!
- @brief process function for cubic polynomial trajectory velocity
+ @brief calculate function for cubic polynomial trajectory velocity
  @f{aligned}{
   \begin{array}{l}
   \dot{q}(t)=k_{1}+2 k_{2}\left(t-t_{0}\right)+3 k_{3}\left(t-t_{0}\right)^{2} \\
   \end{array}
  @f}
  @param[in] ctx points to an instance of cubic polynomial trajectory
  @param[in] ts current time unit(s)
  @return velocity output
 */
-A_PUBLIC a_real_t a_polytrack3_vec(const a_polytrack3_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack3_vec(a_polytrack3_s const *ctx, a_real_t ts);
 
 /*!
- @brief process function for cubic polynomial trajectory acceleration
+ @brief calculate function for cubic polynomial trajectory acceleration
  @f{aligned}{
   \begin{array}{l}
   \ddot{q}(t)=2 k_{2}+6 k_{3}\left(t-t_{0}\right)
   \end{array}
  @f}
  @param[in] ctx points to an instance of cubic polynomial trajectory
  @param[in] ts current time unit(s)
  @return acceleration output
 */
-A_PUBLIC a_real_t a_polytrack3_acc(const a_polytrack3_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack3_acc(a_polytrack3_s const *ctx, a_real_t ts);
 
 /* function for quintic polynomial trajectory */
 
 /*!
  @brief initialize function for quintic polynomial trajectory
  @param[in,out] ctx points to an instance of quintic polynomial trajectory
  @param[in] t time
@@ -189,15 +188,15 @@
  @param[in] v velocity
   @arg 0 source
   @arg 1 target
  @param[in] a acceleration
   @arg 0 source
   @arg 1 target
 */
-A_PUBLIC a_void_t a_polytrack5_init1(a_polytrack5_s *ctx, const a_real_t t[2], const a_real_t q[2], const a_real_t v[2], const a_real_t a[2]);
+A_EXTERN a_void_t a_polytrack5_init1(a_polytrack5_s *ctx, a_real_t const t[2], a_real_t const q[2], a_real_t const v[2], a_real_t const a[2]);
 
 /*!
  @brief initialize function for quintic polynomial trajectory
  @param[in,out] ctx points to an instance of quintic polynomial trajectory
  @param[in] source source for trajectory
   @arg 0 time for source
   @arg 1 position for source
@@ -205,29 +204,29 @@
   @arg 3 acceleration for source
  @param[in] target target for trajectory
   @arg 0 time for target
   @arg 1 position for target
   @arg 2 velocity for target
   @arg 3 acceleration for target
 */
-A_PUBLIC a_void_t a_polytrack5_init2(a_polytrack5_s *ctx, const a_real_t source[4], const a_real_t target[4]);
+A_EXTERN a_void_t a_polytrack5_init2(a_polytrack5_s *ctx, a_real_t const source[4], a_real_t const target[4]);
 
 /*!
  @brief initialize function for quintic polynomial trajectory
  @param[in,out] ctx points to an instance of quintic polynomial trajectory
  @param[in] t0 time for source
  @param[in] t1 time for target
  @param[in] q0 position for source
  @param[in] q1 position for target
  @param[in] v0 velocity for source
  @param[in] v1 velocity for target
  @param[in] a0 acceleration for source
  @param[in] a1 acceleration for target
 */
-A_PUBLIC a_void_t a_polytrack5_init(a_polytrack5_s *ctx,
+A_EXTERN a_void_t a_polytrack5_init(a_polytrack5_s *ctx,
                                     a_real_t t0, a_real_t t1,
                                     a_real_t q0, a_real_t q1,
                                     a_real_t v0, a_real_t v1,
                                     a_real_t a0, a_real_t a1);
 
 /*!
  @brief generation function for quintic polynomial trajectory
@@ -241,72 +240,72 @@
   k_{3}=\cfrac{\left(a_{1}-3\,a_{0}\right)\,t^2+\left(-12\,v_{0}-8\,v_{1}\right)\,t+20\,q}{2\,t^3}\\
   k_{4}=\cfrac{\left(3\,a_{0}-2\,a_{1}\right)\,t^2+\left(16\,v_{0}+14\,v_{1}\right)\,t-30\,q}{2\,t^4}\\
   k_{5}=\cfrac{\left(a_{1}-a_{0}\right)\,t^2+\left(-6\,v_{0}-6\,v_{1}\right)\,t+12\,q}{2\,t^5}
   \end{array}\right.
  @f}
  @param[in,out] ctx points to an instance of quintic polynomial trajectory
 */
-A_PUBLIC a_void_t a_polytrack5_gen(a_polytrack5_s *ctx);
+A_EXTERN a_void_t a_polytrack5_gen(a_polytrack5_s *ctx);
 
 /*!
- @brief process function for quintic polynomial trajectory
+ @brief calculate function for quintic polynomial trajectory
  @f{aligned}{
   \begin{array}{l}
   q(t)=k_{0}+k_{1}\left(t-t_{0}\right)+k_{2}\left(t-t_{0}\right)^{2}+k_{3}\left(t-t_{0}\right)^{3}+k_{4}\left(t-t_{0}\right)^{4}+k_{5}\left(t-t_{0}\right)^{5}\\
   \dot{q}(t)=k_{1}+2 k_{2}\left(t-t_{0}\right)+3 k_{3}\left(t-t_{0}\right)^{2}+4 k_{4}\left(t-t_{0}\right)^{3}+5 k_{5}\left(t-t_{0}\right)^{4}\\
   \ddot{q}(t)=2 k_{2}+6 k_{3}\left(t-t_{0}\right)+12 k_{4}\left(t-t_{0}\right)^{2}+20 k_{5}\left(t-t_{0}\right)^{3}
   \end{array}
  @f}
  @param[in] ctx points to an instance of quintic polynomial trajectory
  @param[in] ts current time unit(s)
  @param[out] out buffer for result
   @arg 0 position output
   @arg 1 velocity output
   @arg 2 acceleration output
 */
-A_PUBLIC a_void_t a_polytrack5_out(const a_polytrack5_s *ctx, a_real_t ts, a_real_t out[3]);
+A_EXTERN a_void_t a_polytrack5_out(a_polytrack5_s const *ctx, a_real_t ts, a_real_t out[3]);
 
 /*!
- @brief process function for quintic polynomial trajectory position
+ @brief calculate function for quintic polynomial trajectory position
  @f{aligned}{
   \begin{array}{l}
   q(t)=k_{0}+k_{1}\left(t-t_{0}\right)+k_{2}\left(t-t_{0}\right)^{2}+k_{3}\left(t-t_{0}\right)^{3}+k_{4}\left(t-t_{0}\right)^{4}+k_{5}\left(t-t_{0}\right)^{5}\\
   \end{array}
  @f}
  @param[in] ctx points to an instance of quintic polynomial trajectory
  @param[in] ts current time unit(s)
  @return position output
 */
-A_PUBLIC a_real_t a_polytrack5_pos(const a_polytrack5_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack5_pos(a_polytrack5_s const *ctx, a_real_t ts);
 
 /*!
- @brief process function for quintic polynomial trajectory velocity
+ @brief calculate function for quintic polynomial trajectory velocity
  @f{aligned}{
   \begin{array}{l}
   \dot{q}(t)=k_{1}+2 k_{2}\left(t-t_{0}\right)+3 k_{3}\left(t-t_{0}\right)^{2}+4 k_{4}\left(t-t_{0}\right)^{3}+5 k_{5}\left(t-t_{0}\right)^{4}\\
   \end{array}
  @f}
  @param[in] ctx points to an instance of quintic polynomial trajectory
  @param[in] ts current time unit(s)
  @return velocity output
 */
-A_PUBLIC a_real_t a_polytrack5_vec(const a_polytrack5_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack5_vec(a_polytrack5_s const *ctx, a_real_t ts);
 
 /*!
- @brief process function for quintic polynomial trajectory acceleration
+ @brief calculate function for quintic polynomial trajectory acceleration
  @f{aligned}{
   \begin{array}{l}
   \ddot{q}(t)=2 k_{2}+6 k_{3}\left(t-t_{0}\right)+12 k_{4}\left(t-t_{0}\right)^{2}+20 k_{5}\left(t-t_{0}\right)^{3}
   \end{array}
  @f}
  @param[in] ctx points to an instance of quintic polynomial trajectory
  @param[in] ts current time unit(s)
  @return acceleration output
 */
-A_PUBLIC a_real_t a_polytrack5_acc(const a_polytrack5_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack5_acc(a_polytrack5_s const *ctx, a_real_t ts);
 
 /* function for hepta polynomial trajectory */
 
 /*!
  @brief initialize function for hepta polynomial trajectory
  @param[in,out] ctx points to an instance of hepta polynomial trajectory
  @param[in] t time
@@ -321,15 +320,15 @@
  @param[in] a acceleration
   @arg 0 source
   @arg 1 target
  @param[in] j jerk
   @arg 0 source
   @arg 1 target
 */
-A_PUBLIC a_void_t a_polytrack7_init1(a_polytrack7_s *ctx, const a_real_t t[2], const a_real_t q[2], const a_real_t v[2], const a_real_t a[2], const a_real_t j[2]);
+A_EXTERN a_void_t a_polytrack7_init1(a_polytrack7_s *ctx, a_real_t const t[2], a_real_t const q[2], a_real_t const v[2], a_real_t const a[2], a_real_t const j[2]);
 
 /*!
  @brief initialize function for hepta polynomial trajectory
  @param[in,out] ctx points to an instance of hepta polynomial trajectory
  @param[in] source source for trajectory
   @arg 0 time for source
   @arg 1 position for source
@@ -339,15 +338,15 @@
  @param[in] target target for trajectory
   @arg 0 time for target
   @arg 1 position for target
   @arg 2 velocity for target
   @arg 3 acceleration for target
   @arg 4 jerk for target
 */
-A_PUBLIC a_void_t a_polytrack7_init2(a_polytrack7_s *ctx, const a_real_t source[5], const a_real_t target[5]);
+A_EXTERN a_void_t a_polytrack7_init2(a_polytrack7_s *ctx, a_real_t const source[5], a_real_t const target[5]);
 
 /*!
  @brief initialize function for hepta polynomial trajectory
  @param[in,out] ctx points to an instance of hepta polynomial trajectory
  @param[in] t0 time for source
  @param[in] t1 time for target
  @param[in] q0 position for source
@@ -355,15 +354,15 @@
  @param[in] v0 velocity for source
  @param[in] v1 velocity for target
  @param[in] a0 acceleration for source
  @param[in] a1 acceleration for target
  @param[in] j0 jerk for source
  @param[in] j1 jerk for target
 */
-A_PUBLIC a_void_t a_polytrack7_init(a_polytrack7_s *ctx,
+A_EXTERN a_void_t a_polytrack7_init(a_polytrack7_s *ctx,
                                     a_real_t t0, a_real_t t1,
                                     a_real_t q0, a_real_t q1,
                                     a_real_t v0, a_real_t v1,
                                     a_real_t a0, a_real_t a1,
                                     a_real_t j0, a_real_t j1);
 
 /*!
@@ -380,18 +379,18 @@
   k_{5}=\cfrac{\left(2\,j_{0}+j_{1}\right)\,t^3+\left(20\,a_{0}-14\,a_{1}\right)\,t^2+\left(90\,v_{0}+78\,v_{1}\right)\,t-168\,q}{2\,t^5}\\
   k_{6}=\cfrac{\left(-4\,j_{0}-3\,j_{1}\right)\,t^3+\left(39\,a_{1}-45\,a_{0}\right)\,t^2+\left(-216\,v_{0}-204\,v_{1}\right)\,t+420\,q}{6\,t^6}\\
   k_{7}=\cfrac{\left(j_{0}+j_{1}\right)\,t^3+\left(12\,a_{0}-12\,a_{1}\right)\,t^2+\left(60\,v_{0}+60\,v_{1}\right)\,t-120\,q}{6\,t^7}
   \end{array}\right.
  @f}
  @param[in,out] ctx points to an instance of hepta polynomial trajectory
 */
-A_PUBLIC a_void_t a_polytrack7_gen(a_polytrack7_s *ctx);
+A_EXTERN a_void_t a_polytrack7_gen(a_polytrack7_s *ctx);
 
 /*!
- @brief process function for hepta polynomial trajectory
+ @brief calculate function for hepta polynomial trajectory
  @f{aligned}{
   \begin{array}{l}
   q(t)=k_{0}+k_{1}\left(t-t_{0}\right)+k_{2}\left(t-t_{0}\right)^{2}+k_{3}\left(t-t_{0}\right)^{3}+k_{4}\left(t-t_{0}\right)^{4}+k_{5}\left(t-t_{0}\right)^{5}+k_{6}\left(t-t_{0}\right)^{6}+k_{7}\left(t-t_{0}\right)^{7}\\
   \dot{q}(t)=k_{1}+2 k_{2}\left(t-t_{0}\right)+3 k_{3}\left(t-t_{0}\right)^{2}+4 k_{4}\left(t-t_{0}\right)^{3}+5 k_{5}\left(t-t_{0}\right)^{4}+6 k_{6}\left(t-t_{0}\right)^{5}+7 k_{7}\left(t-t_{0}\right)^{6}\\
   \ddot{q}(t)=2 k_{2}+6 k_{3}\left(t-t_{0}\right)+12 k_{4}\left(t-t_{0}\right)^{2}+20 k_{5}\left(t-t_{0}\right)^{3}+30 k_{6}\left(t-t_{0}\right)^{4}+42 k_{7}\left(t-t_{0}\right)^{5}\\
   q^{(3)}(t)=6 k_{3}+24 k_{4}\left(t-t_{0}\right)+60 k_{5}\left(t-t_{0}\right)^{2}+120 k_{6}\left(t-t_{0}\right)^{3}+210 k_{7}\left(t-t_{0}\right)^{4}
   \end{array}
@@ -400,68 +399,68 @@
  @param[in] ts current time unit(s)
  @param[out] out buffer for result
   @arg 0 position output
   @arg 1 velocity output
   @arg 2 acceleration output
   @arg 3 jerk output
 */
-A_PUBLIC a_void_t a_polytrack7_out(const a_polytrack7_s *ctx, a_real_t ts, a_real_t out[4]);
+A_EXTERN a_void_t a_polytrack7_out(a_polytrack7_s const *ctx, a_real_t ts, a_real_t out[4]);
 
 /*!
- @brief process function for hepta polynomial trajectory position
+ @brief calculate function for hepta polynomial trajectory position
  @f{aligned}{
   \begin{array}{l}
   q(t)=k_{0}+k_{1}\left(t-t_{0}\right)+k_{2}\left(t-t_{0}\right)^{2}+k_{3}\left(t-t_{0}\right)^{3}+k_{4}\left(t-t_{0}\right)^{4}+k_{5}\left(t-t_{0}\right)^{5}+k_{6}\left(t-t_{0}\right)^{6}+k_{7}\left(t-t_{0}\right)^{7}\\
   \end{array}
  @f}
  @param[in] ctx points to an instance of hepta polynomial trajectory
  @param[in] ts current time unit(s)
  @return position output
 */
-A_PUBLIC a_real_t a_polytrack7_pos(const a_polytrack7_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack7_pos(a_polytrack7_s const *ctx, a_real_t ts);
 
 /*!
- @brief process function for hepta polynomial trajectory velocity
+ @brief calculate function for hepta polynomial trajectory velocity
  @f{aligned}{
   \begin{array}{l}
   \dot{q}(t)=k_{1}+2 k_{2}\left(t-t_{0}\right)+3 k_{3}\left(t-t_{0}\right)^{2}+4 k_{4}\left(t-t_{0}\right)^{3}+5 k_{5}\left(t-t_{0}\right)^{4}+6 k_{6}\left(t-t_{0}\right)^{5}+7 k_{7}\left(t-t_{0}\right)^{6}\\
   \end{array}
  @f}
  @param[in] ctx points to an instance of hepta polynomial trajectory
  @param[in] ts current time unit(s)
  @return velocity output
 */
-A_PUBLIC a_real_t a_polytrack7_vec(const a_polytrack7_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack7_vec(a_polytrack7_s const *ctx, a_real_t ts);
 
 /*!
- @brief process function for hepta polynomial trajectory acceleration
+ @brief calculate function for hepta polynomial trajectory acceleration
  @f{aligned}{
   \begin{array}{l}
   \ddot{q}(t)=2 k_{2}+6 k_{3}\left(t-t_{0}\right)+12 k_{4}\left(t-t_{0}\right)^{2}+20 k_{5}\left(t-t_{0}\right)^{3}+30 k_{6}\left(t-t_{0}\right)^{4}+42 k_{7}\left(t-t_{0}\right)^{5}\\
   \end{array}
  @f}
  @param[in] ctx points to an instance of hepta polynomial trajectory
  @param[in] ts current time unit(s)
  @return acceleration output
 */
-A_PUBLIC a_real_t a_polytrack7_acc(const a_polytrack7_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack7_acc(a_polytrack7_s const *ctx, a_real_t ts);
 
 /*!
- @brief process function for hepta polynomial trajectory jerk
+ @brief calculate function for hepta polynomial trajectory jerk
  @f{aligned}{
   \begin{array}{l}
   q^{(3)}(t)=6 k_{3}+24 k_{4}\left(t-t_{0}\right)+60 k_{5}\left(t-t_{0}\right)^{2}+120 k_{6}\left(t-t_{0}\right)^{3}+210 k_{7}\left(t-t_{0}\right)^{4}
   \end{array}
  @f}
  @param[in] ctx points to an instance of hepta polynomial trajectory
  @param[in] ts current time unit(s)
  @return jerk output
 */
-A_PUBLIC a_real_t a_polytrack7_jer(const a_polytrack7_s *ctx, a_real_t ts);
+A_EXTERN a_real_t a_polytrack7_jer(a_polytrack7_s const *ctx, a_real_t ts);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_POLYTRACK */
 
-#endif /* A_POLYTRACK_H */
+#endif /* polytrack.h */
```

### Comparing `liba-0.1.1rc4/include/a/real.h` & `liba-0.1.1rc5/include/a/real.h`

 * *Files 9% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file real.h
  @brief real number
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_REAL_H
-#define A_REAL_H
+#ifndef LIBA_REAL_H
+#define LIBA_REAL_H
 
 #include "a.h"
 #include "math.h"
 
 /*!
  @ingroup A
  @addtogroup A_REAL real number
@@ -43,17 +42,17 @@
 /*! \f$ \frac{1}{\sqrt{2}}=\frac{\sqrt{2}}{2} \f$ */
 #define A_REAL_SQRT1_2 A_REAL_C(0.707106781186547524401)
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
 
-A_PUBLIC a_real_t a_real_log1p(a_real_t x);
-A_PUBLIC a_real_t a_real_hypot(a_real_t x, a_real_t y);
-A_PUBLIC a_real_t a_real_atan2(a_real_t x, a_real_t y);
+A_EXTERN a_real_t a_real_log1p(a_real_t x);
+A_EXTERN a_real_t a_real_hypot(a_real_t x, a_real_t y);
+A_EXTERN a_real_t a_real_atan2(a_real_t x, a_real_t y);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 #define a_real_fpclassify A_REAL_F(fpclassify)
 #define a_real_copysign A_REAL_F(copysign)
@@ -81,38 +80,38 @@
 #define a_real_exp2 A_REAL_F(exp2)
 #define a_real_expm1 A_REAL_F(expm1)
 
 #define a_real_log A_REAL_F(log)
 #define a_real_logb A_REAL_F(logb)
 #define a_real_log2 A_REAL_F(log2)
 #define a_real_log10 A_REAL_F(log10)
-#if defined(A_HAVE_LOG1P)
+#if defined(A_HAVE_LOG1P) && (A_HAVE_LOG1P + 0 > 0)
 #define a_real_log1p A_REAL_F(log1p)
 #endif /* A_HAVE_LOG1P */
 
 #define a_real_pow A_REAL_F(pow)
 #define a_real_sqrt A_REAL_F(sqrt)
 #define a_real_cbrt A_REAL_F(cbrt)
-#if defined(A_HAVE_HYPOT)
+#if defined(A_HAVE_HYPOT) && (A_HAVE_HYPOT + 0 > 0)
 #define a_real_hypot A_REAL_F(hypot)
 #endif /* A_HAVE_HYPOT */
 
 #define a_real_sin A_REAL_F(sin)
 #define a_real_cos A_REAL_F(cos)
 #define a_real_tan A_REAL_F(tan)
 #define a_real_asin A_REAL_F(asin)
 #define a_real_acos A_REAL_F(acos)
 #define a_real_atan A_REAL_F(atan)
-#if defined(A_HAVE_ATAN2)
+#if defined(A_HAVE_ATAN2) && (A_HAVE_ATAN2 + 0 > 0)
 #define a_real_atan2 A_REAL_F(atan2)
 #endif /* A_HAVE_ATAN2 */
 
 #define a_real_sinh A_REAL_F(sinh)
 #define a_real_cosh A_REAL_F(cosh)
 #define a_real_tanh A_REAL_F(tanh)
 #define a_real_asinh A_REAL_F(asinh)
 #define a_real_acosh A_REAL_F(acosh)
 #define a_real_atanh A_REAL_F(atanh)
 
 /*! @} A_REAL */
 
-#endif /* A_REAL_H */
+#endif /* real.h */
```

### Comparing `liba-0.1.1rc4/include/a/slist.h` & `liba-0.1.1rc5/include/a/slist.h`

 * *Files 14% similar despite different names*

```diff
@@ -1,51 +1,73 @@
 /*!
  @file slist.h
- @brief circular singly linked list implementation.
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
+ @brief circular singly linked list implementation
 */
 
-#ifndef A_SLIST_H
-#define A_SLIST_H
+#ifndef LIBA_SLIST_H
+#define LIBA_SLIST_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_SLIST circular singly linked list
  @{
 */
 
+// clang-format off
+#define A_SLIST_NODE(node) {&(node)}
+#define A_SLIST_INIT(list) {{&(list).head}, &(list).head}
+// clang-format on
+
 /*!
  @brief instance structure for circular singly linked list node
 */
 typedef union a_slist_u
 {
     union a_slist_u *next;
 } a_slist_u;
 
 /*!
  @brief cast a list pointer from another type pointer
  @param[in] obj points to circular singly linked list node
  @return a pointer to circular singly linked list node
 */
-A_INTERN a_slist_u *a_slist_from(a_vptr_t obj) { return a_cast_s(a_slist_u *, obj); }
+A_INTERN a_slist_u *a_slist_from(a_vptr_t const obj) { return a_cast_s(a_slist_u *, obj); }
+
+/*!
+ @brief test whether a list node is null
+ @param[in] ctx points to circular singly linked list node
+ @return int bool
+  @retval 0 non-null
+  @retval 1 null
+*/
+A_INTERN a_bool_t a_slist_null(a_slist_u const *const ctx) { return ctx->next == ctx; }
+
+/*!
+ @brief test whether a list node is used
+ @param[in] ctx points to circular singly linked list node
+ @return int bool
+  @retval 0 unused
+  @retval 1 used
+*/
+A_INTERN a_bool_t a_slist_used(a_slist_u const *const ctx) { return ctx->next != ctx; }
 
 /*!
  @brief initialize for circular singly linked list node
  @param[in,out] ctx points to circular singly linked list node
 */
-A_INTERN a_void_t a_slist_node(a_slist_u *ctx) { ctx->next = ctx; }
+A_INTERN a_void_t a_slist_node(a_slist_u *const ctx) { ctx->next = ctx; }
 
 /*!
  @brief instance structure for circular singly linked list head
 */
 typedef struct a_slist_s
 {
-    a_slist_u head[1];
+    a_slist_u head;
     a_slist_u *tail;
 } a_slist_s;
 
 /*!
  @brief access the struct for this entry
  @param ptr the &a_slist_u pointer
  @param type the type of the struct this is embedded in
@@ -56,193 +78,175 @@
 
 /*!
  @brief iterate over a list
  @param it the &a_slist_u to use as a loop counter
  @param ctx points to circular singly linked list head
 */
 #define a_slist_foreach(it, ctx) \
-    for (a_slist_u *it = (ctx)->head->next; it != (ctx)->head; it = it->next)
+    for (a_slist_u *it = (ctx)->head.next; it != &(ctx)->head; it = it->next)
 
 /*!
  @brief iterate over a list safe against removal of list entry
  @param it the &a_slist_u to use as a loop counter
  @param at another &a_slist_u to use as temporary storage
  @param ctx points to circular singly linked list head
 */
-#define a_slist_forsafe(it, at, ctx)                                     \
-    for (a_slist_u *at = (ctx)->head, *it = at->next; it != (ctx)->head; \
+#define a_slist_forsafe(it, at, ctx)                                       \
+    for (a_slist_u *at = &(ctx)->head, *it = at->next; it != &(ctx)->head; \
          at = (it && it == at->next) ? it : at, it = at->next)
 
 /*!
- @brief constructor for circular singly linked list head
- @param[in,out] ctx points to circular singly linked list head
-*/
-A_INTERN a_void_t a_slist_ctor(a_slist_s *ctx) { ctx->tail = ctx->head->next = ctx->head; }
-
-/*!
- @brief initialize for circular singly linked list head
- @param[in,out] ctx points to circular singly linked list head
-*/
-A_INTERN a_void_t a_slist_init(a_slist_s *ctx) { ctx->tail = ctx->head->next = ctx->head; }
-
-/*!
- @brief destructor for circular singly linked list head
- @param[in,out] ctx points to circular singly linked list head
-*/
-A_INTERN a_void_t a_slist_dtor(a_slist_s *ctx) { ctx->tail = ctx->head->next = ctx->head; }
-
-/*!
- @brief test whether a list node is null
- @param[in] ctx points to circular singly linked list node
- @return int bool
-  @retval 0 non-null
-  @retval 1 null
-*/
-A_INTERN a_bool_t a_slist_null(const a_slist_u *ctx) { return ctx->next == ctx; }
-
-/*!
- @brief test whether a list node is used
- @param[in] ctx points to circular singly linked list node
- @return int bool
-  @retval 0 unused
-  @retval 1 used
-*/
-A_INTERN a_bool_t a_slist_used(const a_slist_u *ctx) { return ctx->next != ctx; }
-
-/*!
  @brief test whether a list head is none
  @param[in] ctx points to circular singly linked list head
  @return int bool
   @retval 0 exist
   @retval 1 none
 */
-A_INTERN a_bool_t a_slist_none(const a_slist_s *ctx) { return ctx->head == ctx->head->next; }
+A_INTERN a_bool_t a_slist_none(a_slist_s const *const ctx) { return &ctx->head == ctx->head.next; }
 
 /*!
  @brief test whether a list node is a tail node
  @param[in] ctx points to circular singly linked list head
  @param[in] node a list node
  @return int bool
   @retval 0 it's not a tail node
   @retval 1 it is a tail node
 */
-A_INTERN a_bool_t a_slist_tail(const a_slist_s *ctx, const a_slist_u *node) { return ctx->head == node->next; }
+A_INTERN a_bool_t a_slist_tail(a_slist_s const *const ctx, a_slist_u const *const node) { return &ctx->head == node->next; }
+
+/*!
+ @brief constructor for circular singly linked list head
+ @param[in,out] ctx points to circular singly linked list head
+*/
+A_INTERN a_void_t a_slist_ctor(a_slist_s *const ctx) { ctx->tail = ctx->head.next = &ctx->head; }
+
+/*!
+ @brief initialize for circular singly linked list head
+ @param[in,out] ctx points to circular singly linked list head
+*/
+A_INTERN a_void_t a_slist_init(a_slist_s *const ctx) { ctx->tail = ctx->head.next = &ctx->head; }
+
+/*!
+ @brief destructor for circular singly linked list head
+ @param[in,out] ctx points to circular singly linked list head
+*/
+A_INTERN a_void_t a_slist_dtor(a_slist_s *const ctx) { ctx->tail = ctx->head.next = &ctx->head; }
 
 /*!
  @brief link head node and tail node
  @param[in,out] head the head node of a list
  @param[in,out] tail the tail node of a list
 */
-A_INTERN a_void_t a_slist_link(a_slist_u *head, a_slist_u *tail) { head->next = tail; }
+A_INTERN a_void_t a_slist_link(a_slist_u *const head, a_slist_u *const tail) { head->next = tail; }
 
 /*!
  @brief insert a node to a list
  @param[in,out] ctx points to circular singly linked list head
  @param[in] prev previous list node
  @param[in] node a list node
 */
-A_INTERN a_void_t a_slist_add(a_slist_s *ctx, a_slist_u *prev, a_slist_u *node)
+A_INTERN a_void_t a_slist_add(a_slist_s *const ctx, a_slist_u *const prev, a_slist_u *const node)
 {
     if (a_slist_tail(ctx, prev))
     {
         ctx->tail = node;
     }
     a_slist_link(node, prev->next);
     a_slist_link(prev, node);
 }
 
 /*!
  @brief insert a node to a list head
  @param[in,out] ctx points to circular singly linked list head
  @param[in] node a list node
 */
-A_INTERN a_void_t a_slist_add_head(a_slist_s *ctx, a_slist_u *node)
+A_INTERN a_void_t a_slist_add_head(a_slist_s *const ctx, a_slist_u *const node)
 {
     if (a_slist_none(ctx))
     {
         ctx->tail = node;
     }
-    a_slist_link(node, ctx->head->next);
-    a_slist_link(ctx->head, node);
+    a_slist_link(node, ctx->head.next);
+    a_slist_link(&ctx->head, node);
 }
 
 /*!
  @brief insert a node to a list tail
  @param[in,out] ctx points to circular singly linked list head
  @param[in] node a list node
 */
-A_INTERN a_void_t a_slist_add_tail(a_slist_s *ctx, a_slist_u *node)
+A_INTERN a_void_t a_slist_add_tail(a_slist_s *const ctx, a_slist_u *const node)
 {
-    a_slist_link(node, ctx->head);
+    a_slist_link(node, &ctx->head);
     a_slist_link(ctx->tail, node);
     ctx->tail = node;
 }
 
 /*!
  @brief delete a node from a list
  @param[in,out] ctx points to circular singly linked list head
  @param[in] prev previous list node
 */
-A_INTERN a_void_t a_slist_del(a_slist_s *ctx, a_slist_u *prev)
+A_INTERN a_void_t a_slist_del(a_slist_s *const ctx, a_slist_u *const prev)
 {
-    a_slist_u *node = prev->next;
+    a_slist_u *const node = prev->next;
     a_slist_link(prev, node->next);
     if (a_slist_tail(ctx, node))
     {
         ctx->tail = prev;
     }
 }
 
 /*!
  @brief delete a node from a list head
  @param[in,out] ctx points to circular singly linked list head
 */
-A_INTERN a_void_t a_slist_del_head(a_slist_s *ctx)
+A_INTERN a_void_t a_slist_del_head(a_slist_s *const ctx)
 {
-    a_slist_u *node = ctx->head->next;
-    a_slist_link(ctx->head, node->next);
+    a_slist_u *const node = ctx->head.next;
+    a_slist_link(&ctx->head, node->next);
     if (a_slist_tail(ctx, node))
     {
-        ctx->tail = ctx->head;
+        ctx->tail = &ctx->head;
     }
 }
 
 /*!
  @brief moving a list to another list
  @param[in,out] ctx points to circular singly linked list head
  @param[in] at the previous &a_slist_u of the inserted node
  @param[in] src source list
 */
-A_INTERN a_void_t a_slist_mov(a_slist_s *ctx, a_slist_u *at, a_slist_s *src)
+A_INTERN a_void_t a_slist_mov(a_slist_s *const ctx, a_slist_u *const at, a_slist_s *const src)
 {
     if (a_slist_none(src))
     {
         return;
     }
     if (a_slist_tail(ctx, at))
     {
         ctx->tail = src->tail;
     }
     a_slist_link(src->tail, at->next);
-    a_slist_link(at, src->head->next);
+    a_slist_link(at, src->head.next);
 }
 
 /*!
  @brief rotate a node in the list
  @param[in,out] ctx points to circular singly linked list head
 */
-A_INTERN a_void_t a_slist_rot(a_slist_s *ctx)
+A_INTERN a_void_t a_slist_rot(a_slist_s *const ctx)
 {
-    a_slist_u *node = ctx->head->next;
-    a_slist_link(ctx->head, node->next);
+    a_slist_u *const node = ctx->head.next;
+    a_slist_link(&ctx->head, node->next);
     a_slist_link(node, ctx->tail->next);
     a_slist_link(ctx->tail, node);
     ctx->tail = node;
 }
 
 /* inline function for generic */
-A_INTERN a_void_t a_slist_ctor_(a_vptr_t ctx) { a_slist_ctor(a_cast_s(a_slist_s *, ctx)); }
-A_INTERN a_void_t a_slist_dtor_(a_vptr_t ctx) { a_slist_dtor(a_cast_s(a_slist_s *, ctx)); }
+A_INTERN a_void_t a_slist_ctor_(a_vptr_t const ctx) { a_slist_ctor(a_cast_s(a_slist_s *, ctx)); }
+A_INTERN a_void_t a_slist_dtor_(a_vptr_t const ctx) { a_slist_dtor(a_cast_s(a_slist_s *, ctx)); }
 
 /*! @} A_SLIST */
 
-#endif /* A_SLIST_H */
+#endif /* slist.h */
```

### Comparing `liba-0.1.1rc4/include/a/tf.h` & `liba-0.1.1rc5/include/a/tf.h`

 * *Files 9% similar despite different names*

```diff
@@ -1,15 +1,14 @@
 /*!
  @file tf.h
  @brief transfer function
- @copyright Copyright (C) 2020-present tqfx, All rights reserved.
 */
 
-#ifndef A_TF_H
-#define A_TF_H
+#ifndef LIBA_TF_H
+#define LIBA_TF_H
 
 #include "a.h"
 
 /*!
  @ingroup A
  @addtogroup A_TF transfer function
  @{
@@ -18,16 +17,16 @@
 /*!
  @brief instance structure for transfer function
 */
 typedef struct a_tf_s
 {
     a_real_t *u; //!< input
     a_real_t *v; //!< output
-    const a_real_t *num; //!< numerator
-    const a_real_t *den; //!< denominator
+    a_real_t const *num; //!< numerator
+    a_real_t const *den; //!< denominator
     a_uint_t m; //!< numerator number
     a_uint_t n; //!< denominator number
 } a_tf_s;
 
 #if defined(__cplusplus)
 extern "C" {
 #endif /* __cplusplus */
@@ -35,59 +34,59 @@
 /*!
  @brief set numerator for transfer function
  @param[in,out] ctx points to an instance of transfer function
  @param[in] m numerator number
  @param[in] num numerator
  @param[in] u input buffer
 */
-A_PUBLIC a_void_t a_tf_set_num(a_tf_s *ctx, a_uint_t m, const a_real_t *num, a_real_t *u);
+A_EXTERN a_void_t a_tf_set_num(a_tf_s *ctx, a_uint_t m, a_real_t const *num, a_real_t *u);
 
 /*!
  @brief set denominator for transfer function
  @param[in,out] ctx points to an instance of transfer function
  @param[in] n denominator number
  @param[in] den denominator
  @param[in] v output buffer
 */
-A_PUBLIC a_void_t a_tf_set_den(a_tf_s *ctx, a_uint_t n, const a_real_t *den, a_real_t *v);
+A_EXTERN a_void_t a_tf_set_den(a_tf_s *ctx, a_uint_t n, a_real_t const *den, a_real_t *v);
 
 /*!
  @brief initialize function for transfer function
  @param[in,out] ctx points to an instance of transfer function
  @param[in] m numerator number
  @param[in] num numerator
  @param[in] u input buffer
  @param[in] n denominator number
  @param[in] den denominator
  @param[in] v output buffer
 */
-A_PUBLIC a_tf_s *a_tf_init(a_tf_s *ctx,
-                           a_uint_t m, const a_real_t *num, a_real_t *u,
-                           a_uint_t n, const a_real_t *den, a_real_t *v);
+A_EXTERN a_tf_s *a_tf_init(a_tf_s *ctx,
+                           a_uint_t m, a_real_t const *num, a_real_t *u,
+                           a_uint_t n, a_real_t const *den, a_real_t *v);
 
 /*!
- @brief process function for transfer function
+ @brief calculate function for transfer function
  @param[in,out] ctx points to an instance of transfer function
  @param[in] x controller output
  @return feedback
 */
-A_PUBLIC a_real_t a_tf_proc(a_tf_s *ctx, a_real_t x);
+A_EXTERN a_real_t a_tf_iter(a_tf_s *ctx, a_real_t x);
 
 /*!
  @brief terminate function for transfer function
  @param[in,out] ctx points to an instance of transfer function
 */
-A_PUBLIC a_tf_s *a_tf_exit(a_tf_s *ctx);
+A_EXTERN a_tf_s *a_tf_exit(a_tf_s *ctx);
 
 /*!
  @brief zero function for transfer function
  @param[in,out] ctx points to an instance of transfer function
 */
-A_PUBLIC a_tf_s *a_tf_zero(a_tf_s *ctx);
+A_EXTERN a_tf_s *a_tf_zero(a_tf_s *ctx);
 
 #if defined(__cplusplus)
 } /* extern "C" */
 #endif /* __cplusplus */
 
 /*! @} A_TF */
 
-#endif /* A_TF_H */
+#endif /* tf.h */
```

### Comparing `liba-0.1.1rc4/liba.egg-info/PKG-INFO` & `liba-0.1.1rc5/liba.egg-info/PKG-INFO`

 * *Files 7% similar despite different names*

```diff
@@ -1,64 +1,81 @@
 Metadata-Version: 2.1
 Name: liba
-Version: 0.1.1rc4
+Version: 0.1.1rc5
 Summary: An algorithm library based on C/C++ language
 Home-page: https://github.com/tqfx/liba.git
 Author: tqfx
 Author-email: tqfx@foxmail.com
 License: MPL-2.0
 Description: # An algorithm library {#mainpage}
         
+        [![docs](https://github.com/tqfx/liba/actions/workflows/docs.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/docs.yml)
         [![conan](https://github.com/tqfx/liba/actions/workflows/conan.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/conan.yml)
         [![xmake](https://github.com/tqfx/liba/actions/workflows/xmake.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/xmake.yml)
+        [![meson](https://github.com/tqfx/liba/actions/workflows/meson.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/meson.yml)
         [![msvc](https://github.com/tqfx/liba/actions/workflows/msvc.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/msvc.yml)
         [![linux](https://github.com/tqfx/liba/actions/workflows/linux.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/linux.yml)
         [![macos](https://github.com/tqfx/liba/actions/workflows/macos.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/macos.yml)
         [![mingw](https://github.com/tqfx/liba/actions/workflows/mingw.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/mingw.yml)
         [![msys2](https://github.com/tqfx/liba/actions/workflows/msys2.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/msys2.yml)
         [![freebsd](https://github.com/tqfx/liba/actions/workflows/freebsd.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/freebsd.yml)
-        [![doxygen](https://github.com/tqfx/liba/actions/workflows/doxygen.yml/badge.svg)](https://github.com/tqfx/liba/actions/workflows/doxygen.yml)
+        
+        ## documentation
+        
+        - [C/C++](https://tqfx.org/liba/)
+        - [Lua](https://tqfx.org/liba/lua/)
+        - [Java](https://tqfx.org/liba/java/)
+        - [Rust](https://tqfx.org/liba/rust/liba/)
         
         ## required tools
         
-        - C/C++ compiler: [gnu](https://gcc.gnu.org) or [llvm](https://clang.llvm.org) or [msvc](https://visualstudio.microsoft.com/visual-cpp-build-tools) etc
+        - C/C++ compiler: [tcc](https://bellard.org/tcc) or [gnu](https://gcc.gnu.org) or [llvm](https://clang.llvm.org) or [msvc](https://visualstudio.microsoft.com/visual-cpp-build-tools) etc
         
         ## optional tools
         
         - [lua](https://www.lua.org)
         - [java](https://www.oracle.com/java)
         - [rust](https://www.rust-lang.org)
+        - [emsdk](https://emscripten.org)
         - [xmake](https://xmake.io)
         - [cmake](https://cmake.org)
         - [conan](https://conan.io)
         - [vcpkg](https://vcpkg.io)
+        - [meson](https://mesonbuild.com)
         - [python](https://www.python.org)
         
         ## build
         
         ### xmake
         
         ```bash
-        xmake f -m release
-        xmake --build --all
-        xmake install --all
+        xmake f
+        xmake
+        xmake i
         ```
         
         ### cmake
         
         ```bash
         cmake -S . -B build
         cmake --build build
         cmake --install build
         ```
         
+        ### meson
+        
+        ```bash
+        meson setup builddir
+        meson install -C builddir
+        ```
+        
         ### vcpkg
         
         ```bash
-        cmake -S . -B build -DENABLE_VCPKG=ON
+        cmake -S . -B build -DLIBA_VCPKG=1
         ```
         
         ```bash
         cp -r build/vcpkg/* $VCPKG_INSTALLATION_ROOT
         ```
         
         ```pwsh
@@ -79,59 +96,53 @@
         
         ### cython
         
         ```bash
         python setup.py build_ext --inplace
         ```
         
-        ### wheel
-        
-        ```bash
-        python setup.py bdist_wheel
-        ```
-        
         ## usage
         
         ### C/C++
         
         #### xmake.lua
         
         ```lua
         add_requires("a")
         ```
         
         ### CMakeLists.txt
         
         ```cmake
         find_package(liba CONFIG REQUIRED)
-        target_link_libraries(<TARGET> PRIVATE liba::a)
+        target_link_libraries(<TARGET> PRIVATE alib) # static
+        target_link_libraries(<TARGET> PRIVATE liba) # shared
         ```
         
         #### conanfile.txt
         
         ```txt
         [requires]
         liba/[~0.1]
         ```
         
         ### Lua
         
         ```lua
-        local a = require("liba")
-        print("version", a.version())
+        local liba = require("liba")
+        print("version", liba.version())
         ```
         
         ### Java
         
         ```java
-        import liba.a;
         public class test {
             public static void main(String[] args) {
-                a.init();
-                System.out.println("version " + a.version());
+                liba.init();
+                System.out.println("version " + liba.version());
             }
         }
         ```
         
         ### Rust
         
         #### Cargo.toml
```

### Comparing `liba-0.1.1rc4/setup.cfg` & `liba-0.1.1rc5/setup.cfg`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [metadata]
 name = liba
-version = 0.1.1-rc4
+version = 0.1.1-rc5
 url = https://github.com/tqfx/liba.git
 author = tqfx
 author_email = tqfx@foxmail.com
 classifiers = 
 	Programming Language :: C
 	Programming Language :: C++
 	Programming Language :: Cython
```

### Comparing `liba-0.1.1rc4/setup.py` & `liba-0.1.1rc5/setup.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,15 +1,17 @@
 #!/usr/bin/env python
 from sys import argv, executable
 from subprocess import Popen
 import os, sys, time
 
 script = os.path.abspath(argv[0])
 os.chdir(os.path.dirname(script))
-if len(argv) < 2:
+if len(argv) < 2 and sys.version.find("MSC") > 0:
+    exit(Popen([executable, script, "--quiet", "build_ext", "--inplace"]).wait())
+elif len(argv) < 2:
     exit(Popen([executable, script, "build_ext", "--inplace"]).wait())
 try:
     from setuptools.command.build_ext import build_ext
     from setuptools import setup, Extension
 except ImportError:
     from distutils.command.build_ext import build_ext
     from distutils.extension import Extension
@@ -64,17 +66,17 @@
         "catan",
         "casinh",
         "cacosh",
         "catanh",
     ):
         name = "A_HAVE_" + func.upper()
         if A_SIZE_REAL == 0x10:
-            func += 'l'
+            func += "l"
         if A_SIZE_REAL == 0x04:
-            func += 'f'
+            func += "f"
         try:
             libm[func]
         except:
             continue
         text += "#define %s 1\n" % (name)
     return text
 
@@ -83,59 +85,55 @@
     with open("setup.cfg", "r") as f:
         version = findall(r"version = (.+)", f.read())[0]
     major, minor, patch = findall(r"(\d+).(\d+).(\d+)", version)[0]
     order = {"little": 1234, "big": 4321}.get(byteorder)
     vsize = ctypes.sizeof(ctypes.c_void_p(0))
     tweak = time.strftime("%Y%m%d%H%M")
     check = check_math(define_macros)
-    text = '''/*!
-@file a.config.h
-@brief algorithm library configuration
-@details it is autogenerated by setup.py
-@copyright Copyright (C) 2020-present tqfx, All rights reserved.
-*/
-#ifndef LIBA_CONFIG_H
-#define LIBA_CONFIG_H
+    text = """/* autogenerated by setup.py */
 #define A_VERSION "{}"
 #define A_VERSION_MAJOR {}
 #define A_VERSION_MINOR {}
 #define A_VERSION_PATCH {}
 #define A_VERSION_TWEAK A_U64_C({})
+#if !defined A_BYTE_ORDER
 #define A_BYTE_ORDER {}
+#endif /* A_BYTE_ORDER */
+#if !defined A_SIZE_VPTR
 #define A_SIZE_VPTR {}
-{}#endif /* LIBA_CONFIG_H */
-'''.format(
+#endif /* A_SIZE_VPTR */
+{}""".format(
         version, major, minor, patch, tweak, order, vsize, check
     )
     with open(config, "wb") as f:
         f.write(text.encode("UTF-8"))
 
 
+config_h = "a.setup.h"
 parser = ArgumentParser(add_help=False)
 parser.add_argument("-b", "--build-base", default="build")
 args = parser.parse_known_args(argv[1:])
 base = args[0].build_base
-config_h = "a.config.h"
 source_c, source_cc = [], []
 header_h, header_hh = [], []
 suffix_c, suffix_cc = (".c",), (".cc", ".cpp", ".cxx")
 suffix_h, suffix_hh = (".h",), (".hh", ".hpp", ".hxx")
-define_macros = [("A_HAVE_H", None), ("A_EXPORTS", None)]
-if os.path.exists("ffi/python/src/a/__init__.pxi"):
-    with open("ffi/python/src/a/__init__.pxi", "r") as f:
+config_h = os.path.relpath(os.path.join(base, config_h), "include")
+define_macros = [("A_HAVE_H", '"' + config_h + '"'), ("A_EXPORTS", None)]
+if os.path.exists("python/src/a/__init__.pxi"):
+    with open("python/src/a/__init__.pxi", "r") as f:
         define_macros += findall(r"DEF (\w+) = (\d+)", f.read())
-if USE_CYTHON and os.path.exists("ffi/python/src/lib.pyx"):
-    source_c = ["ffi/python/src/lib.pyx"]
-elif os.path.exists("ffi/python/src/lib.c"):
-    source_c = ["ffi/python/src/lib.c"]
+if USE_CYTHON and os.path.exists("python/src/a.pyx"):
+    source_c = ["python/src/a.pyx"]
+elif os.path.exists("python/src/a.c"):
+    source_c = ["python/src/a.c"]
 config = os.path.join(base, config_h)
-if not os.path.exists(config):
-    if not os.path.exists(base):
-        os.mkdir(base)
-    configure(config, define_macros)
+if not os.path.exists(base):
+    os.makedirs(base)
+configure(config, define_macros)
 
 for dirpath, dirnames, filenames in os.walk("include"):
     for filename in filenames:
         header = os.path.join(dirpath, filename)
         prefix, suffix = os.path.splitext(header)
         if suffix in suffix_hh:
             header_hh.append(header)
@@ -151,15 +149,15 @@
             source_c.append(source)
 
 ext_modules = [
     Extension(
         name="liba",
         language="c",
         sources=source_c,
-        include_dirs=[base, "include"],
+        include_dirs=["include"],
         define_macros=define_macros,
     )
 ]
 if USE_CYTHON:
     ext_modules = cythonize(  # type: ignore
         ext_modules,
         language_level=version_info[0],  # type: ignore
```

### Comparing `liba-0.1.1rc4/src/arr.c` & `liba-0.1.1rc5/src/buf.c`

 * *Files 22% similar despite different names*

```diff
@@ -1,187 +1,184 @@
-#include "a/arr.h"
-#include <string.h>
+#include "a/buf.h"
 #include <stdlib.h>
 
-#undef a_arr_at
-#undef a_arr_at_
-#undef a_arr_ptr
-#undef a_arr_end
-#undef a_arr_top
-#undef a_arr_top_
-#undef a_arr_push
-#undef a_arr_pull
-#undef a_arr_search
-#undef a_arr_insert
-#undef a_arr_remove
-#undef a_arr_push_fore
-#undef a_arr_push_back
-#undef a_arr_pull_fore
-#undef a_arr_pull_back
+#undef a_buf_at
+#undef a_buf_at_
+#undef a_buf_idx
+#undef a_buf_ptr
+#undef a_buf_end
+#undef a_buf_top
+#undef a_buf_top_
+#undef a_buf_push
+#undef a_buf_pull
+#undef a_buf_search
+#undef a_buf_insert
+#undef a_buf_remove
+#undef a_buf_push_fore
+#undef a_buf_push_back
+#undef a_buf_pull_fore
+#undef a_buf_pull_back
 
-A_INTERN a_vptr_t a_arr_inc_(a_arr_s *ctx)
+static A_INLINE a_vptr_t a_buf_inc_(a_buf_s *const ctx)
 {
     return a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num++;
 }
 
-A_INTERN a_vptr_t a_arr_dec_(a_arr_s *ctx)
+static A_INLINE a_vptr_t a_buf_dec_(a_buf_s *const ctx)
 {
     return a_byte_p(ctx->_ptr) + ctx->_siz * --ctx->_num;
 }
 
-A_STATIC a_void_t a_arr_drop_(a_arr_s *ctx, a_size_t bot, a_void_t (*dtor)(a_vptr_t))
+static a_void_t a_buf_drop_(a_buf_s *const ctx, a_size_t const bot, a_void_t (*const dtor)(a_vptr_t))
 {
     if (dtor)
     {
         while (ctx->_num > bot)
         {
-            dtor(a_arr_dec_(ctx));
+            dtor(a_buf_dec_(ctx));
         }
     }
     ctx->_num = bot;
 }
 
-a_void_t a_arr_ctor(a_arr_s *ctx, a_vptr_t ptr, a_size_t siz, a_size_t num)
+a_void_t a_buf_ctor(a_buf_s *const ctx, a_vptr_t const ptr, a_size_t const siz, a_size_t const num)
 {
     ctx->_ptr = ptr;
     ctx->_siz = siz;
     ctx->_mem = num;
     ctx->_num = 0;
 }
 
-a_void_t a_arr_dtor(a_arr_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_buf_dtor(a_buf_s *const ctx, a_void_t (*const dtor)(a_vptr_t))
 {
     if (ctx->_ptr)
     {
-        a_arr_drop_(ctx, 0, dtor);
+        a_buf_drop_(ctx, 0, dtor);
         ctx->_ptr = A_NULL;
     }
     ctx->_mem = 0;
     ctx->_siz = 0;
 }
 
-a_arr_s *a_arr_move(a_arr_s *ctx, a_arr_s *obj)
+a_buf_s *a_buf_move(a_buf_s *const ctx, a_buf_s *const obj)
 {
-    memcpy(ctx, obj, sizeof(*obj));
-    memset(obj, 0, sizeof(*obj));
+    a_copy(ctx, obj, sizeof(*obj));
+    a_zero(obj, sizeof(*obj));
     return ctx;
 }
 
-a_void_t a_arr_drop(a_arr_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_buf_drop(a_buf_s *const ctx, a_void_t (*const dtor)(a_vptr_t))
 {
-    a_arr_drop_(ctx, 0, dtor);
+    a_buf_drop_(ctx, 0, dtor);
 }
 
-a_void_t a_arr_swap(const a_arr_s *ctx, a_size_t lhs, a_size_t rhs)
+a_void_t a_buf_swap(a_buf_s const *const ctx, a_size_t lhs, a_size_t rhs)
 {
-    a_size_t num = ctx->_num - 1;
+    a_size_t const num = ctx->_num - 1;
     lhs = lhs < ctx->_num ? lhs : num;
     rhs = rhs < ctx->_num ? rhs : num;
     if (lhs != rhs)
     {
-        a_byte_t *ptr = a_byte_p(ctx->_ptr);
-        a_vptr_t lobj = ptr + lhs * ctx->_siz;
-        a_vptr_t robj = ptr + rhs * ctx->_siz;
-        a_swap(ctx->_siz, lobj, robj);
+        a_vptr_t const lobj = a_byte_p(ctx->_ptr) + lhs * ctx->_siz;
+        a_vptr_t const robj = a_byte_p(ctx->_ptr) + rhs * ctx->_siz;
+        a_swap(lobj, robj, ctx->_siz);
     }
 }
 
-a_void_t a_arr_sort(const a_arr_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_buf_sort(a_buf_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     qsort(ctx->_ptr, ctx->_num, ctx->_siz, cmp);
 }
 
-a_void_t a_arr_sort_fore(const a_arr_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_buf_sort_fore(a_buf_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_byte_t *ptr = a_byte_p(ctx->_ptr);
-        a_byte_t *end = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num - ctx->_siz;
+        a_byte_t *const end = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num - ctx->_siz;
         do
         {
-            a_byte_t *cur = ptr + ctx->_siz;
+            a_byte_t *const cur = ptr + ctx->_siz;
             if (cmp(ptr, cur) > 0)
             {
-                a_swap(ctx->_siz, cur, ptr);
+                a_swap(cur, ptr, ctx->_siz);
             }
             else
             {
                 break;
             }
             ptr = cur;
         } while (ptr != end);
     }
 }
 
-a_void_t a_arr_sort_back(const a_arr_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_buf_sort_back(a_buf_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_byte_t *ptr = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num - ctx->_siz;
         do
         {
-            a_byte_t *cur = ptr - ctx->_siz;
+            a_byte_t *const cur = ptr - ctx->_siz;
             if (cmp(cur, ptr) > 0)
             {
-                a_swap(ctx->_siz, cur, ptr);
+                a_swap(cur, ptr, ctx->_siz);
             }
             else
             {
                 break;
             }
             ptr = cur;
         } while (ptr != ctx->_ptr);
     }
 }
 
-a_vptr_t a_arr_search(const a_arr_s *ctx, a_cptr_t obj, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_vptr_t a_buf_search(a_buf_s const *const ctx, a_cptr_t const obj, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     return bsearch(obj, ctx->_ptr, ctx->_num, ctx->_siz, cmp);
 }
 
-a_vptr_t a_arr_insert(a_arr_s *ctx, a_size_t idx)
+a_vptr_t a_buf_insert(a_buf_s *const ctx, a_size_t const idx)
 {
     if (a_likely(ctx->_num < ctx->_mem))
     {
         if (idx < ctx->_num)
         {
-            a_byte_t *src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
-            a_byte_t *dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
-            memmove(dst, src, (ctx->_num - idx) * ctx->_siz);
+            a_byte_t *const src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
+            a_byte_t *const dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
+            a_move(dst, src, (ctx->_num - idx) * ctx->_siz);
             ++ctx->_num;
             return src;
         }
-        return a_arr_inc_(ctx);
+        return a_buf_inc_(ctx);
     }
     return A_NULL;
 }
 
-a_vptr_t a_arr_push_fore(a_arr_s *ctx) { return a_arr_insert(ctx, 0); }
+a_vptr_t a_buf_push_fore(a_buf_s *const ctx) { return a_buf_insert(ctx, 0); }
 
-a_vptr_t a_arr_push_back(a_arr_s *ctx)
+a_vptr_t a_buf_push_back(a_buf_s *const ctx)
 {
-    return a_likely(ctx->_num < ctx->_mem) ? a_arr_inc_(ctx) : A_NULL;
+    return a_likely(ctx->_num < ctx->_mem) ? a_buf_inc_(ctx) : A_NULL;
 }
 
-a_vptr_t a_arr_remove(a_arr_s *ctx, a_size_t idx)
+a_vptr_t a_buf_remove(a_buf_s *const ctx, a_size_t const idx)
 {
-    if (ctx->_num && idx < ctx->_num - 1)
+    a_size_t const num = ctx->_num - 1;
+    if (ctx->_num && idx < num)
     {
-        a_byte_t *end = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num;
-        a_byte_t *dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
-        a_byte_t *src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
-        for (; src != end; src += ctx->_siz, dst += ctx->_siz)
-        {
-            a_swap(ctx->_siz, dst, src);
-        }
+        a_byte_t *const ptr = a_byte_p(ctx->_ptr) + ctx->_siz * num;
+        a_byte_t *const dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
+        a_byte_t *const src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
+        a_swap(dst, src, a_size_c(ptr - dst));
         --ctx->_num;
-        return dst;
+        return ptr;
     }
-    return a_likely(ctx->_num) ? a_arr_dec_(ctx) : A_NULL;
+    return a_likely(ctx->_num) ? a_buf_dec_(ctx) : A_NULL;
 }
 
-a_vptr_t a_arr_pull_fore(a_arr_s *ctx) { return a_arr_remove(ctx, 0); }
+a_vptr_t a_buf_pull_fore(a_buf_s *const ctx) { return a_buf_remove(ctx, 0); }
 
-a_vptr_t a_arr_pull_back(a_arr_s *ctx)
+a_vptr_t a_buf_pull_back(a_buf_s *const ctx)
 {
-    return a_likely(ctx->_num) ? a_arr_dec_(ctx) : A_NULL;
+    return a_likely(ctx->_num) ? a_buf_dec_(ctx) : A_NULL;
 }
```

### Comparing `liba-0.1.1rc4/src/complex.c` & `liba-0.1.1rc5/src/complex.c`

 * *Files 10% similar despite different names*

```diff
@@ -1,28 +1,26 @@
-#define A_COMPLEX_I
+#define LIBA_COMPLEX_C
 #include "a/real.h"
-#include "inline.h"
 #if A_PREREQ_GNUC(2, 95) || __has_warning("-Waggregate-return")
 #pragma GCC diagnostic ignored "-Waggregate-return"
 #endif /* -Waggregate-return */
 #if A_PREREQ_GNUC(3, 0) || __has_warning("-Wfloat-equal")
 #pragma GCC diagnostic ignored "-Wfloat-equal"
 #endif /* -Wfloat-equal */
 #include "complex.h"
-#include "intern.h"
 
-a_complex_s a_complex_polar(a_real_t r, a_real_t theta)
+a_complex_s a_complex_polar(a_real_t const r, a_real_t const theta)
 {
     a_complex_s z;
     z.real = r * a_real_cos(theta);
     z.imag = r * a_real_sin(theta);
     return z;
 }
 
-a_real_t a_complex_logabs(a_complex_s z)
+a_real_t a_complex_logabs(a_complex_s const z)
 {
     a_real_t xabs = a_real_abs(z.real);
     a_real_t yabs = a_real_abs(z.imag);
     a_real_t max, u;
     if (xabs >= yabs)
     {
         max = xabs;
@@ -32,87 +30,87 @@
     {
         max = yabs;
         u = xabs / yabs;
     }
     return a_real_log(max) + a_real_log1p(u * u) * A_REAL_C(0.5);
 }
 
-a_real_t a_complex_abs2(a_complex_s z)
+a_real_t a_complex_abs2(a_complex_s const z)
 {
     return z.real * z.real + z.imag * z.imag;
 }
 
-a_real_t a_complex_abs(a_complex_s z)
+a_real_t a_complex_abs(a_complex_s const z)
 {
     return a_real_hypot(z.real, z.imag);
 }
 
-a_real_t a_complex_arg(a_complex_s z)
+a_real_t a_complex_arg(a_complex_s const z)
 {
     if (z.real == 0 && z.imag == 0)
     {
         return 0;
     }
     return a_real_atan2(z.imag, z.real);
 }
 
-a_complex_s a_complex_add(a_complex_s x, a_complex_s y)
+a_complex_s a_complex_add(a_complex_s x, a_complex_s const y)
 {
     x.real += y.real;
     x.imag += y.imag;
     return x;
 }
 
-a_complex_s a_complex_add_real(a_complex_s x, a_real_t y)
+a_complex_s a_complex_add_real(a_complex_s x, a_real_t const y)
 {
     x.real += y;
     return x;
 }
 
-a_complex_s a_complex_add_imag(a_complex_s x, a_real_t y)
+a_complex_s a_complex_add_imag(a_complex_s x, a_real_t const y)
 {
     x.imag += y;
     return x;
 }
 
-a_complex_s a_complex_sub(a_complex_s x, a_complex_s y)
+a_complex_s a_complex_sub(a_complex_s x, a_complex_s const y)
 {
     x.real -= y.real;
     x.imag -= y.imag;
     return x;
 }
 
-a_complex_s a_complex_sub_real(a_complex_s x, a_real_t y)
+a_complex_s a_complex_sub_real(a_complex_s x, a_real_t const y)
 {
     x.real -= y;
     return x;
 }
 
-a_complex_s a_complex_sub_imag(a_complex_s x, a_real_t y)
+a_complex_s a_complex_sub_imag(a_complex_s x, a_real_t const y)
 {
     x.imag -= y;
     return x;
 }
 
-a_complex_s a_complex_mul(a_complex_s x, a_complex_s y)
+a_complex_s a_complex_mul(a_complex_s x, a_complex_s const y)
 {
     a_complex_s z;
     z.real = x.real * y.real - x.imag * y.imag;
     z.imag = x.real * y.imag + x.imag * y.real;
     return z;
 }
 
-a_complex_s a_complex_mul_real(a_complex_s x, a_real_t y)
+a_complex_s a_complex_mul_real(a_complex_s x, a_real_t const y)
 {
     x.real *= y;
     x.imag *= y;
     return x;
 }
 
-a_complex_s a_complex_mul_imag(a_complex_s x, a_real_t y)
+a_complex_s a_complex_mul_imag(a_complex_s x, a_real_t const y)
 {
     a_complex_s z;
     z.real = -x.imag * y;
     z.imag = x.real * y;
     return z;
 }
 
@@ -123,22 +121,22 @@
     y.real *= inv;
     y.imag *= inv;
     z.real = (x.real * y.real + x.imag * y.imag) * inv;
     z.imag = (x.imag * y.real - x.real * y.imag) * inv;
     return z;
 }
 
-a_complex_s a_complex_div_real(a_complex_s x, a_real_t y)
+a_complex_s a_complex_div_real(a_complex_s x, a_real_t const y)
 {
     x.real /= y;
     x.imag /= y;
     return x;
 }
 
-a_complex_s a_complex_div_imag(a_complex_s x, a_real_t y)
+a_complex_s a_complex_div_imag(a_complex_s x, a_real_t const y)
 {
     a_complex_s z;
     z.real = x.imag / y;
     z.imag = -x.real / y;
     return z;
 }
 
@@ -158,14 +156,17 @@
 #if __has_warning("-Wincompatible-library-redeclaration")
 #pragma clang diagnostic ignored "-Wincompatible-library-redeclaration"
 #endif /* clang 4.0+ */
 #if A_PREREQ_GNUC(10, 1)
 #pragma GCC diagnostic ignored "-Wbuiltin-declaration-mismatch"
 #endif /* gcc 10.1+ */
 
+#if defined(A_HAVE_CSQRT) && (A_HAVE_CSQRT + 0 < 1)
+#undef A_HAVE_CSQRT
+#endif /* A_HAVE_CSQRT */
 #if defined(A_HAVE_CSQRT) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(csqrt, a_complex_t);
 #endif /* A_HAVE_CSQRT */
 a_complex_s a_complex_sqrt(a_complex_s z)
 {
 #if defined(A_HAVE_CSQRT) && defined(A_COMPLEX_T)
     union
@@ -208,30 +209,33 @@
     }
     z.real = z.imag / (w * 2);
     z.imag = w;
     return z;
 #endif /* A_HAVE_CSQRT */
 }
 
-a_complex_s a_complex_sqrt_real(a_real_t x)
+a_complex_s a_complex_sqrt_real(a_real_t const x)
 {
     a_complex_s z = A_COMPLEX_C(0.0, 0.0);
     if (x >= 0)
     {
         z.real = a_real_sqrt(x);
         return z;
     }
     z.imag = a_real_sqrt(-x);
     return z;
 }
 
+#if defined(A_HAVE_CPOW) && (A_HAVE_CPOW + 0 < 1)
+#undef A_HAVE_CPOW
+#endif /* A_HAVE_CPOW */
 #if defined(A_HAVE_CPOW) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F2(cpow, a_complex_t, a_complex_t);
 #endif /* A_HAVE_CPOW */
-a_complex_s a_complex_pow(a_complex_s z, a_complex_s a)
+a_complex_s a_complex_pow(a_complex_s z, a_complex_s const a)
 {
 #if defined(A_HAVE_CPOW) && defined(A_COMPLEX_T)
     union
     {
         a_complex_s s;
         A_COMPLEX_T z;
     } u, v;
@@ -254,15 +258,15 @@
     a_real_t theta = a_complex_arg(z);
     a_real_t rho = a_real_exp(logr * a.real - theta * a.imag);
     a_real_t beta = theta * a.real + logr * a.imag;
     return a_complex_polar(rho, beta);
 #endif /* A_HAVE_CPOW */
 }
 
-a_complex_s a_complex_pow_real(a_complex_s z, a_real_t a)
+a_complex_s a_complex_pow_real(a_complex_s z, a_real_t const a)
 {
     if (z.real == 0 && z.imag == 0)
     {
         if (a == 0)
         {
             z.real = A_REAL_C(1.0);
         }
@@ -271,14 +275,17 @@
     a_real_t logr = a_complex_logabs(z);
     a_real_t theta = a_complex_arg(z);
     a_real_t rho = a_real_exp(logr * a);
     a_real_t beta = theta * a;
     return a_complex_polar(rho, beta);
 }
 
+#if defined(A_HAVE_CEXP) && (A_HAVE_CEXP + 0 < 1)
+#undef A_HAVE_CEXP
+#endif /* A_HAVE_CEXP */
 #if defined(A_HAVE_CEXP) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(cexp, a_complex_t);
 #endif /* A_HAVE_CEXP */
 a_complex_s a_complex_exp(a_complex_s z)
 {
 #if defined(A_HAVE_CEXP) && defined(A_COMPLEX_T)
     union
@@ -293,14 +300,17 @@
     return A_REAL_F1(cexp, z);
 #else /* !A_HAVE_CEXP */
     a_real_t rho = a_real_exp(z.real);
     return a_complex_polar(rho, z.imag);
 #endif /* A_HAVE_CEXP */
 }
 
+#if defined(A_HAVE_CLOG) && (A_HAVE_CLOG + 0 < 1)
+#undef A_HAVE_CLOG
+#endif /* A_HAVE_CLOG */
 #if defined(A_HAVE_CLOG) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(clog, a_complex_t);
 #endif /* A_HAVE_CLOG */
 a_complex_s a_complex_log(a_complex_s z)
 {
 #if defined(A_HAVE_CLOG) && defined(A_COMPLEX_T)
     union
@@ -318,29 +328,32 @@
     a_real_t theta = a_complex_arg(z);
     z.real = logr;
     z.imag = theta;
     return z;
 #endif /* A_HAVE_CLOG */
 }
 
-a_complex_s a_complex_log2(a_complex_s z)
+a_complex_s a_complex_log2(a_complex_s const z)
 {
     return a_complex_mul_real(a_complex_log(z), 1 / A_REAL_LN2);
 }
 
-a_complex_s a_complex_log10(a_complex_s z)
+a_complex_s a_complex_log10(a_complex_s const z)
 {
     return a_complex_mul_real(a_complex_log(z), 1 / A_REAL_LN10);
 }
 
-a_complex_s a_complex_logb(a_complex_s z, a_complex_s b)
+a_complex_s a_complex_logb(a_complex_s const z, a_complex_s const b)
 {
     return a_complex_div(a_complex_log(z), a_complex_log(b));
 }
 
+#if defined(A_HAVE_CSIN) && (A_HAVE_CSIN + 0 < 1)
+#undef A_HAVE_CSIN
+#endif /* A_HAVE_CSIN */
 #if defined(A_HAVE_CSIN) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(csin, a_complex_t);
 #endif /* A_HAVE_CSIN */
 a_complex_s a_complex_sin(a_complex_s z)
 {
 #if defined(A_HAVE_CSIN) && defined(A_COMPLEX_T)
     union
@@ -361,14 +374,17 @@
     }
     z.real = a_real_sin(z.real) * a_real_cosh(z.imag);
     z.imag = a_real_cos(z.real) * a_real_sinh(z.imag);
     return z;
 #endif /* A_HAVE_CSIN */
 }
 
+#if defined(A_HAVE_CCOS) && (A_HAVE_CCOS + 0 < 1)
+#undef A_HAVE_CCOS
+#endif /* A_HAVE_CCOS */
 #if defined(A_HAVE_CCOS) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(ccos, a_complex_t);
 #endif /* A_HAVE_CCOS */
 a_complex_s a_complex_cos(a_complex_s z)
 {
 #if defined(A_HAVE_CCOS) && defined(A_COMPLEX_T)
     union
@@ -389,14 +405,17 @@
     }
     z.real = a_real_cos(z.real) * a_real_cosh(z.imag);
     z.imag = a_real_sin(z.real) * a_real_sinh(-z.imag);
     return z;
 #endif /* A_HAVE_CCOS */
 }
 
+#if defined(A_HAVE_CTAN) && (A_HAVE_CTAN + 0 < 1)
+#undef A_HAVE_CTAN
+#endif /* A_HAVE_CTAN */
 #if defined(A_HAVE_CTAN) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(ctan, a_complex_t);
 #endif /* A_HAVE_CTAN */
 a_complex_s a_complex_tan(a_complex_s z)
 {
 #if defined(A_HAVE_CTAN) && defined(A_COMPLEX_T)
     union
@@ -421,29 +440,32 @@
     }
     a_real_t den = a_real_pow(cr / si, 2) + 1;
     z.imag = 1 / (a_real_tanh(z.imag) * den);
     return z;
 #endif /* A_HAVE_CTAN */
 }
 
-a_complex_s a_complex_sec(a_complex_s z)
+a_complex_s a_complex_sec(a_complex_s const z)
 {
     return a_complex_inv(a_complex_cos(z));
 }
 
-a_complex_s a_complex_csc(a_complex_s z)
+a_complex_s a_complex_csc(a_complex_s const z)
 {
     return a_complex_inv(a_complex_sin(z));
 }
 
-a_complex_s a_complex_cot(a_complex_s z)
+a_complex_s a_complex_cot(a_complex_s const z)
 {
     return a_complex_inv(a_complex_tan(z));
 }
 
+#if defined(A_HAVE_CASIN) && (A_HAVE_CASIN + 0 < 1)
+#undef A_HAVE_CASIN
+#endif /* A_HAVE_CASIN */
 #if defined(A_HAVE_CASIN) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(casin, a_complex_t);
 #endif /* A_HAVE_CASIN */
 a_complex_s a_complex_asin(a_complex_s z)
 {
 #if defined(A_HAVE_CASIN) && defined(A_COMPLEX_T)
     union
@@ -512,15 +534,15 @@
     {
         z.imag = -z.imag;
     }
     return z;
 #endif /* A_HAVE_CASIN */
 }
 
-a_complex_s a_complex_asin_real(a_real_t x)
+a_complex_s a_complex_asin_real(a_real_t const x)
 {
     a_complex_s z = A_COMPLEX_C(0.0, 0.0);
     if (a_real_abs(x) <= 1)
     {
         z.real = a_real_asin(0);
         return z;
     }
@@ -531,14 +553,17 @@
         return z;
     }
     z.imag = -a_real_acosh(x);
     z.real = A_REAL_PI_2;
     return z;
 }
 
+#if defined(A_HAVE_CACOS) && (A_HAVE_CACOS + 0 < 1)
+#undef A_HAVE_CACOS
+#endif /* A_HAVE_CACOS */
 #if defined(A_HAVE_CACOS) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(cacos, a_complex_t);
 #endif /* A_HAVE_CACOS */
 a_complex_s a_complex_acos(a_complex_s z)
 {
 #if defined(A_HAVE_CACOS) && defined(A_COMPLEX_T)
     union
@@ -607,15 +632,15 @@
     {
         z.imag = -z.imag;
     }
     return z;
 #endif /* A_HAVE_CACOS */
 }
 
-a_complex_s a_complex_acos_real(a_real_t x)
+a_complex_s a_complex_acos_real(a_real_t const x)
 {
     a_complex_s z = A_COMPLEX_C(0.0, 0.0);
     if (a_real_abs(x) <= 1)
     {
         z.real = a_real_acos(0);
         return z;
     }
@@ -625,14 +650,17 @@
         z.real = A_REAL_PI;
         return z;
     }
     z.imag = a_real_acosh(x);
     return z;
 }
 
+#if defined(A_HAVE_CATAN) && (A_HAVE_CATAN + 0 < 1)
+#undef A_HAVE_CATAN
+#endif /* A_HAVE_CATAN */
 #if defined(A_HAVE_CATAN) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(catan, a_complex_t);
 #endif /* A_HAVE_CATAN */
 a_complex_s a_complex_atan(a_complex_s z)
 {
 #if defined(A_HAVE_CATAN) && defined(A_COMPLEX_T)
     union
@@ -677,20 +705,20 @@
         return z;
     }
     z.real = A_REAL_C(0.5) * a_real_atan2(z.real * 2, (1 + r) * (1 - r));
     return z;
 #endif /* A_HAVE_CATAN */
 }
 
-a_complex_s a_complex_asec(a_complex_s z)
+a_complex_s a_complex_asec(a_complex_s const z)
 {
     return a_complex_acos(a_complex_inv(z));
 }
 
-a_complex_s a_complex_asec_real(a_real_t x)
+a_complex_s a_complex_asec_real(a_real_t const x)
 {
     a_complex_s z = A_COMPLEX_C(0.0, 0.0);
     if (x <= -1 || x >= 1)
     {
         z.real = a_real_acos(1 / x);
         return z;
     }
@@ -700,20 +728,20 @@
         return z;
     }
     z.imag = -a_real_acosh(-1 / x);
     z.real = A_REAL_PI;
     return z;
 }
 
-a_complex_s a_complex_acsc(a_complex_s z)
+a_complex_s a_complex_acsc(a_complex_s const z)
 {
     return a_complex_asin(a_complex_inv(z));
 }
 
-a_complex_s a_complex_acsc_real(a_real_t x)
+a_complex_s a_complex_acsc_real(a_real_t const x)
 {
     a_complex_s z = A_COMPLEX_C(0.0, 0.0);
     if (x <= -1 || x >= 1)
     {
         z.real = a_real_asin(1 / x);
         return z;
     }
@@ -734,14 +762,17 @@
     {
         z.real = A_REAL_PI_2;
         return z;
     }
     return a_complex_atan(a_complex_inv(z));
 }
 
+#if defined(A_HAVE_CSINH) && (A_HAVE_CSINH + 0 < 1)
+#undef A_HAVE_CSINH
+#endif /* A_HAVE_CSINH */
 #if defined(A_HAVE_CSINH) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(csinh, a_complex_t);
 #endif /* A_HAVE_CSINH */
 a_complex_s a_complex_sinh(a_complex_s z)
 {
 #if defined(A_HAVE_CSINH) && defined(A_COMPLEX_T)
     union
@@ -759,14 +790,17 @@
     a_real_t imag = z.imag;
     z.real = a_real_sinh(real) * a_real_cos(imag);
     z.imag = a_real_cosh(real) * a_real_sin(imag);
     return z;
 #endif /* A_HAVE_CSINH */
 }
 
+#if defined(A_HAVE_CCOSH) && (A_HAVE_CCOSH + 0 < 1)
+#undef A_HAVE_CCOSH
+#endif /* A_HAVE_CCOSH */
 #if defined(A_HAVE_CCOSH) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(ccosh, a_complex_t);
 #endif /* A_HAVE_CCOSH */
 a_complex_s a_complex_cosh(a_complex_s z)
 {
 #if defined(A_HAVE_CCOSH) && defined(A_COMPLEX_T)
     union
@@ -784,14 +818,17 @@
     a_real_t imag = z.imag;
     z.real = a_real_cosh(real) * a_real_cos(imag);
     z.imag = a_real_sinh(real) * a_real_sin(imag);
     return z;
 #endif /* A_HAVE_CCOSH */
 }
 
+#if defined(A_HAVE_CTANH) && (A_HAVE_CTANH + 0 < 1)
+#undef A_HAVE_CTANH
+#endif /* A_HAVE_CTANH */
 #if defined(A_HAVE_CTANH) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(ctanh, a_complex_t);
 #endif /* A_HAVE_CTANH */
 a_complex_s a_complex_tanh(a_complex_s z)
 {
 #if defined(A_HAVE_CTANH) && defined(A_COMPLEX_T)
     union
@@ -816,29 +853,32 @@
     }
     a_real_t den = a_real_pow(ci / sr, 2) + 1;
     z.real = 1 / (a_real_tanh(z.real) * den);
     return z;
 #endif /* A_HAVE_CTANH */
 }
 
-a_complex_s a_complex_sech(a_complex_s z)
+a_complex_s a_complex_sech(a_complex_s const z)
 {
     return a_complex_inv(a_complex_cosh(z));
 }
 
-a_complex_s a_complex_csch(a_complex_s z)
+a_complex_s a_complex_csch(a_complex_s const z)
 {
     return a_complex_inv(a_complex_sinh(z));
 }
 
-a_complex_s a_complex_coth(a_complex_s z)
+a_complex_s a_complex_coth(a_complex_s const z)
 {
     return a_complex_inv(a_complex_tanh(z));
 }
 
+#if defined(A_HAVE_CASINH) && (A_HAVE_CASINH + 0 < 1)
+#undef A_HAVE_CASINH
+#endif /* A_HAVE_CASINH */
 #if defined(A_HAVE_CASINH) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(casinh, a_complex_t);
 #endif /* A_HAVE_CASINH */
 a_complex_s a_complex_asinh(a_complex_s z)
 {
 #if defined(A_HAVE_CASINH) && defined(A_COMPLEX_T)
     union
@@ -854,14 +894,17 @@
 #else /* !A_HAVE_CASINH */
     z = a_complex_mul_imag(z, 1);
     z = a_complex_asin(z);
     return a_complex_mul_imag(z, -1);
 #endif /* A_HAVE_CASINH */
 }
 
+#if defined(A_HAVE_CACOSH) && (A_HAVE_CACOSH + 0 < 1)
+#undef A_HAVE_CACOSH
+#endif /* A_HAVE_CACOSH */
 #if defined(A_HAVE_CACOSH) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(cacosh, a_complex_t);
 #endif /* A_HAVE_CACOSH */
 a_complex_s a_complex_acosh(a_complex_s z)
 {
 #if defined(A_HAVE_CACOSH) && defined(A_COMPLEX_T)
     union
@@ -876,15 +919,15 @@
     return A_REAL_F1(cacosh, z);
 #else /* !A_HAVE_CACOSH */
     z = a_complex_acsc(z);
     return a_complex_mul_imag(z, z.imag > 0 ? -1 : 1);
 #endif /* A_HAVE_CACOSH */
 }
 
-a_complex_s a_complex_acosh_real(a_real_t x)
+a_complex_s a_complex_acosh_real(a_real_t const x)
 {
     a_complex_s z = A_COMPLEX_C(0.0, 0.0);
     if (x >= 1)
     {
         z.real = a_real_acosh(x);
         return z;
     }
@@ -894,14 +937,17 @@
         return z;
     }
     z.real = a_real_acos(-x);
     z.imag = A_REAL_PI;
     return z;
 }
 
+#if defined(A_HAVE_CATANH) && (A_HAVE_CATANH + 0 < 1)
+#undef A_HAVE_CATANH
+#endif /* A_HAVE_CATANH */
 #if defined(A_HAVE_CATANH) && !defined A_COMPLEX_T
 a_complex_t A_REAL_F1(catanh, a_complex_t);
 #endif /* A_HAVE_CATANH */
 a_complex_s a_complex_atanh(a_complex_s z)
 {
 #if defined(A_HAVE_CATANH) && defined(A_COMPLEX_T)
     union
@@ -921,15 +967,15 @@
     }
     z = a_complex_mul_imag(z, 1);
     z = a_complex_atan(z);
     return a_complex_mul_imag(z, -1);
 #endif /* A_HAVE_CATANH */
 }
 
-a_complex_s a_complex_atanh_real(a_real_t x)
+a_complex_s a_complex_atanh_real(a_real_t const x)
 {
     a_complex_s z = A_COMPLEX_C(0.0, 0.0);
     if (x > -1 && x < 1)
     {
         z.real = a_real_atanh(x);
         return z;
     }
@@ -939,21 +985,21 @@
         z.imag = A_REAL_PI_2;
         return z;
     }
     z.imag = -A_REAL_PI_2;
     return z;
 }
 
-a_complex_s a_complex_asech(a_complex_s z)
+a_complex_s a_complex_asech(a_complex_s const z)
 {
     return a_complex_acosh(a_complex_inv(z));
 }
 
-a_complex_s a_complex_acsch(a_complex_s z)
+a_complex_s a_complex_acsch(a_complex_s const z)
 {
     return a_complex_asinh(a_complex_inv(z));
 }
 
-a_complex_s a_complex_acoth(a_complex_s z)
+a_complex_s a_complex_acoth(a_complex_s const z)
 {
     return a_complex_atanh(a_complex_inv(z));
 }
```

### Comparing `liba-0.1.1rc4/src/complex.h` & `liba-0.1.1rc5/src/complex.h`

 * *Files 7% similar despite different names*

```diff
@@ -19,8 +19,8 @@
 #if defined(A_COMPLEX_T)
 /* compiler built-in complex number type */
 #define a_complex_t A_COMPLEX_T
 #else /* !A_COMPLEX_T */
 #define a_complex_t a_complex_s
 #endif /* A_COMPLEX_T */
 
-#endif /* COMPLEX_H */
+#endif /* complex.h */
```

### Comparing `liba-0.1.1rc4/src/fpid.c` & `liba-0.1.1rc5/src/fpid.c`

 * *Files 27% similar despite different names*

```diff
@@ -1,316 +1,260 @@
-#define A_FPID_I
-#include "pid.h"
-#include "inline.h"
+#define LIBA_FPID_C
 #include "fpid.h"
-#include "intern.h"
-#include "a/real.h"
 
-a_real_t a_fpid_op_or(a_real_t l, a_real_t r) { return l + r - l * r; }
+a_real_t a_fpid_op_or(a_real_t const l, a_real_t const r) { return l + r - l * r; }
 
-a_real_t a_fpid_op_and(a_real_t l, a_real_t r) { return l * r; }
+a_real_t a_fpid_op_and(a_real_t const l, a_real_t const r) { return l * r; }
 
-a_real_t a_fpid_op_equ(a_real_t l, a_real_t r)
+a_real_t a_fpid_op_equ(a_real_t const l, a_real_t const r)
 {
     return a_real_sqrt(l * r) * a_real_sqrt(1 - (1 - l) * (1 - r));
 }
 
-a_void_t a_fpid_set_op(a_fpid_s *ctx, a_uint_t op)
+a_void_t a_fpid_set_op(a_fpid_s *const ctx, a_uint_t op)
 {
-    ctx->pid->reg &= ~A_FPID_FUZZY_MASK;
+    ctx->pid.reg &= ~A_FPID_FUZZY_MASK;
     op &= A_FPID_FUZZY_MASK;
-    ctx->pid->reg |= op;
+    ctx->pid.reg |= op;
     switch (op)
     {
     case A_FPID_OR_ALGEBRA:
-    {
         ctx->op = a_fpid_op_or;
         break;
-    }
     case A_FPID_OR_BOUNDED:
     case A_FPID_AND:
-    {
         ctx->op = a_real_min;
         break;
-    }
     case A_FPID_AND_ALGEBRA:
-    {
         ctx->op = a_fpid_op_and;
         break;
-    }
     case A_FPID_AND_BOUNDED:
     case A_FPID_OR:
-    {
         ctx->op = a_real_max;
         break;
-    }
     case A_FPID_EQU:
     default:
         ctx->op = a_fpid_op_equ;
     }
 }
 
-a_uint_t a_fpid_mf(const a_real_t *a, a_real_t x, a_uint_t *idx, a_real_t *mms)
+a_uint_t a_fpid_mf(a_real_t const *a, a_real_t const x, a_uint_t *idx, a_real_t *val)
 {
     a_uint_t num = 0;
     a_int_t e = A_MF_NUL;
     for (a_uint_t i = 0; (void)(e = a_int_c(*a++)), e != A_MF_NUL; ++i)
     {
         a_real_t y = 0;
         switch (e)
         {
         case A_MF_GAUSS:
-        {
             y = a_mf_gauss(x, a[0], a[1]);
             a += 2;
             break;
-        }
         case A_MF_GBELL:
-        {
             y = a_mf_gbell(x, a[0], a[1], a[2]);
             a += 3;
             break;
-        }
         case A_MF_SIG:
-        {
             y = a_mf_sig(x, a[0], a[1]);
             a += 2;
             break;
-        }
         case A_MF_TRAP:
-        {
             y = a_mf_trap(x, a[0], a[1], a[2], a[3]);
             a += 4;
             break;
-        }
         case A_MF_TRI:
-        {
             y = a_mf_tri(x, a[0], a[1], a[2]);
             a += 3;
             break;
-        }
         case A_MF_Z:
-        {
             y = a_mf_z(x, a[0], a[1]);
             a += 2;
             break;
-        }
         case A_MF_NUL:
         default:
-            goto done;
+            goto out;
         }
-        if (y > 0)
+        if (y > A_REAL_EPSILON)
         {
             ++num;
             *idx++ = i;
-            *mms++ = y;
+            *val++ = y;
         }
     }
-done:
+out:
     return num;
 }
 
-a_fpid_s *a_fpid_off(a_fpid_s *ctx)
-{
-    a_pid_off(ctx->pid);
-    return ctx;
-}
-
-a_fpid_s *a_fpid_inc(a_fpid_s *ctx)
+a_fpid_s *a_fpid_off(a_fpid_s *const ctx)
 {
-    a_pid_inc(ctx->pid);
+    a_pid_off(&ctx->pid);
     return ctx;
 }
 
-a_fpid_s *a_fpid_pos(a_fpid_s *ctx, a_real_t max)
+a_fpid_s *a_fpid_inc(a_fpid_s *const ctx)
 {
-    a_pid_pos(ctx->pid, max);
+    a_pid_inc(&ctx->pid);
     return ctx;
 }
 
-a_fpid_s *a_fpid_ilim(a_fpid_s *ctx, a_real_t min, a_real_t max)
+a_fpid_s *a_fpid_pos(a_fpid_s *const ctx, a_real_t const max)
 {
-    a_real_t x = a_real_c((a_fpid_col(ctx) - 1) >> 1 << 1);
-    ctx->sigma = x / (max - min);
+    a_pid_pos(&ctx->pid, max);
     return ctx;
 }
 
-a_fpid_s *a_fpid_olim(a_fpid_s *ctx, a_real_t min, a_real_t max)
+a_fpid_s *a_fpid_kpid(a_fpid_s *const ctx, a_real_t const kp, a_real_t const ki, a_real_t const kd)
 {
-    a_real_t x = a_real_c((a_fpid_col(ctx) - 1) >> 1 << 1);
-    ctx->alpha = (max - min) / x;
-    ctx->pid->outmin = min;
-    ctx->pid->outmax = max;
+    a_pid_kpid(&ctx->pid, kp, ki, kd);
+    ctx->kp = kp;
+    ctx->ki = ki;
+    ctx->kd = kd;
     return ctx;
 }
 
-a_fpid_s *a_fpid_buf1(a_fpid_s *ctx, a_vptr_t ptr, a_size_t max)
+a_fpid_s *a_fpid_buf1(a_fpid_s *const ctx, a_vptr_t ptr, a_size_t max)
 {
-    a_fpid_set_bufnum(ctx, (a_uint_t)max);
-    max <<= 1;
+    a_fpid_set_bufmax(ctx, (a_uint_t)max);
     ctx->idx = a_uint_p(ptr);
-    ptr = a_byte_p(ptr) + sizeof(a_uint_t) * max;
-    ctx->mms = a_real_p(ptr);
-    ptr = a_byte_p(ptr) + sizeof(a_real_t) * max;
-    ctx->mat = a_real_p(ptr);
-    return ctx;
-}
-
-a_fpid_s *a_fpid_kpid(a_fpid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd)
-{
-    a_pid_kpid(ctx->pid, kp, ki, kd);
-    ctx->kp = kp;
-    ctx->ki = ki;
-    ctx->kd = kd;
+    ptr = a_byte_p(ptr) + sizeof(a_uint_t) * (max << 1);
+    ctx->val = a_real_p(ptr);
     return ctx;
 }
 
-a_fpid_s *a_fpid_buff(a_fpid_s *ctx, a_uint_t *idx, a_real_t *mms, a_real_t *mat)
+a_fpid_s *a_fpid_buff(a_fpid_s *const ctx, a_uint_t *const idx, a_real_t *const val)
 {
     ctx->idx = idx;
-    ctx->mms = mms;
-    ctx->mat = mat;
+    ctx->val = val;
     return ctx;
 }
 
-a_fpid_s *a_fpid_setp(a_fpid_s *ctx, a_uint_t num, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e)
+a_fpid_s *a_fpid_chan(a_fpid_s *const ctx, a_uint_t const num, a_real_t *const out, a_real_t *const fdb,
+                      a_real_t *const sum, a_real_t *const ec, a_real_t *const e)
 {
-    a_pid_setp(ctx->pid, num, out, fdb, sum, ec, e);
+    a_pid_chan(&ctx->pid, num, out, fdb, sum, ec, e);
     return ctx;
 }
 
-a_fpid_s *a_fpid_base(a_fpid_s *ctx, a_uint_t num, const a_real_t *mmp, const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd)
+a_fpid_s *a_fpid_base(a_fpid_s *const ctx, a_uint_t const col, a_real_t const *const me, a_real_t const *const mec,
+                      a_real_t const *const mkp, a_real_t const *const mki, a_real_t const *const mkd)
 {
-    a_fpid_set_col(ctx, num);
-    ctx->mmp = mmp;
+    a_fpid_set_col(ctx, col);
+    ctx->me = me;
+    ctx->mec = mec;
     ctx->mkp = mkp;
     ctx->mki = mki;
     ctx->mkd = mkd;
     return ctx;
 }
 
-a_fpid_s *a_fpid_init(a_fpid_s *ctx, a_real_t dt, a_uint_t num, const a_real_t *mmp,
-                      const a_real_t *mkp, const a_real_t *mki, const a_real_t *mkd,
-                      a_real_t imin, a_real_t imax, a_real_t omin, a_real_t omax)
-{
-    a_real_t x = a_real_c((num - 1) >> 1 << 1);
-    a_pid_init(ctx->pid, dt, omin, omax);
-    a_fpid_base(ctx, num, mmp, mkp, mki, mkd);
-    ctx->sigma = x / (imax - imin);
-    ctx->alpha = (omax - omin) / x;
+a_fpid_s *a_fpid_init(a_fpid_s *const ctx, a_real_t const dt, a_uint_t const col, a_real_t const *const me, a_real_t const *const mec,
+                      a_real_t const *const mkp, a_real_t const *const mki, a_real_t const *const mkd, a_real_t const min, a_real_t const max)
+{
+    a_pid_init(&ctx->pid, dt, min, max);
+    a_fpid_base(ctx, col, me, mec, mkp, mki, mkd);
     ctx->op = a_fpid_op_equ;
     ctx->idx = A_NULL;
-    ctx->mms = A_NULL;
-    ctx->mat = A_NULL;
+    ctx->val = A_NULL;
     ctx->kp = 0;
     ctx->ki = 0;
     ctx->kd = 0;
     return ctx;
 }
 
-a_fpid_s *a_fpid_exit(a_fpid_s *ctx) { return a_fpid_zero(ctx); }
+a_fpid_s *a_fpid_exit(a_fpid_s *const ctx) { return a_fpid_zero(ctx); }
 
-a_fpid_s *a_fpid_zero(a_fpid_s *ctx)
+a_fpid_s *a_fpid_zero(a_fpid_s *const ctx)
 {
-    a_pid_zero(ctx->pid);
+    a_pid_zero(&ctx->pid);
     return ctx;
 }
 
-A_STATIC void a_fpid_proc_(a_fpid_s *ctx, a_real_t ev[2], a_uint_t num)
+static void a_fpid_iter_(a_fpid_s *const ctx, a_uint_t const col, a_real_t ec, a_real_t e)
 {
-    /* quantize input */
-    ev[0] = ctx->sigma * ev[0] / (1 << 0);
-    ev[1] = ctx->sigma * ev[1] / (1 << 1);
     /* calculate membership */
-    a_uint_t ne = a_fpid_mf(ctx->mmp, ev[0], ctx->idx + 00, ctx->mms + 00);
-    a_uint_t nc = a_fpid_mf(ctx->mmp, ev[1], ctx->idx + ne, ctx->mms + ne);
-    if (!ne || !nc)
+    a_uint_t const ne = a_fpid_mf(ctx->me, e, ctx->idx, ctx->val);
+    a_uint_t const nec = a_fpid_mf(ctx->mec, ec, ctx->idx + ne, ctx->val + ne);
+    if (!ne || !nec)
     {
         return;
     }
+    a_real_t *const mat = ctx->val + ne + nec;
     /* joint membership */
     a_real_t inv = 0;
     for (a_uint_t i = 0; i != ne; ++i)
     {
-        a_uint_t col = i * nc;
-        for (a_uint_t j = 0; j != nc; ++j)
+        a_uint_t const row = nec * i;
+        for (a_uint_t j = 0; j != nec; ++j)
         {
-            a_uint_t idx = col + j; /* mat(i,j)=f(e[i],ec[j]) */
-            ctx->mat[idx] = ctx->op(ctx->mms[i], ctx->mms[ne + j]);
-            inv += ctx->mat[idx];
+            a_uint_t const idx = row + j; /* mat(i,j)=f(e[i],ec[j]) */
+            mat[idx] = ctx->op(ctx->val[i], ctx->val[ne + j]);
+            inv += mat[idx];
         }
     }
-    inv = ctx->alpha / inv;
+    inv = 1 / inv;
     /* mean of centers defuzzifier */
     a_real_t qv[3] = {0, 0, 0};
-    if (ctx->mkp == A_NULL)
-    {
-        goto skip_kp;
-    }
-    for (a_uint_t i = 0; i != ne; ++i)
+    if (ctx->mkp)
     {
-        a_uint_t col = i * nc;
-        a_uint_t idx = ctx->idx[i] * num;
-        for (a_uint_t j = 0; j != nc; ++j)
+        for (a_uint_t i = 0; i != ne; ++i)
         {
-            qv[0] += ctx->mat[col + j] * ctx->mkp[ctx->idx[ne + j] + idx]; /* mat(i,j)*kp(e[i],ec[j]) */
+            a_uint_t const row = nec * i;
+            a_uint_t const idx = col * ctx->idx[i];
+            for (a_uint_t j = 0; j != nec; ++j) /* mat(i,j) * kp(e[i],ec[j]) */
+            {
+                qv[0] += mat[row + j] * ctx->mkp[idx + ctx->idx[ne + j]];
+            }
         }
+        qv[0] *= inv;
     }
-    qv[0] *= inv;
-skip_kp:
-    if (ctx->mki == A_NULL)
+    if (ctx->mki)
     {
-        goto skip_ki;
-    }
-    for (a_uint_t i = 0; i != ne; ++i)
-    {
-        a_uint_t col = i * nc;
-        a_uint_t idx = ctx->idx[i] * num;
-        for (a_uint_t j = 0; j != nc; ++j)
+        for (a_uint_t i = 0; i != ne; ++i)
         {
-            qv[1] += ctx->mat[col + j] * ctx->mki[ctx->idx[ne + j] + idx]; /* mat(i,j)*ki(e[i],ec[j]) */
+            a_uint_t const row = nec * i;
+            a_uint_t const idx = col * ctx->idx[i];
+            for (a_uint_t j = 0; j != nec; ++j) /* mat(i,j) * ki(e[i],ec[j]) */
+            {
+                qv[1] += mat[row + j] * ctx->mki[idx + ctx->idx[ne + j]];
+            }
         }
+        qv[1] *= inv;
     }
-    qv[1] *= inv;
-skip_ki:
-    if (ctx->mkd == A_NULL)
-    {
-        goto skip_kd;
-    }
-    for (a_uint_t i = 0; i != ne; ++i)
+    if (ctx->mkd)
     {
-        a_uint_t col = i * nc;
-        a_uint_t idx = ctx->idx[i] * num;
-        for (a_uint_t j = 0; j != nc; ++j)
+        for (a_uint_t i = 0; i != ne; ++i)
         {
-            qv[2] += ctx->mat[col + j] * ctx->mkd[ctx->idx[ne + j] + idx]; /* mat(i,j)*kd(e[i],ec[j]) */
+            a_uint_t const row = nec * i;
+            a_uint_t const idx = col * ctx->idx[i];
+            for (a_uint_t j = 0; j != nec; ++j) /* mat(i,j) * kd(e[i],ec[j]) */
+            {
+                qv[2] += mat[row + j] * ctx->mkd[idx + ctx->idx[ne + j]];
+            }
         }
+        qv[2] *= inv;
     }
-    qv[2] *= inv;
-skip_kd:
-    a_pid_kpid(ctx->pid, qv[0] + ctx->kp, qv[1] + ctx->ki, qv[2] + ctx->kd);
+    a_pid_kpid(&ctx->pid, ctx->kp + qv[0], ctx->ki + qv[1], ctx->kd + qv[2]);
 }
 
-a_real_t a_fpid_outv(a_fpid_s *ctx, a_real_t set, a_real_t fdb)
+a_real_t a_fpid_outv(a_fpid_s *const ctx, a_real_t const set, a_real_t const fdb)
 {
-    a_real_t ev[2];
-    a_real_t e = ev[0] = set - fdb;
-    a_real_t ec = ev[1] = e - ctx->pid->e.v;
-    a_fpid_proc_(ctx, ev, a_fpid_col(ctx));
-    return a_pid_outv_(ctx->pid, a_pid_mode(ctx->pid), set, fdb, ec, e);
+    a_real_t const e = set - fdb;
+    a_real_t const ec = e - ctx->pid.e.v;
+    a_fpid_iter_(ctx, a_fpid_col(ctx), ec, e);
+    return a_pid_outv_(&ctx->pid, a_pid_mode(&ctx->pid), set, fdb, ec, e);
 }
 
-a_real_t *a_fpid_outp(a_fpid_s *ctx, a_real_t *set, a_real_t *fdb)
+a_real_t *a_fpid_outp(a_fpid_s *const ctx, a_real_t *const set, a_real_t *const fdb)
 {
-    a_uint_t col = a_fpid_col(ctx);
-    a_uint_t num = a_pid_num(ctx->pid);
-    a_uint_t reg = a_pid_mode(ctx->pid);
+    a_uint_t const col = a_fpid_col(ctx);
+    a_uint_t const num = a_pid_num(&ctx->pid);
+    a_uint_t const mode = a_pid_mode(&ctx->pid);
     for (a_uint_t i = 0; i != num; ++i)
     {
-        a_real_t ev[2];
-        a_real_t e = ev[0] = set[i] - fdb[i];
-        a_real_t ec = ev[1] = e - ctx->pid->e.p[i];
-        a_fpid_proc_(ctx, ev, col);
-        a_pid_outp_(ctx->pid, reg, set[i], fdb[i], ec, e, i);
+        a_real_t const e = set[i] - fdb[i];
+        a_real_t const ec = e - ctx->pid.e.p[i];
+        a_fpid_iter_(ctx, col, ec, e);
+        a_pid_outp_(&ctx->pid, mode, set[i], fdb[i], ec, e, i);
     }
-    return ctx->pid->out.p;
+    return ctx->pid.out.p;
 }
```

### Comparing `liba-0.1.1rc4/src/fuzzy.c` & `liba-0.1.1rc5/src/fuzzy.c`

 * *Files 24% similar despite different names*

```diff
@@ -1,36 +1,36 @@
 #include "a/fuzzy.h"
 #include "a/real.h"
 
-a_real_t a_fuzzy_or(a_uint_t e, a_real_t l, a_real_t r)
+a_real_t a_fuzzy_or(a_uint_t const e, a_real_t const l, a_real_t const r)
 {
     switch (e)
     {
     case A_FUZZY_ALGEBRA:
         return l + r - l * r;
     case A_FUZZY_BOUNDED:
         return a_real_min(1, l + r);
     case A_FUZZY_DEFAULT:
     default:
         return a_real_max(l, r);
     }
 }
 
-a_real_t a_fuzzy_and(a_uint_t e, a_real_t l, a_real_t r)
+a_real_t a_fuzzy_and(a_uint_t const e, a_real_t const l, a_real_t const r)
 {
     switch (e)
     {
     case A_FUZZY_ALGEBRA:
         return l * r;
     case A_FUZZY_BOUNDED:
         return a_real_max(0, l + r - 1);
     case A_FUZZY_DEFAULT:
     default:
         return a_real_min(l, r);
     }
 }
 
-a_real_t a_fuzzy_equ(a_real_t gamma, a_real_t l, a_real_t r)
+a_real_t a_fuzzy_equ(a_real_t const gamma, a_real_t const l, a_real_t const r)
 {
     return a_real_pow(l * r, 1 - gamma) *
            a_real_pow(1 - (1 - l) * (1 - r), gamma);
 }
```

### Comparing `liba-0.1.1rc4/src/host/que.c` & `liba-0.1.1rc5/src/host/que.c`

 * *Files 12% similar despite different names*

```diff
@@ -1,230 +1,229 @@
 #include "a/host/que.h"
-#include <string.h>
 
 #undef a_que_at
 #undef a_que_fore
 #undef a_que_back
 #undef a_que_fore_
 #undef a_que_back_
 #undef a_que_insert
 #undef a_que_remove
 #undef a_que_push_fore
 #undef a_que_push_back
 #undef a_que_pull_fore
 #undef a_que_pull_back
 
-A_INTERN a_void_t func(a_vptr_t vptr) { (void)(vptr); }
-
-A_STATIC a_que_node_s *a_que_node_alloc(a_que_s *ctx)
+static a_que_node_s *a_que_node_new(a_que_s *const ctx)
 {
     a_que_node_s *node = A_NULL;
     if (ctx->_cur)
     {
         node = ctx->_ptr[--ctx->_cur];
     }
     else
     {
-        node = (a_que_node_s *)malloc(sizeof(a_que_node_s));
+        node = (a_que_node_s *)a_alloc(A_NULL, sizeof(a_que_node_s));
         if (a_unlikely(node == A_NULL))
         {
             return node;
         }
         node->_data = A_NULL;
     }
     if (node->_data == A_NULL)
     {
-        node->_data = malloc(ctx->_size);
+        node->_data = a_alloc(A_NULL, ctx->_size);
         if (a_unlikely(node->_data == A_NULL))
         {
-            free(node);
+            a_alloc(node, 0);
             return A_NULL;
         }
     }
     ++ctx->_num;
     return node;
 }
 
-A_STATIC int a_que_node_free(a_que_s *ctx, a_que_node_s *obj)
+static int a_que_node_die(a_que_s *const ctx, a_que_node_s *const obj)
 {
     if (obj == A_NULL)
     {
         return A_INVALID;
     }
     if (ctx->_mem <= ctx->_cur)
     {
-        a_size_t mem = ctx->_mem + (ctx->_mem >> 1) + 1;
-        a_que_node_s **ptr = (a_que_node_s **)realloc(ctx->_ptr, sizeof(a_vptr_t) * mem);
+        a_size_t const mem = ctx->_mem + (ctx->_mem >> 1) + 1;
+        a_que_node_s **const ptr = (a_que_node_s **)a_alloc(ctx->_ptr, sizeof(a_vptr_t) * mem);
         if (a_unlikely(ptr == A_NULL))
         {
             return A_FAILURE;
         }
         ctx->_ptr = ptr;
         ctx->_mem = mem;
     }
     ctx->_ptr[ctx->_cur++] = obj;
     --ctx->_num;
     return A_SUCCESS;
 }
 
-A_STATIC a_void_t a_que_drop_(a_que_s *ctx)
+static a_void_t a_que_drop_(a_que_s *const ctx)
 {
-    while (a_list_used(ctx->_head))
+    while (a_list_used(&ctx->_head))
     {
-        a_que_node_s *node = a_que_from(ctx->_head->prev);
-        if (a_unlikely(a_que_node_free(ctx, node)))
+        a_que_node_s *const node = a_que_from(ctx->_head.prev);
+        if (a_unlikely(a_que_node_die(ctx, node)))
         {
             break;
         }
-        a_list_del_node(node->_node);
-        a_list_dtor(node->_node);
+        a_list_del_node(&node->_node);
+        a_list_dtor(&node->_node);
     }
 }
 
-a_que_s *a_que_new(a_size_t size)
+static A_INLINE a_void_t a_que_dtor_nop(a_vptr_t const vptr) { (void)(vptr); }
+
+a_que_s *a_que_new(a_size_t const size)
 {
-    a_que_s *ctx = (a_que_s *)malloc(sizeof(a_que_s));
+    a_que_s *const ctx = (a_que_s *)a_alloc(A_NULL, sizeof(a_que_s));
     if (ctx)
     {
         a_que_ctor(ctx, size);
     }
     return ctx;
 }
 
-a_void_t a_que_die(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_que_die(a_que_s *const ctx, a_void_t (*const dtor)(a_vptr_t))
 {
     if (ctx)
     {
         a_que_dtor(ctx, dtor);
-        free(ctx);
+        a_alloc(ctx, 0);
     }
 }
 
-a_void_t a_que_ctor(a_que_s *ctx, a_size_t size)
+a_void_t a_que_ctor(a_que_s *const ctx, a_size_t const size)
 {
-    a_list_ctor(ctx->_head);
+    a_list_ctor(&ctx->_head);
     ctx->_size = size ? size : sizeof(a_cast_u);
     ctx->_ptr = A_NULL;
     ctx->_num = 0;
     ctx->_cur = 0;
     ctx->_mem = 0;
 }
 
-a_void_t a_que_dtor(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_que_dtor(a_que_s *const ctx, a_void_t (*dtor)(a_vptr_t))
 {
     a_que_drop_(ctx);
-    dtor = dtor ? dtor : func;
+    dtor = dtor ? dtor : a_que_dtor_nop;
     while (ctx->_cur)
     {
         --ctx->_cur;
         dtor(ctx->_ptr[ctx->_cur]->_data);
-        free(ctx->_ptr[ctx->_cur]->_data);
-        free(ctx->_ptr[ctx->_cur]);
+        a_alloc(ctx->_ptr[ctx->_cur]->_data, 0);
+        a_alloc(ctx->_ptr[ctx->_cur], 0);
     }
-    free(ctx->_ptr);
+    a_alloc(ctx->_ptr, 0);
     ctx->_ptr = A_NULL;
     ctx->_size = 0;
     ctx->_mem = 0;
 }
 
-a_que_s *a_que_move(a_que_s *ctx, a_que_s *obj)
+a_que_s *a_que_move(a_que_s *const ctx, a_que_s *const obj)
 {
-    memcpy(ctx, obj, sizeof(*obj));
-    memset(obj, 0, sizeof(*obj));
+    a_copy(ctx, obj, sizeof(*obj));
+    a_zero(obj, sizeof(*obj));
     return ctx;
 }
 
-a_vptr_t a_que_at(const a_que_s *ctx, a_imax_t idx)
+a_vptr_t a_que_at(a_que_s const *const ctx, a_imax_t const idx)
 {
     a_imax_t cur = 0;
     a_vptr_t vptr = A_NULL;
     if (idx < 0)
     {
-        a_list_foreach_prev(it, ctx->_head)
+        a_list_foreach_prev(it, &ctx->_head)
         {
             if (--cur == idx)
             {
                 vptr = a_que_from(it)->_data;
                 break;
             }
         }
     }
     else
     {
-        a_list_foreach_next(it, ctx->_head)
+        a_list_foreach_next(it, &ctx->_head)
         {
             if (cur++ == idx)
             {
                 vptr = a_que_from(it)->_data;
                 break;
             }
         }
     }
     return vptr;
 }
 
-a_void_t a_que_set(a_que_s *ctx, a_size_t size, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_que_set(a_que_s *const ctx, a_size_t size, a_void_t (*const dtor)(a_vptr_t))
 {
     size = size ? size : sizeof(a_cast_u);
     a_que_drop(ctx, dtor);
     ctx->_size = size;
 }
 
-a_void_t a_que_drop(a_que_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_que_drop(a_que_s *const ctx, a_void_t (*dtor)(a_vptr_t))
 {
     a_que_drop_(ctx);
-    dtor = dtor ? dtor : func;
+    dtor = dtor ? dtor : a_que_dtor_nop;
     for (a_size_t cur = ctx->_cur; cur--; ctx->_ptr[cur]->_data = A_NULL)
     {
         dtor(ctx->_ptr[cur]->_data);
-        free(ctx->_ptr[cur]->_data);
+        a_alloc(ctx->_ptr[cur]->_data, 0);
     }
 }
 
-a_int_t a_que_swap_(const a_que_s *ctx, a_vptr_t lhs, a_vptr_t rhs)
+a_int_t a_que_swap_(a_que_s const *const ctx, a_vptr_t const lhs, a_vptr_t const rhs)
 {
     if (lhs == rhs)
     {
         return A_SUCCESS;
     }
     int ok = A_FAILURE;
     a_que_node_s *l = A_NULL;
     a_que_node_s *r = A_NULL;
-    a_list_foreach_next(it, ctx->_head)
+    a_list_foreach_next(it, &ctx->_head)
     {
-        a_que_node_s *node = a_que_from(it);
+        a_que_node_s *const node = a_que_from(it);
         if (node->_data == lhs)
         {
             l = node;
         }
         else if (node->_data == rhs)
         {
             r = node;
         }
         if (l && r)
         {
-            a_list_swap_node(l->_node, r->_node);
+            a_list_swap_node(&l->_node, &r->_node);
             ok = A_SUCCESS;
             break;
         }
     }
     return ok;
 }
 
-a_void_t a_que_swap(const a_que_s *ctx, a_size_t lhs, a_size_t rhs)
+a_void_t a_que_swap(a_que_s const *const ctx, a_size_t lhs, a_size_t rhs)
 {
     a_size_t cur = 0;
-    a_size_t num = ctx->_num - 1;
+    a_size_t const num = ctx->_num - 1;
     lhs = lhs < ctx->_num ? lhs : num;
     rhs = rhs < ctx->_num ? rhs : num;
     if (lhs != rhs)
     {
         a_que_node_s *l = A_NULL;
         a_que_node_s *r = A_NULL;
-        a_list_foreach_next(it, ctx->_head)
+        a_list_foreach_next(it, &ctx->_head)
         {
             if (cur == lhs)
             {
                 // because lhs less than num
                 // it's never a null pointer
                 l = a_que_from(it);
             }
@@ -232,32 +231,32 @@
             {
                 // because rhs less than num
                 // it's never a null pointer
                 r = a_que_from(it);
             }
             if (l && r)
             {
-                a_list_swap_node(l->_node, r->_node);
+                a_list_swap_node(&l->_node, &r->_node);
                 break;
             }
             ++cur;
         }
     }
 }
 
-a_void_t a_que_sort_fore(const a_que_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_que_sort_fore(a_que_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_list_s *pt = A_NULL;
-        a_list_s *it = ctx->_head->next;
-        for (a_list_s *at = it->next; at != ctx->_head; at = at->next)
+        a_list_s *const it = ctx->_head.next;
+        for (a_list_s *at = it->next; at != &ctx->_head; at = at->next)
         {
-            a_vptr_t lhs = a_que_from(it)->_data;
-            a_vptr_t rhs = a_que_from(at)->_data;
+            a_vptr_t const lhs = a_que_from(it)->_data;
+            a_vptr_t const rhs = a_que_from(at)->_data;
             if (cmp(lhs, rhs) > 0)
             {
                 pt = at;
             }
             else
             {
                 break;
@@ -267,24 +266,24 @@
         {
             a_list_del_(it, it);
             a_list_add_(pt->next, pt, it, it);
         }
     }
 }
 
-a_void_t a_que_sort_back(const a_que_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_que_sort_back(a_que_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_list_s *pt = A_NULL;
-        a_list_s *it = ctx->_head->prev;
-        for (a_list_s *at = it->prev; at != ctx->_head; at = at->prev)
+        a_list_s *const it = ctx->_head.prev;
+        for (a_list_s *at = it->prev; at != &ctx->_head; at = at->prev)
         {
-            a_vptr_t lhs = a_que_from(at)->_data;
-            a_vptr_t rhs = a_que_from(it)->_data;
+            a_vptr_t const lhs = a_que_from(at)->_data;
+            a_vptr_t const rhs = a_que_from(it)->_data;
             if (cmp(lhs, rhs) > 0)
             {
                 pt = at;
             }
             else
             {
                 break;
@@ -294,112 +293,112 @@
         {
             a_list_del_(it, it);
             a_list_add_(pt, pt->prev, it, it);
         }
     }
 }
 
-a_vptr_t a_que_push_fore(a_que_s *ctx)
+a_vptr_t a_que_push_fore(a_que_s *const ctx)
 {
-    a_que_node_s *node = a_que_node_alloc(ctx);
+    a_que_node_s *const node = a_que_node_new(ctx);
     if (a_unlikely(node == A_NULL))
     {
         return node;
     }
-    a_list_add_next(ctx->_head, node->_node);
+    a_list_add_next(&ctx->_head, &node->_node);
     return node->_data;
 }
 
-a_vptr_t a_que_push_back(a_que_s *ctx)
+a_vptr_t a_que_push_back(a_que_s *const ctx)
 {
-    a_que_node_s *node = a_que_node_alloc(ctx);
+    a_que_node_s *const node = a_que_node_new(ctx);
     if (a_unlikely(node == A_NULL))
     {
         return node;
     }
-    a_list_add_prev(ctx->_head, node->_node);
+    a_list_add_prev(&ctx->_head, &node->_node);
     return node->_data;
 }
 
-a_vptr_t a_que_pull_fore(a_que_s *ctx)
+a_vptr_t a_que_pull_fore(a_que_s *const ctx)
 {
     a_vptr_t data = A_NULL;
-    if (a_list_used(ctx->_head))
+    if (a_list_used(&ctx->_head))
     {
-        a_que_node_s *node = a_que_from(ctx->_head->next);
-        if (a_unlikely(a_que_node_free(ctx, node)))
+        a_que_node_s *const node = a_que_from(ctx->_head.next);
+        if (a_unlikely(a_que_node_die(ctx, node)))
         {
             return data;
         }
-        a_list_del_node(node->_node);
-        a_list_dtor(node->_node);
+        a_list_del_node(&node->_node);
+        a_list_dtor(&node->_node);
         data = node->_data;
     }
     return data;
 }
 
-a_vptr_t a_que_pull_back(a_que_s *ctx)
+a_vptr_t a_que_pull_back(a_que_s *const ctx)
 {
     a_vptr_t data = A_NULL;
-    if (a_list_used(ctx->_head))
+    if (a_list_used(&ctx->_head))
     {
-        a_que_node_s *node = a_que_from(ctx->_head->prev);
-        if (a_unlikely(a_que_node_free(ctx, node)))
+        a_que_node_s *const node = a_que_from(ctx->_head.prev);
+        if (a_unlikely(a_que_node_die(ctx, node)))
         {
             return data;
         }
-        a_list_del_node(node->_node);
-        a_list_dtor(node->_node);
+        a_list_del_node(&node->_node);
+        a_list_dtor(&node->_node);
         data = node->_data;
     }
     return data;
 }
 
-a_vptr_t a_que_insert(a_que_s *ctx, a_size_t idx)
+a_vptr_t a_que_insert(a_que_s *const ctx, a_size_t const idx)
 {
     if (idx < ctx->_num)
     {
         a_size_t cur = 0;
-        a_que_node_s *node = a_que_node_alloc(ctx);
+        a_que_node_s *const node = a_que_node_new(ctx);
         if (a_unlikely(node == A_NULL))
         {
             return node;
         }
-        a_list_foreach_next(it, ctx->_head)
+        a_list_foreach_next(it, &ctx->_head)
         {
             if (cur++ == idx)
             {
-                a_list_add_prev(it, node->_node);
+                a_list_add_prev(it, &node->_node);
                 break;
             }
         }
         return node->_data;
     }
     return a_que_push_back(ctx);
 }
 
-a_vptr_t a_que_remove(a_que_s *ctx, a_size_t idx)
+a_vptr_t a_que_remove(a_que_s *const ctx, a_size_t const idx)
 {
     if (idx < ctx->_num)
     {
         a_size_t cur = 0;
         a_que_node_s *node = A_NULL;
-        a_list_foreach_next(it, ctx->_head)
+        a_list_foreach_next(it, &ctx->_head)
         {
             if (cur++ == idx)
             {
                 // because idx less than num
                 // it's never a null pointer
                 node = a_que_from(it);
                 break;
             }
         }
-        if (a_unlikely(a_que_node_free(ctx, node)))
+        if (a_unlikely(a_que_node_die(ctx, node)))
         {
             return A_NULL;
         }
-        a_list_del_node(node->_node);
-        a_list_dtor(node->_node);
+        a_list_del_node(&node->_node);
+        a_list_dtor(&node->_node);
         return node->_data;
     }
     return a_que_pull_back(ctx);
 }
```

### Comparing `liba-0.1.1rc4/src/host/vec.c` & `liba-0.1.1rc5/src/host/vec.c`

 * *Files 16% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 #include "a/host/vec.h"
-#include <string.h>
 
 #undef a_vec_at
 #undef a_vec_at_
+#undef a_vec_idx
 #undef a_vec_ptr
 #undef a_vec_end
 #undef a_vec_top
 #undef a_vec_end_
 #undef a_vec_top_
 #undef a_vec_push
 #undef a_vec_pull
@@ -14,268 +14,266 @@
 #undef a_vec_insert
 #undef a_vec_remove
 #undef a_vec_push_fore
 #undef a_vec_push_back
 #undef a_vec_pull_fore
 #undef a_vec_pull_back
 
-A_INTERN a_vptr_t a_vec_inc_(a_vec_s *ctx)
+static A_INLINE a_vptr_t a_vec_inc_(a_vec_s *const ctx)
 {
     return a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num++;
 }
 
-A_INTERN a_vptr_t a_vec_dec_(a_vec_s *ctx)
+static A_INLINE a_vptr_t a_vec_dec_(a_vec_s *const ctx)
 {
     return a_byte_p(ctx->_ptr) + ctx->_siz * --ctx->_num;
 }
 
-A_STATIC a_void_t a_vec_drop_(a_vec_s *ctx, a_size_t bot, a_void_t (*dtor)(a_vptr_t))
+static a_void_t a_vec_drop_(a_vec_s *const ctx, a_size_t const bot, a_void_t (*const dtor)(a_vptr_t))
 {
     if (dtor)
     {
         while (ctx->_num > bot)
         {
             dtor(a_vec_dec_(ctx));
         }
     }
     ctx->_num = bot;
 }
 
-A_STATIC a_int_t a_vec_alloc(a_vec_s *ctx, a_size_t num)
+static a_int_t a_vec_alloc(a_vec_s *const ctx, a_size_t const num)
 {
     if (ctx->_mem <= num)
     {
         a_size_t mem = ctx->_mem;
         do
         {
             mem += (mem >> 1) + 1;
         } while (mem < num);
-        a_size_t siz = a_align(sizeof(a_vptr_t), ctx->_siz * mem);
-        a_vptr_t ptr = realloc(ctx->_ptr, siz);
+        a_size_t const siz = a_align(sizeof(a_vptr_t), ctx->_siz * mem);
+        a_vptr_t ptr = a_alloc(ctx->_ptr, siz);
         if (a_unlikely(ptr == A_NULL))
         {
             return A_FAILURE;
         }
         ctx->_mem = mem;
         ctx->_ptr = ptr;
     }
     return A_SUCCESS;
 }
 
-a_vec_s *a_vec_new(a_size_t size)
+a_vec_s *a_vec_new(a_size_t const size)
 {
-    a_vec_s *ctx = (a_vec_s *)malloc(sizeof(a_vec_s));
+    a_vec_s *const ctx = (a_vec_s *)a_alloc(A_NULL, sizeof(a_vec_s));
     if (ctx)
     {
         a_vec_ctor(ctx, size);
     }
     return ctx;
 }
 
-a_void_t a_vec_die(a_vec_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_vec_die(a_vec_s *const ctx, a_void_t (*const dtor)(a_vptr_t))
 {
     if (ctx)
     {
         a_vec_dtor(ctx, dtor);
-        free(ctx);
+        a_alloc(ctx, 0);
     }
 }
 
-a_void_t a_vec_ctor(a_vec_s *ctx, a_size_t size)
+a_void_t a_vec_ctor(a_vec_s *const ctx, a_size_t const size)
 {
     ctx->_siz = size ? size : sizeof(a_cast_u);
     ctx->_ptr = A_NULL;
     ctx->_mem = 0;
     ctx->_num = 0;
 }
 
-a_void_t a_vec_dtor(a_vec_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_vec_dtor(a_vec_s *const ctx, a_void_t (*const dtor)(a_vptr_t))
 {
     if (ctx->_ptr)
     {
         a_vec_drop_(ctx, 0, dtor);
-        free(ctx->_ptr);
-        ctx->_ptr = A_NULL;
+        ctx->_ptr = a_alloc(ctx->_ptr, 0);
     }
     ctx->_mem = 0;
     ctx->_siz = 0;
 }
 
-a_int_t a_vec_copy(a_vec_s *ctx, const a_vec_s *obj, a_int_t (*dup)(a_vptr_t, a_cptr_t))
+a_int_t a_vec_copy(a_vec_s *const ctx, a_vec_s const *const obj, a_int_t (*const dup)(a_vptr_t, a_cptr_t))
 {
-    ctx->_ptr = malloc(obj->_mem * obj->_siz);
+    ctx->_ptr = a_alloc(A_NULL, obj->_mem * obj->_siz);
     if (a_unlikely(ctx->_ptr == A_NULL))
     {
         return A_FAILURE;
     }
     ctx->_siz = obj->_siz;
     ctx->_num = obj->_num;
     ctx->_mem = obj->_mem;
-    a_size_t size = obj->_num * obj->_siz;
+    a_size_t const size = obj->_num * obj->_siz;
     if (dup)
     {
         a_byte_t *dst = a_byte_p(ctx->_ptr);
         a_byte_t *src = a_byte_p(obj->_ptr);
-        for (a_byte_t *end = src + size; src != end;)
+        for (a_byte_t *const end = src + size; src != end;)
         {
             dup(dst, src);
             dst += ctx->_siz;
             src += ctx->_siz;
         }
     }
     else
     {
-        memcpy(ctx->_ptr, obj->_ptr, size);
+        a_copy(ctx->_ptr, obj->_ptr, size);
     }
     return A_SUCCESS;
 }
 
-a_vec_s *a_vec_move(a_vec_s *ctx, a_vec_s *obj)
+a_vec_s *a_vec_move(a_vec_s *const ctx, a_vec_s *const obj)
 {
-    memcpy(ctx, obj, sizeof(*obj));
-    memset(obj, 0, sizeof(*obj));
+    a_copy(ctx, obj, sizeof(*obj));
+    a_zero(obj, sizeof(*obj));
     return ctx;
 }
 
-a_void_t a_vec_set(a_vec_s *ctx, a_size_t size, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_vec_set(a_vec_s *const ctx, a_size_t size, a_void_t (*const dtor)(a_vptr_t))
 {
     size = size ? size : sizeof(a_cast_u);
     a_vec_drop_(ctx, 0, dtor);
     ctx->_mem = ctx->_mem * ctx->_siz / size;
     ctx->_siz = size;
 }
 
-a_int_t a_vec_make(a_vec_s *ctx, a_size_t num, a_void_t (*dtor)(a_vptr_t))
+a_int_t a_vec_make(a_vec_s *const ctx, a_size_t const num, a_void_t (*const dtor)(a_vptr_t))
 {
     if (a_unlikely(a_vec_alloc(ctx, num)))
     {
         return A_FAILURE;
     }
     a_vec_drop_(ctx, num, dtor);
     return A_SUCCESS;
 }
 
-a_void_t a_vec_drop(a_vec_s *ctx, a_void_t (*dtor)(a_vptr_t))
+a_void_t a_vec_drop(a_vec_s *const ctx, a_void_t (*const dtor)(a_vptr_t))
 {
     a_vec_drop_(ctx, 0, dtor);
 }
 
-a_void_t a_vec_swap(const a_vec_s *ctx, a_size_t lhs, a_size_t rhs)
+a_void_t a_vec_swap(a_vec_s const *const ctx, a_size_t lhs, a_size_t rhs)
 {
-    a_size_t num = ctx->_num - 1;
+    a_size_t const num = ctx->_num - 1;
     lhs = lhs < ctx->_num ? lhs : num;
     rhs = rhs < ctx->_num ? rhs : num;
     if (lhs != rhs)
     {
-        a_byte_t *ptr = a_byte_p(ctx->_ptr);
-        a_vptr_t lobj = ptr + lhs * ctx->_siz;
-        a_vptr_t robj = ptr + rhs * ctx->_siz;
-        a_swap(ctx->_siz, lobj, robj);
+        a_vptr_t const lobj = a_byte_p(ctx->_ptr) + lhs * ctx->_siz;
+        a_vptr_t const robj = a_byte_p(ctx->_ptr) + rhs * ctx->_siz;
+        a_swap(lobj, robj, ctx->_siz);
     }
 }
 
-a_void_t a_vec_sort(const a_vec_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_vec_sort(a_vec_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     qsort(ctx->_ptr, ctx->_num, ctx->_siz, cmp);
 }
 
-a_void_t a_vec_sort_fore(const a_vec_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_vec_sort_fore(a_vec_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_byte_t *ptr = a_byte_p(ctx->_ptr);
-        a_byte_t *end = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num - ctx->_siz;
+        a_byte_t *const end = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num - ctx->_siz;
         do
         {
-            a_byte_t *cur = ptr + ctx->_siz;
+            a_byte_t *const cur = ptr + ctx->_siz;
             if (cmp(ptr, cur) > 0)
             {
-                a_swap(ctx->_siz, cur, ptr);
+                a_swap(cur, ptr, ctx->_siz);
             }
             else
             {
                 break;
             }
             ptr = cur;
         } while (ptr != end);
     }
 }
 
-a_void_t a_vec_sort_back(const a_vec_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_vec_sort_back(a_vec_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_byte_t *ptr = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num - ctx->_siz;
         do
         {
-            a_byte_t *cur = ptr - ctx->_siz;
+            a_byte_t *const cur = ptr - ctx->_siz;
             if (cmp(cur, ptr) > 0)
             {
-                a_swap(ctx->_siz, cur, ptr);
+                a_swap(cur, ptr, ctx->_siz);
             }
             else
             {
                 break;
             }
             ptr = cur;
         } while (ptr != ctx->_ptr);
     }
 }
 
-a_vptr_t a_vec_search(const a_vec_s *ctx, a_cptr_t obj, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_vptr_t a_vec_search(a_vec_s const *const ctx, a_cptr_t const obj, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     return bsearch(obj, ctx->_ptr, ctx->_num, ctx->_siz, cmp);
 }
 
-a_vptr_t a_vec_insert(a_vec_s *ctx, a_size_t idx)
+a_vptr_t a_vec_insert(a_vec_s *const ctx, a_size_t const idx)
 {
     if (a_unlikely(a_vec_alloc(ctx, ctx->_num)))
     {
         return A_NULL;
     }
     if (idx < ctx->_num)
     {
-        a_byte_t *src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
-        a_byte_t *dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
-        memmove(dst, src, (ctx->_num - idx) * ctx->_siz);
+        a_byte_t *const src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
+        a_byte_t *const dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
+        a_move(dst, src, (ctx->_num - idx) * ctx->_siz);
         ++ctx->_num;
         return src;
     }
     return a_vec_inc_(ctx);
 }
 
-a_vptr_t a_vec_push_fore(a_vec_s *ctx) { return a_vec_insert(ctx, 0); }
+a_vptr_t a_vec_push_fore(a_vec_s *const ctx) { return a_vec_insert(ctx, 0); }
 
-a_vptr_t a_vec_push_back(a_vec_s *ctx)
+a_vptr_t a_vec_push_back(a_vec_s *const ctx)
 {
     if (a_unlikely(a_vec_alloc(ctx, ctx->_num)))
     {
         return A_NULL;
     }
     return a_vec_inc_(ctx);
 }
 
-a_vptr_t a_vec_remove(a_vec_s *ctx, a_size_t idx)
+a_vptr_t a_vec_remove(a_vec_s *const ctx, a_size_t const idx)
 {
     if (ctx->_num && idx < ctx->_num - 1)
     {
         if (a_unlikely(a_vec_alloc(ctx, ctx->_num)))
         {
             return A_NULL;
         }
-        a_byte_t *ptr = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num;
-        a_byte_t *dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
-        a_byte_t *src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
-        memcpy(ptr, dst, ctx->_siz);
-        memmove(dst, src, a_size_c(ptr - src));
+        a_byte_t *const ptr = a_byte_p(ctx->_ptr) + ctx->_siz * ctx->_num;
+        a_byte_t *const dst = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 0);
+        a_byte_t *const src = a_byte_p(ctx->_ptr) + ctx->_siz * (idx + 1);
+        a_copy(ptr, dst, ctx->_siz);
+        a_move(dst, src, a_size_c(ptr - src));
         --ctx->_num;
         return ptr;
     }
     return a_likely(ctx->_num) ? a_vec_dec_(ctx) : A_NULL;
 }
 
-a_vptr_t a_vec_pull_fore(a_vec_s *ctx) { return a_vec_remove(ctx, 0); }
+a_vptr_t a_vec_pull_fore(a_vec_s *const ctx) { return a_vec_remove(ctx, 0); }
 
-a_vptr_t a_vec_pull_back(a_vec_s *ctx)
+a_vptr_t a_vec_pull_back(a_vec_s *const ctx)
 {
     return a_likely(ctx->_num) ? a_vec_dec_(ctx) : A_NULL;
 }
```

### Comparing `liba-0.1.1rc4/src/host/vector.c` & `liba-0.1.1rc5/src/host/vector.c`

 * *Files 17% similar despite different names*

```diff
@@ -1,131 +1,130 @@
 #include "a/host/vector.h"
-#include <string.h>
 
 #undef a_vector_at
 #undef a_vector_at_
+#undef a_vector_idx
 #undef a_vector_ptr
 #undef a_vector_end
 #undef a_vector_top
 #undef a_vector_top_
 #undef a_vector_push
 #undef a_vector_pull
 #undef a_vector_search
 #undef a_vector_insert
 #undef a_vector_remove
 #undef a_vector_push_fore
 #undef a_vector_push_back
 #undef a_vector_pull_fore
 #undef a_vector_pull_back
 
-A_INTERN a_vptr_t a_vector_inc_(a_vector_s *ctx)
+static A_INLINE a_vptr_t a_vector_inc_(a_vector_s *const ctx)
 {
-    a_vptr_t last = ctx->_tail;
+    a_vptr_t const last = ctx->_tail;
     ctx->_tail = a_byte_p(ctx->_tail) + ctx->_size;
     return (void)(++ctx->_num), last;
 }
 
-A_INTERN a_vptr_t a_vector_dec_(a_vector_s *ctx)
+static A_INLINE a_vptr_t a_vector_dec_(a_vector_s *const ctx)
 {
     ctx->_tail = a_byte_p(ctx->_tail) - ctx->_size;
     return (void)(--ctx->_num), ctx->_tail;
 }
 
-A_STATIC a_void_t a_vector_drop_(a_vector_s *ctx, a_size_t bot)
+static a_void_t a_vector_drop_(a_vector_s *const ctx, a_size_t const bot)
 {
     if (ctx->dtor)
     {
         while (ctx->_num > bot)
         {
             ctx->dtor(a_vector_dec_(ctx));
         }
     }
     ctx->_tail = a_byte_p(ctx->_head) + ctx->_size * bot;
     ctx->_num = bot;
 }
 
-A_STATIC a_int_t a_vector_alloc(a_vector_s *ctx, a_size_t num)
+static a_int_t a_vector_alloc(a_vector_s *const ctx, a_size_t const num)
 {
     if (ctx->_mem <= num)
     {
         a_size_t mem = ctx->_mem;
         do
         {
             mem += (mem >> 1) + 1;
         } while (mem < num);
-        a_size_t mem_ = mem * ctx->_size;
-        a_size_t num_ = ctx->_num * ctx->_size;
-        a_size_t size = a_align(sizeof(a_vptr_t), mem_);
-        a_vptr_t head = realloc(ctx->_head, size);
+        a_size_t const mem_ = mem * ctx->_size;
+        a_size_t const num_ = ctx->_num * ctx->_size;
+        a_size_t const size = a_align(sizeof(a_vptr_t), mem_);
+        a_vptr_t const head = a_alloc(ctx->_head, size);
         if (a_unlikely(head == A_NULL))
         {
             return A_FAILURE;
         }
         ctx->_mem = mem;
         ctx->_head = head;
         ctx->_tail = a_byte_p(head) + num_;
         ctx->_last = a_byte_p(head) + mem_;
     }
     return A_SUCCESS;
 }
 
-a_vector_s *a_vector_new(a_size_t size,
-                         a_void_t (*ctor)(a_vptr_t),
-                         a_void_t (*dtor)(a_vptr_t))
+a_vector_s *a_vector_new(a_size_t const size,
+                         a_void_t (*const ctor)(a_vptr_t),
+                         a_void_t (*const dtor)(a_vptr_t))
 {
-    a_vector_s *ctx = (a_vector_s *)malloc(sizeof(a_vector_s));
+    a_vector_s *const ctx = (a_vector_s *)a_alloc(A_NULL, sizeof(a_vector_s));
     if (ctx)
     {
         a_vector_ctor(ctx, size, ctor, dtor);
     }
     return ctx;
 }
 
-a_void_t a_vector_die(a_vector_s *ctx)
+a_void_t a_vector_die(a_vector_s *const ctx)
 {
     if (ctx)
     {
         a_vector_dtor(ctx);
-        free(ctx);
+        a_alloc(ctx, 0);
     }
 }
 
-a_void_t a_vector_ctor(a_vector_s *ctx, a_size_t size,
-                       a_void_t (*ctor)(a_vptr_t),
-                       a_void_t (*dtor)(a_vptr_t))
+a_void_t a_vector_ctor(a_vector_s *const ctx, a_size_t const size,
+                       a_void_t (*const ctor)(a_vptr_t),
+                       a_void_t (*const dtor)(a_vptr_t))
 {
     ctx->_size = size ? size : sizeof(a_cast_u);
     ctx->ctor = ctor;
     ctx->dtor = dtor;
     ctx->_last = A_NULL;
     ctx->_tail = A_NULL;
     ctx->_head = A_NULL;
     ctx->_num = 0;
     ctx->_mem = 0;
 }
 
-a_void_t a_vector_dtor(a_vector_s *ctx)
+a_void_t a_vector_dtor(a_vector_s *const ctx)
 {
     if (ctx->_head)
     {
         a_vector_drop_(ctx, 0);
-        free(ctx->_head);
-        ctx->_head = A_NULL;
+        ctx->_head = a_alloc(ctx->_head, 0);
     }
     ctx->_tail = A_NULL;
     ctx->_last = A_NULL;
     ctx->_size = 0;
     ctx->_mem = 0;
 }
 
-a_int_t a_vector_copy(a_vector_s *ctx, const a_vector_s *obj, a_int_t (*dup)(a_vptr_t, a_cptr_t))
+a_int_t a_vector_copy(a_vector_s *const ctx, a_vector_s const *const obj, a_int_t (*const dup)(a_vptr_t, a_cptr_t))
 {
-    a_size_t num_ = obj->_num * obj->_size;
-    a_size_t mem_ = obj->_mem * obj->_size;
-    ctx->_head = malloc(mem_);
+    a_size_t const num_ = obj->_num * obj->_size;
+    a_size_t const mem_ = obj->_mem * obj->_size;
+    ctx->_head = a_alloc(A_NULL, mem_);
     if (a_unlikely(ctx->_head == A_NULL))
     {
         return A_FAILURE;
     }
     ctx->ctor = obj->ctor;
     ctx->dtor = obj->dtor;
     ctx->_num = obj->_num;
@@ -142,181 +141,180 @@
             dup(dst, src);
             dst += obj->_size;
             src += obj->_size;
         }
     }
     else
     {
-        memcpy(ctx->_head, obj->_head, num_);
+        a_copy(ctx->_head, obj->_head, num_);
     }
     return A_SUCCESS;
 }
 
-a_vector_s *a_vector_move(a_vector_s *ctx, a_vector_s *obj)
+a_vector_s *a_vector_move(a_vector_s *const ctx, a_vector_s *const obj)
 {
-    memcpy(ctx, obj, sizeof(*obj));
-    memset(obj, 0, sizeof(*obj));
+    a_copy(ctx, obj, sizeof(*obj));
+    a_zero(obj, sizeof(*obj));
     return ctx;
 }
 
-a_void_t a_vector_set(a_vector_s *ctx, a_size_t size,
-                      a_void_t (*ctor)(a_vptr_t),
-                      a_void_t (*dtor)(a_vptr_t))
+a_void_t a_vector_set(a_vector_s *const ctx, a_size_t size,
+                      a_void_t (*const ctor)(a_vptr_t),
+                      a_void_t (*const dtor)(a_vptr_t))
 {
     size = size ? size : sizeof(a_cast_u);
     a_vector_drop_(ctx, 0);
     ctx->_mem = ctx->_mem * ctx->_size / size;
     ctx->_size = size;
     ctx->ctor = ctor;
     ctx->dtor = dtor;
 }
 
-a_int_t a_vector_make(a_vector_s *ctx, a_size_t num)
+a_int_t a_vector_make(a_vector_s *const ctx, a_size_t const num)
 {
     if (a_unlikely(a_vector_alloc(ctx, num)))
     {
         return A_FAILURE;
     }
     a_vector_drop_(ctx, num);
     return A_SUCCESS;
 }
 
-a_void_t a_vector_drop(a_vector_s *ctx)
+a_void_t a_vector_drop(a_vector_s *const ctx)
 {
     a_vector_drop_(ctx, 0);
 }
 
-a_void_t a_vector_swap(const a_vector_s *ctx, a_size_t lhs, a_size_t rhs)
+a_void_t a_vector_swap(a_vector_s const *const ctx, a_size_t lhs, a_size_t rhs)
 {
-    a_size_t num = ctx->_num - 1;
+    a_size_t const num = ctx->_num - 1;
     lhs = lhs < ctx->_num ? lhs : num;
     rhs = rhs < ctx->_num ? rhs : num;
     if (lhs != rhs)
     {
-        a_byte_t *ptr = a_byte_p(ctx->_head);
-        a_vptr_t lobj = ptr + lhs * ctx->_size;
-        a_vptr_t robj = ptr + rhs * ctx->_size;
-        a_swap(ctx->_size, lobj, robj);
+        a_vptr_t const lobj = a_byte_p(ctx->_head) + lhs * ctx->_size;
+        a_vptr_t const robj = a_byte_p(ctx->_head) + rhs * ctx->_size;
+        a_swap(lobj, robj, ctx->_size);
     }
 }
 
-a_void_t a_vector_sort(const a_vector_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_vector_sort(a_vector_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     qsort(ctx->_head, ctx->_num, ctx->_size, cmp);
 }
 
-a_void_t a_vector_sort_fore(const a_vector_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_vector_sort_fore(a_vector_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_byte_t *ptr = a_byte_p(ctx->_head);
-        a_byte_t *end = a_byte_p(ctx->_tail) - ctx->_size;
+        a_byte_t *const end = a_byte_p(ctx->_tail) - ctx->_size;
         do
         {
-            a_byte_t *cur = ptr + ctx->_size;
+            a_byte_t *const cur = ptr + ctx->_size;
             if (cmp(ptr, cur) > 0)
             {
-                a_swap(ctx->_size, cur, ptr);
+                a_swap(cur, ptr, ctx->_size);
             }
             else
             {
                 break;
             }
             ptr = cur;
         } while (ptr != end);
     }
 }
 
-a_void_t a_vector_sort_back(const a_vector_s *ctx, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_void_t a_vector_sort_back(a_vector_s const *const ctx, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     if (ctx->_num > 1)
     {
         a_byte_t *ptr = a_byte_p(ctx->_tail) - ctx->_size;
         do
         {
-            a_byte_t *cur = ptr - ctx->_size;
+            a_byte_t *const cur = ptr - ctx->_size;
             if (cmp(cur, ptr) > 0)
             {
-                a_swap(ctx->_size, cur, ptr);
+                a_swap(cur, ptr, ctx->_size);
             }
             else
             {
                 break;
             }
             ptr = cur;
         } while (ptr != ctx->_head);
     }
 }
 
-a_vptr_t a_vector_search(const a_vector_s *ctx, a_cptr_t obj, a_int_t (*cmp)(a_cptr_t, a_cptr_t))
+a_vptr_t a_vector_search(a_vector_s const *const ctx, a_cptr_t const obj, a_int_t (*const cmp)(a_cptr_t, a_cptr_t))
 {
     return bsearch(obj, ctx->_head, ctx->_num, ctx->_size, cmp);
 }
 
-a_vptr_t a_vector_insert(a_vector_s *ctx, a_size_t idx)
+a_vptr_t a_vector_insert(a_vector_s *const ctx, a_size_t const idx)
 {
     if (a_unlikely(a_vector_alloc(ctx, ctx->_num)))
     {
         return A_NULL;
     }
     if (idx < ctx->_num)
     {
-        a_byte_t *ptr = a_byte_p(ctx->_tail);
-        a_byte_t *src = a_byte_p(ctx->_head) + ctx->_size * (idx + 0);
-        a_byte_t *dst = a_byte_p(ctx->_head) + ctx->_size * (idx + 1);
-        memmove(dst, src, a_size_c(ptr - src));
+        a_byte_t *const ptr = a_byte_p(ctx->_tail);
+        a_byte_t *const src = a_byte_p(ctx->_head) + ctx->_size * (idx + 0);
+        a_byte_t *const dst = a_byte_p(ctx->_head) + ctx->_size * (idx + 1);
+        a_move(dst, src, a_size_c(ptr - src));
         a_vector_inc_(ctx);
         if (ctx->ctor)
         {
             ctx->ctor(src);
         }
         return src;
     }
-    a_vptr_t obj = a_vector_inc_(ctx);
+    a_vptr_t const obj = a_vector_inc_(ctx);
     if (ctx->ctor)
     {
         ctx->ctor(obj);
     }
     return obj;
 }
 
-a_vptr_t a_vector_push_fore(a_vector_s *ctx) { return a_vector_insert(ctx, 0); }
+a_vptr_t a_vector_push_fore(a_vector_s *const ctx) { return a_vector_insert(ctx, 0); }
 
-a_vptr_t a_vector_push_back(a_vector_s *ctx)
+a_vptr_t a_vector_push_back(a_vector_s *const ctx)
 {
     if (a_unlikely(a_vector_alloc(ctx, ctx->_num)))
     {
         return A_NULL;
     }
-    a_vptr_t obj = a_vector_inc_(ctx);
+    a_vptr_t const obj = a_vector_inc_(ctx);
     if (ctx->ctor)
     {
         ctx->ctor(obj);
     }
     return obj;
 }
 
-a_vptr_t a_vector_remove(a_vector_s *ctx, a_size_t idx)
+a_vptr_t a_vector_remove(a_vector_s *const ctx, a_size_t const idx)
 {
     if (ctx->_num && idx < ctx->_num - 1)
     {
         if (a_unlikely(a_vector_alloc(ctx, ctx->_num)))
         {
             return A_NULL;
         }
-        a_byte_t *ptr = a_byte_p(ctx->_tail);
-        a_byte_t *dst = a_byte_p(ctx->_head) + ctx->_size * (idx + 0);
-        a_byte_t *src = a_byte_p(ctx->_head) + ctx->_size * (idx + 1);
-        memcpy(ptr, dst, ctx->_size);
-        memmove(dst, src, a_size_c(ptr - src));
+        a_byte_t *const ptr = a_byte_p(ctx->_tail);
+        a_byte_t *const dst = a_byte_p(ctx->_head) + ctx->_size * (idx + 0);
+        a_byte_t *const src = a_byte_p(ctx->_head) + ctx->_size * (idx + 1);
+        a_copy(ptr, dst, ctx->_size);
+        a_move(dst, src, a_size_c(ptr - src));
         a_vector_dec_(ctx);
         return ptr;
     }
     return a_likely(ctx->_head != ctx->_tail) ? a_vector_dec_(ctx) : A_NULL;
 }
 
-a_vptr_t a_vector_pull_fore(a_vector_s *ctx) { return a_vector_remove(ctx, 0); }
+a_vptr_t a_vector_pull_fore(a_vector_s *const ctx) { return a_vector_remove(ctx, 0); }
 
-a_vptr_t a_vector_pull_back(a_vector_s *ctx)
+a_vptr_t a_vector_pull_back(a_vector_s *const ctx)
 {
     return a_likely(ctx->_head != ctx->_tail) ? a_vector_dec_(ctx) : A_NULL;
 }
```

### Comparing `liba-0.1.1rc4/src/math.c` & `liba-0.1.1rc5/src/math.c`

 * *Files 16% similar despite different names*

```diff
@@ -1,49 +1,49 @@
 #include "math.h"
 
-a_f64_t a_f64_sq(a_f64_t x, a_f64_t *p)
+a_f64_t a_f64_sq(a_f64_t x, a_f64_t *const o)
 {
-#undef K
+#undef U
 #if defined(_MSC_VER) && (_MSC_VER < 1914)
     const union
     {
         a_u64_t u;
         a_f64_t x;
-    } k = {A_U64_C(0x41A0000000000000)};
-#define K k.x
+    } u = {A_U64_C(0x41A0000000000000)};
+#define U u.x
 #else
-#define K A_F64_C(0x1P27)
+#define U A_F64_C(0x1P27)
 #endif
     a_f64_t xh, xl, xc;
-    xc = x * (K + 1);
+    xc = x * (U + 1);
     xh = x - xc + xc;
     xl = x - xh;
     x *= x;
-    *p = xh * xh - x + 2 * xh * xl + xl * xl;
+    *o = xh * xh - x + 2 * xh * xl + xl * xl;
     return x;
-#undef K
+#undef U
 }
 
 #undef a_f32_hypot
 a_f32_t a_f32_hypot(a_f32_t x, a_f32_t y)
 {
-#undef NEG
-#undef POS
+#undef MIN
+#undef MAX
 #if defined(_MSC_VER) && (_MSC_VER < 1914)
     const union
     {
         a_u32_t u;
         a_f32_t x;
-    } pos = {A_U32_C(0x6C800000)},
-      neg = {A_U32_C(0x12800000)};
-#define POS pos.x
-#define NEG neg.x
+    } max = {A_U32_C(0x6C800000)},
+      min = {A_U32_C(0x12800000)};
+#define MAX max.x
+#define MIN min.x
 #else
-#define POS A_F32_C(0x1P+90)
-#define NEG A_F32_C(0x1P-90)
+#define MAX A_F32_C(0x1P+90)
+#define MIN A_F32_C(0x1P-90)
 #endif
     union
     {
         a_f32_t x;
         a_u32_t u;
     } ux, uy;
     a_f32_t z;
@@ -69,46 +69,46 @@
     {
         return x + y;
     }
 
     z = 1;
     if (ux.u >= (0x7F + 60) << 23)
     {
-        z = POS;
-        x *= NEG;
-        y *= NEG;
+        z = MAX;
+        x *= MIN;
+        y *= MIN;
     }
     else if (uy.u < (0x7F - 60) << 23)
     {
-        z = NEG;
-        x *= POS;
-        y *= POS;
+        z = MIN;
+        x *= MAX;
+        y *= MAX;
     }
     return z * a_f32_sqrt(a_f32_c(a_f64_c(x) * a_f64_c(x) + a_f64_c(y) * a_f64_c(y)));
-#undef NEG
-#undef POS
+#undef MIN
+#undef MAX
 }
 
 #undef a_f64_hypot
 a_f64_t a_f64_hypot(a_f64_t x, a_f64_t y)
 {
-#undef NEG
-#undef POS
+#undef MIN
+#undef MAX
 #if defined(_MSC_VER) && (_MSC_VER < 1914)
     const union
     {
         a_u64_t u;
         a_f64_t x;
-    } pos = {A_U64_C(0x6BB0000000000000)},
-      neg = {A_U64_C(0x1430000000000000)};
-#define POS pos.x
-#define NEG neg.x
+    } max = {A_U64_C(0x6BB0000000000000)},
+      min = {A_U64_C(0x1430000000000000)};
+#define MAX max.x
+#define MIN min.x
 #else
-#define POS A_F64_C(0x1P+700)
-#define NEG A_F64_C(0x1P-700)
+#define MAX A_F64_C(0x1P+700)
+#define MIN A_F64_C(0x1P-700)
 #endif
     union
     {
         a_f64_t x;
         a_u64_t u;
     } ux, uy;
     a_int_t ex, ey;
@@ -142,58 +142,98 @@
     {
         return x + y;
     }
 
     z = 1;
     if (ex > 0x3FF + 510)
     {
-        z = POS;
-        x *= NEG;
-        y *= NEG;
+        z = MAX;
+        x *= MIN;
+        y *= MIN;
     }
     else if (ey < 0x3FF - 450)
     {
-        z = NEG;
-        x *= POS;
-        y *= POS;
+        z = MIN;
+        x *= MAX;
+        y *= MAX;
     }
     hx = a_f64_sq(x, &lx);
     hy = a_f64_sq(y, &ly);
     return z * a_f64_sqrt(ly + lx + hy + hx);
-#undef NEG
-#undef POS
+#undef MIN
+#undef MAX
 }
 
-a_f32_t a_sqrt_inv(a_f32_t x)
+a_f32_t a_f32_rsqrt(a_f32_t const x)
 {
+#if 0
+    return 1 / a_f32_sqrt(x);
+#else
+#undef U
+#define U 0x5F375A86
     union
     {
         a_f32_t x;
         a_u32_t u;
     } u;
     u.x = x;
     if (a_likely(x > 0))
     {
         a_f32_t xh = A_F32_C(0.5) * x;
-        u.u = A_U32_C(0x5F3759DF) - (u.u >> 1);
+        u.u = A_U32_C(U) - (u.u >> 1);
         u.x *= A_F32_C(1.5) - u.x * u.x * xh;
         u.x *= A_F32_C(1.5) - u.x * u.x * xh;
     }
     else if (x < 0)
     {
         u.u = A_F32_NNAN;
     }
     else
     {
         u.u |= A_F32_PINF;
     }
     return u.x;
+#undef U
+#endif
+}
+
+a_f64_t a_f64_rsqrt(a_f64_t const x)
+{
+#if 0
+    return 1 / a_f64_sqrt(x);
+#else
+#undef U
+#define U 0x5FE6EC85E7DE30DA
+    union
+    {
+        a_f64_t x;
+        a_u64_t u;
+    } u;
+    u.x = x;
+    if (a_likely(x > 0))
+    {
+        a_f64_t xh = A_F64_C(0.5) * x;
+        u.u = A_U64_C(U) - (u.u >> 1);
+        u.x *= A_F64_C(1.5) - u.x * u.x * xh;
+        u.x *= A_F64_C(1.5) - u.x * u.x * xh;
+    }
+    else if (x < 0)
+    {
+        u.u = A_F64_NNAN;
+    }
+    else
+    {
+        u.u |= A_F64_PINF;
+    }
+    return u.x;
+#undef U
+#endif
 }
 
-a_u32_t a_u32_sqrt(a_u32_t x, a_u32_t *p)
+a_u32_t a_u32_sqrt(a_u32_t x, a_u32_t *const o)
 {
     a_u32_t y = 0;
     for (a_uint_t i = 0; i < 32; i += 2)
     {
         a_u32_t k = A_U32_C(0x40000000) >> i;
         a_u32_t j = y + k;
         if (x >= j)
@@ -202,22 +242,22 @@
             y = (y >> 1) | k;
         }
         else
         {
             y >>= 1;
         }
     }
-    if (p)
+    if (o)
     {
-        *p = x;
+        *o = x;
     }
     return y;
 }
 
-a_u64_t a_u64_sqrt(a_u64_t x, a_u64_t *p)
+a_u64_t a_u64_sqrt(a_u64_t x, a_u64_t *const o)
 {
     a_u64_t y = 0;
     for (a_uint_t i = 0; i < 64; i += 2)
     {
         a_u64_t k = A_U64_C(0x4000000000000000) >> i;
         a_u64_t j = y + k;
         if (x >= j)
@@ -226,13 +266,13 @@
             y = (y >> 1) | k;
         }
         else
         {
             y >>= 1;
         }
     }
-    if (p)
+    if (o)
     {
-        *p = x;
+        *o = x;
     }
     return y;
 }
```

### Comparing `liba-0.1.1rc4/src/mf.c` & `liba-0.1.1rc5/src/mf.c`

 * *Files 12% similar despite different names*

```diff
@@ -1,26 +1,26 @@
 #include "a/real.h"
 #include "a/mf.h"
 
-a_real_t a_mf_gauss(a_real_t x, a_real_t sigma, a_real_t c)
+a_real_t a_mf_gauss(a_real_t const x, a_real_t const sigma, a_real_t const c)
 {
     return a_real_exp(a_real_pow((x - c) / sigma, 2) / -2);
 }
 
-a_real_t a_mf_gbell(a_real_t x, a_real_t a, a_real_t b, a_real_t c)
+a_real_t a_mf_gbell(a_real_t const x, a_real_t const a, a_real_t const b, a_real_t const c)
 {
     return 1 / (a_real_pow(a_real_abs((x - c) / a), 2 * b) + 1);
 }
 
-a_real_t a_mf_sig(a_real_t x, a_real_t a, a_real_t c)
+a_real_t a_mf_sig(a_real_t const x, a_real_t const a, a_real_t const c)
 {
     return 1 / (a_real_exp((c - x) * a) + 1);
 }
 
-a_real_t a_mf_trap(a_real_t x, a_real_t a, a_real_t b, a_real_t c, a_real_t d)
+a_real_t a_mf_trap(a_real_t x, a_real_t const a, a_real_t const b, a_real_t const c, a_real_t const d)
 {
     if (x < b)
     {
         if (x > a) // a < x <= b
         {
             x = (x - a) / (b - a);
         }
@@ -43,15 +43,15 @@
     else // b <= x <= c
     {
         x = 1;
     }
     return x;
 }
 
-a_real_t a_mf_tri(a_real_t x, a_real_t a, a_real_t b, a_real_t c)
+a_real_t a_mf_tri(a_real_t x, a_real_t const a, a_real_t const b, a_real_t const c)
 {
     if (x < b)
     {
         if (x > a) // a < x <= b
         {
             x = (x - a) / (b - a);
         }
@@ -70,15 +70,15 @@
         {
             x = 0;
         }
     }
     return x;
 }
 
-a_real_t a_mf_z(a_real_t x, a_real_t a, a_real_t b)
+a_real_t a_mf_z(a_real_t x, a_real_t const a, a_real_t const b)
 {
     if (x < a)
     {
         x = 1;
     }
     else if (x < (a + b) / 2)
     {
@@ -91,15 +91,15 @@
     else
     {
         x = 0;
     }
     return x;
 }
 
-a_real_t a_mf(a_uint_t e, a_real_t x, a_real_t *a)
+a_real_t a_mf(a_uint_t const e, a_real_t const x, a_real_t const *const a)
 {
     switch (e)
     {
     case A_MF_GAUSS:
         return a_mf_gauss(x, a[0], a[1]);
     case A_MF_GBELL:
         return a_mf_gbell(x, a[0], a[1], a[2]);
```

### Comparing `liba-0.1.1rc4/src/pid.c` & `liba-0.1.1rc5/src/pid.c`

 * *Files 15% similar despite different names*

```diff
@@ -1,116 +1,123 @@
-#define A_PID_I
-#include "a/a.h"
-#include "inline.h"
+#define LIBA_PID_C
 #include "pid.h"
-#include "intern.h"
 
-a_void_t a_pid_set_dt(a_pid_s *ctx, a_real_t dt)
+a_void_t a_pid_set_dt(a_pid_s *const ctx, a_real_t const dt)
 {
-    a_real_t t = dt / ctx->dt;
+    a_real_t const t = dt / ctx->dt;
     ctx->ki *= t;
     ctx->kd /= t;
     ctx->dt = dt;
 }
 
-a_pid_s *a_pid_off(a_pid_s *ctx)
+a_pid_s *a_pid_off(a_pid_s *const ctx)
 {
     a_pid_set_mode(ctx, A_PID_OFF);
     return ctx;
 }
 
-a_pid_s *a_pid_inc(a_pid_s *ctx)
+a_pid_s *a_pid_inc(a_pid_s *const ctx)
 {
     a_pid_set_mode(ctx, A_PID_INC);
     return ctx;
 }
 
-a_pid_s *a_pid_pos(a_pid_s *ctx, a_real_t max)
+a_pid_s *a_pid_pos(a_pid_s *const ctx, a_real_t const max)
 {
     ctx->summax = (max > 0) ? max : -max;
     if (ctx->outmax < ctx->summax)
     {
         ctx->summax = ctx->outmax;
     }
     a_pid_set_mode(ctx, A_PID_POS);
     return ctx;
 }
 
-a_pid_s *a_pid_kpid(a_pid_s *ctx, a_real_t kp, a_real_t ki, a_real_t kd)
+a_pid_s *a_pid_kpid(a_pid_s *const ctx, a_real_t const kp, a_real_t const ki, a_real_t const kd)
 {
     ctx->kp = kp;
     ctx->ki = ki * ctx->dt;
     ctx->kd = kd / ctx->dt;
     return ctx;
 }
 
-a_pid_s *a_pid_setp(a_pid_s *ctx, a_uint_t num, a_real_t *out, a_real_t *fdb, a_real_t *sum, a_real_t *ec, a_real_t *e)
+a_pid_s *a_pid_chan(a_pid_s *const ctx, a_uint_t const num, a_real_t *const out, a_real_t *const fdb, a_real_t *const sum, a_real_t *const ec, a_real_t *const e)
 {
-    a_pid_set_num(ctx, num);
-    ctx->out.p = out;
-    ctx->fdb.p = fdb;
-    ctx->sum.p = sum;
-    ctx->ec.p = ec;
-    ctx->e.p = e;
+    if (num > 1)
+    {
+        a_pid_set_num(ctx, num);
+        ctx->out.p = out;
+        ctx->fdb.p = fdb;
+        ctx->sum.p = sum;
+        ctx->ec.p = ec;
+        ctx->e.p = e;
+    }
+    else
+    {
+        a_pid_set_num(ctx, 0);
+    }
     return a_pid_zero(ctx);
 }
 
-a_pid_s *a_pid_init(a_pid_s *ctx, a_real_t dt, a_real_t min, a_real_t max)
+a_pid_s *a_pid_init(a_pid_s *const ctx, a_real_t const dt, a_real_t const min, a_real_t const max)
 {
     ctx->reg = A_PID_OFF;
     ctx->outmin = min;
     ctx->outmax = max;
     ctx->summax = 0;
     ctx->num = 0;
     ctx->dt = dt;
     ctx->kp = 0;
     ctx->ki = 0;
     ctx->kd = 0;
     return a_pid_zero(ctx);
 }
 
-a_pid_s *a_pid_exit(a_pid_s *ctx) { return a_pid_zero(ctx); }
+a_pid_s *a_pid_exit(a_pid_s *const ctx) { return a_pid_zero(ctx); }
 
-a_pid_s *a_pid_zero(a_pid_s *ctx)
+a_pid_s *a_pid_zero(a_pid_s *const ctx)
 {
-    a_uint_t num = a_pid_num(ctx);
-    for (a_uint_t i = 0; i != num; ++i)
+    a_uint_t const num = a_pid_num(ctx);
+    if (num > 1)
     {
-        ctx->sum.p[i] = 0;
-        ctx->out.p[i] = 0;
-        ctx->fdb.p[i] = 0;
-        ctx->ec.p[i] = 0;
-        ctx->e.p[i] = 0;
+        for (a_uint_t i = 0; i != num; ++i)
+        {
+            ctx->sum.p[i] = 0;
+            ctx->out.p[i] = 0;
+            ctx->fdb.p[i] = 0;
+            ctx->ec.p[i] = 0;
+            ctx->e.p[i] = 0;
+        }
     }
-    if (num == 0)
+    else
     {
         ctx->out.v = 0;
         ctx->sum.v = 0;
         ctx->fdb.v = 0;
         ctx->ec.v = 0;
         ctx->e.v = 0;
     }
     return ctx;
 }
 
-a_real_t a_pid_outv_(a_pid_s *ctx, a_uint_t mode, a_real_t set, a_real_t fdb, a_real_t ec, a_real_t e)
+a_real_t a_pid_outv_(a_pid_s *const ctx, a_uint_t const mode, a_real_t const set, a_real_t const fdb, a_real_t const ec, a_real_t const e)
 {
     /* calculation */
     switch (mode)
     {
     case A_PID_INC:
     {
         /* K_p[e(k)-e(k-1)]+K_i e(k)+K_d[ec(k)-ec(k-1)] */
         ctx->sum.v += ctx->kp * ec + ctx->ki * e + ctx->kd * (ec - ctx->ec.v);
         ctx->out.v = ctx->sum.v;
         break;
     }
     case A_PID_POS:
     {
-        a_real_t sum = ctx->ki * e;
+        a_real_t const sum = ctx->ki * e;
         /* when the limit of integration is exceeded or */
         /* the direction of integration is the same, the integration stops. */
         if ((-ctx->summax < ctx->sum.v && ctx->sum.v < ctx->summax) || ctx->sum.v * sum < 0)
         {
             /* sum = K_i \sum^k_{i=0} e(i) */
             ctx->sum.v += sum;
         }
@@ -135,29 +142,29 @@
     /* cache data */
     ctx->fdb.v = fdb;
     ctx->ec.v = ec;
     ctx->e.v = e;
     return ctx->out.v;
 }
 
-a_real_t a_pid_outp_(a_pid_s *ctx, a_uint_t mode, a_real_t set, a_real_t fdb, a_real_t ec, a_real_t e, a_uint_t i)
+a_real_t a_pid_outp_(a_pid_s *const ctx, a_uint_t const mode, a_real_t const set, a_real_t const fdb, a_real_t const ec, a_real_t const e, a_uint_t const i)
 {
     /* calculation */
     switch (mode)
     {
     case A_PID_INC:
     {
         /* K_p[e(k)-e(k-1)]+K_i e(k)+K_d[ec(k)-ec(k-1)] */
         ctx->sum.p[i] += ctx->kp * ec + ctx->ki * e + ctx->kd * (ec - ctx->ec.p[i]);
         ctx->out.p[i] = ctx->sum.p[i];
         break;
     }
     case A_PID_POS:
     {
-        a_real_t sum = ctx->ki * e;
+        a_real_t const sum = ctx->ki * e;
         /* when the limit of integration is exceeded or */
         /* the direction of integration is the same, the integration stops. */
         if ((-ctx->summax < ctx->sum.p[i] && ctx->sum.p[i] < ctx->summax) || ctx->sum.p[i] * sum < 0)
         {
             /* sum = K_i \sum^k_{i=0} e(i) */
             ctx->sum.p[i] += sum;
         }
@@ -182,26 +189,26 @@
     /* cache data */
     ctx->fdb.p[i] = fdb;
     ctx->ec.p[i] = ec;
     ctx->e.p[i] = e;
     return ctx->out.p[i];
 }
 
-a_real_t a_pid_outv(a_pid_s *ctx, a_real_t set, a_real_t fdb)
+a_real_t a_pid_outv(a_pid_s *const ctx, a_real_t const set, a_real_t const fdb)
 {
-    a_real_t e = set - fdb;
-    a_real_t ec = e - ctx->e.v;
+    a_real_t const e = set - fdb;
+    a_real_t const ec = e - ctx->e.v;
     return a_pid_outv_(ctx, a_pid_mode(ctx), set, fdb, ec, e);
 }
 
-a_real_t *a_pid_outp(a_pid_s *ctx, a_real_t *set, a_real_t *fdb)
+a_real_t *a_pid_outp(a_pid_s *const ctx, a_real_t *const set, a_real_t *const fdb)
 {
-    a_uint_t num = a_pid_num(ctx);
-    a_uint_t reg = a_pid_mode(ctx);
+    a_uint_t const num = a_pid_num(ctx);
+    a_uint_t const mode = a_pid_mode(ctx);
     for (a_uint_t i = 0; i != num; ++i)
     {
-        a_real_t e = set[i] - fdb[i];
-        a_real_t ec = e - ctx->e.p[i];
-        a_pid_outp_(ctx, reg, set[i], fdb[i], ec, e, i);
+        a_real_t const e = set[i] - fdb[i];
+        a_real_t const ec = e - ctx->e.p[i];
+        a_pid_outp_(ctx, mode, set[i], fdb[i], ec, e, i);
     }
     return ctx->out.p;
 }
```

### Comparing `liba-0.1.1rc4/src/polytrack.c` & `liba-0.1.1rc5/src/polytrack.c`

 * *Files 8% similar despite different names*

```diff
@@ -1,65 +1,65 @@
 #include "a/polytrack.h"
 #include "a/poly.h"
 
 /* function for cubic polynomial trajectory */
 
-a_void_t a_polytrack3_init1(a_polytrack3_s *ctx, const a_real_t t[2], const a_real_t q[2], const a_real_t v[2])
+a_void_t a_polytrack3_init1(a_polytrack3_s *const ctx, a_real_t const t[2], a_real_t const q[2], a_real_t const v[2])
 {
     ctx->t[0] = t[0];
     ctx->t[1] = t[1];
     ctx->q[0] = q[0];
     ctx->q[1] = q[1];
     ctx->v[0] = v[0];
     ctx->v[1] = v[1];
     a_polytrack3_gen(ctx);
 }
 
-a_void_t a_polytrack3_init2(a_polytrack3_s *ctx, const a_real_t source[3], const a_real_t target[3])
+a_void_t a_polytrack3_init2(a_polytrack3_s *const ctx, a_real_t const source[3], a_real_t const target[3])
 {
     ctx->t[0] = source[0];
     ctx->t[1] = target[0];
     ctx->q[0] = source[1];
     ctx->q[1] = target[1];
     ctx->v[0] = source[2];
     ctx->v[1] = target[2];
     a_polytrack3_gen(ctx);
 }
 
-a_void_t a_polytrack3_init(a_polytrack3_s *ctx,
-                           a_real_t t0, a_real_t t1,
-                           a_real_t q0, a_real_t q1,
-                           a_real_t v0, a_real_t v1)
+a_void_t a_polytrack3_init(a_polytrack3_s *const ctx,
+                           a_real_t const t0, a_real_t const t1,
+                           a_real_t const q0, a_real_t const q1,
+                           a_real_t const v0, a_real_t const v1)
 {
     ctx->t[0] = t0;
     ctx->t[1] = t1;
     ctx->q[0] = q0;
     ctx->q[1] = q1;
     ctx->v[0] = v0;
     ctx->v[1] = v1;
     a_polytrack3_gen(ctx);
 }
 
-a_void_t a_polytrack3_gen(a_polytrack3_s *ctx)
+a_void_t a_polytrack3_gen(a_polytrack3_s *const ctx)
 {
-    a_real_t q = ctx->q[1] - ctx->q[0];
-    a_real_t t = ctx->t[1] - ctx->t[0];
-    a_real_t inv_t1 = 1 / t;
-    a_real_t inv_t2 = inv_t1 * inv_t1;
-    a_real_t inv_t3 = inv_t1 * inv_t2;
+    a_real_t const q = ctx->q[1] - ctx->q[0];
+    a_real_t const t = ctx->t[1] - ctx->t[0];
+    a_real_t const inv_t1 = 1 / t;
+    a_real_t const inv_t2 = inv_t1 * inv_t1;
+    a_real_t const inv_t3 = inv_t1 * inv_t2;
 
     ctx->k[0] = ctx->q[0];
     ctx->k[1] = ctx->v[0];
     ctx->k[2] = inv_t1 * (-2 * ctx->v[0] - ctx->v[1]) +
                 inv_t2 * q * 3;
     ctx->k[3] = inv_t2 * (ctx->v[0] + ctx->v[1]) -
                 inv_t3 * q * 2;
 }
 
-a_void_t a_polytrack3_out(const a_polytrack3_s *ctx, a_real_t ts, a_real_t out[3])
+a_void_t a_polytrack3_out(a_polytrack3_s const *const ctx, a_real_t ts, a_real_t out[3])
 {
     a_real_t a[4];
     a[0] = ctx->k[3];
     a[1] = ctx->k[2];
     a[2] = ctx->k[1];
     a[3] = ctx->k[0];
     ts -= ctx->t[0];
@@ -67,95 +67,95 @@
     a[0] *= 3;
     a[1] *= 2;
     out[1] = a_poly_evar(a, 3, ts);
     a[0] *= 2;
     out[2] = a_poly_evar(a, 2, ts);
 }
 
-a_real_t a_polytrack3_pos(const a_polytrack3_s *ctx, a_real_t ts)
+a_real_t a_polytrack3_pos(a_polytrack3_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[4];
     a[0] = ctx->k[3];
     a[1] = ctx->k[2];
     a[2] = ctx->k[1];
     a[3] = ctx->k[0];
     return a_poly_evar(a, 4, ts - ctx->t[0]);
 }
 
-a_real_t a_polytrack3_vec(const a_polytrack3_s *ctx, a_real_t ts)
+a_real_t a_polytrack3_vec(a_polytrack3_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[3];
     a[0] = ctx->k[3] * 3;
     a[1] = ctx->k[2] * 2;
     a[2] = ctx->k[1];
     return a_poly_evar(a, 3, ts - ctx->t[0]);
 }
 
-a_real_t a_polytrack3_acc(const a_polytrack3_s *ctx, a_real_t ts)
+a_real_t a_polytrack3_acc(a_polytrack3_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[2];
     a[0] = ctx->k[3] * 3 * 2;
     a[1] = ctx->k[2] * 2;
     return a_poly_evar(a, 2, ts - ctx->t[0]);
 }
 
 /* function for quintic polynomial trajectory */
 
-a_void_t a_polytrack5_init1(a_polytrack5_s *ctx, const a_real_t t[2], const a_real_t q[2], const a_real_t v[2], const a_real_t a[2])
+a_void_t a_polytrack5_init1(a_polytrack5_s *const ctx, a_real_t const t[2], a_real_t const q[2], a_real_t const v[2], a_real_t const a[2])
 {
     ctx->t[0] = t[0];
     ctx->t[1] = t[1];
     ctx->q[0] = q[0];
     ctx->q[1] = q[1];
     ctx->v[0] = v[0];
     ctx->v[1] = v[1];
     ctx->a[0] = a[0];
     ctx->a[1] = a[1];
     a_polytrack5_gen(ctx);
 }
 
-a_void_t a_polytrack5_init2(a_polytrack5_s *ctx, const a_real_t source[4], const a_real_t target[4])
+a_void_t a_polytrack5_init2(a_polytrack5_s *const ctx, a_real_t const source[4], a_real_t const target[4])
 {
     ctx->t[0] = source[0];
     ctx->t[1] = target[0];
     ctx->q[0] = source[1];
     ctx->q[1] = target[1];
     ctx->v[0] = source[2];
     ctx->v[1] = target[2];
     ctx->a[0] = source[3];
     ctx->a[1] = target[3];
     a_polytrack5_gen(ctx);
 }
 
-a_void_t a_polytrack5_init(a_polytrack5_s *ctx,
-                           a_real_t t0, a_real_t t1,
-                           a_real_t q0, a_real_t q1,
-                           a_real_t v0, a_real_t v1,
-                           a_real_t a0, a_real_t a1)
+a_void_t a_polytrack5_init(a_polytrack5_s *const ctx,
+                           a_real_t const t0, a_real_t const t1,
+                           a_real_t const q0, a_real_t const q1,
+                           a_real_t const v0, a_real_t const v1,
+                           a_real_t const a0, a_real_t const a1)
 {
     ctx->t[0] = t0;
     ctx->t[1] = t1;
     ctx->v[0] = v0;
     ctx->v[1] = v1;
     ctx->q[0] = q0;
     ctx->q[1] = q1;
     ctx->a[0] = a0;
     ctx->a[1] = a1;
     a_polytrack5_gen(ctx);
 }
 
-a_void_t a_polytrack5_gen(a_polytrack5_s *ctx)
+a_void_t a_polytrack5_gen(a_polytrack5_s *const ctx)
 {
-    a_real_t q = ctx->q[1] - ctx->q[0];
-    a_real_t t = ctx->t[1] - ctx->t[0];
-    a_real_t inv_t1 = 1 / t;
-    a_real_t inv_t2 = inv_t1 * inv_t1;
-    a_real_t inv_t3 = inv_t1 * inv_t2;
-    a_real_t inv_t4 = inv_t2 * inv_t2;
-    a_real_t inv_t5 = inv_t2 * inv_t3;
+    a_real_t const q = ctx->q[1] - ctx->q[0];
+    a_real_t const t = ctx->t[1] - ctx->t[0];
+    a_real_t const inv_t1 = 1 / t;
+    a_real_t const inv_t2 = inv_t1 * inv_t1;
+    a_real_t const inv_t3 = inv_t1 * inv_t2;
+    a_real_t const inv_t4 = inv_t2 * inv_t2;
+    a_real_t const inv_t5 = inv_t2 * inv_t3;
     ctx->k[0] = ctx->q[0];
     ctx->k[1] = ctx->v[0];
     ctx->k[2] = ctx->a[0] * a_real_c(1 / 2.0);
     ctx->k[3] = a_real_c(1 / 2.0) *
                 (inv_t1 * (ctx->a[1] - 3 * ctx->a[0]) -
                  inv_t2 * (12 * ctx->v[0] + 8 * ctx->v[1]) +
                  inv_t3 * q * 20);
@@ -165,15 +165,15 @@
                  inv_t4 * q * 30);
     ctx->k[5] = a_real_c(1 / 2.0) *
                 (inv_t3 * (ctx->a[1] - ctx->a[0]) -
                  inv_t4 * (ctx->v[0] + ctx->v[1]) * 6 +
                  inv_t5 * q * 12);
 }
 
-a_void_t a_polytrack5_out(const a_polytrack5_s *ctx, a_real_t ts, a_real_t out[3])
+a_void_t a_polytrack5_out(a_polytrack5_s const *const ctx, a_real_t ts, a_real_t out[3])
 {
     a_real_t a[6];
     a[0] = ctx->k[5];
     a[1] = ctx->k[4];
     a[2] = ctx->k[3];
     a[3] = ctx->k[2];
     a[4] = ctx->k[1];
@@ -187,110 +187,110 @@
     out[1] = a_poly_evar(a, 5, ts);
     a[0] *= 4;
     a[1] *= 3;
     a[2] *= 2;
     out[2] = a_poly_evar(a, 4, ts);
 }
 
-a_real_t a_polytrack5_pos(const a_polytrack5_s *ctx, a_real_t ts)
+a_real_t a_polytrack5_pos(a_polytrack5_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[6];
     a[0] = ctx->k[5];
     a[1] = ctx->k[4];
     a[2] = ctx->k[3];
     a[3] = ctx->k[2];
     a[4] = ctx->k[1];
     a[5] = ctx->k[0];
     return a_poly_evar(a, 6, ts - ctx->t[0]);
 }
 
-a_real_t a_polytrack5_vec(const a_polytrack5_s *ctx, a_real_t ts)
+a_real_t a_polytrack5_vec(a_polytrack5_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[5];
     a[0] = ctx->k[5] * 5;
     a[1] = ctx->k[4] * 4;
     a[2] = ctx->k[3] * 3;
     a[3] = ctx->k[2] * 2;
     a[4] = ctx->k[1];
     return a_poly_evar(a, 5, ts - ctx->t[0]);
 }
 
-a_real_t a_polytrack5_acc(const a_polytrack5_s *ctx, a_real_t ts)
+a_real_t a_polytrack5_acc(a_polytrack5_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[4];
     a[0] = ctx->k[5] * 5 * 4;
     a[1] = ctx->k[4] * 4 * 3;
     a[2] = ctx->k[3] * 3 * 2;
     a[3] = ctx->k[2] * 2;
     return a_poly_evar(a, 4, ts - ctx->t[0]);
 }
 
 /* function for hepta polynomial trajectory */
 
-a_void_t a_polytrack7_init1(a_polytrack7_s *ctx, const a_real_t t[2], const a_real_t q[2], const a_real_t v[2], const a_real_t a[2], const a_real_t j[2])
+a_void_t a_polytrack7_init1(a_polytrack7_s *const ctx, a_real_t const t[2], a_real_t const q[2], a_real_t const v[2], a_real_t const a[2], a_real_t const j[2])
 {
     ctx->t[0] = t[0];
     ctx->t[1] = t[1];
     ctx->q[0] = q[0];
     ctx->q[1] = q[1];
     ctx->v[0] = v[0];
     ctx->v[1] = v[1];
     ctx->a[0] = a[0];
     ctx->a[1] = a[1];
     ctx->j[0] = j[0];
     ctx->j[1] = j[1];
     a_polytrack7_gen(ctx);
 }
 
-a_void_t a_polytrack7_init2(a_polytrack7_s *ctx, const a_real_t source[5], const a_real_t target[5])
+a_void_t a_polytrack7_init2(a_polytrack7_s *const ctx, a_real_t const source[5], a_real_t const target[5])
 {
     ctx->t[0] = source[0];
     ctx->t[1] = target[0];
     ctx->q[0] = source[1];
     ctx->q[1] = target[1];
     ctx->v[0] = source[2];
     ctx->v[1] = target[2];
     ctx->a[0] = source[3];
     ctx->a[1] = target[3];
     ctx->j[0] = source[4];
     ctx->j[1] = target[4];
     a_polytrack7_gen(ctx);
 }
 
-a_void_t a_polytrack7_init(a_polytrack7_s *ctx,
-                           a_real_t t0, a_real_t t1,
-                           a_real_t q0, a_real_t q1,
-                           a_real_t v0, a_real_t v1,
-                           a_real_t a0, a_real_t a1,
-                           a_real_t j0, a_real_t j1)
+a_void_t a_polytrack7_init(a_polytrack7_s *const ctx,
+                           a_real_t const t0, a_real_t const t1,
+                           a_real_t const q0, a_real_t const q1,
+                           a_real_t const v0, a_real_t const v1,
+                           a_real_t const a0, a_real_t const a1,
+                           a_real_t const j0, a_real_t const j1)
 {
     ctx->t[0] = t0;
     ctx->t[1] = t1;
     ctx->q[0] = q0;
     ctx->q[1] = q1;
     ctx->v[0] = v0;
     ctx->v[1] = v1;
     ctx->a[0] = a0;
     ctx->a[1] = a1;
     ctx->j[0] = j0;
     ctx->j[1] = j1;
     a_polytrack7_gen(ctx);
 }
 
-a_void_t a_polytrack7_gen(a_polytrack7_s *ctx)
+a_void_t a_polytrack7_gen(a_polytrack7_s *const ctx)
 {
-    a_real_t q = ctx->q[1] - ctx->q[0];
-    a_real_t t = ctx->t[1] - ctx->t[0];
-    a_real_t inv_t1 = 1 / t;
-    a_real_t inv_t2 = inv_t1 * inv_t1;
-    a_real_t inv_t3 = inv_t1 * inv_t2;
-    a_real_t inv_t4 = inv_t2 * inv_t2;
-    a_real_t inv_t5 = inv_t2 * inv_t3;
-    a_real_t inv_t6 = inv_t3 * inv_t3;
-    a_real_t inv_t7 = inv_t3 * inv_t4;
+    a_real_t const q = ctx->q[1] - ctx->q[0];
+    a_real_t const t = ctx->t[1] - ctx->t[0];
+    a_real_t const inv_t1 = 1 / t;
+    a_real_t const inv_t2 = inv_t1 * inv_t1;
+    a_real_t const inv_t3 = inv_t1 * inv_t2;
+    a_real_t const inv_t4 = inv_t2 * inv_t2;
+    a_real_t const inv_t5 = inv_t2 * inv_t3;
+    a_real_t const inv_t6 = inv_t3 * inv_t3;
+    a_real_t const inv_t7 = inv_t3 * inv_t4;
     ctx->k[0] = ctx->q[0];
     ctx->k[1] = ctx->v[0];
     ctx->k[2] = ctx->a[0] * a_real_c(1 / 2.0);
     ctx->k[3] = ctx->j[0] * a_real_c(1 / 6.0);
     ctx->k[4] = a_real_c(1 / 6.0) *
                 (inv_t1 * (-4 * ctx->j[0] - ctx->j[1]) +
                  inv_t2 * (15 * ctx->a[1] - 30 * ctx->a[0]) -
@@ -309,15 +309,15 @@
     ctx->k[7] = a_real_c(1 / 6.0) *
                 (inv_t4 * (ctx->j[0] + ctx->j[1]) +
                  inv_t5 * (ctx->a[0] - ctx->a[1]) * 12 +
                  inv_t6 * (ctx->v[0] + ctx->v[1]) * 60 -
                  inv_t7 * q * 120);
 }
 
-a_void_t a_polytrack7_out(const a_polytrack7_s *ctx, a_real_t ts, a_real_t out[4])
+a_void_t a_polytrack7_out(a_polytrack7_s const *const ctx, a_real_t ts, a_real_t out[4])
 {
     a_real_t a[8];
     a[0] = ctx->k[7];
     a[1] = ctx->k[6];
     a[2] = ctx->k[5];
     a[3] = ctx->k[4];
     a[4] = ctx->k[3];
@@ -342,54 +342,54 @@
     a[0] *= 5;
     a[1] *= 4;
     a[2] *= 3;
     a[3] *= 2;
     out[3] = a_poly_evar(a, 5, ts);
 }
 
-a_real_t a_polytrack7_pos(const a_polytrack7_s *ctx, a_real_t ts)
+a_real_t a_polytrack7_pos(a_polytrack7_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[8];
     a[0] = ctx->k[7];
     a[1] = ctx->k[6];
     a[2] = ctx->k[5];
     a[3] = ctx->k[4];
     a[4] = ctx->k[3];
     a[5] = ctx->k[2];
     a[6] = ctx->k[1];
     a[7] = ctx->k[0];
     return a_poly_evar(a, 8, ts - ctx->t[0]);
 }
 
-a_real_t a_polytrack7_vec(const a_polytrack7_s *ctx, a_real_t ts)
+a_real_t a_polytrack7_vec(a_polytrack7_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[7];
     a[0] = ctx->k[7] * 7;
     a[1] = ctx->k[6] * 6;
     a[2] = ctx->k[5] * 5;
     a[3] = ctx->k[4] * 4;
     a[4] = ctx->k[3] * 3;
     a[5] = ctx->k[2] * 2;
     a[6] = ctx->k[1];
     return a_poly_evar(a, 7, ts - ctx->t[0]);
 }
 
-a_real_t a_polytrack7_acc(const a_polytrack7_s *ctx, a_real_t ts)
+a_real_t a_polytrack7_acc(a_polytrack7_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[6];
     a[0] = ctx->k[7] * 7 * 6;
     a[1] = ctx->k[6] * 6 * 5;
     a[2] = ctx->k[5] * 5 * 4;
     a[3] = ctx->k[4] * 4 * 3;
     a[4] = ctx->k[3] * 3 * 2;
     a[5] = ctx->k[2] * 2;
     return a_poly_evar(a, 6, ts - ctx->t[0]);
 }
 
-a_real_t a_polytrack7_jer(const a_polytrack7_s *ctx, a_real_t ts)
+a_real_t a_polytrack7_jer(a_polytrack7_s const *const ctx, a_real_t const ts)
 {
     a_real_t a[5];
     a[0] = ctx->k[7] * 7 * 6 * 5;
     a[1] = ctx->k[6] * 6 * 5 * 4;
     a[2] = ctx->k[5] * 5 * 4 * 3;
     a[3] = ctx->k[4] * 4 * 3 * 2;
     a[4] = ctx->k[3] * 3 * 2;
```

### Comparing `liba-0.1.1rc4/src/real.c` & `liba-0.1.1rc5/src/real.c`

 * *Files 8% similar despite different names*

```diff
@@ -1,29 +1,29 @@
 #include "a/real.h"
 
 #undef a_real_log1p
-a_real_t a_real_log1p(a_real_t x)
+a_real_t a_real_log1p(a_real_t const x)
 {
     return A_REAL_F1(log, x + 1);
 }
 
 #undef a_real_hypot
-a_real_t a_real_hypot(a_real_t x, a_real_t y)
+a_real_t a_real_hypot(a_real_t const x, a_real_t const y)
 {
 #if A_REAL_TYPE == A_REAL_SINGLE
     return a_f32_hypot(x, y);
 #elif A_REAL_TYPE == A_REAL_DOUBLE
     return a_f64_hypot(x, y);
 #elif A_REAL_TYPE == A_REAL_EXTEND
     return A_REAL_F1(sqrt, x * x + y * y);
 #endif /* A_REAL_TYPE */
 }
 
 #undef a_real_atan2
-a_real_t a_real_atan2(a_real_t x, a_real_t y)
+a_real_t a_real_atan2(a_real_t const x, a_real_t const y)
 {
     if (x > 0)
     {
         return A_REAL_F1(atan, y / x);
     }
     if (x < 0)
     {
```

### Comparing `liba-0.1.1rc4/src/tf.c` & `liba-0.1.1rc5/src/tf.c`

 * *Files 25% similar despite different names*

```diff
@@ -1,45 +1,44 @@
 #include "a/tf.h"
-#include <string.h>
 
-A_STATIC void a_tf_roll(a_real_t *p, a_uint_t n, a_real_t x)
+static void a_tf_roll(a_real_t *const p, a_uint_t n, a_real_t const x)
 {
     for (a_uint_t i = --n; i; n = i)
     {
         p[n] = p[--i];
     }
     *p = x;
 }
 
-a_void_t a_tf_set_num(a_tf_s *ctx, a_uint_t m, const a_real_t *num, a_real_t *u)
+a_void_t a_tf_set_num(a_tf_s *const ctx, a_uint_t const m, a_real_t const *const num, a_real_t *const u)
 {
-    memset(u, 0, sizeof(a_real_t) * m);
+    a_zero(u, sizeof(a_real_t) * m);
     ctx->num = num;
     ctx->m = m;
     ctx->u = u;
 }
 
-a_void_t a_tf_set_den(a_tf_s *ctx, a_uint_t n, const a_real_t *den, a_real_t *v)
+a_void_t a_tf_set_den(a_tf_s *const ctx, a_uint_t const n, a_real_t const *const den, a_real_t *const v)
 {
-    memset(v, 0, sizeof(a_real_t) * n);
+    a_zero(v, sizeof(a_real_t) * n);
     ctx->den = den;
     ctx->n = n;
     ctx->v = v;
 }
 
-a_tf_s *a_tf_init(a_tf_s *ctx,
-                  a_uint_t m, const a_real_t *num, a_real_t *u,
-                  a_uint_t n, const a_real_t *den, a_real_t *v)
+a_tf_s *a_tf_init(a_tf_s *const ctx,
+                  a_uint_t const m, a_real_t const *const num, a_real_t *const u,
+                  a_uint_t const n, a_real_t const *const den, a_real_t *const v)
 {
     a_tf_set_num(ctx, m, num, u);
     a_tf_set_den(ctx, n, den, v);
     return ctx;
 }
 
-a_real_t a_tf_proc(a_tf_s *ctx, a_real_t x)
+a_real_t a_tf_iter(a_tf_s *const ctx, a_real_t const x)
 {
     a_real_t y = 0;
     a_tf_roll(ctx->u, ctx->m, x);
     for (a_uint_t i = 0; i != ctx->m; ++i)
     {
         y += ctx->num[i] * ctx->u[i];
     }
@@ -47,15 +46,15 @@
     {
         y -= ctx->den[i] * ctx->v[i];
     }
     a_tf_roll(ctx->v, ctx->n, y);
     return y;
 }
 
-a_tf_s *a_tf_exit(a_tf_s *ctx) { return a_tf_zero(ctx); }
+a_tf_s *a_tf_exit(a_tf_s *const ctx) { return a_tf_zero(ctx); }
 
-a_tf_s *a_tf_zero(a_tf_s *ctx)
+a_tf_s *a_tf_zero(a_tf_s *const ctx)
 {
-    memset(ctx->u, 0, sizeof(a_real_t) * ctx->m);
-    memset(ctx->v, 0, sizeof(a_real_t) * ctx->n);
+    a_zero(ctx->u, sizeof(a_real_t) * ctx->m);
+    a_zero(ctx->v, sizeof(a_real_t) * ctx->n);
     return ctx;
 }
```

